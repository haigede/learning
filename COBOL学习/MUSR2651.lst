* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page   1
* MUSR2651.cob
     1******************************************************************
     2* $Header$
     3******************************************************************
     4*
     5* システムＩＤ   : T-STAR
     6* システム名称   : 次期TSTARシステム
     7* ＩＤ           : MUSR2651
     8* 名称           : GAMMA残高データ生成処理
     9* 処理概要       : 指定されたポートフォリオ且つ残高基準日FROM～TO
    10*                  期間内の処理対象日のデータを運用成果残高テーブ
    11*                  ルから抽出し、ＧＡＭMＡ用出力ファイルを作成
    12*                  する。
    13*                  更新結果により、進捗管理テーブルに対して、
    14*                 「進捗タスクID」が運用成果GX残高の
    15*                 「進捗ステータス」を更新する。
    16* 参照ＤＢ       : 運用成果残高
    17* 更新ＤＢ       : なし
    18* 引数           : 利用会社コード
    19*                  処理実行日
    20*                  業務タスクID
    21*                  起動ＩＤ
    22*                  ファイルパス
    23*
    24* 改訂履歴
    25* 年月日   区分 所属     担当    内容
    26* -------- ---- -------- ------- ---------------------------------
    27* 20080613 新規 SCS      徐勝飛  新規作成
    28* 20080908 修正 SCS      黄剣鵬  修正
    29* 20081029 修正 SCS      許国戦  修正
    30* 20081104 修正 SCS      許国戦  連結障害対応No.362
    31* 20081202 修正 SCS      劉輝    残タスク129の対応
    32* 20081204 修正 SCS      馬輝    残タスク159の対応
    33* 20081204 修正 SCS      馬輝    残タスク157の対応
    34* 20081211 修正 SCS      馬輝    残タスク135の対応
    35* 20081211 修正 SCS      馬輝    連結障害775の対応
    36* 20081212 修正 SCS      馬輝    連結障害841の対応
    37* 20081222 修正 SCS      馬輝    連結障害211の対応
    38* 20081230 修正 SCS      馬輝    連結障害493の対応
    39* 20090106 修正 SCS      馬輝    連結障害20090106の対応
    40* 20090106 修正 SCS      馬輝    連結障害1077の対応
    41* 20090227 修正 SCS      黄剣鵬  修正
    42* 20090319 修正 SCS      黄剣鵬  連結障害1532の対応
    43* 20090320 修正 SCS      黄剣鵬  連結障害No.1579
    44* 20090323 修正 SCS      黄剣鵬  連結障害No.1577
    45* 20090512 修正 SCS      馬輝    テーマ252対応
    46* 20090615 修正 SCS      馬輝    残タスク238の対応
    47* 20090615 修正 SCS      馬輝    残タスク246の対応
    48* 20090707 修正 SCS      馬輝    テーマ891の対応
    49* 20090710 修正 SCS      馬輝    テーマ945の対応
    50* 20090714 修正 SCS      馬輝    テーマ965の対応
    51* 20090716 修正 SCS      馬輝    テーマ1007の対応
    52* 20090720 修正 SCS      馬輝    テーマ1011の対応
    53* 20090728 修正 SCS      黄剣鵬  テーマ1102対応
    54* 20090727 修正 SCS      馬輝    テーマ1136
    55* 20090818 修正 SCS      馬輝    テーマ1304
    56* 20090818 修正 SCS      馬輝    テーマ1236
    57* 20090824 修正 SCS      馬輝    テーマ1061の対応
    58* 20090824 修正 SCS      馬輝    テーマ1379の対応
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page   2
* MUSR2651.cob
    59* 20090824 修正 SCS      馬輝    テーマ1382の対応
    60* 20090828 修正 SCS      馬輝    テーマ1418の対応
    61* 20090828 修正 SCS      馬輝    テーマ1419の対応
    62* 20090903 修正 SCS      馬輝    テーマ1015の対応
    63* 20090907 修正 SCS      馬輝    テーマ1374の対応
    64* 20090910 修正 SCS      馬輝    テーマ1527の対応
    65* 20090910 修正 SCS      馬輝    テーマ1526の対応
    66* 20090918 修正 SCS      馬輝    テーマ1644の対応
    67* 20090924 修正 SCS      馬輝    テーマ1650の対応
    68* 20090924 修正 SCS      梅春栄  テーマ1769の対応
    69* 20091009 修正 SCS      馬輝    テーマ1801の対応
    70* 20091009 修正 SCS      馬輝    テーマ1802の対応
    71* 20091009 修正 SCS      馬輝    テーマ1803の対応
    72* 20091009 修正 SCS      馬輝    テーマ1905の対応
    73* 20091102 修正 SCS      梅春栄  テーマ1976の対応
    74* 20091107 修正 SCS      黄剣鵬  テーマ2026の対応
    75* 20091102 修正 SCS      梅春栄  テーマ2057の対応
    76* 20091202 修正 SCS      丁      テーマ2185対応
    77* 20091210 修正 SCS      黄剣鵬  テーマ2216対応
    78* 20091216 修正 SCS      梅春栄  テーマ2275の対応
    79* 20091218 修正 SCS      梅春栄  テーマ2286の対応
    80* 20100114 修正 SCS      黄剣鵬  テーマ1945対応
    81* 20100404 修正 SCS      陳琦偉  テーマ2682の対応
    82* 20100624 修正 SCS      徐志成  テーマ2833の対応
    83* 20110228 修正 SCS      高志軍  テーマ2693対応
    84* 20110628 修正 SCS      高志軍  テーマ3276対応
    85* 20120723 修正 SCS      潘遠    テーマ3422対応
    86* 20120802 修正 SCS      潘遠    テーマ3428対応
    87* 20120830 修正 SCS      馬旭君  テーマ3422追加修正対応
    88* 20130115 修正 SCS      査      テーマ3456対応
    89* 20130117 修正 ISC      蒋小波  テーマ3406対応
    90* 20130718 修正 SCS      馬旭君  テーマ3344対応
    91******************************************************************
    92 IDENTIFICATION         DIVISION.
    93 PROGRAM-ID.    MUSR2651.
    94 AUTHOR.        Nomura.
    95 DATE-WRITTEN.  08-06-13.
    96 DATE-COMPILED. 04-Dec-13 16:03.
    97******************************************************************
    98*
    99*        環  境  部
   100*
   101******************************************************************
   102 ENVIRONMENT            DIVISION.
   103 CONFIGURATION          SECTION.
   104*SOURCE-COMPUTER.       L1000V.
   105 SOURCE-COMPUTER.       L1000V  WITH  DEBUGGING  MODE.
   106 OBJECT-COMPUTER.       RP5470.
   107 INPUT-OUTPUT           SECTION.
   108 FILE-CONTROL.
   109     SELECT  OUT-FILE
   110                        ASSIGN  TO  OUTFILE
   111                        ORGANIZATION IS  LINE SEQUENTIAL
   112                        FILE STATUS  IS  WK-FILE-STATUS.
   113     SELECT  OUT-FILE-2
   114                        ASSIGN  TO  OUTFILE-2
   115                        ORGANIZATION IS  LINE SEQUENTIAL
   116                        FILE STATUS  IS  WK-FILE-STATUS-2.
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page   3
* MUSR2651.cob
   117     SELECT  OUT-FILE-3
   118                        ASSIGN  TO  OUTFILE-3
   119                        ORGANIZATION IS  LINE SEQUENTIAL
   120                        FILE STATUS  IS  WK-FILE-STATUS-3.
   121     SELECT  OUT-FILE-4
   122                        ASSIGN  TO  OUTFILE-4
   123                        ORGANIZATION IS  LINE SEQUENTIAL
   124                        FILE STATUS  IS  WK-FILE-STATUS-4.
   125     SELECT  OUT-FILE-5
   126                        ASSIGN  TO  OUTFILE-5
   127                        ORGANIZATION IS  LINE SEQUENTIAL
   128                        FILE STATUS  IS  WK-FILE-STATUS-5.
   129     SELECT  OUT-FILE-6
   130                        ASSIGN  TO  OUTFILE-6
   131                        ORGANIZATION IS  LINE SEQUENTIAL
   132                        FILE STATUS  IS  WK-FILE-STATUS-6.
   133     SELECT  OUT-FILE-7
   134                        ASSIGN  TO  OUTFILE-7
   135                        ORGANIZATION IS  LINE SEQUENTIAL
   136                        FILE STATUS  IS  WK-FILE-STATUS-7.
   137     SELECT  OUT-FILE-8
   138                        ASSIGN  TO  OUTFILE-8
   139                        ORGANIZATION IS  LINE SEQUENTIAL
   140                        FILE STATUS  IS  WK-FILE-STATUS-8.
   141******************************************************************
   142*
   143*        デ  ー  タ  部
   144*
   145******************************************************************
   146 DATA                   DIVISION.
   147 FILE                   SECTION.
   148 FD  OUT-FILE
   149                   DATA       RECORD  DAT-REC
   150                   LABEL      RECORD  IS
   151                                        STANDARD.
   152 01  DAT-REC                 PIC  X(3000).
   153 FD  OUT-FILE-2
   154                   DATA       RECORD  DAT-REC2
   155                   LABEL      RECORD  IS
   156                                        STANDARD.
   157 01  DAT-REC2                PIC  X(3000).
   158 FD  OUT-FILE-3
   159                   DATA       RECORD  DAT-REC3
   160                   LABEL      RECORD  IS
   161                                        STANDARD.
   162 01  DAT-REC3                PIC  X(3000).
   163 FD  OUT-FILE-4
   164                   DATA       RECORD  DAT-REC4
   165                   LABEL      RECORD  IS
   166                                        STANDARD.
   167 01  DAT-REC4                PIC  X(3000).
   168 FD  OUT-FILE-5
   169                   DATA       RECORD  DAT-REC5
   170                   LABEL      RECORD  IS
   171                                        STANDARD.
   172 01  DAT-REC5                PIC  X(3000).
   173 FD  OUT-FILE-6
   174                   DATA       RECORD  DAT-REC6
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page   4
* MUSR2651.cob
   175                   LABEL      RECORD  IS
   176                                        STANDARD.
   177 01  DAT-REC6                PIC  X(3000).
   178 FD  OUT-FILE-7
   179                   DATA       RECORD  DAT-REC7
   180                   LABEL      RECORD  IS
   181                                        STANDARD.
   182 01  DAT-REC7                PIC  X(3000).
   183 FD  OUT-FILE-8
   184                   DATA       RECORD  DAT-REC8
   185                   LABEL      RECORD  IS
   186                                        STANDARD.
   187 01  DAT-REC8                PIC  X(3000).
   188******************************************************************
   189*        作業場所節
   190******************************************************************
   191 WORKING-STORAGE        SECTION.
   192 01  SQLFPN GLOBAL.
   193     02  SQLFPN-FILE-LEN PIC S9(4) COMP-5 VALUE +12.
   194     02  SQLFPN-FILENAME PIC X(12) VALUE "MUSR2651.pco".
   195
   196 01  SQLCTX GLOBAL PIC S9(9) COMP-5 VALUE +321461.
   197
   198
   199 01  SQLEXD GLOBAL.
   200     02  SQL-SQLVSN   PIC S9(9) COMP-5 VALUE +10.
   201     02  SQL-ARRSIZ   PIC S9(9) COMP-5 VALUE +118.
   202     02  SQL-ITERS    PIC S9(9) COMP-5.
   203     02  SQL-OFFSET   PIC S9(9) COMP-5.
   204     02  SQL-SELERR   PIC S9(4) COMP-5.
   205     02  SQL-SQLETY   PIC S9(4) COMP-5.
   206     02  SQL-OCCURS   PIC S9(9) COMP-5.
   207     02  SQL-CUD      PIC S9(9) COMP-5.
   208     02  SQL-SQLEST   PIC S9(9) COMP-5.
   209     02  SQL-STMT     PIC S9(9) COMP-5.
   210     02  SQL-SQLADTP  PIC S9(9) COMP-5 VALUE 0.
   211     02  SQL-SQLTDSP  PIC S9(9) COMP-5 VALUE 0.
   212     02  SQL-SQPHSV   PIC S9(9) COMP-5.
   213     02  SQL-SQPHSL   PIC S9(9) COMP-5.
   214     02  SQL-SQPHSS   PIC S9(9) COMP-5.
   215     02  SQL-SQPIND   PIC S9(9) COMP-5.
   216     02  SQL-SQPINS   PIC S9(9) COMP-5.
   217     02  SQL-SQPARM   PIC S9(9) COMP-5.
   218     02  SQL-SQPARC   PIC S9(9) COMP-5.
   219     02  SQL-SQPADTO  PIC S9(9) COMP-5.
   220     02  SQL-SQPTDSO  PIC S9(9) COMP-5.
   221     02  SQL-SQHSTV   PIC S9(9) COMP-5 OCCURS 118 TIMES.
   222     02  SQL-SQHSTL   PIC S9(9) COMP-5 OCCURS 118 TIMES.
   223     02  SQL-SQHSTS   PIC S9(9) COMP-5 OCCURS 118 TIMES.
   224     02  SQL-SQINDV   PIC S9(9) COMP-5 OCCURS 118 TIMES.
   225     02  SQL-SQINDS   PIC S9(9) COMP-5 OCCURS 118 TIMES.
   226     02  SQL-SQHARM   PIC S9(9) COMP-5 OCCURS 118 TIMES.
   227     02  SQL-SQHARC   PIC S9(9) COMP-5 OCCURS 118 TIMES.
   228     02  SQL-SQADTO   PIC S9(4) COMP-5 OCCURS 118 TIMES.
   229     02  SQL-SQTDSO   PIC S9(4) COMP-5 OCCURS 118 TIMES.
   230
   231
   232 01  SQL-RUNTIME-VARS.
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page   5
* MUSR2651.cob
   233     02  SQL-IAPXIT-SUCCESS  PIC S9(9) COMP-5 VALUE    +0.
   234     02  SQL-IAPXIT-FAILURE  PIC S9(9) COMP-5 VALUE +1403.
   235     02  SQL-IAPXIT-FATALERR PIC S9(9) COMP-5 VALUE  +535.
   236
   237 01  SQLCUD GLOBAL.
   238     02     FILLER PIC S9(4) COMP-5 VALUE +10.
   239     02     FILLER PIC S9(4) COMP-5 VALUE +4146.
   240     02     FILLER PIC S9(4) COMP-5 VALUE +838.
   241     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   242     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   243     02     FILLER PIC S9(4) COMP-5 VALUE +5.
   244     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   245     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   246     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   247     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   248     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   249     02     FILLER PIC S9(4) COMP-5 VALUE +27.
   250     02     FILLER PIC S9(4) COMP-5 VALUE +2346.
   251     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   252     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   253     02     FILLER PIC S9(4) COMP-5 VALUE +4.
   254     02     FILLER PIC S9(4) COMP-5 VALUE +4.
   255     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   256     02     FILLER PIC S9(4) COMP-5 VALUE +1.
   257     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   258     02     FILLER PIC S9(4) COMP-5 VALUE +1.
   259     02     FILLER PIC S9(4) COMP-5 VALUE +96.
   260     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   261     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   262     02     FILLER PIC S9(4) COMP-5 VALUE +1.
   263     02     FILLER PIC S9(4) COMP-5 VALUE +10.
   264     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   265     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   266     02     FILLER PIC S9(4) COMP-5 VALUE +1.
   267     02     FILLER PIC S9(4) COMP-5 VALUE +10.
   268     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   269     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   270     02     FILLER PIC S9(4) COMP-5 VALUE +1.
   271     02     FILLER PIC S9(4) COMP-5 VALUE +10.
   272     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   273     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   274     02     FILLER PIC S9(4) COMP-5 VALUE +36.
   275     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   276     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   277     02     FILLER PIC S9(4) COMP-5 VALUE +1.
   278     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   279     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   280     02     FILLER PIC S9(4) COMP-5 VALUE +17.
   281     02     FILLER PIC S9(4) COMP-5 VALUE +4788.
   282     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   283     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   284     02     FILLER PIC S9(4) COMP-5 VALUE +1.
   285     02     FILLER PIC S9(4) COMP-5 VALUE +1.
   286     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   287     02     FILLER PIC S9(4) COMP-5 VALUE +1.
   288     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   289     02     FILLER PIC S9(4) COMP-5 VALUE +1.
   290     02     FILLER PIC S9(4) COMP-5 VALUE +96.
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page   6
* MUSR2651.cob
   291     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   292     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   293     02     FILLER PIC S9(4) COMP-5 VALUE +55.
   294     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   295     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   296     02     FILLER PIC S9(4) COMP-5 VALUE +1.
   297     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   298     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   299     02     FILLER PIC S9(4) COMP-5 VALUE +45.
   300     02     FILLER PIC S9(4) COMP-5 VALUE +4842.
   301     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   302     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   303     02     FILLER PIC S9(4) COMP-5 VALUE +7.
   304     02     FILLER PIC S9(4) COMP-5 VALUE +7.
   305     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   306     02     FILLER PIC S9(4) COMP-5 VALUE +1.
   307     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   308     02     FILLER PIC S9(4) COMP-5 VALUE +1.
   309     02     FILLER PIC S9(4) COMP-5 VALUE +96.
   310     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   311     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   312     02     FILLER PIC S9(4) COMP-5 VALUE +1.
   313     02     FILLER PIC S9(4) COMP-5 VALUE +96.
   314     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   315     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   316     02     FILLER PIC S9(4) COMP-5 VALUE +1.
   317     02     FILLER PIC S9(4) COMP-5 VALUE +96.
   318     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   319     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   320     02     FILLER PIC S9(4) COMP-5 VALUE +1.
   321     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   322     02     FILLER PIC S9(4) COMP-5 VALUE +8.
   323     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   324     02     FILLER PIC S9(4) COMP-5 VALUE +1.
   325     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   326     02     FILLER PIC S9(4) COMP-5 VALUE +8.
   327     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   328     02     FILLER PIC S9(4) COMP-5 VALUE +1.
   329     02     FILLER PIC S9(4) COMP-5 VALUE +96.
   330     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   331     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   332     02     FILLER PIC S9(4) COMP-5 VALUE +1.
   333     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   334     02     FILLER PIC S9(4) COMP-5 VALUE +8.
   335     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   336     02     FILLER PIC S9(4) COMP-5 VALUE +98.
   337     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   338     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   339     02     FILLER PIC S9(4) COMP-5 VALUE +1.
   340     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   341     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   342     02     FILLER PIC S9(4) COMP-5 VALUE +13.
   343     02     FILLER PIC S9(4) COMP-5 VALUE +4904.
   344     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   345     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   346     02     FILLER PIC S9(4) COMP-5 VALUE +118.
   347     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   348     02     FILLER PIC S9(4) COMP-5 VALUE +0.
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page   7
* MUSR2651.cob
   349     02     FILLER PIC S9(4) COMP-5 VALUE +1.
   350     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   351     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   352     02     FILLER PIC S9(4) COMP-5 VALUE +96.
   353     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   354     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   355     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   356     02     FILLER PIC S9(4) COMP-5 VALUE +96.
   357     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   358     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   359     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   360     02     FILLER PIC S9(4) COMP-5 VALUE +96.
   361     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   362     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   363     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   364     02     FILLER PIC S9(4) COMP-5 VALUE +96.
   365     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   366     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   367     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   368     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   369     02     FILLER PIC S9(4) COMP-5 VALUE +8.
   370     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   371     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   372     02     FILLER PIC S9(4) COMP-5 VALUE +96.
   373     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   374     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   375     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   376     02     FILLER PIC S9(4) COMP-5 VALUE +96.
   377     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   378     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   379     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   380     02     FILLER PIC S9(4) COMP-5 VALUE +96.
   381     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   382     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   383     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   384     02     FILLER PIC S9(4) COMP-5 VALUE +96.
   385     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   386     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   387     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   388     02     FILLER PIC S9(4) COMP-5 VALUE +96.
   389     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   390     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   391     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   392     02     FILLER PIC S9(4) COMP-5 VALUE +96.
   393     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   394     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   395     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   396     02     FILLER PIC S9(4) COMP-5 VALUE +96.
   397     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   398     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   399     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   400     02     FILLER PIC S9(4) COMP-5 VALUE +96.
   401     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   402     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   403     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   404     02     FILLER PIC S9(4) COMP-5 VALUE +96.
   405     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   406     02     FILLER PIC S9(4) COMP-5 VALUE +0.
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page   8
* MUSR2651.cob
   407     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   408     02     FILLER PIC S9(4) COMP-5 VALUE +96.
   409     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   410     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   411     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   412     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   413     02     FILLER PIC S9(4) COMP-5 VALUE +8.
   414     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   415     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   416     02     FILLER PIC S9(4) COMP-5 VALUE +96.
   417     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   418     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   419     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   420     02     FILLER PIC S9(4) COMP-5 VALUE +96.
   421     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   422     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   423     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   424     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   425     02     FILLER PIC S9(4) COMP-5 VALUE +18.
   426     02     FILLER PIC S9(4) COMP-5 VALUE +6.
   427     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   428     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   429     02     FILLER PIC S9(4) COMP-5 VALUE +18.
   430     02     FILLER PIC S9(4) COMP-5 VALUE +6.
   431     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   432     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   433     02     FILLER PIC S9(4) COMP-5 VALUE +18.
   434     02     FILLER PIC S9(4) COMP-5 VALUE +3.
   435     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   436     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   437     02     FILLER PIC S9(4) COMP-5 VALUE +18.
   438     02     FILLER PIC S9(4) COMP-5 VALUE +10.
   439     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   440     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   441     02     FILLER PIC S9(4) COMP-5 VALUE +18.
   442     02     FILLER PIC S9(4) COMP-5 VALUE +10.
   443     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   444     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   445     02     FILLER PIC S9(4) COMP-5 VALUE +8.
   446     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   447     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   448     02     FILLER PIC S9(4) COMP-5 VALUE +96.
   449     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   450     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   451     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   452     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   453     02     FILLER PIC S9(4) COMP-5 VALUE +18.
   454     02     FILLER PIC S9(4) COMP-5 VALUE +3.
   455     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   456     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   457     02     FILLER PIC S9(4) COMP-5 VALUE +18.
   458     02     FILLER PIC S9(4) COMP-5 VALUE +3.
   459     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   460     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   461     02     FILLER PIC S9(4) COMP-5 VALUE +18.
   462     02     FILLER PIC S9(4) COMP-5 VALUE +3.
   463     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   464     02     FILLER PIC S9(4) COMP-5 VALUE +154.
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page   9
* MUSR2651.cob
   465     02     FILLER PIC S9(4) COMP-5 VALUE +18.
   466     02     FILLER PIC S9(4) COMP-5 VALUE +6.
   467     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   468     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   469     02     FILLER PIC S9(4) COMP-5 VALUE +18.
   470     02     FILLER PIC S9(4) COMP-5 VALUE +3.
   471     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   472     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   473     02     FILLER PIC S9(4) COMP-5 VALUE +18.
   474     02     FILLER PIC S9(4) COMP-5 VALUE +10.
   475     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   476     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   477     02     FILLER PIC S9(4) COMP-5 VALUE +8.
   478     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   479     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   480     02     FILLER PIC S9(4) COMP-5 VALUE +96.
   481     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   482     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   483     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   484     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   485     02     FILLER PIC S9(4) COMP-5 VALUE +18.
   486     02     FILLER PIC S9(4) COMP-5 VALUE +3.
   487     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   488     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   489     02     FILLER PIC S9(4) COMP-5 VALUE +18.
   490     02     FILLER PIC S9(4) COMP-5 VALUE +3.
   491     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   492     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   493     02     FILLER PIC S9(4) COMP-5 VALUE +18.
   494     02     FILLER PIC S9(4) COMP-5 VALUE +10.
   495     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   496     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   497     02     FILLER PIC S9(4) COMP-5 VALUE +18.
   498     02     FILLER PIC S9(4) COMP-5 VALUE +3.
   499     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   500     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   501     02     FILLER PIC S9(4) COMP-5 VALUE +18.
   502     02     FILLER PIC S9(4) COMP-5 VALUE +3.
   503     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   504     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   505     02     FILLER PIC S9(4) COMP-5 VALUE +18.
   506     02     FILLER PIC S9(4) COMP-5 VALUE +3.
   507     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   508     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   509     02     FILLER PIC S9(4) COMP-5 VALUE +18.
   510     02     FILLER PIC S9(4) COMP-5 VALUE +6.
   511     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   512     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   513     02     FILLER PIC S9(4) COMP-5 VALUE +18.
   514     02     FILLER PIC S9(4) COMP-5 VALUE +3.
   515     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   516     02     FILLER PIC S9(4) COMP-5 VALUE +96.
   517     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   518     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   519     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   520     02     FILLER PIC S9(4) COMP-5 VALUE +96.
   521     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   522     02     FILLER PIC S9(4) COMP-5 VALUE +0.
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  10
* MUSR2651.cob
   523     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   524     02     FILLER PIC S9(4) COMP-5 VALUE +96.
   525     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   526     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   527     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   528     02     FILLER PIC S9(4) COMP-5 VALUE +96.
   529     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   530     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   531     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   532     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   533     02     FILLER PIC S9(4) COMP-5 VALUE +18.
   534     02     FILLER PIC S9(4) COMP-5 VALUE +6.
   535     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   536     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   537     02     FILLER PIC S9(4) COMP-5 VALUE +18.
   538     02     FILLER PIC S9(4) COMP-5 VALUE +6.
   539     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   540     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   541     02     FILLER PIC S9(4) COMP-5 VALUE +18.
   542     02     FILLER PIC S9(4) COMP-5 VALUE +6.
   543     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   544     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   545     02     FILLER PIC S9(4) COMP-5 VALUE +18.
   546     02     FILLER PIC S9(4) COMP-5 VALUE +10.
   547     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   548     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   549     02     FILLER PIC S9(4) COMP-5 VALUE +18.
   550     02     FILLER PIC S9(4) COMP-5 VALUE +6.
   551     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   552     02     FILLER PIC S9(4) COMP-5 VALUE +96.
   553     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   554     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   555     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   556     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   557     02     FILLER PIC S9(4) COMP-5 VALUE +18.
   558     02     FILLER PIC S9(4) COMP-5 VALUE +3.
   559     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   560     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   561     02     FILLER PIC S9(4) COMP-5 VALUE +18.
   562     02     FILLER PIC S9(4) COMP-5 VALUE +3.
   563     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   564     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   565     02     FILLER PIC S9(4) COMP-5 VALUE +18.
   566     02     FILLER PIC S9(4) COMP-5 VALUE +10.
   567     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   568     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   569     02     FILLER PIC S9(4) COMP-5 VALUE +18.
   570     02     FILLER PIC S9(4) COMP-5 VALUE +3.
   571     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   572     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   573     02     FILLER PIC S9(4) COMP-5 VALUE +18.
   574     02     FILLER PIC S9(4) COMP-5 VALUE +3.
   575     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   576     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   577     02     FILLER PIC S9(4) COMP-5 VALUE +18.
   578     02     FILLER PIC S9(4) COMP-5 VALUE +3.
   579     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   580     02     FILLER PIC S9(4) COMP-5 VALUE +154.
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  11
* MUSR2651.cob
   581     02     FILLER PIC S9(4) COMP-5 VALUE +18.
   582     02     FILLER PIC S9(4) COMP-5 VALUE +3.
   583     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   584     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   585     02     FILLER PIC S9(4) COMP-5 VALUE +18.
   586     02     FILLER PIC S9(4) COMP-5 VALUE +3.
   587     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   588     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   589     02     FILLER PIC S9(4) COMP-5 VALUE +18.
   590     02     FILLER PIC S9(4) COMP-5 VALUE +3.
   591     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   592     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   593     02     FILLER PIC S9(4) COMP-5 VALUE +18.
   594     02     FILLER PIC S9(4) COMP-5 VALUE +3.
   595     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   596     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   597     02     FILLER PIC S9(4) COMP-5 VALUE +18.
   598     02     FILLER PIC S9(4) COMP-5 VALUE +3.
   599     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   600     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   601     02     FILLER PIC S9(4) COMP-5 VALUE +18.
   602     02     FILLER PIC S9(4) COMP-5 VALUE +3.
   603     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   604     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   605     02     FILLER PIC S9(4) COMP-5 VALUE +18.
   606     02     FILLER PIC S9(4) COMP-5 VALUE +3.
   607     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   608     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   609     02     FILLER PIC S9(4) COMP-5 VALUE +18.
   610     02     FILLER PIC S9(4) COMP-5 VALUE +3.
   611     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   612     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   613     02     FILLER PIC S9(4) COMP-5 VALUE +18.
   614     02     FILLER PIC S9(4) COMP-5 VALUE +3.
   615     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   616     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   617     02     FILLER PIC S9(4) COMP-5 VALUE +18.
   618     02     FILLER PIC S9(4) COMP-5 VALUE +3.
   619     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   620     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   621     02     FILLER PIC S9(4) COMP-5 VALUE +18.
   622     02     FILLER PIC S9(4) COMP-5 VALUE +3.
   623     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   624     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   625     02     FILLER PIC S9(4) COMP-5 VALUE +18.
   626     02     FILLER PIC S9(4) COMP-5 VALUE +3.
   627     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   628     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   629     02     FILLER PIC S9(4) COMP-5 VALUE +18.
   630     02     FILLER PIC S9(4) COMP-5 VALUE +3.
   631     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   632     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   633     02     FILLER PIC S9(4) COMP-5 VALUE +18.
   634     02     FILLER PIC S9(4) COMP-5 VALUE +3.
   635     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   636     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   637     02     FILLER PIC S9(4) COMP-5 VALUE +18.
   638     02     FILLER PIC S9(4) COMP-5 VALUE +3.
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  12
* MUSR2651.cob
   639     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   640     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   641     02     FILLER PIC S9(4) COMP-5 VALUE +18.
   642     02     FILLER PIC S9(4) COMP-5 VALUE +10.
   643     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   644     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   645     02     FILLER PIC S9(4) COMP-5 VALUE +18.
   646     02     FILLER PIC S9(4) COMP-5 VALUE +3.
   647     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   648     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   649     02     FILLER PIC S9(4) COMP-5 VALUE +18.
   650     02     FILLER PIC S9(4) COMP-5 VALUE +3.
   651     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   652     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   653     02     FILLER PIC S9(4) COMP-5 VALUE +18.
   654     02     FILLER PIC S9(4) COMP-5 VALUE +3.
   655     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   656     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   657     02     FILLER PIC S9(4) COMP-5 VALUE +18.
   658     02     FILLER PIC S9(4) COMP-5 VALUE +3.
   659     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   660     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   661     02     FILLER PIC S9(4) COMP-5 VALUE +18.
   662     02     FILLER PIC S9(4) COMP-5 VALUE +3.
   663     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   664     02     FILLER PIC S9(4) COMP-5 VALUE +96.
   665     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   666     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   667     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   668     02     FILLER PIC S9(4) COMP-5 VALUE +96.
   669     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   670     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   671     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   672     02     FILLER PIC S9(4) COMP-5 VALUE +96.
   673     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   674     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   675     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   676     02     FILLER PIC S9(4) COMP-5 VALUE +96.
   677     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   678     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   679     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   680     02     FILLER PIC S9(4) COMP-5 VALUE +96.
   681     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   682     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   683     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   684     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   685     02     FILLER PIC S9(4) COMP-5 VALUE +18.
   686     02     FILLER PIC S9(4) COMP-5 VALUE +3.
   687     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   688     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   689     02     FILLER PIC S9(4) COMP-5 VALUE +18.
   690     02     FILLER PIC S9(4) COMP-5 VALUE +3.
   691     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   692     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   693     02     FILLER PIC S9(4) COMP-5 VALUE +18.
   694     02     FILLER PIC S9(4) COMP-5 VALUE +10.
   695     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   696     02     FILLER PIC S9(4) COMP-5 VALUE +154.
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  13
* MUSR2651.cob
   697     02     FILLER PIC S9(4) COMP-5 VALUE +18.
   698     02     FILLER PIC S9(4) COMP-5 VALUE +10.
   699     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   700     02     FILLER PIC S9(4) COMP-5 VALUE +96.
   701     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   702     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   703     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   704     02     FILLER PIC S9(4) COMP-5 VALUE +96.
   705     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   706     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   707     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   708     02     FILLER PIC S9(4) COMP-5 VALUE +96.
   709     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   710     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   711     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   712     02     FILLER PIC S9(4) COMP-5 VALUE +96.
   713     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   714     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   715     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   716     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   717     02     FILLER PIC S9(4) COMP-5 VALUE +18.
   718     02     FILLER PIC S9(4) COMP-5 VALUE +3.
   719     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   720     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   721     02     FILLER PIC S9(4) COMP-5 VALUE +18.
   722     02     FILLER PIC S9(4) COMP-5 VALUE +3.
   723     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   724     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   725     02     FILLER PIC S9(4) COMP-5 VALUE +18.
   726     02     FILLER PIC S9(4) COMP-5 VALUE +3.
   727     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   728     02     FILLER PIC S9(4) COMP-5 VALUE +96.
   729     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   730     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   731     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   732     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   733     02     FILLER PIC S9(4) COMP-5 VALUE +18.
   734     02     FILLER PIC S9(4) COMP-5 VALUE +3.
   735     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   736     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   737     02     FILLER PIC S9(4) COMP-5 VALUE +18.
   738     02     FILLER PIC S9(4) COMP-5 VALUE +3.
   739     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   740     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   741     02     FILLER PIC S9(4) COMP-5 VALUE +18.
   742     02     FILLER PIC S9(4) COMP-5 VALUE +3.
   743     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   744     02     FILLER PIC S9(4) COMP-5 VALUE +96.
   745     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   746     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   747     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   748     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   749     02     FILLER PIC S9(4) COMP-5 VALUE +18.
   750     02     FILLER PIC S9(4) COMP-5 VALUE +3.
   751     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   752     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   753     02     FILLER PIC S9(4) COMP-5 VALUE +18.
   754     02     FILLER PIC S9(4) COMP-5 VALUE +3.
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  14
* MUSR2651.cob
   755     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   756     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   757     02     FILLER PIC S9(4) COMP-5 VALUE +18.
   758     02     FILLER PIC S9(4) COMP-5 VALUE +3.
   759     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   760     02     FILLER PIC S9(4) COMP-5 VALUE +96.
   761     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   762     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   763     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   764     02     FILLER PIC S9(4) COMP-5 VALUE +96.
   765     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   766     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   767     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   768     02     FILLER PIC S9(4) COMP-5 VALUE +96.
   769     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   770     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   771     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   772     02     FILLER PIC S9(4) COMP-5 VALUE +96.
   773     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   774     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   775     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   776     02     FILLER PIC S9(4) COMP-5 VALUE +96.
   777     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   778     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   779     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   780     02     FILLER PIC S9(4) COMP-5 VALUE +96.
   781     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   782     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   783     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   784     02     FILLER PIC S9(4) COMP-5 VALUE +96.
   785     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   786     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   787     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   788     02     FILLER PIC S9(4) COMP-5 VALUE +96.
   789     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   790     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   791     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   792     02     FILLER PIC S9(4) COMP-5 VALUE +96.
   793     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   794     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   795     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   796     02     FILLER PIC S9(4) COMP-5 VALUE +96.
   797     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   798     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   799     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   800     02     FILLER PIC S9(4) COMP-5 VALUE +96.
   801     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   802     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   803     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   804     02     FILLER PIC S9(4) COMP-5 VALUE +96.
   805     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   806     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   807     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   808     02     FILLER PIC S9(4) COMP-5 VALUE +96.
   809     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   810     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   811     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   812     02     FILLER PIC S9(4) COMP-5 VALUE +96.
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  15
* MUSR2651.cob
   813     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   814     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   815     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   816     02     FILLER PIC S9(4) COMP-5 VALUE +96.
   817     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   818     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   819     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   820     02     FILLER PIC S9(4) COMP-5 VALUE +96.
   821     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   822     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   823     02     FILLER PIC S9(4) COMP-5 VALUE +585.
   824     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   825     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   826     02     FILLER PIC S9(4) COMP-5 VALUE +1.
   827     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   828     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   829     02     FILLER PIC S9(4) COMP-5 VALUE +15.
   830     02     FILLER PIC S9(4) COMP-5 VALUE +6393.
   831     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   832     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   833     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   834     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   835     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   836     02     FILLER PIC S9(4) COMP-5 VALUE +1.
   837     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   838     02     FILLER PIC S9(4) COMP-5 VALUE +600.
   839     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   840     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   841     02     FILLER PIC S9(4) COMP-5 VALUE +1.
   842     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   843     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   844     02     FILLER PIC S9(4) COMP-5 VALUE +15.
   845     02     FILLER PIC S9(4) COMP-5 VALUE +6441.
   846     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   847     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   848     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   849     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   850     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   851     02     FILLER PIC S9(4) COMP-5 VALUE +1.
   852     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   853     02     FILLER PIC S9(4) COMP-5 VALUE +615.
   854     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   855     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   856     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   857     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   858     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   859     02     FILLER PIC S9(4) COMP-5 VALUE +17.
   860     02     FILLER PIC S9(4) COMP-5 VALUE +6552.
   861     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   862     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   863     02     FILLER PIC S9(4) COMP-5 VALUE +1.
   864     02     FILLER PIC S9(4) COMP-5 VALUE +1.
   865     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   866     02     FILLER PIC S9(4) COMP-5 VALUE +1.
   867     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   868     02     FILLER PIC S9(4) COMP-5 VALUE +1.
   869     02     FILLER PIC S9(4) COMP-5 VALUE +96.
   870     02     FILLER PIC S9(4) COMP-5 VALUE +0.
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  16
* MUSR2651.cob
   871     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   872     02     FILLER PIC S9(4) COMP-5 VALUE +634.
   873     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   874     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   875     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   876     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   877     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   878     02     FILLER PIC S9(4) COMP-5 VALUE +45.
   879     02     FILLER PIC S9(4) COMP-5 VALUE +6606.
   880     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   881     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   882     02     FILLER PIC S9(4) COMP-5 VALUE +6.
   883     02     FILLER PIC S9(4) COMP-5 VALUE +6.
   884     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   885     02     FILLER PIC S9(4) COMP-5 VALUE +1.
   886     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   887     02     FILLER PIC S9(4) COMP-5 VALUE +1.
   888     02     FILLER PIC S9(4) COMP-5 VALUE +96.
   889     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   890     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   891     02     FILLER PIC S9(4) COMP-5 VALUE +1.
   892     02     FILLER PIC S9(4) COMP-5 VALUE +96.
   893     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   894     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   895     02     FILLER PIC S9(4) COMP-5 VALUE +1.
   896     02     FILLER PIC S9(4) COMP-5 VALUE +96.
   897     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   898     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   899     02     FILLER PIC S9(4) COMP-5 VALUE +1.
   900     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   901     02     FILLER PIC S9(4) COMP-5 VALUE +8.
   902     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   903     02     FILLER PIC S9(4) COMP-5 VALUE +1.
   904     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   905     02     FILLER PIC S9(4) COMP-5 VALUE +8.
   906     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   907     02     FILLER PIC S9(4) COMP-5 VALUE +1.
   908     02     FILLER PIC S9(4) COMP-5 VALUE +96.
   909     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   910     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   911     02     FILLER PIC S9(4) COMP-5 VALUE +673.
   912     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   913     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   914     02     FILLER PIC S9(4) COMP-5 VALUE +3.
   915     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   916     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   917     02     FILLER PIC S9(4) COMP-5 VALUE +17.
   918     02     FILLER PIC S9(4) COMP-5 VALUE +2473.
   919     02     FILLER PIC S9(4) COMP-5 VALUE +1.
   920     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   921     02     FILLER PIC S9(4) COMP-5 VALUE +1.
   922     02     FILLER PIC S9(4) COMP-5 VALUE +1.
   923     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   924     02     FILLER PIC S9(4) COMP-5 VALUE +1.
   925     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   926     02     FILLER PIC S9(4) COMP-5 VALUE +1.
   927     02     FILLER PIC S9(4) COMP-5 VALUE +96.
   928     02     FILLER PIC S9(4) COMP-5 VALUE +0.
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  17
* MUSR2651.cob
   929     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   930     02     FILLER PIC S9(4) COMP-5 VALUE +692.
   931     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   932     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   933     02     FILLER PIC S9(4) COMP-5 VALUE +3.
   934     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   935     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   936     02     FILLER PIC S9(4) COMP-5 VALUE +45.
   937     02     FILLER PIC S9(4) COMP-5 VALUE +2527.
   938     02     FILLER PIC S9(4) COMP-5 VALUE +1.
   939     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   940     02     FILLER PIC S9(4) COMP-5 VALUE +7.
   941     02     FILLER PIC S9(4) COMP-5 VALUE +7.
   942     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   943     02     FILLER PIC S9(4) COMP-5 VALUE +1.
   944     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   945     02     FILLER PIC S9(4) COMP-5 VALUE +1.
   946     02     FILLER PIC S9(4) COMP-5 VALUE +96.
   947     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   948     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   949     02     FILLER PIC S9(4) COMP-5 VALUE +1.
   950     02     FILLER PIC S9(4) COMP-5 VALUE +96.
   951     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   952     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   953     02     FILLER PIC S9(4) COMP-5 VALUE +1.
   954     02     FILLER PIC S9(4) COMP-5 VALUE +96.
   955     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   956     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   957     02     FILLER PIC S9(4) COMP-5 VALUE +1.
   958     02     FILLER PIC S9(4) COMP-5 VALUE +96.
   959     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   960     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   961     02     FILLER PIC S9(4) COMP-5 VALUE +1.
   962     02     FILLER PIC S9(4) COMP-5 VALUE +96.
   963     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   964     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   965     02     FILLER PIC S9(4) COMP-5 VALUE +1.
   966     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   967     02     FILLER PIC S9(4) COMP-5 VALUE +8.
   968     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   969     02     FILLER PIC S9(4) COMP-5 VALUE +1.
   970     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   971     02     FILLER PIC S9(4) COMP-5 VALUE +8.
   972     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   973     02     FILLER PIC S9(4) COMP-5 VALUE +735.
   974     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   975     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   976     02     FILLER PIC S9(4) COMP-5 VALUE +3.
   977     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   978     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   979     02     FILLER PIC S9(4) COMP-5 VALUE +13.
   980     02     FILLER PIC S9(4) COMP-5 VALUE +2578.
   981     02     FILLER PIC S9(4) COMP-5 VALUE +1.
   982     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   983     02     FILLER PIC S9(4) COMP-5 VALUE +1.
   984     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   985     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   986     02     FILLER PIC S9(4) COMP-5 VALUE +1.
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  18
* MUSR2651.cob
   987     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   988     02     FILLER PIC S9(4) COMP-5 VALUE +2.
   989     02     FILLER PIC S9(4) COMP-5 VALUE +154.
   990     02     FILLER PIC S9(4) COMP-5 VALUE +8.
   991     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   992     02     FILLER PIC S9(4) COMP-5 VALUE +754.
   993     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   994     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   995     02     FILLER PIC S9(4) COMP-5 VALUE +1.
   996     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   997     02     FILLER PIC S9(4) COMP-5 VALUE +0.
   998     02     FILLER PIC S9(4) COMP-5 VALUE +15.
   999     02     FILLER PIC S9(4) COMP-5 VALUE +3000.
  1000     02     FILLER PIC S9(4) COMP-5 VALUE +1.
  1001     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1002     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1003     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1004     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1005     02     FILLER PIC S9(4) COMP-5 VALUE +1.
  1006     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1007     02     FILLER PIC S9(4) COMP-5 VALUE +769.
  1008     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1009     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1010     02     FILLER PIC S9(4) COMP-5 VALUE +2.
  1011     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1012     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1013     02     FILLER PIC S9(4) COMP-5 VALUE +15.
  1014     02     FILLER PIC S9(4) COMP-5 VALUE +3016.
  1015     02     FILLER PIC S9(4) COMP-5 VALUE +1.
  1016     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1017     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1018     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1019     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1020     02     FILLER PIC S9(4) COMP-5 VALUE +1.
  1021     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1022     02     FILLER PIC S9(4) COMP-5 VALUE +784.
  1023     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1024     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1025     02     FILLER PIC S9(4) COMP-5 VALUE +3.
  1026     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1027     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1028     02     FILLER PIC S9(4) COMP-5 VALUE +15.
  1029     02     FILLER PIC S9(4) COMP-5 VALUE +3033.
  1030     02     FILLER PIC S9(4) COMP-5 VALUE +1.
  1031     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1032     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1033     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1034     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1035     02     FILLER PIC S9(4) COMP-5 VALUE +1.
  1036     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1037     02     FILLER PIC S9(4) COMP-5 VALUE +799.
  1038     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1039     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1040     02     FILLER PIC S9(4) COMP-5 VALUE +4.
  1041     02     FILLER PIC S9(4) COMP-5 VALUE +7.
  1042     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1043     02     FILLER PIC S9(4) COMP-5 VALUE +30.
  1044     02     FILLER PIC S9(4) COMP-5 VALUE +3183.
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  19
* MUSR2651.cob
  1045     02     FILLER PIC S9(4) COMP-5 VALUE +1.
  1046     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1047     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1048     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1049     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1050     02     FILLER PIC S9(4) COMP-5 VALUE +1.
  1051     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1052     02     FILLER PIC S9(4) COMP-5 VALUE +814.
  1053     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1054     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1055     02     FILLER PIC S9(4) COMP-5 VALUE +5.
  1056     02     FILLER PIC S9(4) COMP-5 VALUE +9.
  1057     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1058     02     FILLER PIC S9(4) COMP-5 VALUE +32.
  1059     02     FILLER PIC S9(4) COMP-5 VALUE +3237.
  1060     02     FILLER PIC S9(4) COMP-5 VALUE +1.
  1061     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1062     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1063     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1064     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1065     02     FILLER PIC S9(4) COMP-5 VALUE +1.
  1066     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1067     02     FILLER PIC S9(4) COMP-5 VALUE +829.
  1068     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1069     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1070     02     FILLER PIC S9(4) COMP-5 VALUE +6.
  1071     02     FILLER PIC S9(4) COMP-5 VALUE +7.
  1072     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1073     02     FILLER PIC S9(4) COMP-5 VALUE +29.
  1074     02     FILLER PIC S9(4) COMP-5 VALUE +3637.
  1075     02     FILLER PIC S9(4) COMP-5 VALUE +1.
  1076     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1077     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1078     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1079     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1080     02     FILLER PIC S9(4) COMP-5 VALUE +1.
  1081     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1082     02     FILLER PIC S9(4) COMP-5 VALUE +844.
  1083     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1084     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1085     02     FILLER PIC S9(4) COMP-5 VALUE +7.
  1086     02     FILLER PIC S9(4) COMP-5 VALUE +7.
  1087     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1088     02     FILLER PIC S9(4) COMP-5 VALUE +29.
  1089     02     FILLER PIC S9(4) COMP-5 VALUE +3806.
  1090     02     FILLER PIC S9(4) COMP-5 VALUE +1.
  1091     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1092     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1093     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1094     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1095     02     FILLER PIC S9(4) COMP-5 VALUE +1.
  1096     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1097     02     FILLER PIC S9(4) COMP-5 VALUE +859.
  1098     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1099     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1100     02     FILLER PIC S9(4) COMP-5 VALUE +2.
  1101     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1102     02     FILLER PIC S9(4) COMP-5 VALUE +0.
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  20
* MUSR2651.cob
  1103     02     FILLER PIC S9(4) COMP-5 VALUE +13.
  1104     02     FILLER PIC S9(4) COMP-5 VALUE +1013.
  1105     02     FILLER PIC S9(4) COMP-5 VALUE +2.
  1106     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1107     02     FILLER PIC S9(4) COMP-5 VALUE +1.
  1108     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1109     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1110     02     FILLER PIC S9(4) COMP-5 VALUE +1.
  1111     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1112     02     FILLER PIC S9(4) COMP-5 VALUE +2.
  1113     02     FILLER PIC S9(4) COMP-5 VALUE +154.
  1114     02     FILLER PIC S9(4) COMP-5 VALUE +8.
  1115     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1116     02     FILLER PIC S9(4) COMP-5 VALUE +878.
  1117     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1118     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1119     02     FILLER PIC S9(4) COMP-5 VALUE +2.
  1120     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1121     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1122     02     FILLER PIC S9(4) COMP-5 VALUE +15.
  1123     02     FILLER PIC S9(4) COMP-5 VALUE +1293.
  1124     02     FILLER PIC S9(4) COMP-5 VALUE +2.
  1125     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1126     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1127     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1128     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1129     02     FILLER PIC S9(4) COMP-5 VALUE +1.
  1130     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1131     02     FILLER PIC S9(4) COMP-5 VALUE +893.
  1132     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1133     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1134     02     FILLER PIC S9(4) COMP-5 VALUE +2.
  1135     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1136     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1137     02     FILLER PIC S9(4) COMP-5 VALUE +15.
  1138     02     FILLER PIC S9(4) COMP-5 VALUE +1340.
  1139     02     FILLER PIC S9(4) COMP-5 VALUE +2.
  1140     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1141     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1142     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1143     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1144     02     FILLER PIC S9(4) COMP-5 VALUE +1.
  1145     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1146     02     FILLER PIC S9(4) COMP-5 VALUE +908.
  1147     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1148     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1149     02     FILLER PIC S9(4) COMP-5 VALUE +8.
  1150     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1151     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1152     02     FILLER PIC S9(4) COMP-5 VALUE +17.
  1153     02     FILLER PIC S9(4) COMP-5 VALUE +1675.
  1154     02     FILLER PIC S9(4) COMP-5 VALUE +2.
  1155     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1156     02     FILLER PIC S9(4) COMP-5 VALUE +1.
  1157     02     FILLER PIC S9(4) COMP-5 VALUE +1.
  1158     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1159     02     FILLER PIC S9(4) COMP-5 VALUE +1.
  1160     02     FILLER PIC S9(4) COMP-5 VALUE +0.
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  21
* MUSR2651.cob
  1161     02     FILLER PIC S9(4) COMP-5 VALUE +1.
  1162     02     FILLER PIC S9(4) COMP-5 VALUE +96.
  1163     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1164     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1165     02     FILLER PIC S9(4) COMP-5 VALUE +927.
  1166     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1167     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1168     02     FILLER PIC S9(4) COMP-5 VALUE +8.
  1169     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1170     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1171     02     FILLER PIC S9(4) COMP-5 VALUE +21.
  1172     02     FILLER PIC S9(4) COMP-5 VALUE +1722.
  1173     02     FILLER PIC S9(4) COMP-5 VALUE +2.
  1174     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1175     02     FILLER PIC S9(4) COMP-5 VALUE +7.
  1176     02     FILLER PIC S9(4) COMP-5 VALUE +7.
  1177     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1178     02     FILLER PIC S9(4) COMP-5 VALUE +1.
  1179     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1180     02     FILLER PIC S9(4) COMP-5 VALUE +1.
  1181     02     FILLER PIC S9(4) COMP-5 VALUE +154.
  1182     02     FILLER PIC S9(4) COMP-5 VALUE +8.
  1183     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1184     02     FILLER PIC S9(4) COMP-5 VALUE +1.
  1185     02     FILLER PIC S9(4) COMP-5 VALUE +96.
  1186     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1187     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1188     02     FILLER PIC S9(4) COMP-5 VALUE +1.
  1189     02     FILLER PIC S9(4) COMP-5 VALUE +96.
  1190     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1191     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1192     02     FILLER PIC S9(4) COMP-5 VALUE +1.
  1193     02     FILLER PIC S9(4) COMP-5 VALUE +96.
  1194     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1195     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1196     02     FILLER PIC S9(4) COMP-5 VALUE +1.
  1197     02     FILLER PIC S9(4) COMP-5 VALUE +96.
  1198     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1199     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1200     02     FILLER PIC S9(4) COMP-5 VALUE +1.
  1201     02     FILLER PIC S9(4) COMP-5 VALUE +96.
  1202     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1203     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1204     02     FILLER PIC S9(4) COMP-5 VALUE +1.
  1205     02     FILLER PIC S9(4) COMP-5 VALUE +96.
  1206     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1207     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1208     02     FILLER PIC S9(4) COMP-5 VALUE +970.
  1209     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1210     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1211     02     FILLER PIC S9(4) COMP-5 VALUE +3.
  1212     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1213     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1214     02     FILLER PIC S9(4) COMP-5 VALUE +15.
  1215     02     FILLER PIC S9(4) COMP-5 VALUE +1922.
  1216     02     FILLER PIC S9(4) COMP-5 VALUE +2.
  1217     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1218     02     FILLER PIC S9(4) COMP-5 VALUE +0.
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  22
* MUSR2651.cob
  1219     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1220     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1221     02     FILLER PIC S9(4) COMP-5 VALUE +1.
  1222     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1223     02     FILLER PIC S9(4) COMP-5 VALUE +985.
  1224     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1225     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1226     02     FILLER PIC S9(4) COMP-5 VALUE +3.
  1227     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1228     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1229     02     FILLER PIC S9(4) COMP-5 VALUE +15.
  1230     02     FILLER PIC S9(4) COMP-5 VALUE +1969.
  1231     02     FILLER PIC S9(4) COMP-5 VALUE +2.
  1232     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1233     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1234     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1235     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1236     02     FILLER PIC S9(4) COMP-5 VALUE +1.
  1237     02     FILLER PIC S9(4) COMP-5 VALUE +0.
  1238 01  IDNAME                  PIC  X(80)  VALUE
  1239 "$Id$".
  1240******************************************************************
  1241*                コンスタント  エリア
  1242******************************************************************
  1243 01  CONSTANT-AREA.
  1244*----------  共通用コンスタント
  1245   05  CNS-USCNS.
* 1246     COPY "USCNS.cpy".
  1247******************************************************************
  1248* $Header$
  1249******************************************************************
  1250*
  1251* システムＩＤ   : T-STAR
  1252* システム名称   : 次期TSTARシステム
  1253* コピー句ＩＤ   : USCNS.cpy
  1254* コピー句名称   : US共通用コンスタント
  1255*
  1256* 改訂履歴
  1257* 年月日   区分 所属   担当者  内容
  1258* -------- ---- ------ ------- -----------------------------------
  1259* 20071227 新規 SCS            新規作成
  1260******************************************************************
  1261*----------   顧問共通用コンスタント
* 1262     COPY  "KOMONCNS.cpy".
  1263******************************************************************
  1264* $Header$
  1265******************************************************************
  1266*
  1267* システムＩＤ   : T-STAR
  1268* システム名称   : 新有価証券バックオフィスシステム
  1269* コピー句ＩＤ   : KOMONCNS.cpy
  1270* コピー句名称   : 顧問共通用コンスタント
  1271*
  1272* 改訂履歴
  1273* 年月日   区分 所属   担当者  内容
  1274* -------- ---- ------ ------- -----------------------------------
  1275* 20071106 新規 SCS            新規作成
  1276******************************************************************
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  23
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/KOMONCNS.cpy)
  1277*                ＳＱＬ  リターンコード
  1278******************************************************************
  1279 20  CNS-SQL-NORMAL          PIC  S9(04) VALUE  0.
  1280 20  CNS-SQL-NOTFOUND        PIC  S9(04) VALUE  +1403.
  1281 20  CNS-SQL-LOCK            PIC  S9(09) VALUE  -54.
  1282 20  CNS-SQL-UNIQUE          PIC  S9(04) VALUE  -1.
  1283******************************************************************
  1284*                ＳＱＬ  コンスタント
  1285******************************************************************
  1286 20  CNS-SQL-OPEN            PIC  X(04)  VALUE  "OPEN".
  1287 20  CNS-SQL-CLOSE           PIC  X(05)  VALUE  "CLOSE".
  1288 20  CNS-SQL-SELECT          PIC  X(06)  VALUE  "SELECT".
  1289 20  CNS-SQL-FETCH           PIC  X(05)  VALUE  "FETCH".
  1290 20  CNS-SQL-INSERT          PIC  X(06)  VALUE  "INSERT".
  1291 20  CNS-SQL-UPDATE          PIC  X(06)  VALUE  "UPDATE".
  1292 20  CNS-SQL-DELETE          PIC  X(06)  VALUE  "DELETE".
  1293 20  CNS-SQL-PREPARE         PIC  X(07)  VALUE  "PREPARE".
  1294 20  CNS-SQL-TRUNCATE        PIC  X(06)  VALUE  "TRUNCA".
  1295 20  CNS-SQL-DROP            PIC  X(04)  VALUE  "DROP".
  1296 20  CNS-SQL-CREATE          PIC  X(06)  VALUE  "CREATE".
  1297 20  CNS-SQL-CONNECT         PIC  X(08)  VALUE  "CONNECT ".
  1298 20  CNS-SQL-COMMIT          PIC  X(14)  VALUE  "COMMIT RELEASE".
  1299 20  CNS-SQL-ALTER           PIC  X(05)  VALUE  "ALTER".
  1300 20  CNS-SQL-ROLLBACK        PIC  X(08)  VALUE  "ROLLBACK".
  1301 20  CNS-SQL-DISCONNECT      PIC  X(06)  VALUE  "DISCON".
  1302 20  CNS-SQL-NULL            PIC  X(04)  VALUE  "NULL".
  1303 20  CNS-SQL-DUAL            PIC  X(04)  VALUE  "DUAL".
  1304******************************************************************
  1305*                ファイル  リターンコード
  1306******************************************************************
  1307 20  CNS-FILE-NORMAL         PIC  X(02)  VALUE "00".
  1308 20  CNS-FILE-EOF            PIC  X(02)  VALUE "10".
  1309******************************************************************
  1310*                ファイル  コンスタント
  1311******************************************************************
  1312 20  CNS-FILE-OPEN           PIC  X(04)  VALUE "OPEN".
  1313 20  CNS-FILE-READ           PIC  X(04)  VALUE "READ".
  1314 20  CNS-FILE-WRITE          PIC  X(05)  VALUE "WRITE".
  1315 20  CNS-FILE-CLOSE          PIC  X(05)  VALUE "CLOSE".
  1316******************************************************************
  1317*                バッチ終了メッセージ出力ルーチン エラー種別
  1318******************************************************************
  1319 20  CNS-N                   PIC  X(01)  VALUE  "N".
  1320 20  CNS-U                   PIC  X(01)  VALUE  "U".
  1321 20  CNS-S                   PIC  X(01)  VALUE  "S".
  1322******************************************************************
  1323*----------  引数の何番目
  1324******************************************************************
  1325 20  CNS-IDX-01              PIC  9(01)  VALUE  1.
  1326 20  CNS-IDX-02              PIC  9(01)  VALUE  2.
  1327 20  CNS-IDX-03              PIC  9(01)  VALUE  3.
  1328 20  CNS-IDX-04              PIC  9(01)  VALUE  4.
  1329 20  CNS-IDX-05              PIC  9(01)  VALUE  5.
  1330 20  CNS-IDX-06              PIC  9(01)  VALUE  6.
  1331 20  CNS-IDX-07              PIC  9(01)  VALUE  7.
  1332 20  CNS-IDX-08              PIC  9(01)  VALUE  8.
  1333 20  CNS-IDX-09              PIC  9(01)  VALUE  9.
  1334******************************************************************
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  24
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/KOMONCNS.cpy)
  1335*                詳細リターンコードデコードフラグ
  1336******************************************************************
  1337 20  CNS-DETAIL-0            PIC  X(01)  VALUE "0".
  1338 20  CNS-DETAIL-1            PIC  X(01)  VALUE "1".
  1339 20  CNS-DETAIL-2            PIC  X(01)  VALUE "2".
  1340******************************************************************
  1341*                サブRTN戻り値
  1342******************************************************************
  1343 20  CNS-RTN-000             PIC  X(03)  VALUE  "000".
  1344 20  CNS-RTN-002             PIC  X(03)  VALUE  "002".
  1345 20  CNS-RTN-003             PIC  X(03)  VALUE  "003".
  1346 20  CNS-RTN-110             PIC  X(03)  VALUE  "110".
  1347 20  CNS-RTN-130             PIC  X(03)  VALUE  "130".
  1348 20  CNS-RTN-160             PIC  X(03)  VALUE  "160".
  1349 20  CNS-RTN-200             PIC  X(03)  VALUE  "200".
  1350 20  CNS-RTN-220             PIC  X(03)  VALUE  "220".
  1351 20  CNS-RTN-230             PIC  X(03)  VALUE  "230".
  1352 20  CNS-RTN-300             PIC  X(03)  VALUE  "300".
  1353 20  CNS-RTN-320             PIC  X(03)  VALUE  "320".
  1354 20  CNS-RTN-340             PIC  X(03)  VALUE  "340".
  1355 20  CNS-RTN-400             PIC  X(03)  VALUE  "400".
  1356 20  CNS-RTN-800             PIC  X(03)  VALUE  "800".
  1357 20  CNS-RTN-810             PIC  X(03)  VALUE  "810".
  1358 20  CNS-RTN-900             PIC  X(03)  VALUE  "900".
  1359 20  CNS-RTN-901             PIC  X(03)  VALUE  "901".
  1360 20  CNS-RTN-910             PIC  X(03)  VALUE  "910".
  1361******************************************************************
  1362*                SPP戻り値
  1363******************************************************************
  1364 20  CNS-RTN-SPP0            PIC  X(01)  VALUE  "0".
  1365 20  CNS-RTN-SPP6            PIC  X(01)  VALUE  "6".
  1366 20  CNS-RTN-SPP7            PIC  X(01)  VALUE  "7".
  1367 20  CNS-RTN-SPPUA           PIC  X(01)  VALUE  "A".
  1368 20  CNS-RTN-SPPLA           PIC  X(01)  VALUE  "a".
  1369******************************************************************
  1370*                OL/BT区分
  1371******************************************************************
  1372 20  CNS-OL                  PIC  X(02)  VALUE  "OL".
  1373 20  CNS-BT                  PIC  X(02)  VALUE  "BT".
  1374******************************************************************
  1375*                起動処理分類
  1376******************************************************************
  1377 20  CNS-KIDO-KBN-SPP        PIC  X(01)  VALUE  "1".
  1378 20  CNS-KIDO-KBN-BT         PIC  X(01)  VALUE  "3".
  1379******************************************************************
  1380*                JOBアベンド区分
  1381******************************************************************
  1382 20  CNS-JOB-KBN-NML         PIC  X(01)  VALUE  "0".
  1383 20  CNS-JOB-KBN-ABD         PIC  X(01)  VALUE  "1".
  1384******************************************************************
  1385*                ステータス
  1386******************************************************************
  1387 20  CNS-ON                  PIC  9(01)  VALUE  1.
  1388 20  CNS-OFF                 PIC  9(01)  VALUE  0.
  1389******************************************************************
  1390*                シェル戻り値
  1391******************************************************************
  1392 20  CNS-RTN-00              PIC  9(02)  VALUE  0.
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  25
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/KOMONCNS.cpy)
  1393 20  CNS-RTN-02              PIC  9(02)  VALUE  2.
  1394 20  CNS-RTN-04              PIC  9(02)  VALUE  4.
  1395 20  CNS-RTN-08              PIC  9(02)  VALUE  8.
  1396 20  CNS-RTN-16              PIC  9(02)  VALUE  16.
  1397******************************************************************
  1398*                共通USER
  1399******************************************************************
  1400 20  CNS-KYOUTU-USER         PIC  X(04)  VALUE  "C000".
  1401******************************************************************
  1402*                ポジション用コンスタント
  1403******************************************************************
  1404 20  CNS-POS-001             PIC  X(04)  VALUE "0001".
  1405 20  CNS-POS-002             PIC  X(04)  VALUE "0002".
  1406 20  CNS-POS-003             PIC  X(04)  VALUE "0003".
  1407 20  CNS-POS-004             PIC  X(04)  VALUE "0004".
  1408 20  CNS-POS-005             PIC  X(04)  VALUE "0005".
  1409 20  CNS-POS-006             PIC  X(04)  VALUE "0006".
  1410 20  CNS-POS-007             PIC  X(04)  VALUE "0007".
  1411 20  CNS-POS-008             PIC  X(04)  VALUE "0008".
  1412 20  CNS-POS-009             PIC  X(04)  VALUE "0009".
  1413 20  CNS-POS-010             PIC  X(04)  VALUE "0010".
  1414 20  CNS-POS-011             PIC  X(04)  VALUE "0011".
  1415 20  CNS-POS-012             PIC  X(04)  VALUE "0012".
  1416 20  CNS-POS-013             PIC  X(04)  VALUE "0013".
  1417 20  CNS-POS-014             PIC  X(04)  VALUE "0014".
  1418 20  CNS-POS-015             PIC  X(04)  VALUE "0015".
  1419 20  CNS-POS-016             PIC  X(04)  VALUE "0016".
  1420 20  CNS-POS-017             PIC  X(04)  VALUE "0017".
  1421 20  CNS-POS-018             PIC  X(04)  VALUE "0018".
  1422 20  CNS-POS-019             PIC  X(04)  VALUE "0019".
  1423 20  CNS-POS-020             PIC  X(04)  VALUE "0020".
  1424 20  CNS-POS-021             PIC  X(04)  VALUE "0021".
  1425 20  CNS-POS-022             PIC  X(04)  VALUE "0022".
  1426 20  CNS-POS-023             PIC  X(04)  VALUE "0023".
  1427 20  CNS-POS-024             PIC  X(04)  VALUE "0024".
  1428 20  CNS-POS-025             PIC  X(04)  VALUE "0025".
  1429 20  CNS-POS-026             PIC  X(04)  VALUE "0026".
  1430 20  CNS-POS-027             PIC  X(04)  VALUE "0027".
  1431 20  CNS-POS-028             PIC  X(04)  VALUE "0028".
  1432 20  CNS-POS-029             PIC  X(04)  VALUE "0029".
  1433 20  CNS-POS-030             PIC  X(04)  VALUE "0030".
  1434 20  CNS-POS-031             PIC  X(04)  VALUE "0031".
  1435 20  CNS-POS-032             PIC  X(04)  VALUE "0032".
  1436 20  CNS-POS-033             PIC  X(04)  VALUE "0033".
  1437 20  CNS-POS-034             PIC  X(04)  VALUE "0034".
  1438 20  CNS-POS-035             PIC  X(04)  VALUE "0035".
  1439 20  CNS-POS-036             PIC  X(04)  VALUE "0036".
  1440 20  CNS-POS-037             PIC  X(04)  VALUE "0037".
  1441 20  CNS-POS-038             PIC  X(04)  VALUE "0038".
  1442 20  CNS-POS-039             PIC  X(04)  VALUE "0039".
  1443 20  CNS-POS-040             PIC  X(04)  VALUE "0040".
  1444 20  CNS-POS-041             PIC  X(04)  VALUE "0041".
  1445 20  CNS-POS-042             PIC  X(04)  VALUE "0042".
  1446 20  CNS-POS-043             PIC  X(04)  VALUE "0043".
  1447 20  CNS-POS-044             PIC  X(04)  VALUE "0044".
  1448 20  CNS-POS-045             PIC  X(04)  VALUE "0045".
  1449 20  CNS-POS-046             PIC  X(04)  VALUE "0046".
  1450 20  CNS-POS-047             PIC  X(04)  VALUE "0047".
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  26
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/KOMONCNS.cpy)
  1451 20  CNS-POS-048             PIC  X(04)  VALUE "0048".
  1452 20  CNS-POS-049             PIC  X(04)  VALUE "0049".
  1453 20  CNS-POS-050             PIC  X(04)  VALUE "0050".
  1454 20  CNS-POS-051             PIC  X(04)  VALUE "0051".
  1455 20  CNS-POS-052             PIC  X(04)  VALUE "0052".
  1456 20  CNS-POS-053             PIC  X(04)  VALUE "0053".
  1457 20  CNS-POS-054             PIC  X(04)  VALUE "0054".
  1458 20  CNS-POS-055             PIC  X(04)  VALUE "0055".
  1459 20  CNS-POS-056             PIC  X(04)  VALUE "0056".
  1460 20  CNS-POS-057             PIC  X(04)  VALUE "0057".
  1461 20  CNS-POS-058             PIC  X(04)  VALUE "0058".
  1462 20  CNS-POS-059             PIC  X(04)  VALUE "0059".
  1463 20  CNS-POS-060             PIC  X(04)  VALUE "0060".
  1464 20  CNS-POS-061             PIC  X(04)  VALUE "0061".
  1465 20  CNS-POS-062             PIC  X(04)  VALUE "0062".
  1466 20  CNS-POS-063             PIC  X(04)  VALUE "0063".
  1467 20  CNS-POS-064             PIC  X(04)  VALUE "0064".
  1468 20  CNS-POS-065             PIC  X(04)  VALUE "0065".
  1469 20  CNS-POS-066             PIC  X(04)  VALUE "0066".
  1470 20  CNS-POS-067             PIC  X(04)  VALUE "0067".
  1471 20  CNS-POS-068             PIC  X(04)  VALUE "0068".
  1472 20  CNS-POS-069             PIC  X(04)  VALUE "0069".
  1473 20  CNS-POS-070             PIC  X(04)  VALUE "0070".
  1474 20  CNS-POS-071             PIC  X(04)  VALUE "0071".
  1475 20  CNS-POS-072             PIC  X(04)  VALUE "0072".
  1476 20  CNS-POS-073             PIC  X(04)  VALUE "0073".
  1477 20  CNS-POS-074             PIC  X(04)  VALUE "0074".
  1478 20  CNS-POS-075             PIC  X(04)  VALUE "0075".
  1479 20  CNS-POS-076             PIC  X(04)  VALUE "0076".
  1480 20  CNS-POS-077             PIC  X(04)  VALUE "0077".
  1481 20  CNS-POS-078             PIC  X(04)  VALUE "0078".
  1482 20  CNS-POS-079             PIC  X(04)  VALUE "0079".
  1483 20  CNS-POS-080             PIC  X(04)  VALUE "0080".
  1484 20  CNS-POS-081             PIC  X(04)  VALUE "0081".
  1485 20  CNS-POS-082             PIC  X(04)  VALUE "0082".
  1486 20  CNS-POS-083             PIC  X(04)  VALUE "0083".
  1487 20  CNS-POS-084             PIC  X(04)  VALUE "0084".
  1488 20  CNS-POS-085             PIC  X(04)  VALUE "0085".
  1489 20  CNS-POS-086             PIC  X(04)  VALUE "0086".
  1490 20  CNS-POS-087             PIC  X(04)  VALUE "0087".
  1491 20  CNS-POS-088             PIC  X(04)  VALUE "0088".
  1492 20  CNS-POS-089             PIC  X(04)  VALUE "0089".
  1493 20  CNS-POS-090             PIC  X(04)  VALUE "0090".
  1494 20  CNS-POS-091             PIC  X(04)  VALUE "0091".
  1495 20  CNS-POS-092             PIC  X(04)  VALUE "0092".
  1496 20  CNS-POS-093             PIC  X(04)  VALUE "0093".
  1497 20  CNS-POS-094             PIC  X(04)  VALUE "0094".
  1498 20  CNS-POS-095             PIC  X(04)  VALUE "0095".
  1499 20  CNS-POS-096             PIC  X(04)  VALUE "0096".
  1500 20  CNS-POS-097             PIC  X(04)  VALUE "0097".
  1501 20  CNS-POS-098             PIC  X(04)  VALUE "0098".
  1502 20  CNS-POS-099             PIC  X(04)  VALUE "0099".
  1503 20  CNS-POS-100             PIC  X(04)  VALUE "0100".
  1504 20  CNS-POS-101             PIC  X(04)  VALUE "0101".
  1505 20  CNS-POS-102             PIC  X(04)  VALUE "0102".
  1506 20  CNS-POS-103             PIC  X(04)  VALUE "0103".
  1507 20  CNS-POS-104             PIC  X(04)  VALUE "0104".
  1508 20  CNS-POS-105             PIC  X(04)  VALUE "0105".
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  27
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/KOMONCNS.cpy)
  1509 20  CNS-POS-106             PIC  X(04)  VALUE "0106".
  1510 20  CNS-POS-107             PIC  X(04)  VALUE "0107".
  1511 20  CNS-POS-108             PIC  X(04)  VALUE "0108".
  1512 20  CNS-POS-109             PIC  X(04)  VALUE "0109".
  1513 20  CNS-POS-110             PIC  X(04)  VALUE "0110".
  1514 20  CNS-POS-111             PIC  X(04)  VALUE "0111".
  1515 20  CNS-POS-112             PIC  X(04)  VALUE "0112".
  1516 20  CNS-POS-113             PIC  X(04)  VALUE "0113".
  1517 20  CNS-POS-114             PIC  X(04)  VALUE "0114".
  1518 20  CNS-POS-115             PIC  X(04)  VALUE "0115".
  1519 20  CNS-POS-116             PIC  X(04)  VALUE "0116".
  1520 20  CNS-POS-117             PIC  X(04)  VALUE "0117".
  1521 20  CNS-POS-118             PIC  X(04)  VALUE "0118".
  1522 20  CNS-POS-119             PIC  X(04)  VALUE "0119".
  1523 20  CNS-POS-120             PIC  X(04)  VALUE "0120".
  1524 20  CNS-POS-121             PIC  X(04)  VALUE "0121".
  1525 20  CNS-POS-122             PIC  X(04)  VALUE "0122".
  1526 20  CNS-POS-123             PIC  X(04)  VALUE "0123".
  1527 20  CNS-POS-124             PIC  X(04)  VALUE "0124".
  1528 20  CNS-POS-125             PIC  X(04)  VALUE "0125".
  1529 20  CNS-POS-126             PIC  X(04)  VALUE "0126".
  1530 20  CNS-POS-127             PIC  X(04)  VALUE "0127".
  1531 20  CNS-POS-128             PIC  X(04)  VALUE "0128".
  1532 20  CNS-POS-129             PIC  X(04)  VALUE "0129".
  1533 20  CNS-POS-130             PIC  X(04)  VALUE "0130".
  1534 20  CNS-POS-131             PIC  X(04)  VALUE "0131".
  1535 20  CNS-POS-132             PIC  X(04)  VALUE "0132".
  1536 20  CNS-POS-133             PIC  X(04)  VALUE "0133".
  1537 20  CNS-POS-134             PIC  X(04)  VALUE "0134".
  1538 20  CNS-POS-135             PIC  X(04)  VALUE "0135".
  1539 20  CNS-POS-136             PIC  X(04)  VALUE "0136".
  1540 20  CNS-POS-137             PIC  X(04)  VALUE "0137".
  1541 20  CNS-POS-138             PIC  X(04)  VALUE "0138".
  1542 20  CNS-POS-139             PIC  X(04)  VALUE "0139".
  1543 20  CNS-POS-140             PIC  X(04)  VALUE "0140".
  1544 20  CNS-POS-141             PIC  X(04)  VALUE "0141".
  1545 20  CNS-POS-142             PIC  X(04)  VALUE "0142".
  1546 20  CNS-POS-143             PIC  X(04)  VALUE "0143".
  1547 20  CNS-POS-144             PIC  X(04)  VALUE "0144".
  1548 20  CNS-POS-145             PIC  X(04)  VALUE "0145".
  1549 20  CNS-POS-146             PIC  X(04)  VALUE "0146".
  1550 20  CNS-POS-147             PIC  X(04)  VALUE "0147".
  1551 20  CNS-POS-148             PIC  X(04)  VALUE "0148".
  1552 20  CNS-POS-149             PIC  X(04)  VALUE "0149".
  1553 20  CNS-POS-150             PIC  X(04)  VALUE "0150".
  1554 20  CNS-POS-151             PIC  X(04)  VALUE "0151".
  1555 20  CNS-POS-152             PIC  X(04)  VALUE "0152".
  1556 20  CNS-POS-153             PIC  X(04)  VALUE "0153".
  1557 20  CNS-POS-154             PIC  X(04)  VALUE "0154".
  1558 20  CNS-POS-155             PIC  X(04)  VALUE "0155".
  1559 20  CNS-POS-156             PIC  X(04)  VALUE "0156".
  1560 20  CNS-POS-157             PIC  X(04)  VALUE "0157".
  1561 20  CNS-POS-158             PIC  X(04)  VALUE "0158".
  1562 20  CNS-POS-159             PIC  X(04)  VALUE "0159".
  1563 20  CNS-POS-160             PIC  X(04)  VALUE "0160".
  1564 20  CNS-POS-161             PIC  X(04)  VALUE "0161".
  1565 20  CNS-POS-162             PIC  X(04)  VALUE "0162".
  1566 20  CNS-POS-163             PIC  X(04)  VALUE "0163".
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  28
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/KOMONCNS.cpy)
  1567 20  CNS-POS-164             PIC  X(04)  VALUE "0164".
  1568 20  CNS-POS-165             PIC  X(04)  VALUE "0165".
  1569 20  CNS-POS-166             PIC  X(04)  VALUE "0166".
  1570 20  CNS-POS-167             PIC  X(04)  VALUE "0167".
  1571 20  CNS-POS-168             PIC  X(04)  VALUE "0168".
  1572 20  CNS-POS-169             PIC  X(04)  VALUE "0169".
  1573 20  CNS-POS-170             PIC  X(04)  VALUE "0170".
  1574 20  CNS-POS-171             PIC  X(04)  VALUE "0171".
  1575 20  CNS-POS-172             PIC  X(04)  VALUE "0172".
  1576 20  CNS-POS-173             PIC  X(04)  VALUE "0173".
  1577 20  CNS-POS-174             PIC  X(04)  VALUE "0174".
  1578 20  CNS-POS-175             PIC  X(04)  VALUE "0175".
  1579 20  CNS-POS-176             PIC  X(04)  VALUE "0176".
  1580 20  CNS-POS-177             PIC  X(04)  VALUE "0177".
  1581 20  CNS-POS-178             PIC  X(04)  VALUE "0178".
  1582 20  CNS-POS-179             PIC  X(04)  VALUE "0179".
  1583 20  CNS-POS-180             PIC  X(04)  VALUE "0180".
  1584 20  CNS-POS-181             PIC  X(04)  VALUE "0181".
  1585 20  CNS-POS-182             PIC  X(04)  VALUE "0182".
  1586 20  CNS-POS-183             PIC  X(04)  VALUE "0183".
  1587 20  CNS-POS-184             PIC  X(04)  VALUE "0184".
  1588 20  CNS-POS-185             PIC  X(04)  VALUE "0185".
  1589 20  CNS-POS-186             PIC  X(04)  VALUE "0186".
  1590 20  CNS-POS-187             PIC  X(04)  VALUE "0187".
  1591 20  CNS-POS-188             PIC  X(04)  VALUE "0188".
  1592 20  CNS-POS-189             PIC  X(04)  VALUE "0189".
  1593 20  CNS-POS-190             PIC  X(04)  VALUE "0190".
  1594 20  CNS-POS-191             PIC  X(04)  VALUE "0191".
  1595 20  CNS-POS-192             PIC  X(04)  VALUE "0192".
  1596 20  CNS-POS-193             PIC  X(04)  VALUE "0193".
  1597 20  CNS-POS-194             PIC  X(04)  VALUE "0194".
  1598 20  CNS-POS-195             PIC  X(04)  VALUE "0195".
  1599 20  CNS-POS-196             PIC  X(04)  VALUE "0196".
  1600 20  CNS-POS-197             PIC  X(04)  VALUE "0197".
  1601 20  CNS-POS-198             PIC  X(04)  VALUE "0198".
  1602 20  CNS-POS-199             PIC  X(04)  VALUE "0199".
  1603 20  CNS-POS-200             PIC  X(04)  VALUE "0200".
  1604******************************************************************
  1605*                画面アクション区分
  1606******************************************************************
  1607* 0:照会
  1608 20  CNS-GAMEN-ACT-KBN-0     PIC  X(01)  VALUE  "0".
  1609* 1:登録
  1610 20  CNS-GAMEN-ACT-KBN-1     PIC  X(01)  VALUE  "1".
  1611* 2:変更
  1612 20  CNS-GAMEN-ACT-KBN-2     PIC  X(01)  VALUE  "2".
  1613* 3:削除
  1614 20  CNS-GAMEN-ACT-KBN-3     PIC  X(01)  VALUE  "3".
  1615* 4:検索、
  1616 20  CNS-GAMEN-ACT-KBN-4     PIC  X(01)  VALUE  "4".
  1617* 5:帳票ﾘｸｴｽﾄ
  1618 20  CNS-GAMEN-ACT-KBN-5     PIC  X(01)  VALUE  "5".
  1619******************************************************************
  1620*                正常エラー区分
  1621******************************************************************
  1622* 00':正常
  1623 20  CNS-NML-ERR-KBN-00      PIC  X(02)  VALUE  "00".
  1624* 01':業務グループ/会社選択権限エラー
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  29
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/KOMONCNS.cpy)
  1625 20  CNS-NML-ERR-KBN-01      PIC  X(02)  VALUE  "01".
  1626* 02':メニュー利用権限エラー
  1627 20  CNS-NML-ERR-KBN-02      PIC  X(02)  VALUE  "02".
  1628* 03':業務タスク利用権限エラー
  1629 20  CNS-NML-ERR-KBN-03      PIC  X(02)  VALUE  "03".
  1630* 04':アップロード利用権限エラー
  1631 20  CNS-NML-ERR-KBN-04      PIC  X(02)  VALUE  "04".
  1632* 05':帳票利用権限エラー
  1633 20  CNS-NML-ERR-KBN-05      PIC  X(02)  VALUE  "05".
  1634* 07'：ファンド利用権限エラー
  1635 20  CNS-NML-ERR-KBN-07      PIC  X(02)  VALUE  "07".
  1636* 08':ユーザーID管理権限エラー
  1637 20  CNS-NML-ERR-KBN-08      PIC  X(02)  VALUE  "08".
  1638* 09':業務グループ管理権限エラー
  1639 20  CNS-NML-ERR-KBN-09      PIC  X(02)  VALUE  "09".
  1640******************************************************************
  1641*                件数区分
  1642******************************************************************
  1643* ユーザ会社件数
  1644 20  CNS-SERCH-KBN-USER      PIC  X(01)  VALUE  "1".
  1645* システム件数
  1646 20  CNS-SERCH-KBN-SYSTEM    PIC  X(01)  VALUE  "2".
  1647******************************************************************
  1648*                課金用検索区分
  1649******************************************************************
  1650* 全件
  1651 20  CNS-EE-KBN-ALL          PIC  X(01)  VALUE  "1".
  1652* 上記以外
  1653 20  CNS-EE-KBN-NORMAL       PIC  X(01)  VALUE  "0".
  1654******************************************************************
  1655*                SPP SUB共通定数
  1656******************************************************************
  1657* AIFAの長さ
  1658 20  CNS-AIFA-LEN            PIC  9(03)  VALUE  400.
  1659* 共通ﾍｯﾀﾞの長さ
  1660 20  CNS-HEADER-LEN          PIC  9(03)  VALUE  300.
  1661* WOMTBIGNのERRメッセージ
  1662 20  CNS-WOMTBIGN-ERR        PIC  X(14)  VALUE  "WOMTBIGNエラー".
  1663* WOMTCOMTのERRメッセージ
  1664 20  CNS-WOMTCOMT-ERR        PIC  X(14)  VALUE  "WOMTCOMTエラー".
  1665* ASCII-CODE TAB
  1666 20  CNS-TAB                 PIC  X(01)  VALUE  X'09'.
  1667* ASCII-CODE ENTER+NEWLINE
  1668 20  CNS-ENTER               PIC  X(02)  VALUE  X'0D0A'.
  1669******************************************************************
  1670*                BT戻り値
  1671******************************************************************
  1672 20  CNS-RTN-BT0            PIC  9(02)  VALUE  0.
  1673 20  CNS-RTN-BT2            PIC  9(02)  VALUE  2.
  1674 20  CNS-RTN-BT4            PIC  9(02)  VALUE  4.
  1675 20  CNS-RTN-BT8            PIC  9(02)  VALUE  8.
  1676 20  CNS-RTN-BT16           PIC  9(02)  VALUE  16.
  1677******************************************************************
  1678*                BT SUB共通定数
  1679******************************************************************
  1680* パラメータエラーメッセージ
  1681 20  CNS-PARM-ERR            PIC  X(18)  VALUE
  1682                                         "パラメータ　エラー".
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  30
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/KOMONCNS.cpy)
  1683* CONNECTのERRメッセージ
  1684 20  CNS-CONNECT-ERR         PIC  X(15)  VALUE  "CONNECT　エラー".
  1685* COMMITのERRメッセージ
  1686 20  CNS-COMMIT-ERR          PIC  X(14)  VALUE  "COMMIT　エラー".
  1687* COMMIT RELEASE　エラー
  1688 20  CNS-COM-RELEASE-ERR     PIC  X(22)  VALUE
  1689                                         "COMMIT RELEASE　エラー".
  1690* ROLLBACK　エラー
  1691 20  CNS-ROLLBACK-ERR        PIC  X(16)  VALUE
  1692                                         "ROLLBACK　エラー".
  1693*----------   MT取引事由コンスタント
* 1694     COPY  "TORIJIYUCNS.cpy".
  1695******************************************************************
  1696* $Header$
  1697******************************************************************
  1698*
  1699* システムＩＤ   : T-STAR
  1700* システム名称   : 次期TSTARシステム
  1701* コピー句ＩＤ   : TORIJIYUCNS.cpy
  1702* コピー句名称   : MT取引事由コンスタント
  1703*
  1704* 改訂履歴
  1705* 年月日   区分 所属   担当者  内容
  1706* -------- ---- ------ ------- -----------------------------------
  1707* 20080612 新規 SCS            新規作成
  1708* 20081106 修正 SCS   王偉領   MX-121
  1709******************************************************************
  1710*----------  その他数量/簿価増加（片伝）
  1711 20  CNS-JIYU-AIN            PIC  X(04)  VALUE  "AIN ".
  1712*----------  アキュミュレ－ション
  1713 20  CNS-JIYU-ACUM           PIC  X(04)  VALUE  "ACUM".
  1714*----------  アモチゼ－ション
  1715 20  CNS-JIYU-AMRT           PIC  X(04)  VALUE  "AMRT".
  1716*----------  その他数量/簿価減少（片伝）
  1717 20  CNS-JIYU-AOUT           PIC  X(04)  VALUE  "AOUT".
  1718*----------  一般的な購入
  1719 20  CNS-JIYU-BUY            PIC  X(04)  VALUE  "BUY ".
  1720*----------  先物現引による購入
  1721 20  CNS-JIYU-FBUY           PIC  X(04)  VALUE  "FBUY".
  1722*----------  オプション権利行使／割当による購入
  1723 20  CNS-JIYU-OSIO           PIC  X(04)  VALUE  "OSIO".
  1724*----------  ＴＢＡ割当による購入
  1725 20  CNS-JIYU-OSIT           PIC  X(04)  VALUE  "OSIT".
  1726*----------  ワラント行使による購入
  1727 20  CNS-JIYU-OSIW           PIC  X(04)  VALUE  "OSIW".
  1728*----------  公募・売出による購入
  1729 20  CNS-JIYU-PO             PIC  X(04)  VALUE  "PO  ".
  1730*----------  信用現引による購入
  1731 20  CNS-JIYU-SBUY           PIC  X(04)  VALUE  "SBUY".
  1732*----------  資本返還による減資
  1733 20  CNS-JIYU-CAPD           PIC  X(04)  VALUE  "CAPD".
  1734*----------  CB転換による取得
  1735 20  CNS-JIYU-CBB            PIC  X(04)  VALUE  "CBB ".
  1736*----------  CB転換
  1737 20  CNS-JIYU-CBC            PIC  X(04)  VALUE  "CBC ".
  1738*----------  転換交付金入金
  1739 20  CNS-JIYU-CBCH           PIC  X(04)  VALUE  "CBCH".
  1740*----------  予約実行による為替送回金
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  31
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/TORIJIYUCNS.cpy)
  1741 20  CNS-JIYU-CFFA           PIC  X(04)  VALUE  "CFFA".
  1742*----------  有償増資（権利落による減少）
  1743 20  CNS-JIYU-CID            PIC  X(04)  VALUE  "CID ".
  1744*----------  分割（利益準備金）・減
  1745 20  CNS-JIYU-CIQD           PIC  X(04)  VALUE  "CIQD".
  1746*----------  株式分割（分割元）
  1747 20  CNS-JIYU-CISD           PIC  X(04)  VALUE  "CISD".
  1748*----------  新旧併合（新株）
  1749 20  CNS-JIYU-CONS           PIC  X(04)  VALUE  "CONS".
  1750*----------  有償増資（新株発行による減少）
  1751 20  CNS-JIYU-ISD            PIC  X(04)  VALUE  "ISD ".
  1752*----------  会社合併（減少)
  1753 20  CNS-JIYU-MRGD           PIC  X(04)  VALUE  "MRGD".
  1754*----------  信用増資（減少）
  1755 20  CNS-JIYU-MSPD           PIC  X(04)  VALUE  "MSPD".
  1756*----------  会社分割（分割元）
  1757 20  CNS-JIYU-OCID           PIC  X(04)  VALUE  "OCID".
  1758*----------  無償併合
  1759 20  CNS-JIYU-REDU           PIC  X(04)  VALUE  "REDU".
  1760*----------  株式配当による減少
  1761 20  CNS-JIYU-SDID           PIC  X(04)  VALUE  "SDID".
  1762*----------  子会社株式配当による減少
  1763 20  CNS-JIYU-ODID           PIC  X(04)  VALUE  "ODID".
  1764*----------  有償増資（権利落による増加）
  1765 20  CNS-JIYU-CII            PIC  X(04)  VALUE  "CII ".
  1766*----------  分割（利益準備金）・増
  1767 20  CNS-JIYU-CIQI           PIC  X(04)  VALUE  "CIQI".
  1768*----------  株式分割（分割先）
  1769 20  CNS-JIYU-CISI           PIC  X(04)  VALUE  "CISI".
  1770*----------  株式分割
  1771 20  CNS-JIYU-CISL           PIC  X(04)  VALUE  "CISL".
  1772*----------  新旧併合(親株)
  1773 20  CNS-JIYU-CONI           PIC  X(04)  VALUE  "CONI".
  1774*----------  有償増資（新株発行による増加）
  1775 20  CNS-JIYU-ISI            PIC  X(04)  VALUE  "ISI ".
  1776*----------  会社合併(増加)
  1777 20  CNS-JIYU-MRG            PIC  X(04)  VALUE  "MRG ".
  1778*----------  信用増資（増加）
  1779 20  CNS-JIYU-MSPI           PIC  X(04)  VALUE  "MSPI".
  1780*----------  会社分割（分割先）
  1781 20  CNS-JIYU-OCII           PIC  X(04)  VALUE  "OCII".
  1782*----------  株式配当による増加
  1783 20  CNS-JIYU-SDII           PIC  X(04)  VALUE  "SDII".
  1784*----------  子会社株式配当による増加
  1785 20  CNS-JIYU-ODIV           PIC  X(04)  VALUE  "ODIV".
  1786*----------  有償増資（払込）
  1787 20  CNS-JIYU-CIP            PIC  X(04)  VALUE  "CIP ".
  1788*----------  投資顧問料支払
  1789 20  CNS-JIYU-ACS            PIC  X(04)  VALUE  "ACS ".
  1790*----------  未払投資顧問料支払
  1791 20  CNS-JIYU-ACSP           PIC  X(04)  VALUE  "ACSP".
  1792*----------  カストディ－・フィ－支払
  1793 20  CNS-JIYU-CFE            PIC  X(04)  VALUE  "CFE ".
  1794*----------  未払カストディ－・フィ－支払
  1795 20  CNS-JIYU-CFEP           PIC  X(04)  VALUE  "CFEP".
  1796*----------  その他費用（運用外要因）支払
  1797 20  CNS-JIYU-CSO            PIC  X(04)  VALUE  "CSO ".
  1798*----------  未払その他費用（運用外要因）支払
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  32
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/TORIJIYUCNS.cpy)
  1799 20  CNS-JIYU-CSOP           PIC  X(04)  VALUE  "CSOP".
  1800*----------  端数株式調整金支払
  1801 20  CNS-JIYU-CSSA           PIC  X(04)  VALUE  "CSSA".
  1802*----------  その他運用費用支払
  1803 20  CNS-JIYU-CST            PIC  X(04)  VALUE  "CST ".
  1804*----------  未払その他運用費用支払
  1805 20  CNS-JIYU-CSTP           PIC  X(04)  VALUE  "CSTP".
  1806*----------  支払利息
  1807 20  CNS-JIYU-PYIT           PIC  X(04)  VALUE  "PYIT".
  1808*----------  信用取引借株料支払
  1809 20  CNS-JIYU-PYML           PIC  X(04)  VALUE  "PYML".
  1810*----------  品借料支払
  1811 20  CNS-JIYU-PYSG           PIC  X(04)  VALUE  "PYSG".
  1812*----------  担保金利息支払
  1813 20  CNS-JIYU-SDLO           PIC  X(04)  VALUE  "SDLO".
  1814*----------  特別法人税支払
  1815 20  CNS-JIYU-STX            PIC  X(04)  VALUE  "STX ".
  1816*----------  未払特別法人税支払
  1817 20  CNS-JIYU-STXP           PIC  X(04)  VALUE  "STXP".
  1818*----------  源泉税
  1819 20  CNS-JIYU-TAX            PIC  X(04)  VALUE  "TAX ".
  1820*----------  信託報酬支払
  1821 20  CNS-JIYU-TST            PIC  X(04)  VALUE  "TST ".
  1822*----------  未払信託報酬支払
  1823 20  CNS-JIYU-TSTP           PIC  X(04)  VALUE  "TSTP".
  1824*----------  未払投資顧問料計上
  1825 20  CNS-JIYU-ACSU           PIC  X(04)  VALUE  "ACSU".
  1826*----------  未払カストディ－・フィ－計上
  1827 20  CNS-JIYU-CFEU           PIC  X(04)  VALUE  "CFEU".
  1828*----------  未払その他費用（運用外要因）計上
  1829 20  CNS-JIYU-CSOU           PIC  X(04)  VALUE  "CSOU".
  1830*----------  未払その他運用費用計上
  1831 20  CNS-JIYU-CSTU           PIC  X(04)  VALUE  "CSTU".
  1832*----------  未払特別法人税計上
  1833 20  CNS-JIYU-STXU           PIC  X(04)  VALUE  "STXU".
  1834*----------  未払信託報酬計上
  1835 20  CNS-JIYU-TSTU           PIC  X(04)  VALUE  "TSTU".
  1836*----------  購入による経過利息
  1837 20  CNS-JIYU-DMY1           PIC  X(04)  VALUE  "DMY1".
  1838*----------  購入による利払額面計上
  1839 20  CNS-JIYU-DMY2           PIC  X(04)  VALUE  "DMY2".
  1840*----------  売却による経過利息
  1841 20  CNS-JIYU-DMY3           PIC  X(04)  VALUE  "DMY3".
  1842*----------  売却による利払額面計上
  1843 20  CNS-JIYU-DMY4           PIC  X(04)  VALUE  "DMY4".
  1844*----------  配当調整金支払
  1845 20  CNS-JIYU-DVAP           PIC  X(04)  VALUE  "DVAP".
  1846*----------  利金入金
  1847 20  CNS-JIYU-CPN            PIC  X(04)  VALUE  "CPN ".
  1848*----------  現金による配当金
  1849 20  CNS-JIYU-DIVS           PIC  X(04)  VALUE  "DIVS".
  1850*----------  配当調整金入金
  1851 20  CNS-JIYU-DVAI           PIC  X(04)  VALUE  "DVAI".
  1852*----------  利息
  1853 20  CNS-JIYU-INTA           PIC  X(04)  VALUE  "INTA".
  1854*----------  分配金受取
  1855 20  CNS-JIYU-INTF           PIC  X(04)  VALUE  "INTF".
  1856*----------  分配金再投資
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  33
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/TORIJIYUCNS.cpy)
  1857 20  CNS-JIYU-DVRE           PIC  X(04)  VALUE  "DVRE".
  1858*----------  為替差損（売買）計上
  1859 20  CNS-JIYU-EXLC           PIC  X(04)  VALUE  "EXLC".
  1860*----------  為替差損（利配）計上
  1861 20  CNS-JIYU-EXLI           PIC  X(04)  VALUE  "EXLI".
  1862*----------  為替差益（売買）計上
  1863 20  CNS-JIYU-EXPC           PIC  X(04)  VALUE  "EXPC".
  1864*----------  為替差益（利配）計上
  1865 20  CNS-JIYU-EXPI           PIC  X(04)  VALUE  "EXPI".
  1866*----------  源泉税還付予定額計上
  1867 20  CNS-JIYU-EXTR           PIC  X(04)  VALUE  "EXTR".
  1868*----------  実行
  1869 20  CNS-JIYU-FEX            PIC  X(04)  VALUE  "FEX ".
  1870*----------  現引・現渡
  1871 20  CNS-JIYU-FEXS           PIC  X(04)  VALUE  "FEXS".
  1872*----------  ファンド欠損金
  1873 20  CNS-JIYU-FLOS           PIC  X(04)  VALUE  "FLOS".
  1874*----------  調整損戻入
  1875 20  CNS-JIYU-FALR           PIC  X(04)  VALUE  "FALR".
  1876*----------  調整損計上
  1877 20  CNS-JIYU-FALU           PIC  X(04)  VALUE  "FALU".
  1878*----------  調整益戻入
  1879 20  CNS-JIYU-FAPR           PIC  X(04)  VALUE  "FAPR".
  1880*----------  調整益計上
  1881 20  CNS-JIYU-FAPU           PIC  X(04)  VALUE  "FAPU".
  1882*----------  未収収益戻入
  1883 20  CNS-JIYU-FTCR           PIC  X(04)  VALUE  "FTCR".
  1884*----------  未収収益計上
  1885 20  CNS-JIYU-FTCU           PIC  X(04)  VALUE  "FTCU".
  1886*----------  評価損戻入
  1887 20  CNS-JIYU-FTLR           PIC  X(04)  VALUE  "FTLR".
  1888*----------  評価損計上
  1889 20  CNS-JIYU-FTLU           PIC  X(04)  VALUE  "FTLU".
  1890*----------  前払金評価損計上
  1891 20  CNS-JIYU-FTLV           PIC  X(04)  VALUE  "FTLV".
  1892*----------  前払金評価損戻入
  1893 20  CNS-JIYU-FTLW           PIC  X(04)  VALUE  "FTLW".
  1894*----------  評価益戻入
  1895 20  CNS-JIYU-FTPR           PIC  X(04)  VALUE  "FTPR".
  1896*----------  評価益計上
  1897 20  CNS-JIYU-FTPU           PIC  X(04)  VALUE  "FTPU".
  1898*----------  前払金評価益計上
  1899 20  CNS-JIYU-FTPV           PIC  X(04)  VALUE  "FTPV".
  1900*----------  前払金評価益戻入
  1901 20  CNS-JIYU-FTPW           PIC  X(04)  VALUE  "FTPW".
  1902*----------  配当付株数計上
  1903 20  CNS-JIYU-FTSQ           PIC  X(04)  VALUE  "FTSQ".
  1904*----------  収益計上簿価異動(キャピタル)
  1905 20  CNS-JIYU-GANC           PIC  X(04)  VALUE  "GANC".
  1906*----------  収益計上簿価異動(インカム)
  1907 20  CNS-JIYU-GANI           PIC  X(04)  VALUE  "GANI".
  1908*----------  買現先エンド
  1909 20  CNS-JIYU-GNBE           PIC  X(04)  VALUE  "GNBE".
  1910*----------  買現先スタ－ト
  1911 20  CNS-JIYU-GNBS           PIC  X(04)  VALUE  "GNBS".
  1912*----------  売現先エンド
  1913 20  CNS-JIYU-GNSE           PIC  X(04)  VALUE  "GNSE".
  1914*----------  売現先スタ－ト
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  34
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/TORIJIYUCNS.cpy)
  1915 20  CNS-JIYU-GNSS           PIC  X(04)  VALUE  "GNSS".
  1916*----------  初期設定元本
  1917 20  CNS-JIYU-INFI           PIC  X(04)  VALUE  "INFI".
  1918*----------  元本入金
  1919 20  CNS-JIYU-INFL           PIC  X(04)  VALUE  "INFL".
  1920*----------  損失計上簿価異動(キャピタル)
  1921 20  CNS-JIYU-LOOC           PIC  X(04)  VALUE  "LOOC".
  1922*----------  損失計上簿価異動(インカム)
  1923 20  CNS-JIYU-LOOI           PIC  X(04)  VALUE  "LOOI".
  1924*----------  繰上/定時/抽選償還
  1925 20  CNS-JIYU-MATD           PIC  X(04)  VALUE  "MATD".
  1926*----------  満期償還
  1927 20  CNS-JIYU-MATU           PIC  X(04)  VALUE  "MATU".
  1928*----------  保証金等差入
  1929 20  CNS-JIYU-MIN            PIC  X(04)  VALUE  "MIN".
  1930*----------  保証金等差入(値洗いによる）
  1931 20  CNS-JIYU-MTIN           PIC  X(04)  VALUE  "MTIN".
  1932*----------  代用有価証券差入
  1933 20  CNS-JIYU-MINS           PIC  X(04)  VALUE  "MINS".
  1934*----------  代用有価証券回収
  1935 20  CNS-JIYU-MOTS           PIC  X(04)  VALUE  "MOTS".
  1936*----------  保証金等回収
  1937 20  CNS-JIYU-MOUT           PIC  X(04)  VALUE  "MOUT".
  1938*----------  新規買・信用増資
  1939 20  CNS-JIYU-MSPB           PIC  X(04)  VALUE  "MSPB".
  1940*----------  新規売・信用増資
  1941 20  CNS-JIYU-MSPS           PIC  X(04)  VALUE  "MSPS".
  1942*----------  保証金等回収(値洗いによる）
  1943 20  CNS-JIYU-MTOT           PIC  X(04)  VALUE  "MTOT".
  1944*----------  会社合併交付金
  1945 20  CNS-JIYU-MRCH           PIC  X(04)  VALUE  "MRCH".
  1946*----------  権利消滅
  1947 20  CNS-JIYU-OABL           PIC  X(04)  VALUE  "OABL".
  1948*----------  義務消滅
  1949 20  CNS-JIYU-OABS           PIC  X(04)  VALUE  "OABS".
  1950*----------  有償増資（権利消滅）
  1951 20  CNS-JIYU-RABD           PIC  X(04)  VALUE  "RABD".
  1952*----------  現物割当
  1953 20  CNS-JIYU-OATB           PIC  X(04)  VALUE  "OATB".
  1954*----------  権利割当による差金決済
  1955 20  CNS-JIYU-OAS            PIC  X(04)  VALUE  "OAS ".
  1956*----------  権利割当（先物）による引落
  1957 20  CNS-JIYU-OASF           PIC  X(04)  VALUE  "OASF".
  1958*----------  権利割当（現物）による引落
  1959 20  CNS-JIYU-OASS           PIC  X(04)  VALUE  "OASS".
  1960*----------  権利行使による差金決済
  1961 20  CNS-JIYU-OEX            PIC  X(04)  VALUE  "OEX ".
  1962*----------  権利行使（先物）による引落
  1963 20  CNS-JIYU-OEXF           PIC  X(04)  VALUE  "OEXF".
  1964*----------  権利行使（現物）による引落
  1965 20  CNS-JIYU-OEXS           PIC  X(04)  VALUE  "OEXS".
  1966*----------  ワラント行使
  1967 20  CNS-JIYU-OEXW           PIC  X(04)  VALUE  "OEXW".
  1968*----------  新規買建
  1969 20  CNS-JIYU-OPB            PIC  X(04)  VALUE  "OPB ".
  1970*----------  オプション権利割当による新規買建
  1971 20  CNS-JIYU-OPBA           PIC  X(04)  VALUE  "OPBA".
  1972*----------  オプション権利行使による新規買建
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  35
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/TORIJIYUCNS.cpy)
  1973 20  CNS-JIYU-OPBE           PIC  X(04)  VALUE  "OPBE".
  1974*----------  権利新規買建
  1975 20  CNS-JIYU-OPRB           PIC  X(04)  VALUE  "OPRB".
  1976*----------  権利新規売建
  1977 20  CNS-JIYU-OPRS           PIC  X(04)  VALUE  "OPRS".
  1978*----------  新規売建
  1979 20  CNS-JIYU-OPS            PIC  X(04)  VALUE  "OPS ".
  1980*----------  オプション権利割当による新規売建
  1981 20  CNS-JIYU-OPSA           PIC  X(04)  VALUE  "OPSA".
  1982*----------  オプション権利行使による新規売建
  1983 20  CNS-JIYU-OPSE           PIC  X(04)  VALUE  "OPSE".
  1984*----------  元本出金
  1985 20  CNS-JIYU-OUFL           PIC  X(04)  VALUE  "OUFL".
  1986*----------  金利受取
  1987 20  CNS-JIYU-INTI           PIC  X(04)  VALUE  "INTI".
  1988*----------  保証金利息受領
  1989*20  CNS-JIYU-INTM           PIC  X(04)  VALUE  "INTM".
  1990*----------  資本返還金受取
  1991 20  CNS-JIYU-PFCD           PIC  X(04)  VALUE  "PFCD".
  1992*----------  クラスアクション和解金受取
  1993 20  CNS-JIYU-PFCL           PIC  X(04)  VALUE  "PFCL".
  1994*----------  端数株式調整金受取
  1995 20  CNS-JIYU-PFSA           PIC  X(04)  VALUE  "PFSA".
  1996*----------  その他運用益(キャピタル)受取
  1997 20  CNS-JIYU-PRFC           PIC  X(04)  VALUE  "PRFC".
  1998*----------  その他運用益(インカム)受取
  1999 20  CNS-JIYU-PRFI           PIC  X(04)  VALUE  "PRFI".
  2000*----------  その他益（運用外要因）受取
  2001 20  CNS-JIYU-PRFO           PIC  X(04)  VALUE  "PRFO".
  2002*----------  品貸料受領
  2003 20  CNS-JIYU-SLGA           PIC  X(04)  VALUE  "SLGA".
  2004*----------  キャッシュ支払簿価異動
  2005 20  CNS-JIYU-PYIN           PIC  X(04)  VALUE  "PYIN".
  2006*----------  株式配当
  2007 20  CNS-JIYU-QDIS           PIC  X(04)  VALUE  "QDIS".
  2008*----------  みなし配当
  2009 20  CNS-JIYU-QDIV           PIC  X(04)  VALUE  "QDIV".
  2010*----------  キャッシュ受取簿価移動
  2011 20  CNS-JIYU-RCOT           PIC  X(04)  VALUE  "RCOT".
  2012*----------  "購入による経過利息損益計上"
  2013 20  CNS-JIYU-RCPB           PIC  X(04)  VALUE  "RCPB".
  2014*----------  売却による経過利息損益計上
  2015 20  CNS-JIYU-RCPS           PIC  X(04)  VALUE  "RCPS".
  2016*----------  ファンド収益払出
  2017 20  CNS-JIYU-REV            PIC  X(04)  VALUE  "REV ".
  2018*----------  ファンド損繰越
  2019 20  CNS-JIYU-FLOC           PIC  X(04)  VALUE  "FLOC".
  2020*----------  ファンド益繰越
  2021 20  CNS-JIYU-REVC           PIC  X(04)  VALUE  "REVC".
  2022*----------  ファンド収益再投資
  2023 20  CNS-JIYU-REVI           PIC  X(04)  VALUE  "REVI".
  2024*----------  担保金等受入
  2025 20  CNS-JIYU-SDIN           PIC  X(04)  VALUE  "SDIN".
  2026*----------  担保金等返戻
  2027 20  CNS-JIYU-SDOT           PIC  X(04)  VALUE  "SDOT".
  2028*----------  有価証券借入
  2029 20  CNS-JIYU-SECB           PIC  X(04)  VALUE  "SECB".
  2030*----------  有価証券返戻
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  36
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/TORIJIYUCNS.cpy)
  2031 20  CNS-JIYU-SECR           PIC  X(04)  VALUE  "SECR".
  2032*----------  先物現渡による売却
  2033 20  CNS-JIYU-FSEL           PIC  X(04)  VALUE  "FSEL".
  2034*----------  オプション権利行使／割当による売却
  2035 20  CNS-JIYU-OSOT           PIC  X(04)  VALUE  "OSOT".
  2036*----------  単元株未満の買取請求による売却
  2037 20  CNS-JIYU-REQ            PIC  X(04)  VALUE  "REQ ".
  2038*----------  端数株式調整売却
  2039 20  CNS-JIYU-RSLL           PIC  X(04)  VALUE  "RSLL".
  2040*----------  一般的な売却
  2041 20  CNS-JIYU-SELL           PIC  X(04)  VALUE  "SELL".
  2042*----------  信用現渡による売却
  2043 20  CNS-JIYU-SSEL           PIC  X(04)  VALUE  "SSEL".
  2044*----------  ＴＢＡ割当による売却
  2045 20  CNS-JIYU-TSOT           PIC  X(04)  VALUE  "TSOT".
  2046*----------  現物マッチングによる引落
  2047 20  CNS-JIYU-FEXD           PIC  X(04)  VALUE  "FEXD".
  2048*----------  最終決済
  2049 20  CNS-JIYU-FEXF           PIC  X(04)  VALUE  "FEXF".
  2050*----------  相殺
  2051 20  CNS-JIYU-OFST           PIC  X(04)  VALUE  "OFST".
  2052*----------  反対売買
  2053 20  CNS-JIYU-SET            PIC  X(04)  VALUE  "SET ".
  2054*----------  オプション権利割当による反対売買
  2055 20  CNS-JIYU-SETA           PIC  X(04)  VALUE  "SETA".
  2056*----------  オプション権利行使による反対売買
  2057 20  CNS-JIYU-SETE           PIC  X(04)  VALUE  "SETE".
  2058*----------  負債減少
  2059 20  CNS-JIYU-LOUT           PIC  X(04)  VALUE  "LOUT".
  2060*----------  買戻し
  2061 20  CNS-JIYU-SHBY           PIC  X(04)  VALUE  "SHBY".
  2062*----------  買戻請求
  2063 20  CNS-JIYU-SHRQ           PIC  X(04)  VALUE  "SHRQ".
  2064*----------  負債増加
  2065 20  CNS-JIYU-LIN            PIC  X(04)  VALUE  "LIN ".
  2066*----------  空売り
  2067 20  CNS-JIYU-SHSL           PIC  X(04)  VALUE  "SHSL".
  2068*----------  現物による元本受入
  2069 20  CNS-JIYU-SINP           PIC  X(04)  VALUE  "SINP".
  2070*----------  元本受入に伴う評価情報
  2071 20  CNS-JIYU-SINH           PIC  X(04)  VALUE  "SINH".
  2072*----------  元本受入による増加
  2073 20  CNS-JIYU-SINI           PIC  X(04)  VALUE  "SINI".
  2074*----------  有価証券貸付
  2075 20  CNS-JIYU-SLIN           PIC  X(04)  VALUE  "SLIN".
  2076*----------  有価証券回収
  2077 20  CNS-JIYU-SLOT           PIC  X(04)  VALUE  "SLOT".
  2078*----------  元本返戻による減少
  2079 20  CNS-JIYU-SOUD           PIC  X(04)  VALUE  "SOUD".
  2080*----------  元本返戻に伴う評価情報
  2081 20  CNS-JIYU-SOUH           PIC  X(04)  VALUE  "SOUH".
  2082*----------  現物による元本返戻
  2083 20  CNS-JIYU-SOUP           PIC  X(04)  VALUE  "SOUP".
  2084*----------  源泉税還付金入金仮払金引落
  2085 20  CNS-JIYU-RETR           PIC  X(04)  VALUE  "RETR".
  2086*----------  源泉税還付金入金益計上
  2087 20  CNS-JIYU-TAXR           PIC  X(04)  VALUE  "TAXR".
  2088*----------  ノンカバー為替差損益
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  37
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/TORIJIYUCNS.cpy)
  2089 20  CNS-JIYU-DMY5           PIC  X(04)  VALUE  "DMY5".
  2090*----------  収益計上簿価異動による経過利息
  2091 20  CNS-JIYU-DMY6           PIC  X(04)  VALUE  "DMY6".
  2092*----------  損失計上簿価異動による経過利息
  2093 20  CNS-JIYU-DMY7           PIC  X(04)  VALUE  "DMY7".
  2094*----------  その他増による経過利息
  2095 20  CNS-JIYU-DMY8           PIC  X(04)  VALUE  "DMY8".
  2096*----------  その他減による経過利息
  2097 20  CNS-JIYU-DMY9           PIC  X(04)  VALUE  "DMY9".
  2098*----------  切離法評価益計上
  2099 20  CNS-JIYU-FTSG           PIC  X(04)  VALUE  "FTSG".
  2100*----------  切離法評価損計上
  2101 20  CNS-JIYU-FTSL           PIC  X(04)  VALUE  "FTSL".
  2102*----------  その他益
  2103 20  CNS-JIYU-PRF            PIC  X(04)  VALUE  "PRF ".
  2104*----------  前払金評価益計上
  2105 20  CNS-JIYU-FTPK           PIC  X(04)  VALUE  "FTPK".
  2106*----------  前払金評価益計上
  2107 20  CNS-JIYU-FTLK           PIC  X(04)  VALUE  "FTLK".
  2108*----------  前払金評価益計上
  2109 20  CNS-JIYU-FTPS           PIC  X(04)  VALUE  "FTPS".
  2110*----------  前払金評価益計上
  2111 20  CNS-JIYU-FTLS           PIC  X(04)  VALUE  "FTLS".
  2112*----------  前払金評価益計上
  2113 20  CNS-JIYU-FTPB           PIC  X(04)  VALUE  "FTPB".
  2114*----------  未払金評価損計上
  2115 20  CNS-JIYU-FTLB           PIC  X(04)  VALUE  "FTLB".
  2116*----------  前払金評価損戻入
  2117 20  CNS-JIYU-FTPL           PIC  X(04)  VALUE  "FTPL".
  2118*----------  前払金評価損戻入
  2119 20  CNS-JIYU-FTLL           PIC  X(04)  VALUE  "FTLL".
  2120*----------  前払金評価損戻入
  2121 20  CNS-JIYU-FTPT           PIC  X(04)  VALUE  "FTPT".
  2122*----------  前払金評価損戻入
  2123 20  CNS-JIYU-FTLT           PIC  X(04)  VALUE  "FTLT".
  2124*----------  前払金評価損戻入
  2125 20  CNS-JIYU-FTPC           PIC  X(04)  VALUE  "FTPC".
  2126*----------  前払金評価損戻入
  2127 20  CNS-JIYU-FTLC           PIC  X(04)  VALUE  "FTLC".
  2128*----------   MT証券種別コンスタント
* 2129     COPY  "SKSBTCNS.cpy".
  2130******************************************************************
  2131* $Header$
  2132******************************************************************
  2133*
  2134* システムＩＤ   : T-STAR
  2135* システム名称   : 次期TSTARシステム
  2136* コピー句ＩＤ   : SKSBTCNS.cpy
  2137* コピー句名称   : MT証券種別コンスタント
  2138*
  2139* 改訂履歴
  2140* 年月日   区分 所属   担当者  内容
  2141* -------- ---- ------ ------- -----------------------------------
  2142* 20080612 新規 SCS            新規作成
  2143*
  2144******************************************************************
  2145*----------  株式
  2146 20  CNS-SKSBT-S             PIC  X(04)  VALUE  "S   ".
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  38
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/SKSBTCNS.cpy)py)
  2147*----------  新株引受権証券（ワラント）
  2148 20  CNS-SKSBT-WAR           PIC  X(04)  VALUE  "WAR ".
  2149*----------  ライツ（増資時発生）
  2150 20  CNS-SKSBT-WR            PIC  X(04)  VALUE  "WR  ".
  2151*----------  その他国内株式
  2152 20  CNS-SKSBT-DSMS          PIC  X(04)  VALUE  "DSMS".
  2153*----------  その他外国株式
  2154 20  CNS-SKSBT-FSMS          PIC  X(04)  VALUE  "FSMS".
  2155*----------  債券
  2156 20  CNS-SKSBT-B             PIC  X(04)  VALUE  "B   ".
  2157*----------  MBS
  2158 20  CNS-SKSBT-MB            PIC  X(04)  VALUE  "MB  ".
  2159*----------  その他国内債券
  2160 20  CNS-SKSBT-DBMS          PIC  X(04)  VALUE  "DBMS".
  2161*----------  その他外国債券
  2162 20  CNS-SKSBT-FBMS          PIC  X(04)  VALUE  "FBMS".
  2163*----------  転換社債
  2164 20  CNS-SKSBT-CB            PIC  X(04)  VALUE  "CB  ".
  2165*----------  新株引受権付社債
  2166 20  CNS-SKSBT-WB            PIC  X(04)  VALUE  "WB  ".
  2167*----------  その他転換社債
  2168 20  CNS-SKSBT-CBMS          PIC  X(04)  VALUE  "CBMS".
  2169*----------  中国ファンド、MMF他短期社投および投資対象分類不明なバランス型
  2170 20  CNS-SKSBT-IT            PIC  X(04)  VALUE  "IT  ".
  2171*----------  債券型投信
  2172 20  CNS-SKSBT-ITB           PIC  X(04)  VALUE  "ITB ".
  2173*----------  株式型投信
  2174 20  CNS-SKSBT-ITS           PIC  X(04)  VALUE  "ITS ".
  2175*----------  CB型投信
  2176 20  CNS-SKSBT-ITCB          PIC  X(04)  VALUE  "ITCB".
  2177*----------  国内債券型投信
  2178 20  CNS-SKSBT-ITDB          PIC  X(04)  VALUE  "ITDB".
  2179*----------  国内株式型投信
  2180 20  CNS-SKSBT-ITDS          PIC  X(04)  VALUE  "ITDS".
  2181*----------  国内CB型投信
  2182 20  CNS-SKSBT-ITDC          PIC  X(04)  VALUE  "ITDC".
  2183*----------  外国株式型投信
  2184 20  CNS-SKSBT-ITFS          PIC  X(04)  VALUE  "ITFS".
  2185*----------  外国債券型投信
  2186 20  CNS-SKSBT-ITFB          PIC  X(04)  VALUE  "ITFB".
  2187*----------  外貨建投信（区分不可能の場合）
  2188 20  CNS-SKSBT-ITF           PIC  X(04)  VALUE  "ITF ".
  2189*----------  中国ファンド、MMF他および投資対象分類不明なバランス型投資信託
  2190 20  CNS-SKSBT-ET            PIC  X(04)  VALUE  "ET  ".
  2191*----------  債券型上場投信
  2192 20  CNS-SKSBT-ETB           PIC  X(04)  VALUE  "ETB ".
  2193*----------  株式型上場投信
  2194 20  CNS-SKSBT-ETS           PIC  X(04)  VALUE  "ETS ".
  2195*----------  CB型上場投信
  2196 20  CNS-SKSBT-ETCB          PIC  X(04)  VALUE  "ETCB".
  2197*----------  国内債券型上場投信
  2198 20  CNS-SKSBT-ETDB          PIC  X(04)  VALUE  "ETDB".
  2199*----------  国内株式型上場投信
  2200 20  CNS-SKSBT-ETDS          PIC  X(04)  VALUE  "ETDS".
  2201*----------  国内CB型上場投信
  2202 20  CNS-SKSBT-ETDC          PIC  X(04)  VALUE  "ETDC".
  2203*----------  外国株式型上場投信
  2204 20  CNS-SKSBT-ETFS          PIC  X(04)  VALUE  "ETFS".
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  39
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/SKSBTCNS.cpy)py)
  2205*----------  外国債券型上場投信
  2206 20  CNS-SKSBT-ETFB          PIC  X(04)  VALUE  "ETFB".
  2207*----------  外貨建上場投信（区分不可能の場合）
  2208 20  CNS-SKSBT-ETF           PIC  X(04)  VALUE  "ETF ".
  2209*----------  不動産投資信託受益証券
  2210 20  CNS-SKSBT-REIT          PIC  X(04)  VALUE  "REIT".
  2211*----------  現金
  2212 20  CNS-SKSBT-CASH          PIC  X(04)  VALUE  "CASH".
  2213*----------  コール
  2214 20  CNS-SKSBT-CALL          PIC  X(04)  VALUE  "CALL".
  2215*----------  手形
  2216 20  CNS-SKSBT-BILL          PIC  X(04)  VALUE  "BILL".
  2217*----------  CP
  2218 20  CNS-SKSBT-CP            PIC  X(04)  VALUE  "CP  ".
  2219*----------  大口定期預金
  2220 20  CNS-SKSBT-DA            PIC  X(04)  VALUE  "DA  ".
  2221*----------  CD現先・CP現先
  2222 20  CNS-SKSBT-GEN           PIC  X(04)  VALUE  "GEN ".
  2223*----------  譲渡性預金
  2224 20  CNS-SKSBT-NCD           PIC  X(04)  VALUE  "NCD ".
  2225*----------  証拠金（区分不可能な場合）
  2226 20  CNS-SKSBT-MAR           PIC  X(04)  VALUE  "MAR ".
  2227*----------  債券先物証拠金
  2228 20  CNS-SKSBT-MABF          PIC  X(04)  VALUE  "MABF".
  2229*----------  債券オプション証拠金
  2230 20  CNS-SKSBT-MABO          PIC  X(04)  VALUE  "MABO".
  2231*----------  債券証拠金（対象商品の区分不可能の場合）
  2232 20  CNS-SKSBT-MAB           PIC  X(04)  VALUE  "MAB ".
  2233*----------  外国債券委託証拠金
  2234 20  CNS-SKSBT-MAFB          PIC  X(04)  VALUE  "MAFB".
  2235*----------  株式先物証拠金
  2236 20  CNS-SKSBT-MASF          PIC  X(04)  VALUE  "MASF".
  2237*----------  株式オプション証拠金
  2238 20  CNS-SKSBT-MASO          PIC  X(04)  VALUE  "MASO".
  2239*----------  株式証拠金（対象商品の区分不可能の場合）
  2240 20  CNS-SKSBT-MAS           PIC  X(04)  VALUE  "MAS ".
  2241*----------  外国株式証拠金（対象商品の区分不可能の場合）
  2242 20  CNS-SKSBT-MAFS          PIC  X(04)  VALUE  "MAFS".
  2243*----------  代用有価証券(株式)
  2244 20  CNS-SKSBT-MSS           PIC  X(04)  VALUE  "MSS ".
  2245*----------  代用有価証券(債券)
  2246 20  CNS-SKSBT-MSB           PIC  X(04)  VALUE  "MSB ".
  2247*----------  不動産
  2248 20  CNS-SKSBT-R             PIC  X(04)  VALUE  "R   ".
  2249*----------  個別株式コールオプション
  2250 20  CNS-SKSBT-SGC           PIC  X(04)  VALUE  "SGC ".
  2251*----------  個別株式プットオプション
  2252 20  CNS-SKSBT-SGP           PIC  X(04)  VALUE  "SGP ".
  2253*----------  株価指数コールオプション
  2254 20  CNS-SKSBT-SOC           PIC  X(04)  VALUE  "SOC ".
  2255*----------  株価指数プットオプション
  2256 20  CNS-SKSBT-SOP           PIC  X(04)  VALUE  "SOP ".
  2257*----------  株価指数先物コールオプション
  2258 20  CNS-SKSBT-FOC           PIC  X(04)  VALUE  "FOC ".
  2259*----------  株価指数先物プットオプション
  2260 20  CNS-SKSBT-FOP           PIC  X(04)  VALUE  "FOP ".
  2261*----------  店頭現債コールオプション
  2262 20  CNS-SKSBT-BGC           PIC  X(04)  VALUE  "BGC ".
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  40
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/SKSBTCNS.cpy)py)
  2263*----------  店頭現債プットオプション
  2264 20  CNS-SKSBT-BGP           PIC  X(04)  VALUE  "BGP ".
  2265*----------  債券先物コールオプション
  2266 20  CNS-SKSBT-BOC           PIC  X(04)  VALUE  "BOC ".
  2267*----------  債券先物プットオプション
  2268 20  CNS-SKSBT-BOP           PIC  X(04)  VALUE  "BOP ".
  2269*----------  通貨コールオプション（区分不可能な場合）
  2270 20  CNS-SKSBT-FHC           PIC  X(04)  VALUE  "FHC ".
  2271*----------  通貨コールオプション（株式）
  2272 20  CNS-SKSBT-FHCS          PIC  X(04)  VALUE  "FHCS".
  2273*----------  通貨コールオプション（債券）
  2274 20  CNS-SKSBT-FHCB          PIC  X(04)  VALUE  "FHCB".
  2275*----------  通貨プットオプション（区分不可能な場合）
  2276 20  CNS-SKSBT-FHP           PIC  X(04)  VALUE  "FHP ".
  2277*----------  通貨プットオプション（株式）
  2278 20  CNS-SKSBT-FHPS          PIC  X(04)  VALUE  "FHPS".
  2279*----------  通貨プットオプション（債券）
  2280 20  CNS-SKSBT-FHPB          PIC  X(04)  VALUE  "FHPB".
  2281*----------  通貨先物コールオプション（区分不可能な場合）
  2282 20  CNS-SKSBT-FIC           PIC  X(04)  VALUE  "FIC ".
  2283*----------  通貨先物コールオプション（株式）
  2284 20  CNS-SKSBT-FICS          PIC  X(04)  VALUE  "FICS".
  2285*----------  通貨先物コールオプション（債券）
  2286 20  CNS-SKSBT-FICB          PIC  X(04)  VALUE  "FICB".
  2287*----------  通貨先物プットオプション（区分不可能な場合）
  2288 20  CNS-SKSBT-FIP           PIC  X(04)  VALUE  "FIP ".
  2289*----------  通貨先物プットオプション（株式）
  2290 20  CNS-SKSBT-FIPS          PIC  X(04)  VALUE  "FIPS".
  2291*----------  通貨先物プットオプション（債券）
  2292 20  CNS-SKSBT-FIPB          PIC  X(04)  VALUE  "FIPB".
  2293*----------  金利先物コールオプション
  2294 20  CNS-SKSBT-KOC           PIC  X(04)  VALUE  "KOC ".
  2295*----------  金利先物プットオプション
  2296 20  CNS-SKSBT-KOP           PIC  X(04)  VALUE  "KOP ".
  2297*----------  株価指数先物
  2298 20  CNS-SKSBT-SF            PIC  X(04)  VALUE  "SF  ".
  2299*----------  債券先物
  2300 20  CNS-SKSBT-BF            PIC  X(04)  VALUE  "BF  ".
  2301*----------  通貨先物（区分不可能な場合）
  2302 20  CNS-SKSBT-FIF           PIC  X(04)  VALUE  "FIF ".
  2303*----------  通貨先物（株式）
  2304 20  CNS-SKSBT-FIFS          PIC  X(04)  VALUE  "FIFS".
  2305*----------  通貨先物（債券）
  2306 20  CNS-SKSBT-FIFB          PIC  X(04)  VALUE  "FIFB".
  2307*----------  金利先物
  2308 20  CNS-SKSBT-KIF           PIC  X(04)  VALUE  "KIF ".
  2309*----------  為替直物
  2310 20  CNS-SKSBT-EX            PIC  X(04)  VALUE  "EX  ".
  2311*----------  為替予約（区分不可能な場合）
  2312 20  CNS-SKSBT-EXC           PIC  X(04)  VALUE  "EXC ".
  2313*----------  為替予約（債券）
  2314 20  CNS-SKSBT-EXCB          PIC  X(04)  VALUE  "EXCB".
  2315*----------  為替予約（株式）
  2316 20  CNS-SKSBT-EXCS          PIC  X(04)  VALUE  "EXCS".
  2317*----------  ＴＢＡ
  2318 20  CNS-SKSBT-TBA           PIC  X(04)  VALUE  "TBA ".
  2319*----------  株式信用
  2320 20  CNS-SKSBT-SM            PIC  X(04)  VALUE  "SM  ".
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  41
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/SKSBTCNS.cpy)py)
  2321*----------  元本
  2322 20  CNS-SKSBT-PRI           PIC  X(04)  VALUE  "PRI ".
  2323*----------  貸株
  2324 20  CNS-SKSBT-SLS           PIC  X(04)  VALUE  "SLS ".
  2325*----------  債券レポ取引
  2326 20  CNS-SKSBT-SLB           PIC  X(04)  VALUE  "SLB ".
  2327*----------  債券新現先取引
  2328 20  CNS-SKSBT-GNS           PIC  X(04)  VALUE  "GNS ".
  2329*----------  貸付有価証券担保金（負債）（分離不能な場合）
  2330 20  CNS-SKSBT-SD            PIC  X(04)  VALUE  "SD  ".
  2331*----------  貸付有価証券担保金（負債）（レポ）
  2332 20  CNS-SKSBT-SDB           PIC  X(04)  VALUE  "SDB ".
  2333*----------  貸付有価証券担保金（負債）（新現先）
  2334 20  CNS-SKSBT-SDG           PIC  X(04)  VALUE  "SDG ".
  2335*----------  貸付有価証券担保金（負債）（貸株）
  2336 20  CNS-SKSBT-SDS           PIC  X(04)  VALUE  "SDS ".
  2337*----------  その他商品（株式型）
  2338 20  CNS-SKSBT-XMOS          PIC  X(04)  VALUE  "XMOS".
  2339*----------  その他商品（債券型）
  2340 20  CNS-SKSBT-XMOB          PIC  X(04)  VALUE  "XMOB".
  2341*----------  その他商品（短期型）
  2342 20  CNS-SKSBT-XMOC          PIC  X(04)  VALUE  "XMOC".
  2343*----------  その他商品（負債型）
  2344 20  CNS-SKSBT-XMOL          PIC  X(04)  VALUE  "XMOL".
  2345*----------  その他商品（先物型）
  2346 20  CNS-SKSBT-XMFF          PIC  X(04)  VALUE  "XMFF".
  2347*----------  その他商品（オプション型）
  2348 20  CNS-SKSBT-XMFO          PIC  X(04)  VALUE  "XMFO".
  2349*----------  ファンド全体
  2350 20  CNS-SKSBT-FDAL          PIC  X(04)  VALUE  "FDAL".
  2351*----------  その他期末整理仕訳用残高
  2352 20  CNS-SKSBT-OOXZ          PIC  X(04)  VALUE  "OOXZ".
  2353*----------  最終決済
  2354 20  CNS-SKSBT-FEXF          PIC  X(04)  VALUE  "FEXF".
  2355*----------  現物マッチングによる引落
  2356 20  CNS-SKSBT-FEXD          PIC  X(04)  VALUE  "FEXD".
  2357*----------  現引・現渡
  2358 20  CNS-SKSBT-FEXS          PIC  X(04)  VALUE  "FEXS".
  2359*----------  反対売買
  2360 20  CNS-SKSBT-SET           PIC  X(04)  VALUE  "SET ".
  2361*----------  オプション権利割当による反対売買
  2362 20  CNS-SKSBT-SETA          PIC  X(04)  VALUE  "SETA".
  2363*----------  オプション権利行使による反対売買
  2364 20  CNS-SKSBT-SETE          PIC  X(04)  VALUE  "SETE".
  2365*----------  権利割当による差金決済
  2366 20  CNS-SKSBT-OAS           PIC  X(04)  VALUE  "OAS ".
  2367*----------  権利行使による差金決済
  2368 20  CNS-SKSBT-OEX           PIC  X(04)  VALUE  "OEX ".
  2369*----------  現物割当
  2370 20  CNS-SKSBT-OATB          PIC  X(04)  VALUE  "OATB".
  2371*----------  権利消滅
  2372 20  CNS-SKSBT-OABL          PIC  X(04)  VALUE  "OABL".
  2373*----------  義務消滅
  2374 20  CNS-SKSBT-OABS          PIC  X(04)  VALUE  "OABS".
  2375*----------  権利割当（現物）による引落
  2376 20  CNS-SKSBT-OASS          PIC  X(04)  VALUE  "OASS".
  2377*----------  権利行使（現物）による引落
  2378 20  CNS-SKSBT-OEXS          PIC  X(04)  VALUE  "OEXS".
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  42
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/SKSBTCNS.cpy)py)
  2379*----------  権利割当（先物）による引落
  2380 20  CNS-SKSBT-OASF          PIC  X(04)  VALUE  "OASF".
  2381*----------  権利行使（先物）による引落
  2382 20  CNS-SKSBT-OEXF          PIC  X(04)  VALUE  "OEXF".
  2383*----------  信用増資・減
  2384 20  CNS-SKSBT-MSPD          PIC  X(04)  VALUE  "MSPD".
  2385******************************************************************
  2386*                システムMAX件数
  2387******************************************************************
  2388 20  CNS-MAX-999             PIC  9(03)  VALUE  999.
  2389******************************************************************
  2390******************************************************************
  2391*----------      数字
  2392******************************************************************
  2393 20  CNS-0                   PIC  9(01)  VALUE  0.
  2394 20  CNS-1                   PIC  9(01)  VALUE  1.
  2395 20  CNS-2                   PIC  9(01)  VALUE  2.
  2396 20  CNS-3                   PIC  9(01)  VALUE  3.
  2397 20  CNS-4                   PIC  9(01)  VALUE  4.
  2398 20  CNS-5                   PIC  9(01)  VALUE  5.
  2399 20  CNS-6                   PIC  9(01)  VALUE  6.
  2400 20  CNS-7                   PIC  9(01)  VALUE  7.
  2401 20  CNS-8                   PIC  9(01)  VALUE  8.
  2402 20  CNS-9                   PIC  9(01)  VALUE  9.
  2403 20  CNS-10                  PIC  9(02)  VALUE  10.
  2404 20  CNS-11                  PIC  9(02)  VALUE  11.
  2405 20  CNS-12                  PIC  9(02)  VALUE  12.
  2406 20  CNS-13                  PIC  9(02)  VALUE  13.
  2407 20  CNS-14                  PIC  9(02)  VALUE  14.
  2408 20  CNS-15                  PIC  9(02)  VALUE  15.
  2409 20  CNS-16                  PIC  9(02)  VALUE  16.
  2410 20  CNS-17                  PIC  9(02)  VALUE  17.
  2411 20  CNS-18                  PIC  9(02)  VALUE  18.
  2412 20  CNS-19                  PIC  9(02)  VALUE  19.
  2413 20  CNS-20                  PIC  9(02)  VALUE  20.
  2414 20  CNS-21                  PIC  9(02)  VALUE  21.
  2415 20  CNS-22                  PIC  9(02)  VALUE  22.
  2416 20  CNS-23                  PIC  9(02)  VALUE  23.
  2417 20  CNS-24                  PIC  9(02)  VALUE  24.
  2418 20  CNS-25                  PIC  9(02)  VALUE  25.
  2419 20  CNS-26                  PIC  9(02)  VALUE  26.
  2420 20  CNS-27                  PIC  9(02)  VALUE  27.
  2421 20  CNS-28                  PIC  9(02)  VALUE  28.
  2422 20  CNS-29                  PIC  9(02)  VALUE  29.
  2423 20  CNS-30                  PIC  9(02)  VALUE  30.
  2424 20  CNS-31                  PIC  9(02)  VALUE  31.
  2425 20  CNS-32                  PIC  9(02)  VALUE  32.
  2426 20  CNS-33                  PIC  9(02)  VALUE  33.
  2427 20  CNS-34                  PIC  9(02)  VALUE  34.
  2428 20  CNS-35                  PIC  9(02)  VALUE  35.
  2429 20  CNS-36                  PIC  9(02)  VALUE  36.
  2430 20  CNS-37                  PIC  9(02)  VALUE  37.
  2431 20  CNS-38                  PIC  9(02)  VALUE  38.
  2432 20  CNS-39                  PIC  9(02)  VALUE  39.
  2433 20  CNS-40                  PIC  9(02)  VALUE  40.
  2434 20  CNS-41                  PIC  9(02)  VALUE  41.
  2435 20  CNS-42                  PIC  9(02)  VALUE  42.
  2436 20  CNS-43                  PIC  9(02)  VALUE  43.
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  43
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/USCNS.cpy)py)py)
  2437 20  CNS-44                  PIC  9(02)  VALUE  44.
  2438 20  CNS-45                  PIC  9(02)  VALUE  45.
  2439 20  CNS-46                  PIC  9(02)  VALUE  46.
  2440 20  CNS-47                  PIC  9(02)  VALUE  47.
  2441 20  CNS-48                  PIC  9(02)  VALUE  48.
  2442 20  CNS-49                  PIC  9(02)  VALUE  49.
  2443 20  CNS-50                  PIC  9(02)  VALUE  50.
  2444 20  CNS-51                  PIC  9(02)  VALUE  51.
  2445 20  CNS-52                  PIC  9(02)  VALUE  52.
  2446 20  CNS-53                  PIC  9(02)  VALUE  53.
  2447 20  CNS-54                  PIC  9(02)  VALUE  54.
  2448 20  CNS-55                  PIC  9(02)  VALUE  55.
  2449 20  CNS-56                  PIC  9(02)  VALUE  56.
  2450 20  CNS-57                  PIC  9(02)  VALUE  57.
  2451 20  CNS-58                  PIC  9(02)  VALUE  58.
  2452 20  CNS-59                  PIC  9(02)  VALUE  59.
  2453 20  CNS-60                  PIC  9(02)  VALUE  60.
  2454 20  CNS-61                  PIC  9(02)  VALUE  61.
  2455 20  CNS-62                  PIC  9(02)  VALUE  62.
  2456 20  CNS-63                  PIC  9(02)  VALUE  63.
  2457 20  CNS-64                  PIC  9(02)  VALUE  64.
  2458 20  CNS-65                  PIC  9(02)  VALUE  65.
  2459 20  CNS-66                  PIC  9(02)  VALUE  66.
  2460 20  CNS-67                  PIC  9(02)  VALUE  67.
  2461 20  CNS-68                  PIC  9(02)  VALUE  68.
  2462 20  CNS-69                  PIC  9(02)  VALUE  69.
  2463 20  CNS-70                  PIC  9(02)  VALUE  70.
  2464 20  CNS-71                  PIC  9(02)  VALUE  71.
  2465 20  CNS-72                  PIC  9(02)  VALUE  72.
  2466 20  CNS-73                  PIC  9(02)  VALUE  73.
  2467 20  CNS-74                  PIC  9(02)  VALUE  74.
  2468 20  CNS-75                  PIC  9(02)  VALUE  75.
  2469 20  CNS-76                  PIC  9(02)  VALUE  76.
  2470 20  CNS-77                  PIC  9(02)  VALUE  77.
  2471 20  CNS-78                  PIC  9(02)  VALUE  78.
  2472 20  CNS-79                  PIC  9(02)  VALUE  79.
  2473 20  CNS-80                  PIC  9(02)  VALUE  80.
  2474 20  CNS-81                  PIC  9(02)  VALUE  81.
  2475 20  CNS-82                  PIC  9(02)  VALUE  82.
  2476 20  CNS-83                  PIC  9(02)  VALUE  83.
  2477 20  CNS-84                  PIC  9(02)  VALUE  84.
  2478 20  CNS-85                  PIC  9(02)  VALUE  85.
  2479 20  CNS-86                  PIC  9(02)  VALUE  86.
  2480 20  CNS-87                  PIC  9(02)  VALUE  87.
  2481 20  CNS-88                  PIC  9(02)  VALUE  88.
  2482 20  CNS-89                  PIC  9(02)  VALUE  89.
  2483 20  CNS-90                  PIC  9(02)  VALUE  90.
  2484 20  CNS-99                  PIC  9(02)  VALUE  99.
  2485 20  CNS-100                 PIC  9(03)  VALUE  100.
  2486 20  CNS-200                 PIC  9(03)  VALUE  200.
  2487 20  CNS-365                 PIC  9(03)  VALUE  365.
  2488 20  CNS-366                 PIC  9(03)  VALUE  366.
  2489 20  CNS-400                 PIC  9(03)  VALUE  400.
  2490 20  CNS-500                 PIC  9(03)  VALUE  500.
  2491 20  CNS-999                 PIC  9(03)  VALUE  999.
  2492 20  CNS-1000                PIC  9(04)  VALUE  1000.
  2493 20  CNS-10000               PIC  9(05)  VALUE  10000.
  2494 20  CNS-50000               PIC  9(05)  VALUE  50000.
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  44
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/USCNS.cpy)py)py)
  2495 20  CNS-99999               PIC  9(05)  VALUE  99999.
  2496 20  CNS-1000000             PIC  9(07)  VALUE  1000000.
  2497******************************************************************
  2498*----------      言語区分
  2499******************************************************************
  2500 20  CNS-JPN                 PIC  X(01)  VALUE  "J".
  2501 20  CNS-ENG                 PIC  X(01)  VALUE  "E".
  2502******************************************************************
  2503*----------      字母
  2504******************************************************************
  2505 20  CNS-X-0                 PIC  X(01)  VALUE  "0".
  2506 20  CNS-X-1                 PIC  X(01)  VALUE  "1".
  2507 20  CNS-X-2                 PIC  X(01)  VALUE  "2".
  2508 20  CNS-X-3                 PIC  X(01)  VALUE  "3".
  2509 20  CNS-X-4                 PIC  X(01)  VALUE  "4".
  2510 20  CNS-X-5                 PIC  X(01)  VALUE  "5".
  2511 20  CNS-X-6                 PIC  X(01)  VALUE  "6".
  2512 20  CNS-X-7                 PIC  X(01)  VALUE  "7".
  2513 20  CNS-X-8                 PIC  X(01)  VALUE  "8".
  2514 20  CNS-X-9                 PIC  X(01)  VALUE  "9".
  2515 20  CNS-X-10                PIC  X(02)  VALUE  "10".
  2516 20  CNS-X-01                PIC  X(02)  VALUE  "01".
  2517 20  CNS-X-99                PIC  X(02)  VALUE  "99".
  2518 20  CNS-X-0000              PIC  X(04)  VALUE  "0000".
  2519 20  CNS-X-0001              PIC  X(04)  VALUE  "0001".
  2520 20  CNS-X-500               PIC  X(04)  VALUE  "500".
  2521 20  CNS-X-1000              PIC  X(04)  VALUE  "1000".
  2522 20  CNS-X-RX                PIC  X(02)  VALUE  "RX".
  2523******************************************************************
  2524*                サブRTN戻り値
  2525******************************************************************
  2526 20  CNS-RTN-140             PIC  X(03)  VALUE  "140".
  2527******************************************************************
  2528*----------  TXRX利用区分ポジション
  2529******************************************************************
  2530 20  CNS-TXRX-POS            PIC  9(03)  VALUE  267.
  2531******************************************************************
  2532*----------  利用会社コード（４９９９）
  2533******************************************************************
  2534 20  CNS-COMP-NRI            PIC  X(04)  VALUE  "4999".
  2535******************************************************************
  2536*----------      実行ステータス
  2537******************************************************************
  2538*----------  正常終了
  2539 20  CNS-STS-100             PIC  X(03)  VALUE  "100".
  2540*----------  警告終了
  2541 20  CNS-STS-200             PIC  X(03)  VALUE  "200".
  2542*----------  業務エラー(続行可能)
  2543 20  CNS-STS-270             PIC  X(03)  VALUE  "270".
  2544*----------  業務エラー(明細続行不可)
  2545 20  CNS-STS-275             PIC  X(03)  VALUE  "275".
  2546*----------  業務エラー(処理中メイン続行不可)
  2547 20  CNS-STS-277             PIC  X(03)  VALUE  "277".
  2548*----------  業務エラー(業務タスク続行不可)
  2549 20  CNS-STS-375             PIC  X(03)  VALUE  "375".
  2550*----------  システムエラー
  2551 20  CNS-STS-400             PIC  X(03)  VALUE  "400".
  2552******************************************************************
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  45
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/USCNS.cpy)py)py)
  2553*                SMTCCH91,SMTCCH98 RTN戻り値
  2554******************************************************************
  2555 20  CNS-X-000               PIC  X(03)  VALUE  "000".
  2556 20  CNS-X-001               PIC  X(03)  VALUE  "001".
  2557 20  CNS-X-002               PIC  X(03)  VALUE  "002".
  2558 20  CNS-X-003               PIC  X(03)  VALUE  "003".
  2559 20  CNS-X-004               PIC  X(03)  VALUE  "004".
  2560******************************************************************
  2561*----------      進捗ステータス
  2562******************************************************************
  2563*----------  確定済
  2564 20  CNS-SHINTK-STS-000      PIC  X(03)  VALUE  "000".
  2565*----------  正常終了
  2566 20  CNS-SHINTK-STS-100      PIC  X(03)  VALUE  "100".
  2567*----------  警告終了
  2568 20  CNS-SHINTK-STS-200      PIC  X(03)  VALUE  "200".
  2569*----------  業務エラー(続行可能)
  2570 20  CNS-SHINTK-STS-270      PIC  X(03)  VALUE  "270".
  2571*----------  業務エラー(明細続行不可)
  2572 20  CNS-SHINTK-STS-275      PIC  X(03)  VALUE  "275".
  2573*----------  業務エラー(業務タスク続行不可)
  2574 20  CNS-SHINTK-STS-375      PIC  X(03)  VALUE  "375".
  2575*----------  システムエラー
  2576 20  CNS-SHINTK-STS-400      PIC  X(03)  VALUE  "400".
  2577*----------  再処理要
  2578 20  CNS-SHINTK-STS-500      PIC  X(03)  VALUE  "500".
  2579*----------  実行中
  2580 20  CNS-SHINTK-STS-600      PIC  X(03)  VALUE  "600".
  2581******************************************************************
  2582*----------      時刻形式区分
  2583******************************************************************
  2584 20  CNS-TIME-FORM-KBN-1     PIC  X(01)  VALUE  "1".
  2585 20  CNS-TIME-FORM-KBN-2     PIC  X(01)  VALUE  "2".
  2586******************************************************************
  2587*----------      メッセージID
  2588******************************************************************
  2589*----------  $項目$が取得できません。
  2590 20  CNS-MSG-E000217         PIC  X(07)  VALUE  "E000217".
  2591*----------  $項目TO$は$項目FROM$以降の日付を指定してください。
  2592 20  CNS-MSG-E000257         PIC  X(07)  VALUE  "E000257".
  2593*----------  $項目名$整合性チェックエラー。
  2594 20  CNS-MSG-E000370         PIC  X(07)  VALUE  "E000370".
  2595*----------  [$項目名$]は取得できません。
  2596 20  CNS-MSG-W000313         PIC  X(07)  VALUE  "W000313".
  2597*----------  現在、オンライン停止中です。
  2598 20  CNS-MSG-E000001         PIC  X(07)  VALUE  "E000001".
  2599*----------  該当メニューの利用権限がありません。
  2600 20  CNS-MSG-E000002         PIC  X(07)  VALUE  "E000002".
  2601*----------  [$項目名$]は100件超えています。
  2602 20  CNS-MSG-W000345         PIC  X(07)  VALUE  "W000345".
  2603*----------  [$項目名$]は1000件超えています。
  2604 20  CNS-MSG-W000346         PIC  X(07)  VALUE  "W000346".
  2605*----------  [$項目名$]は500件超えています。
  2606 20  CNS-MSG-W000398         PIC  X(07)  VALUE  "W000398".
  2607*----------  業務タスクIDが存在しません。
  2608 20  CNS-MSG-E000080         PIC  X(07)  VALUE  "E000080".
  2609*----------  業務タスクの利用権限がありません。
  2610 20  CNS-MSG-E000081         PIC  X(07)  VALUE  "E000081".
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  46
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/USCNS.cpy)py)py)
  2611*----------  リクエスト受付が正常終了しました。
  2612 20  CNS-MSG-I000024         PIC  X(07)  VALUE  "I000024".
  2613*----------  関連する業務タスクが稼働中のため現在は実行できません。
  2614 20  CNS-MSG-E000085         PIC  X(07)  VALUE  "E000085".
  2615*----------  [$項目名$]の入力値が不正です。
  2616 20  CNS-MSG-E000130         PIC  X(07)  VALUE  "E000130".
  2617*----------  [$項目名$]を入力してください。
  2618 20  CNS-MSG-E000133         PIC  X(07)  VALUE  "E000133".
  2619*----------  ファイルが指定されていません。
  2620 20  CNS-MSG-E000384         PIC  X(07)  VALUE  "E000384".
  2621*----------  指定したファイルのサイズは、上限値を超えています。
  2622 20  CNS-MSG-E000385         PIC  X(07)  VALUE  "E000385".
  2623*----------  指定したファイルは存在しない、または空ファイルです。
  2624 20  CNS-MSG-E000386         PIC  X(07)  VALUE  "E000386".
  2625*----------  TO日付と決算日断面区分の整合性がとれていない。
  2626 20  CNS-MSG-E000419         PIC  X(07)  VALUE  "E000419".
  2627*----------  運用成果$項目名$未作成あり。
  2628 20  CNS-MSG-W000420         PIC  X(07)  VALUE  "W000420".
  2629*----------  [$項目名$]データが異常あり。
  2630 20  CNS-MSG-E000428         PIC  X(07)  VALUE  "E000428".
  2631*----------  [$項目名$]データがなし。
  2632 20  CNS-MSG-E000429         PIC  X(07)  VALUE  "E000429".
  2633*----------  $項目$が存在しません
  2634 20  CNS-MSG-E000090         PIC  X(07)  VALUE  "E000090".
  2635*----------  [$項目名$]を一つ以上入力してください。
  2636 20  CNS-MSG-E000424         PIC  X(07)  VALUE  "E000424".
  2637*----------  ジョブが強制終了になりました
  2638 20  CNS-MSG-E000431         PIC  X(07)  VALUE  "E000431".
  2639*----------  $項目1$$項目2$の整合性が合っていません
  2640 20  CNS-MSG-E000439         PIC  X(07)  VALUE  "E000439".
  2641*----------  ジョブが一時終了になりました。
  2642 20  CNS-MSG-E000451         PIC  X(07)  VALUE  "E000451".
  2643*----------  帳票$帳票ID$が存在しません。
  2644 20  CNS-MSG-E000082         PIC  X(07)  VALUE  "E000082".
  2645*----------  帳票$帳票ID$の利用権限がありません。
  2646 20  CNS-MSG-E000083         PIC  X(07)  VALUE  "E000083".
  2647*----------  パラメーター不正。
  2648 20  CNS-MSG-E000189         PIC  X(07)  VALUE  "E000189".
  2649*----------  $項目名$の取得可能の件数は$件数$件超過した
  2650 20  CNS-MSG-E000445         PIC  X(07)  VALUE  "E000445".
  2651*----------  該当$項目名$が存在しません。
  2652 20  CNS-MSG-W000220         PIC  X(07)  VALUE  "W000220".
  2653*----------  $項目名$行目指定された銘柄に適用する銘柄が存在しません。
  2654 20  CNS-MSG-W000432         PIC  X(07)  VALUE  "W000432".
  2655*----------  $項目名$行目検索不可です。検索条件を修正してください。
  2656 20  CNS-MSG-W000433         PIC  X(07)  VALUE  "W000433".
  2657*----------  重複するデータが既に存在しています。
  2658 20  CNS-MSG-E000093         PIC  X(07)  VALUE  "E000093".
  2659*----------  [$項目名$]は桁数オーバーです。
  2660 20  CNS-MSG-EP00171         PIC  X(07)  VALUE  "EP00171".
  2661*----------  確認が正常終了しました。
  2662 20  CNS-MSG-I000109         PIC  X(07)  VALUE  "I000109".
  2663*----------  登録が正常終了しました。
  2664 20  CNS-MSG-I000013         PIC  X(07)  VALUE  "I000013".
  2665*---------- 帳票$ページ$ページに、枠に入りきれない項目があります。
  2666 20  CNS-MSG-W000328         PIC  X(07)  VALUE  "W000328".
  2667*---------- 帳票$ページ$ページに、端数３桁目以降を切捨表示項目があります
  2668 20  CNS-MSG-W000329         PIC  X(07)  VALUE  "W000329".
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  47
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/USCNS.cpy)py)py)
  2669*---------- 帳票$ページ$ページに、端数２桁目以降を切捨表示項目があります
  2670 20  CNS-MSG-W000330         PIC  X(07)  VALUE  "W000330".
  2671*---------- 帳票$ページ$ページに、端数を切捨表示項目があります。
  2672 20  CNS-MSG-W000331         PIC  X(07)  VALUE  "W000331".
  2673*---------- 帳票$ページ$ページに、符号を表示しない項目があります。
  2674 20  CNS-MSG-W000332         PIC  X(07)  VALUE  "W000332".
  2675*---------- $項目$ライセンスチェックエラーです。
  2676 20  CNS-MSG-E000462         PIC  X(07)  VALUE  "E000462".
  2677*---------- アップロードIDが存在しません。
  2678 20  CNS-MSG-E000459         PIC  X(07)  VALUE  "E000459".
  2679*---------- $項目名$$項目値$の利用権限がありません。
  2680 20  CNS-MSG-E000360         PIC  X(07)  VALUE  "E000360".
  2681*---------- 断面($ファンド$-$ポート$-$日付$)が続行不可である。
  2682 20  CNS-MSG-W000457         PIC  X(07)  VALUE  "W000457".
  2683*---------- 断面($ファンド$-$ポート$-$行数$)が続行不可である。
  2684 20  CNS-MSG-E000458         PIC  X(07)  VALUE  "E000458".
  2685*---------- 指定したデータは既に存在しています。
  2686 20  CNS-MSG-E000088         PIC  X(07)  VALUE  "E000088".
  2687*---------- 指定したデータは既に存在しています。
  2688 20  CNS-MSG-W000483         PIC  X(07)  VALUE  "W000483".
  2689*---------- 該当データが存在しません。
  2690 20  CNS-MSG-W000484         PIC  X(07)  VALUE  "W000484".
  2691*---------- $項目名$データに異常があります。
  2692 20  CNS-MSG-W000509         PIC  X(07)  VALUE  "W000509".
  2693*---------- $項目名$データがありません。
  2694 20  CNS-MSG-W000510         PIC  X(07)  VALUE  "W000510".
  2695*---------- $項目名$の桁数はオーバーしました。
  2696 20  CNS-MSG-E000499         PIC  X(07)  VALUE  "E000499".
  2697*---------- 銘柄コード$銘柄コード$が存在しません。
  2698 20  CNS-MSG-E000062         PIC  X(07)  VALUE  "E000062".
  2699*---------- ポートフォリオ別データ抽出件数超過50000件
  2700 20  CNS-MSG-W000309         PIC  X(07)  VALUE  "W000309".
  2701*---------- $帳票名$の作成対象データが存在しません。
  2702 20  CNS-MSG-W000179         PIC  X(07)  VALUE  "W000179".
  2703*---------- 対象となるデータが存在しません。
  2704 20  CNS-MSG-I000019         PIC  X(07)  VALUE  "I000019".
  2705*---------- 外部から内部銘柄への変換が失敗したが、登録が成功しました。
  2706 20  CNS-MSG-W000421         PIC  X(07)  VALUE  "W000421".
  2707*---------- 銘柄コード$銘柄コード$自社証券種別が取得できません
  2708 20  CNS-MSG-E000530         PIC  X(07)  VALUE  "E000530".
  2709*---------- 外部銘柄$項目名$に適用する銘柄の件数は１件超えました。
  2710 20  CNS-MSG-E000529         PIC  X(07)  VALUE  "E000529".
  2711*---------- 外部から内部銘柄への変換が失敗しました。
  2712 20  CNS-MSG-E000422         PIC  X(07)  VALUE  "E000422".
  2713*---------- 利用権限のないポートフォリオは処理しませんでした。
  2714 20  CNS-MSG-E000534         PIC  X(07)  VALUE  "E000534".
  2715*---------- $ファイルID$の作成対象データが存在しません。
  2716 20  CNS-MSG-W900095         PIC  X(07)  VALUE  "W900095".
  2717*---------- 指定した$項目名$は既存データと不一致
  2718 20  CNS-MSG-W900028         PIC  X(07)  VALUE  "W900028".
  2719*---------- 銘柄属性不整合により、登録できません。
  2720 20  CNS-MSG-E900050         PIC  X(07)  VALUE  "E900050".
  2721*---------- $項目名$$項目値$が存在しません。
  2722 20  CNS-MSG-E000218         PIC  X(07)  VALUE  "E000218".
  2723*----------  重複するデータが既に存在しています。$項目$$項目$$項目$$項目$
  2724 20  CNS-MSG-E000238         PIC  X(07)  VALUE  "E000238".
  2725*----------  アップロードファイルの項目数が不正です。
  2726 20  CNS-MSG-E000556         PIC  X(07)  VALUE  "E000556".
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  48
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/USCNS.cpy)py)py)
  2727*----------  確定期間内の進捗タスク[$ID$]に未処理の基準日があります。
  2728 20  CNS-MSG-W000566         PIC  X(07)  VALUE  "W000566".
  2729*----------  $項目$が処理対象外です。
  2730 20  CNS-MSG-E000564         PIC  X(07)  VALUE  "E000564".
  2731*----------  $CODE$処理を確認してください
  2732 20  CNS-MSG-W000600         PIC  X(07)  VALUE  "W000600".
  2733*----------  期間FROM－TOの期間は1年以内で入力して下さい。
  2734 20  CNS-MSG-E000606         PIC  X(07)  VALUE  "E000606".
  2735*----------  $CODE$に異常がありますので処理対象期間を変更しました。
  2736 20  CNS-MSG-W000607         PIC  X(07)  VALUE  "W000607".
  2737******************************************************************
  2738*----------      置換文字
  2739******************************************************************
  2740*----------  約定受渡区分
  2741 20  CNS-YJ-UW-KBN           PIC  X(12)  VALUE  "約定受渡区分".
  2742*----------  取引期間FROM
  2743 20  CNS-TORI-KJN-FROM       PIC  X(12)  VALUE  "取引期間FROM".
  2744*----------  取引期間TO
  2745 20  CNS-TORI-KJN-TO         PIC  X(10)  VALUE  "取引期間TO".
  2746*----------  赤黒区分
  2747 20  CNS-AKA-KBN             PIC  X(08)  VALUE  "赤黒区分".
  2748*----------  ポートフォリオ
  2749 20  CNS-FUND-PTF            PIC  X(14)  VALUE  "ポートフォリオ".
  2750*----------  ファンド/ポートフォリオグループ
  2751 20  CNS-FUND-CD             PIC  X(31)  VALUE  "ファンド".
  2752*----------  ポートフォリオ
  2753 20  CNS-PTF-CD              PIC  X(14)  VALUE  "ポートフォリオ".
  2754*----------  決算日断面区分
  2755 20  CNS-KESSAN-DANMEN       PIC  X(14)  VALUE  "決算日断面区分".
  2756*----------  評価系列
  2757 20  CNS-HYK-KRTU            PIC  X(08)  VALUE  "評価系列".
  2758*----------  ブローカー
  2759 20  CNS-BRK-CD              PIC  X(10)  VALUE  "ブローカー".
  2760*----------  現地決済通貨
  2761 20  CNS-LCL-KESSAI-TUKA     PIC  X(12)  VALUE  "現地決済通貨".
  2762*----------  現地取引通貨
  2763 20  CNS-LCL-TRHK-TUKA       PIC  X(12)  VALUE  "現地取引通貨".
  2764*----------  通貨コード
  2765 20  CNS-TUKA-CD             PIC  X(10)  VALUE  "通貨コード".
  2766*----------  国コード
  2767 20  CNS-KUNI-CD             PIC  X(08)  VALUE  "国コード".
  2768*----------  取引通貨
  2769 20  CNS-TRHK-TUKA           PIC  X(08)  VALUE  "取引通貨".
  2770*----------  取引内容
  2771 20  CNS-TRHK-NAIYO          PIC  X(08)  VALUE  "取引内容".
  2772*----------  取引事由
  2773 20  CNS-TRHK-JIYU           PIC  X(08)  VALUE  "取引事由".
  2774*----------  発注ブローカ
  2775 20  CNS-UYK-BRK             PIC  X(12)  VALUE  "発注ブローカ".
  2776*----------  現地ブローカ
  2777 20  CNS-LCL-BROKER          PIC  X(12)  VALUE  "現地ブローカ".
  2778*----------  出力先
  2779 20  CNS-OUT-SAKI-FLG        PIC  X(06)  VALUE  "出力先".
  2780*----------  勘定科目
  2781 20  CNS-KNJ-KAMK            PIC  X(08)  VALUE  "勘定科目".
  2782*----------  勘定科目コード
  2783 20  CNS-KNJ-KAMK-CD         PIC  X(14)  VALUE  "勘定科目コード".
  2784*----------  出力項目
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  49
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/USCNS.cpy)py)py)
  2785 20  CNS-OUT-KOMK            PIC  X(08)  VALUE  "出力項目".
  2786*----------  証券種別
  2787 20  CNS-SEC-SBT             PIC  X(08)  VALUE  "証券種別".
  2788*----------  証券種別コード
  2789 20  CNS-SEC-SBT-CD          PIC  X(14)  VALUE  "証券種別コード".
  2790*----------  銘柄通貨
  2791 20  CNS-MEG-TUKA            PIC  X(08)  VALUE  "銘柄通貨".
  2792*----------  発行国
  2793 20  CNS-HAKO                PIC  X(06)  VALUE  "発行国".
  2794*----------  発行国除外区分
  2795 20  CNS-HAKO-KBN            PIC  X(14)  VALUE  "発行国除外区分".
  2796*----------  投資対象国
  2797 20  CNS-TOUSI-TARGET-KUNI   PIC  X(10)  VALUE  "投資対象国".
  2798*----------  銘柄
  2799 20  CNS-GAIBU-MEG           PIC  X(04)  VALUE  "銘柄".
  2800*----------  銘柄項目
  2801 20  CNS-MEG-KOMOKU          PIC  X(08)  VALUE  "銘柄項目".
  2802*----------  銘柄除外区分
  2803 20  CNS-GAIBU-MEG-KBN       PIC  X(12)  VALUE  "銘柄除外区分".
  2804*----------  株式種別
  2805 20  CNS-KABU-SBT            PIC  X(08)  VALUE  "株式種別".
  2806*----------  回
  2807 20  CNS-KAYI                PIC  X(02)  VALUE  "回".
  2808*----------  号
  2809 20  CNS-GOU                 PIC  X(02)  VALUE  "号".
  2810*----------  限月
  2811 20  CNS-GENGETSU            PIC  X(04)  VALUE  "限月".
  2812*----------  満期日
  2813 20  CNS-MNK-YMD             PIC  X(06)  VALUE  "満期日".
  2814*----------  ALL
  2815 20  CNS-X-ALL               PIC  X(03)  VALUE  "ALL".
  2816*----------  帳票作成単位
  2817 20  CNS-TYOUHYOU-TANI       PIC  X(12)  VALUE  "帳票作成単位".
  2818*----------  電子帳票形式
  2819 20  CNS-TYOUHYOU-FMT        PIC  X(12)  VALUE  "電子帳票形式".
  2820*----------  紙出力区分
  2821 20  CNS-OUT-KBN             PIC  X(10)  VALUE  "紙出力区分".
  2822*----------  出力先プリンタ
  2823 20  CNS-OUT-SAKI            PIC  X(14)  VALUE  "出力先プリンタ".
  2824*----------  言語
  2825 20  CNS-GENGO               PIC  X(04)  VALUE  "言語".
  2826*----------  残高
  2827 20  CNS-OUT-ZT              PIC  X(04)  VALUE  "残高".
  2828*----------  取引
  2829 20  CNS-OUT-TH              PIC  X(04)  VALUE  "取引".
  2830*----------  内部銘柄コード
  2831 20  CNS-NB-MEG-CD           PIC  X(14)  VALUE  "内部銘柄コード".
  2832*----------  会社コード
  2833 20  CNS-CMP-CD              PIC  X(10)  VALUE  "会社コード".
  2834*----------  残高期間FROM
  2835 20  CNS-ZAN-KJN-FROM        PIC  X(12)  VALUE  "残高期間FROM".
  2836*----------  残高期間TO
  2837 20  CNS-ZAN-KJN-TO          PIC  X(10)  VALUE  "残高期間TO".
  2838*----------  評価
  2839 20  CNS-OUT-HYK             PIC  X(04)  VALUE  "評価".
  2840*----------  銘柄属性
  2841 20  CNS-MEG-ZOKUSEI         PIC  X(08)  VALUE  "銘柄属性".
  2842*----------  約定受渡区分
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  50
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/USCNS.cpy)py)py)
  2843 20  CNS-YAKU-UKE-KBN        PIC  X(12)  VALUE  "約定受渡区分".
  2844*----------  コードリファレンス系列
  2845 20  CNS-REF-KRTU-CD         PIC  X(22)
  2846                             VALUE  "コードリファレンス系列".
  2847*----------  外部銘柄コード
  2848 20  CNS-GAIBU-MEG-CD        PIC  X(14)
  2849                             VALUE  "外部銘柄コード".
  2850*----------  銘柄リファレンス系列
  2851 20  CNS-CD-REF-KRTU         PIC  X(20)
  2852                             VALUE  "銘柄リファレンス系列".
  2853*----------  ポートフォリオグループ
  2854 20  CNS-PTF-GRP             PIC  X(22)
  2855                             VALUE  "ポートフォリオグループ".
  2856*----------  ポートフォリオ処理区分
  2857 20  CNS-PTF-SYORI-KBN       PIC  X(22)
  2858                             VALUE  "ポートフォリオ処理区分".
  2859*----------  ポートフォリオ区分
  2860 20  CNS-FUND-PTF-KBN        PIC  X(18)
  2861                             VALUE  "ポートフォリオ区分".
  2862*----------  評価系列処理区分
  2863 20  CNS-HYK-KRTU-KBN        PIC  X(16)
  2864                             VALUE  "評価系列処理区分".
  2865*----------  ブローカー処理区分
  2866 20  CNS-BRK-CD-KBN          PIC  X(18)
  2867                             VALUE  "ブローカー処理区分".
  2868*----------  取引通貨
  2869 20  CNS-KWS-TH-TUKA         PIC  X(16)
  2870                             VALUE  "為替取引決済通貨".
  2871*----------  カストディコード
  2872 20  CNS-CAST-CD             PIC  X(16)
  2873                             VALUE  "カストディコード".
  2874*----------  カウンターパーティ
  2875 20  CNS-COUNTER-BIR         PIC  X(18)
  2876                             VALUE  "カウンターパーティ".
  2877*----------  証券種別除外区分
  2878 20  CNS-SEC-SBT-KBN         PIC  X(16)
  2879                             VALUE  "証券種別除外区分".
  2880*----------  取引事由処理区分
  2881 20  CNS-TRHK-JIYU-KBN       PIC  X(16)
  2882                             VALUE  "取引事由処理区分".
  2883*----------  銘柄通貨除外区分
  2884 20  CNS-MEG-TUKA-KBN        PIC  X(16)
  2885                             VALUE  "銘柄通貨除外区分".
  2886*----------  投資対象国除外区分
  2887 20  CNS-TOUSI-TARGET-KUNI-KBN
  2888                             PIC  X(18)
  2889                             VALUE  "投資対象国除外区分".
  2890*----------  ストライクプライス
  2891 20  CNS-STRIKEPRICE         PIC  X(18)
  2892                             VALUE  "ストライクプライス".
  2893*----------  内部ポートフォリオコード
  2894 20  CNS-NB-PTF-CD           PIC  X(24)
  2895                             VALUE  "内部ポートフォリオコード".
  2896*----------  外部ポートフォリオコード
  2897 20  CNS-GB-PTF-CD           PIC  X(24)
  2898                             VALUE  "外部ポートフォリオコード".
  2899*----------  証券種別、取引種類
  2900 20  CNS-SEC-TRHK            PIC  X(18)
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  51
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/USCNS.cpy)py)py)
  2901                             VALUE  "証券種別、取引種類".
  2902*----------  ポートフォリオデータ
  2903 20  CNS-PTF-DATA            PIC  X(20)
  2904                             VALUE  "ポートフォリオデータ".
  2905*----------  ポートフォリオコード
  2906 20  CNS-PORTFOLIO-CD        PIC  X(20)
  2907                             VALUE  "ポートフォリオコード".
  2908*----------  デフォルト評価系列
  2909 20  CNS-HYOKA-KRTU          PIC  X(18)
  2910                             VALUE  "デフォルト評価系列".
  2911*----------  勘定科目コード下２桁
  2912 20  CNS-KNJ-KAMK-2          PIC  X(20)
  2913                             VALUE  "勘定科目コード下２桁".
  2914*----------  証券種別_外部コード
  2915 20  CNS-SEC-SBT-GAIBU-CD    PIC  X(19)
  2916                             VALUE  "証券種別_外部コード".
  2917*----------  ファンドコード,ポートフォリオコード,計上基準日,
  2918*----------  銘柄コード,取引サブ番号,赤黒区分
  2919 20  CNS-SIX-KEY.
  2920   25  FILLER                PIC  X(47)
  2921       VALUE  "ファンドコード,ポートフォリオコード,計上基準日,".
  2922   25  FILLER                PIC  X(32)
  2923       VALUE  "銘柄コード,取引サブ番号,赤黒区分".
  2924*----------  コードリファレンス系列コード
  2925 20  CNS-CD-REF-KRTU-CD      PIC  X(28)
  2926     VALUE  "コードリファレンス系列コード".
  2927*----------  コードリファレンス系列コード
  2928 20  CNS-SHORI-KENRI-DATA    PIC  X(30)
  2929     VALUE  "処理対象実行状況管理明細データ".
  2930*----------  個別玉管理番号
  2931 20  CNS-KB-KANRI-NO         PIC  X(14)
  2932                             VALUE  "個別玉管理番号".
  2933*----------  進捗管理データ
  2934 20  CNS-SINTYOKU-DATA       PIC  X(14)
  2935                             VALUE  "進捗管理データ".
  2936*----------  集計用証券種別
  2937 20  CNS-SYUKEI-SEC-SBT        PIC  X(14)
  2938                             VALUE  "集計用証券種別".
  2939******************************************************************
  2940*----------      SPP/バッチ処理区分
  2941******************************************************************
  2942*----------  SPP/バッチ処理区分S
  2943 20  CNS-KIDOU-KBN-S         PIC  X(01)  VALUE  "S".
  2944*----------  SPP/バッチ処理区分B
  2945 20  CNS-KIDOU-KBN-B         PIC  X(01)  VALUE  "B".
  2946******************************************************************
  2947*----------      コード区分
  2948******************************************************************
  2949*----------  取引の種類
  2950 20  CNS-CD-KBN-01           PIC  X(02)  VALUE  "01".
  2951*----------  発行体
  2952 20  CNS-CD-KBN-02           PIC  X(02)  VALUE  "02".
  2953*----------  銘柄分類軸
  2954 20  CNS-CD-KBN-03           PIC  X(02)  VALUE  "03".
  2955*----------  ファンドマネージャ
  2956 20  CNS-CD-KBN-04           PIC  X(02)  VALUE  "04".
  2957*----------  市場コード
  2958 20  CNS-CD-KBN-05           PIC  X(02)  VALUE  "05".
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  52
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/USCNS.cpy)py)py)
  2959*----------  時価系列コード
  2960 20  CNS-CD-KBN-06           PIC  X(02)  VALUE  "06".
  2961*----------  為替系列コード
  2962 20  CNS-CD-KBN-07           PIC  X(02)  VALUE  "07".
  2963*----------  権利配当情報系列コード
  2964 20  CNS-CD-KBN-08           PIC  X(02)  VALUE  "08".
  2965*----------  処理グループ
  2966 20  CNS-CD-KBN-09           PIC  X(02)  VALUE  "09".
  2967*----------  料率バターン
  2968 20  CNS-CD-KBN-10           PIC  X(02)  VALUE  "10".
  2969*----------  異動計算パターンコード
  2970 20  CNS-CD-KBN-12           PIC  X(02)  VALUE  "12".
  2971*----------  評価時価取得方法コード
  2972 20  CNS-CD-KBN-13           PIC  X(02)  VALUE  "13".
  2973*----------  評価為替取得方法コード
  2974 20  CNS-CD-KBN-14           PIC  X(02)  VALUE  "14".
  2975*----------  評価計算パターンコード
  2976 20  CNS-CD-KBN-15           PIC  X(02)  VALUE  "15".
  2977******************************************************************
  2978*----------      帳票出力区分
  2979******************************************************************
  2980*----------  株式
  2981 20  CNS-REP-KBN-1           PIC  X(01)  VALUE  "1".
  2982*----------  債券
  2983 20  CNS-REP-KBN-2           PIC  X(01)  VALUE  "2".
  2984*----------  投資信託
  2985 20  CNS-REP-KBN-3           PIC  X(01)  VALUE  "3".
  2986*----------  為替予約
  2987 20  CNS-REP-KBN-4           PIC  X(01)  VALUE  "4".
  2988*----------  先物
  2989 20  CNS-REP-KBN-5           PIC  X(01)  VALUE  "5".
  2990*----------  オプション
  2991 20  CNS-REP-KBN-6           PIC  X(01)  VALUE  "6".
  2992*----------  その他
  2993 20  CNS-REP-KBN-7           PIC  X(01)  VALUE  "7".
  2994*----------  その他先物・オプション
  2995 20  CNS-REP-KBN-8           PIC  X(01)  VALUE  "8".
  2996******************************************************************
  2997*----------      進捗タスクID
  2998******************************************************************
  2999*----------  取引入力
  3000 20  CNS-ST00400             PIC  X(07)  VALUE  "ST00400".
  3001*----------  残高・損益データ更新
  3002 20  CNS-ST00500             PIC  X(07)  VALUE  "ST00500".
  3003*----------  評価データ更新
  3004 20  CNS-ST00600             PIC  X(07)  VALUE  "ST00600".
  3005*----------  運用成果取引データ更新
  3006 20  CNS-ST00700             PIC  X(07)  VALUE  "ST00700".
  3007*----------  運用成果残高データ更新
  3008 20  CNS-ST00800             PIC  X(07)  VALUE  "ST00800".
  3009*----------  運用成果集計データ更新
  3010 20  CNS-ST00900             PIC  X(07)  VALUE  "ST00900".
  3011******************************************************************
  3012*----------      商品分類
  3013******************************************************************
  3014*----------  債券
  3015 20  CNS-SYOHIN-BUNRUI-B     PIC  X(04)  VALUE  "B   ".
  3016*----------  現金
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  53
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/USCNS.cpy)py)py)
  3017 20  CNS-SYOHIN-BUNRUI-CASH  PIC  X(04)  VALUE  "CASH".
  3018*----------  転換社債
  3019 20  CNS-SYOHIN-BUNRUI-CB    PIC  X(04)  VALUE  "CB  ".
  3020*----------  見合い(負債)
  3021 20  CNS-SYOHIN-BUNRUI-DL    PIC  X(04)  VALUE  "DL  ".
  3022*----------  為替予約
  3023 20  CNS-SYOHIN-BUNRUI-FE    PIC  X(04)  VALUE  "FE  ".
  3024*----------  先物コールオプション
  3025 20  CNS-SYOHIN-BUNRUI-FO    PIC  X(04)  VALUE  "FO  ".
  3026*----------  先物
  3027 20  CNS-SYOHIN-BUNRUI-FT    PIC  X(04)  VALUE  "FT  ".
  3028*----------  投信
  3029 20  CNS-SYOHIN-BUNRUI-IT    PIC  X(04)  VALUE  "IT  ".
  3030*----------  証拠金
  3031 20  CNS-SYOHIN-BUNRUI-MAR   PIC  X(04)  VALUE  "MAR ".
  3032*----------  オプション
  3033 20  CNS-SYOHIN-BUNRUI-OP    PIC  X(04)  VALUE  "OP  ".
  3034*----------  その他商品
  3035 20  CNS-SYOHIN-BUNRUI-OTHR  PIC  X(04)  VALUE  "OTHR".
  3036*----------  元本
  3037 20  CNS-SYOHIN-BUNRUI-PRI   PIC  X(04)  VALUE  "PRI ".
  3038*----------  不動産
  3039 20  CNS-SYOHIN-BUNRUI-R     PIC  X(04)  VALUE  "R   ".
  3040*----------  株式
  3041 20  CNS-SYOHIN-BUNRUI-S     PIC  X(04)  VALUE  "S   ".
  3042*----------  貸付有価証券担保金(負債)
  3043 20  CNS-SYOHIN-BUNRUI-SD    PIC  X(04)  VALUE  "SD  ".
  3044*----------  預金
  3045 20  CNS-SYOHIN-BUNRUI-SH    PIC  X(04)  VALUE  "SH  ".
  3046*----------  取引
  3047 20  CNS-SYOHIN-BUNRUI-SL    PIC  X(04)  VALUE  "SL  ".
  3048*----------  新株引受権付
  3049 20  CNS-SYOHIN-BUNRUI-WB    PIC  X(04)  VALUE  "WB  ".
  3050******************************************************************
  3051*----------      資産負債・買建売建フラグ
  3052******************************************************************
  3053*----------  L
  3054 20  CNS-TATE-FLG-L          PIC  X(01)  VALUE  "L".
  3055*----------  S
  3056 20  CNS-TATE-FLG-S          PIC  X(01)  VALUE  "S".
  3057******************************************************************
  3058*----------      取引種類名称
  3059******************************************************************
  3060*----------  買い
  3061 20  CNS-TRHK-SHRU-MEI-1     PIC  X(04)  VALUE  "買い".
  3062*----------  BUY
  3063 20  CNS-TRHK-SHRU-MEI-1-E   PIC  X(03)  VALUE  "Buy".
  3064*----------  売り
  3065 20  CNS-TRHK-SHRU-MEI-2     PIC  X(04)  VALUE  "売り".
  3066*----------  SELL
  3067 20  CNS-TRHK-SHRU-MEI-2-E   PIC  X(04)  VALUE  "Sell".
  3068*----------  買決
  3069 20  CNS-TRHK-SHRU-MEI-3     PIC  X(04)  VALUE  "買決".
  3070*----------  BUY SETTLE.
  3071 20  CNS-TRHK-SHRU-MEI-3-E   PIC  X(11)  VALUE  "Buy Settle.".
  3072*----------  売決
  3073 20  CNS-TRHK-SHRU-MEI-4     PIC  X(04)  VALUE  "売決".
  3074*----------  SELL SETTLE.
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  54
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/USCNS.cpy)py)py)
  3075 20  CNS-TRHK-SHRU-MEI-4-E   PIC  X(12)  VALUE  "Sell Settle.".
  3076*----------  行使
  3077 20  CNS-TRHK-SHRU-MEI-5     PIC  X(04)  VALUE  "行使".
  3078*----------  EXERCISE
  3079 20  CNS-TRHK-SHRU-MEI-5-E   PIC  X(08)  VALUE  "Exercise".
  3080*----------  割当
  3081 20  CNS-TRHK-SHRU-MEI-6     PIC  X(04)  VALUE  "割当".
  3082*----------  ASSIGNMENT
  3083 20  CNS-TRHK-SHRU-MEI-6-E   PIC  X(10)  VALUE  "Assignment".
  3084*----------  売建
  3085 20  CNS-TRHK-SHRU-MEI-7     PIC  X(04)  VALUE  "売建".
  3086*----------  ?
  3087 20  CNS-TRHK-SHRU-MEI-7-E   PIC  X(09)  VALUE  "Sell Open".
  3088*----------  買戻
  3089 20  CNS-TRHK-SHRU-MEI-8     PIC  X(04)  VALUE  "買戻".
  3090*----------  BUY BK
  3091 20  CNS-TRHK-SHRU-MEI-8-E   PIC  X(06)  VALUE  "Buy BK".
  3092*----------  買建
  3093 20  CNS-TRHK-SHRU-MEI-9     PIC  X(04)  VALUE  "買建".
  3094*----------  ?
  3095 20  CNS-TRHK-SHRU-MEI-9-E   PIC  X(08)  VALUE  "Buy Open".
  3096*----------  転売
  3097 20  CNS-TRHK-SHRU-MEI-10    PIC  X(04)  VALUE  "転売".
  3098*----------  SELLBK
  3099 20  CNS-TRHK-SHRU-MEI-10-E  PIC  X(07)  VALUE  "Sell BK".
  3100******************************************************************
  3101*----------      取引種類コード
  3102******************************************************************
  3103*----------  1
  3104 20  CNS-TRHK-SHRU-CD-1      PIC  X(02)  VALUE  "01".
  3105*----------  2
  3106 20  CNS-TRHK-SHRU-CD-2      PIC  X(02)  VALUE  "02".
  3107*----------  3
  3108 20  CNS-TRHK-SHRU-CD-3      PIC  X(02)  VALUE  "03".
  3109*----------  4
  3110 20  CNS-TRHK-SHRU-CD-4      PIC  X(02)  VALUE  "04".
  3111*----------  5
  3112 20  CNS-TRHK-SHRU-CD-5      PIC  X(02)  VALUE  "05".
  3113*----------  6
  3114 20  CNS-TRHK-SHRU-CD-6      PIC  X(02)  VALUE  "06".
  3115*----------  7
  3116 20  CNS-TRHK-SHRU-CD-7      PIC  X(02)  VALUE  "07".
  3117*----------  8
  3118 20  CNS-TRHK-SHRU-CD-8      PIC  X(02)  VALUE  "08".
  3119*----------  9
  3120 20  CNS-TRHK-SHRU-CD-9      PIC  X(02)  VALUE  "09".
  3121*----------  10
  3122 20  CNS-TRHK-SHRU-CD-10     PIC  X(02)  VALUE  "10".
  3123******************************************************************
  3124*----------      OTHER
  3125******************************************************************
  3126*---------- 仕訳計算パターン
  3127 20  CNS-FLG-T               PIC  X(01)  VALUE  "T".
  3128*----------  フェッチ
  3129 20  CNS-FETCH               PIC  X(05)  VALUE  "FETCH".
  3130*----------  READ
  3131 20  CNS-READ                PIC  X(04)  VALUE  "READ".
  3132*----------  INSERT
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  55
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/USCNS.cpy)py)py)
  3133 20  CNS-INSERT              PIC  X(06)  VALUE  "INSERT".
  3134*----------  UPDATE
  3135 20  CNS-UPDATE              PIC  X(06)  VALUE  "UPDATE".
  3136*----------  DELETE
  3137 20  CNS-DELETE              PIC  X(06)  VALUE  "DELETE".
  3138*----------
  3139 20  CNS-WRITE               PIC  X(05)  VALUE  "WRITE".
  3140*----------  約定ベース
  3141 20  CNS-YAKU-BASE           PIC  X(10)  VALUE  "約定ベース".
  3142*----------  Trade Date
  3143 20  CNS-TRADE-DATE          PIC  X(10)  VALUE  "Trade Date".
  3144*----------  受渡ベース
  3145 20  CNS-UKE-BASE            PIC  X(10)  VALUE  "受渡ベース".
  3146*----------  Settlement Date
  3147 20  CNS-SETTLEMENT-DATE     PIC  X(15)  VALUE  "Settlement Date".
  3148******************************************************************
  3149*----------      勘定科目コード上３桁(運用成果)
  3150******************************************************************
  3151*----------  資産残高
  3152 20  CNS-KNJ-KAMK-CD-110     PIC  X(03)  VALUE  "110".
  3153*----------  資産残高(決算計上見合分(未収収益))
  3154 20  CNS-KNJ-KAMK-CD-111     PIC  X(03)  VALUE  "111".
  3155*----------  資産残高(決算計上見合分(オフバラ))
  3156 20  CNS-KNJ-KAMK-CD-112     PIC  X(03)  VALUE  "112".
  3157*----------  前払金
  3158 20  CNS-KNJ-KAMK-CD-120     PIC  X(03)  VALUE  "120".
  3159*----------  仮払金
  3160 20  CNS-KNJ-KAMK-CD-130     PIC  X(03)  VALUE  "130".
  3161*----------  仮受金
  3162 20  CNS-KNJ-KAMK-CD-210     PIC  X(03)  VALUE  "210".
  3163*----------  負債残高
  3164 20  CNS-KNJ-KAMK-CD-220     PIC  X(03)  VALUE  "220".
  3165*----------  未払費用
  3166 20  CNS-KNJ-KAMK-CD-230     PIC  X(03)  VALUE  "230".
  3167*----------  合計
  3168 20  CNS-KNJ-KAMK-CD-300     PIC  X(03)  VALUE  "300".
  3169*----------  売買損
  3170 20  CNS-KNJ-KAMK-CD-401     PIC  X(03)  VALUE  "401".
  3171*----------  償還損
  3172 20  CNS-KNJ-KAMK-CD-402     PIC  X(03)  VALUE  "402".
  3173*----------  償却損
  3174 20  CNS-KNJ-KAMK-CD-403     PIC  X(03)  VALUE  "403".
  3175*----------  為替差損
  3176 20  CNS-KNJ-KAMK-CD-404     PIC  X(03)  VALUE  "404".
  3177*----------  投資顧問料
  3178 20  CNS-KNJ-KAMK-CD-411     PIC  X(03)  VALUE  "411".
  3179*----------  信託報酬
  3180 20  CNS-KNJ-KAMK-CD-412     PIC  X(03)  VALUE  "412".
  3181*----------  カストディフィ
  3182 20  CNS-KNJ-KAMK-CD-421     PIC  X(03)  VALUE  "421".
  3183*----------  カストディフィ(外株)
  3184 20  CNS-KNJ-KAMK-CD-422     PIC  X(03)  VALUE  "422".
  3185*----------  カストディフィ(外債)
  3186 20  CNS-KNJ-KAMK-CD-423     PIC  X(03)  VALUE  "423".
  3187*----------  手数料
  3188 20  CNS-KNJ-KAMK-CD-431     PIC  X(03)  VALUE  "431".
  3189*----------  消費税
  3190 20  CNS-KNJ-KAMK-CD-441     PIC  X(03)  VALUE  "441".
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  56
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/USCNS.cpy)py)py)
  3191*----------  特別法人税
  3192 20  CNS-KNJ-KAMK-CD-443     PIC  X(03)  VALUE  "443".
  3193*----------  源泉徴収税
  3194 20  CNS-KNJ-KAMK-CD-446     PIC  X(03)  VALUE  "446".
  3195*----------  信託利益調整損
  3196 20  CNS-KNJ-KAMK-CD-461     PIC  X(03)  VALUE  "461".
  3197*----------  その他費用（運用外）
  3198 20  CNS-KNJ-KAMK-CD-498     PIC  X(03)  VALUE  "498".
  3199*----------  その他費用
  3200 20  CNS-KNJ-KAMK-CD-499     PIC  X(03)  VALUE  "499".
  3201*----------  売買益
  3202 20  CNS-KNJ-KAMK-CD-501     PIC  X(03)  VALUE  "501".
  3203*----------  償還益
  3204 20  CNS-KNJ-KAMK-CD-502     PIC  X(03)  VALUE  "502".
  3205*----------  為替差益
  3206 20  CNS-KNJ-KAMK-CD-504     PIC  X(03)  VALUE  "504".
  3207*----------  株式配当金
  3208 20  CNS-KNJ-KAMK-CD-511     PIC  X(03)  VALUE  "511".
  3209*----------  公社債利息
  3210 20  CNS-KNJ-KAMK-CD-512     PIC  X(03)  VALUE  "512".
  3211*----------  CB利息
  3212 20  CNS-KNJ-KAMK-CD-513     PIC  X(03)  VALUE  "513".
  3213*----------  CALL利息
  3214 20  CNS-KNJ-KAMK-CD-514     PIC  X(03)  VALUE  "514".
  3215*----------  手形利息
  3216 20  CNS-KNJ-KAMK-CD-515     PIC  X(03)  VALUE  "515".
  3217*----------  大口預金利息
  3218 20  CNS-KNJ-KAMK-CD-516     PIC  X(03)  VALUE  "516".
  3219*----------  預金利息
  3220 20  CNS-KNJ-KAMK-CD-517     PIC  X(03)  VALUE  "517".
  3221*----------  外貨預金利息
  3222 20  CNS-KNJ-KAMK-CD-518     PIC  X(03)  VALUE  "518".
  3223*----------  現先利息
  3224 20  CNS-KNJ-KAMK-CD-519     PIC  X(03)  VALUE  "519".
  3225*----------  貸付信託利息
  3226 20  CNS-KNJ-KAMK-CD-521     PIC  X(03)  VALUE  "521".
  3227*----------  譲渡性預金利息
  3228 20  CNS-KNJ-KAMK-CD-522     PIC  X(03)  VALUE  "522".
  3229*----------  ワラント利息
  3230 20  CNS-KNJ-KAMK-CD-523     PIC  X(03)  VALUE  "523".
  3231*----------  証拠金利息
  3232 20  CNS-KNJ-KAMK-CD-524     PIC  X(03)  VALUE  "524".
  3233*----------  その他利息
  3234 20  CNS-KNJ-KAMK-CD-525     PIC  X(03)  VALUE  "525".
  3235*----------  源泉税還付金(外株配当)
  3236 20  CNS-KNJ-KAMK-CD-543     PIC  X(03)  VALUE  "543".
  3237*----------  源泉税還付金(外債利金)
  3238 20  CNS-KNJ-KAMK-CD-544     PIC  X(03)  VALUE  "544".
  3239*----------  源泉税還付金(その他)
  3240 20  CNS-KNJ-KAMK-CD-545     PIC  X(03)  VALUE  "545".
  3241*----------  信託利益調整益
  3242 20  CNS-KNJ-KAMK-CD-561     PIC  X(03)  VALUE  "561".
  3243*----------  その他収益（運用外）
  3244 20  CNS-KNJ-KAMK-CD-598     PIC  X(03)  VALUE  "598".
  3245*----------  その他収益
  3246 20  CNS-KNJ-KAMK-CD-599     PIC  X(03)  VALUE  "599".
  3247*----------  還付金残高評価額
  3248 20  CNS-KNJ-KAMK-CD-911     PIC  X(03)  VALUE  "911".
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  57
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/USCNS.cpy)py)py)
  3249*----------  運用通貨未収金評価額
  3250 20  CNS-KNJ-KAMK-CD-912     PIC  X(03)  VALUE  "912".
  3251*----------  外貨未収金評価額
  3252 20  CNS-KNJ-KAMK-CD-913     PIC  X(03)  VALUE  "913".
  3253*----------  運用通貨未払金評価額
  3254 20  CNS-KNJ-KAMK-CD-914     PIC  X(03)  VALUE  "914".
  3255*----------  外貨未払金評価額
  3256 20  CNS-KNJ-KAMK-CD-916     PIC  X(03)  VALUE  "916".
  3257*----------  前払金評価額
  3258 20  CNS-KNJ-KAMK-CD-917     PIC  X(03)  VALUE  "917".
  3259*----------  評価金額
  3260 20  CNS-KNJ-KAMK-CD-918     PIC  X(03)  VALUE  "918".
  3261*----------  還付金残高評価益
  3262 20  CNS-KNJ-KAMK-CD-921     PIC  X(03)  VALUE  "921".
  3263*----------  運用通貨未収金評価益
  3264 20  CNS-KNJ-KAMK-CD-922     PIC  X(03)  VALUE  "922".
  3265*----------  外貨未収金評価益
  3266 20  CNS-KNJ-KAMK-CD-923     PIC  X(03)  VALUE  "923".
  3267*----------  運用通貨未払金評価益
  3268 20  CNS-KNJ-KAMK-CD-924     PIC  X(03)  VALUE  "924".
  3269*----------  外貨未払金評価益
  3270 20  CNS-KNJ-KAMK-CD-926     PIC  X(03)  VALUE  "926".
  3271*----------  前払金評価益
  3272 20  CNS-KNJ-KAMK-CD-927     PIC  X(03)  VALUE  "927".
  3273*----------  評価益
  3274 20  CNS-KNJ-KAMK-CD-928     PIC  X(03)  VALUE  "928".
  3275*----------  還付金残高評価損
  3276 20  CNS-KNJ-KAMK-CD-931     PIC  X(03)  VALUE  "931".
  3277*----------  運用通貨未収金評価損
  3278 20  CNS-KNJ-KAMK-CD-932     PIC  X(03)  VALUE  "932".
  3279*----------  外貨未収金評価損
  3280 20  CNS-KNJ-KAMK-CD-933     PIC  X(03)  VALUE  "933".
  3281*----------  運用通貨未払金評価損
  3282 20  CNS-KNJ-KAMK-CD-934     PIC  X(03)  VALUE  "934".
  3283*----------  前払金評価損
  3284 20  CNS-KNJ-KAMK-CD-937     PIC  X(03)  VALUE  "937".
  3285*----------  評価損
  3286 20  CNS-KNJ-KAMK-CD-938     PIC  X(03)  VALUE  "938".
  3287*----------  外貨未払金評価損
  3288 20  CNS-KNJ-KAMK-CD-939     PIC  X(03)  VALUE  "939".
  3289*----------  未収利息
  3290 20  CNS-KNJ-KAMK-CD-940     PIC  X(03)  VALUE  "940".
  3291*----------  運用通貨未収金
  3292 20  CNS-KNJ-KAMK-CD-951     PIC  X(03)  VALUE  "951".
  3293*----------  外貨未収金
  3294 20  CNS-KNJ-KAMK-CD-952     PIC  X(03)  VALUE  "952".
  3295*----------  運用通貨未払金
  3296 20  CNS-KNJ-KAMK-CD-961     PIC  X(03)  VALUE  "961".
  3297*----------  外貨未払金
  3298 20  CNS-KNJ-KAMK-CD-962     PIC  X(03)  VALUE  "962".
  3299*----------  未払費用（簿外）
  3300 20  CNS-KNJ-KAMK-CD-971     PIC  X(03)  VALUE  "971".
  3301*----------  未払投資顧問料（簿外）
  3302 20  CNS-KNJ-KAMK-CD-972     PIC  X(03)  VALUE  "972".
  3303*----------  未払信託報酬（簿外）
  3304 20  CNS-KNJ-KAMK-CD-973     PIC  X(03)  VALUE  "973".
  3305*----------  建玉金額残
  3306 20  CNS-KNJ-KAMK-CD-982     PIC  X(03)  VALUE  "982".
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  58
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/USCNS.cpy)py)py)
  3307*----------  経過利息
  3308 20  CNS-KNJ-KAMK-CD-983     PIC  X(03)  VALUE  "983".
  3309*----------  想定元本邦貨換算
  3310 20  CNS-KNJ-KAMK-CD-984     PIC  X(03)  VALUE  "984".
  3311*----------  信託報酬にかかる消費税
  3312 20  CNS-KNJ-KAMK-CD-991     PIC  X(03)  VALUE  "991".
  3313*----------  投資顧問料にかかる消費税
  3314 20  CNS-KNJ-KAMK-CD-992     PIC  X(03)  VALUE  "992".
  3315*----------  カストディー・フィー(外株)にかかる消費税
  3316 20  CNS-KNJ-KAMK-CD-993     PIC  X(03)  VALUE  "993".
  3317*----------  カストディー・フィー(外債)にかかる消費税
  3318 20  CNS-KNJ-KAMK-CD-994     PIC  X(03)  VALUE  "994".
  3319*----------  カストディー・フィー(外国証券)にかかる消費税
  3320 20  CNS-KNJ-KAMK-CD-995     PIC  X(03)  VALUE  "995".
  3321*----------  信託利益調整残
  3322 20  CNS-KNJ-KAMK-CD-996     PIC  X(03)  VALUE  "996".
  3323******************************************************************
  3324*----------      証券種別
  3325******************************************************************
  3326*----------  株式
  3327 20  CNS-SEC-SBT-A           PIC  X(05)  VALUE  "SKSS1".
  3328*----------  公社債
  3329 20  CNS-SEC-SBT-B           PIC  X(05)  VALUE  "SKSS2".
  3330*----------  短期資産
  3331 20  CNS-SEC-SBT-C           PIC  X(05)  VALUE  "SKSS3".
  3332*----------  CASH
  3333 20  CNS-SEC-SBT-D           PIC  X(05)  VALUE  "SKSS4".
  3334*----------  先物（全種類）
  3335 20  CNS-SEC-SBT-E           PIC  X(05)  VALUE  "SKSS5".
  3336*----------  為替予約（全種類）
  3337 20  CNS-SEC-SBT-F           PIC  X(05)  VALUE  "SKSS6".
  3338******************************************************************
  3339*----------      分類コード
  3340******************************************************************
  3341*----------  国内
  3342 20  CNS-BUNRUI-CD-1         PIC  X(05)  VALUE  "BUNR1".
  3343*----------  アメリカ
  3344 20  CNS-BUNRUI-CD-2         PIC  X(05)  VALUE  "BUNR2".
  3345*----------  英国
  3346 20  CNS-BUNRUI-CD-3         PIC  X(05)  VALUE  "BUNR3".
  3347*----------  欧州
  3348 20  CNS-BUNRUI-CD-4         PIC  X(05)  VALUE  "BUNR4".
  3349*----------  海外
  3350 20  CNS-BUNRUI-CD-5         PIC  X(05)  VALUE  "BUNR5".
  3351*----------  その他
  3352 20  CNS-BUNRUI-CD-6         PIC  X(05)  VALUE  "BUNR6".
  3353*----------  債券（オフバランス含む）
  3354 20  CNS-BUNRUI-CD-7         PIC  X(05)  VALUE  "BUN07".
  3355*----------  債券オフバランス
  3356 20  CNS-BUNRUI-CD-8         PIC  X(05)  VALUE  "BUN08".
  3357*----------  新株予約権付社債（オフバランス含む）
  3358 20  CNS-BUNRUI-CD-9         PIC  X(05)  VALUE  "BUN09".
  3359*----------  新株予約権付社債オフバランス
  3360 20  CNS-BUNRUI-CD-10        PIC  X(05)  VALUE  "BUN10".
  3361*----------  株式（オフバランス含む）
  3362 20  CNS-BUNRUI-CD-11        PIC  X(05)  VALUE  "BUN11".
  3363*----------  株式オフバランス
  3364 20  CNS-BUNRUI-CD-12        PIC  X(05)  VALUE  "BUN12".
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  59
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/USCNS.cpy)py)py)
  3365*----------  短期商品（オフバランス含む）
  3366 20  CNS-BUNRUI-CD-13        PIC  X(05)  VALUE  "BUN13".
  3367*----------  短期商品オフバランス
  3368 20  CNS-BUNRUI-CD-14        PIC  X(05)  VALUE  "BUN14".
  3369*----------  最下位層分類コード1
  3370 20  CNS-BUNRUI-CD-15        PIC  X(05)  VALUE  "BUN15".
  3371*----------  最下位層分類コード2
  3372 20  CNS-BUNRUI-CD-16        PIC  X(05)  VALUE  "BUN16".
  3373*----------  最下位層分類コード3
  3374 20  CNS-BUNRUI-CD-17        PIC  X(05)  VALUE  "BUN17".
  3375*----------  元本（PRI）
  3376 20  CNS-BUNRUI-CD-18        PIC  X(05)  VALUE  "BUN18".
  3377*----------  オフバランス
  3378 20  CNS-BUNRUI-CD-19        PIC  X(05)  VALUE  "BUN19".
  3379******************************************************************
  3380*----------      分類コード2
  3381******************************************************************
  3382*----------  株式
  3383 20  CNS-BUNRUI-CD-001       PIC  X(05)  VALUE  "0A001".
  3384*----------  新株引受権証券（ワラント）
  3385 20  CNS-BUNRUI-CD-002       PIC  X(05)  VALUE  "0A002".
  3386*----------  ライツ（増資時発生）
  3387 20  CNS-BUNRUI-CD-003       PIC  X(05)  VALUE  "0A003".
  3388*----------  その他国内株式
  3389 20  CNS-BUNRUI-CD-004       PIC  X(05)  VALUE  "0A004".
  3390*----------  その他外国株式
  3391 20  CNS-BUNRUI-CD-005       PIC  X(05)  VALUE  "0A005".
  3392*----------  債券
  3393 20  CNS-BUNRUI-CD-006       PIC  X(05)  VALUE  "0B006".
  3394*----------  MBS
  3395 20  CNS-BUNRUI-CD-007       PIC  X(05)  VALUE  "0B007".
  3396*----------  その他国内債券
  3397 20  CNS-BUNRUI-CD-008       PIC  X(05)  VALUE  "0B008".
  3398*----------  その他外国債券
  3399 20  CNS-BUNRUI-CD-009       PIC  X(05)  VALUE  "0B009".
  3400*----------  新株予約権付社債
  3401 20  CNS-BUNRUI-CD-010       PIC  X(05)  VALUE  "0C010".
  3402*----------  新株予約権
  3403 20  CNS-BUNRUI-CD-011       PIC  X(05)  VALUE  "0D011".
  3404*----------  為替直物
  3405 20  CNS-BUNRUI-CD-012       PIC  X(05)  VALUE  "0E012".
  3406*----------  個別株式コールオプション
  3407 20  CNS-BUNRUI-CD-013       PIC  X(05)  VALUE  "0F013".
  3408*----------  個別株式プットオプション
  3409 20  CNS-BUNRUI-CD-014       PIC  X(05)  VALUE  "0F014".
  3410*----------  株価指数コールオプション
  3411 20  CNS-BUNRUI-CD-015       PIC  X(05)  VALUE  "0F015".
  3412*----------  株価指数プットオプション
  3413 20  CNS-BUNRUI-CD-016       PIC  X(05)  VALUE  "0F016".
  3414*----------  株価指数先物コールオプション
  3415 20  CNS-BUNRUI-CD-017       PIC  X(05)  VALUE  "0F017".
  3416*----------  株価指数先物プットオプション
  3417 20  CNS-BUNRUI-CD-018       PIC  X(05)  VALUE  "0F018".
  3418*----------  店頭現債コールオプション
  3419 20  CNS-BUNRUI-CD-019       PIC  X(05)  VALUE  "0F019".
  3420*----------  店頭現債プットオプション
  3421 20  CNS-BUNRUI-CD-020       PIC  X(05)  VALUE  "0F020".
  3422*----------  債券先物コールオプション
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  60
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/USCNS.cpy)py)py)
  3423 20  CNS-BUNRUI-CD-021       PIC  X(05)  VALUE  "0F021".
  3424*----------  債券先物プットオプション
  3425 20  CNS-BUNRUI-CD-022       PIC  X(05)  VALUE  "0F022".
  3426*----------  通貨コールオプション（区分不可能な場合）
  3427 20  CNS-BUNRUI-CD-023       PIC  X(05)  VALUE  "0F023".
  3428*----------  通貨コールオプション（株式）
  3429 20  CNS-BUNRUI-CD-024       PIC  X(05)  VALUE  "0F024".
  3430*----------  通貨コールオプション（債券）
  3431 20  CNS-BUNRUI-CD-025       PIC  X(05)  VALUE  "0F025".
  3432*----------  通貨プットオプション（区分不可能な場合）
  3433 20  CNS-BUNRUI-CD-026       PIC  X(05)  VALUE  "0F026".
  3434*----------  通貨プットオプション（株式）
  3435 20  CNS-BUNRUI-CD-027       PIC  X(05)  VALUE  "0F027".
  3436*----------  通貨プットオプション（債券）
  3437 20  CNS-BUNRUI-CD-028       PIC  X(05)  VALUE  "0F028".
  3438*----------  通貨先物コールオプション（区分不可能な場合）
  3439 20  CNS-BUNRUI-CD-029       PIC  X(05)  VALUE  "0F029".
  3440*----------  通貨先物コールオプション（株式）
  3441 20  CNS-BUNRUI-CD-030       PIC  X(05)  VALUE  "0F030".
  3442*----------  通貨先物コールオプション（債券）
  3443 20  CNS-BUNRUI-CD-031       PIC  X(05)  VALUE  "0F031".
  3444*----------  通貨先物プットオプション（区分不可能な場合）
  3445 20  CNS-BUNRUI-CD-032       PIC  X(05)  VALUE  "0F032".
  3446*----------  通貨先物プットオプション（株式）
  3447 20  CNS-BUNRUI-CD-033       PIC  X(05)  VALUE  "0F033".
  3448*----------  通貨先物プットオプション（債券）
  3449 20  CNS-BUNRUI-CD-034       PIC  X(05)  VALUE  "0F034".
  3450*----------  金利先物コールオプション
  3451 20  CNS-BUNRUI-CD-035       PIC  X(05)  VALUE  "0F035".
  3452*----------  金利先物プットオプション
  3453 20  CNS-BUNRUI-CD-036       PIC  X(05)  VALUE  "0F036".
  3454*----------  証拠金（区分不可能な場合）
  3455 20  CNS-BUNRUI-CD-037       PIC  X(05)  VALUE  "0G037".
  3456*----------  債券先物証拠金
  3457 20  CNS-BUNRUI-CD-038       PIC  X(05)  VALUE  "0G038".
  3458*----------  債券オプション証拠金
  3459 20  CNS-BUNRUI-CD-039       PIC  X(05)  VALUE  "0G039".
  3460*----------  債券証拠金（対象商品の区分不可能の場合）
  3461 20  CNS-BUNRUI-CD-040       PIC  X(05)  VALUE  "0G040".
  3462*----------  外国債券委託証拠金
  3463 20  CNS-BUNRUI-CD-041       PIC  X(05)  VALUE  "0G041".
  3464*----------  株式先物証拠金
  3465 20  CNS-BUNRUI-CD-042       PIC  X(05)  VALUE  "0G042".
  3466*----------  株式オプション証拠金
  3467 20  CNS-BUNRUI-CD-043       PIC  X(05)  VALUE  "0G043".
  3468*----------  株式証拠金（対象商品の区分不可能の場合）
  3469 20  CNS-BUNRUI-CD-044       PIC  X(05)  VALUE  "0G044".
  3470*----------  外国株式証拠金（対象商品の区分不可能の場合）
  3471 20  CNS-BUNRUI-CD-045       PIC  X(05)  VALUE  "0G045".
  3472*----------  現金
  3473 20  CNS-BUNRUI-CD-046       PIC  X(05)  VALUE  "0H046".
  3474*----------  コール
  3475 20  CNS-BUNRUI-CD-047       PIC  X(05)  VALUE  "0I047".
  3476*----------  CP
  3477 20  CNS-BUNRUI-CD-048       PIC  X(05)  VALUE  "0I048".
  3478*----------  手形
  3479 20  CNS-BUNRUI-CD-049       PIC  X(05)  VALUE  "0I049".
  3480*----------  大口定期預金
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  61
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/USCNS.cpy)py)py)
  3481 20  CNS-BUNRUI-CD-050       PIC  X(05)  VALUE  "0I050".
  3482*----------  CD現先・CP現先
  3483 20  CNS-BUNRUI-CD-051       PIC  X(05)  VALUE  "0I051".
  3484*----------  譲渡性預金
  3485 20  CNS-BUNRUI-CD-052       PIC  X(05)  VALUE  "0I052".
  3486*----------  株式信用
  3487 20  CNS-BUNRUI-CD-053       PIC  X(05)  VALUE  "0J053".
  3488*----------  為替予約（区分不可能な場合）
  3489 20  CNS-BUNRUI-CD-054       PIC  X(05)  VALUE  "0K054".
  3490*----------  為替予約（債券）
  3491 20  CNS-BUNRUI-CD-055       PIC  X(05)  VALUE  "0K055".
  3492*----------  為替予約（株式）
  3493 20  CNS-BUNRUI-CD-056       PIC  X(05)  VALUE  "0K056".
  3494*----------  株価指数先物
  3495 20  CNS-BUNRUI-CD-057       PIC  X(05)  VALUE  "0L057".
  3496*----------  債券先物
  3497 20  CNS-BUNRUI-CD-058       PIC  X(05)  VALUE  "0L058".
  3498*----------  通貨先物（区分不可能な場合）
  3499 20  CNS-BUNRUI-CD-059       PIC  X(05)  VALUE  "0L059".
  3500*----------  通貨先物（株式）
  3501 20  CNS-BUNRUI-CD-060       PIC  X(05)  VALUE  "0L060".
  3502*----------  通貨先物（債券）
  3503 20  CNS-BUNRUI-CD-061       PIC  X(05)  VALUE  "0L061".
  3504*----------  金利先物
  3505 20  CNS-BUNRUI-CD-062       PIC  X(05)  VALUE  "0L062".
  3506*----------  為替先物
  3507 20  CNS-BUNRUI-CD-063       PIC  X(05)  VALUE  "0M063".
  3508*----------  元本
  3509 20  CNS-BUNRUI-CD-064       PIC  X(05)  VALUE  "0N064".
  3510*----------  転換社債
  3511 20  CNS-BUNRUI-CD-065       PIC  X(05)  VALUE  "0P065".
  3512*----------  新株引受権付社債
  3513 20  CNS-BUNRUI-CD-066       PIC  X(05)  VALUE  "0P066".
  3514*----------  その他転換社債
  3515 20  CNS-BUNRUI-CD-067       PIC  X(05)  VALUE  "0P067".
  3516******************************************************************
  3517*----------      個別玉管理番号
  3518******************************************************************
  3519*----------  運用通貨未収金
  3520 20  CNS-MEG-CD-RECVBC       PIC  X(10)  VALUE  "RECVBC    ".
  3521 20  CNS-MEG-CD-MARECVBC     PIC  X(10)  VALUE  "MARECVBC  ".
  3522*----------  外貨未収金
  3523 20  CNS-MEG-CD-ACRECVLC     PIC  X(10)  VALUE  "ACRECVLC  ".
  3524 20  CNS-MEG-CD-RECVLC       PIC  X(10)  VALUE  "RECVLC    ".
  3525 20  CNS-MEG-CD-MARECVLC     PIC  X(10)  VALUE  "MARECVLC  ".
  3526*----------  運用通貨未払金
  3527 20  CNS-MEG-CD-PAYBC        PIC  X(10)  VALUE  "PAYBC     ".
  3528 20  CNS-MEG-CD-MAPAYBC      PIC  X(10)  VALUE  "MAPAYBC   ".
  3529*----------  外貨未払金
  3530 20  CNS-MEG-CD-ACPAYLC      PIC  X(10)  VALUE  "ACPAYLC   ".
  3531 20  CNS-MEG-CD-PAYLC        PIC  X(10)  VALUE  "PAYLC     ".
  3532 20  CNS-MEG-CD-MAPAYLC      PIC  X(10)  VALUE  "MAPAYLC   ".
  3533******************************************************************
  3534*                サブRTN戻り値
  3535******************************************************************
  3536 20  CNS-RTN-001             PIC  X(03)  VALUE  "001".
  3537 20  CNS-RTN-004             PIC  X(03)  VALUE  "004".
  3538 20  CNS-RTN-005             PIC  X(03)  VALUE  "005".
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  62
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/USCNS.cpy)py)py)
  3539 20  CNS-RTN-006             PIC  X(03)  VALUE  "006".
  3540 20  CNS-RTN-100             PIC  X(03)  VALUE  "100".
  3541 20  CNS-RTN-111             PIC  X(03)  VALUE  "111".
  3542 20  CNS-RTN-113             PIC  X(03)  VALUE  "113".
  3543 20  CNS-RTN-201             PIC  X(03)  VALUE  "201".
  3544 20  CNS-RTN-210             PIC  X(03)  VALUE  "210".
  3545******************************************************************
  3546*                環境変数値
  3547******************************************************************
  3548 20  CNS-APL-NAS-DIR         PIC  X(11)  VALUE  "APL_NAS_DIR".
  3549 20  CNS-APL-DAT-DIR         PIC  X(11)  VALUE  "APL_DAT_DIR".
  3550 20  CNS-BL-UPFILE-PATH      PIC  X(14)  VALUE  "BL_UPFILE_PATH".
  3551*----------  TSVDL
  3552 20  CNS-TSVDL               PIC  X(05)  VALUE  "tsvdl".
  3553******************************************************************
  3554*----------      取引内容コード
  3555******************************************************************
  3556*----------  その他数量/簿価増加（片伝）
  3557 20  CNS-TRHK-NAIYO-CD-AIN   PIC  X(04)  VALUE  "AIN ".
  3558*----------  アモチ/アキュム
  3559 20  CNS-TRHK-NAIYO-CD-AMAC  PIC  X(04)  VALUE  "AMAC".
  3560*----------  その他数量/簿価減少（片伝）
  3561 20  CNS-TRHK-NAIYO-CD-AOUT  PIC  X(04)  VALUE  "AOUT".
  3562*----------  購入
  3563 20  CNS-TRHK-NAIYO-CD-BUY   PIC  X(04)  VALUE  "BUY ".
  3564*----------  資本返還による減資
  3565 20  CNS-TRHK-NAIYO-CD-CAPD  PIC  X(04)  VALUE  "CAPD".
  3566*----------  CB転換による取得
  3567 20  CNS-TRHK-NAIYO-CD-CBB   PIC  X(04)  VALUE  "CBB ".
  3568*----------  CB転換
  3569 20  CNS-TRHK-NAIYO-CD-CBC   PIC  X(04)  VALUE  "CBC ".
  3570*----------  転換交付金入金
  3571 20  CNS-TRHK-NAIYO-CD-CBCH  PIC  X(04)  VALUE  "CBCH".
  3572*----------  為替送回金
  3573 20  CNS-TRHK-NAIYO-CD-CFFA  PIC  X(04)  VALUE  "CFFA".
  3574*----------  C/Aによる減少
  3575 20  CNS-TRHK-NAIYO-CD-CID   PIC  X(04)  VALUE  "CID ".
  3576*----------  C/Aによる増加
  3577 20  CNS-TRHK-NAIYO-CD-CII   PIC  X(04)  VALUE  "CII ".
  3578*----------  権利取得のための払込
  3579 20  CNS-TRHK-NAIYO-CD-CIP   PIC  X(04)  VALUE  "CIP ".
  3580*----------  費用出金
  3581 20  CNS-TRHK-NAIYO-CD-COST  PIC  X(04)  VALUE  "COST".
  3582*----------  未払費用
  3583 20  CNS-TRHK-NAIYO-CD-CSTU  PIC  X(04)  VALUE  "CSTU".
  3584*----------  DUMMY
  3585 20  CNS-TRHK-NAIYO-CD-DMY   PIC  X(04)  VALUE  "DMY ".
  3586*----------  現金インカムゲイン対応支払
  3587 20  CNS-TRHK-NAIYO-CD-DVAP  PIC  X(04)  VALUE  "DVAP".
  3588*----------  現金インカムゲイン入金
  3589 20  CNS-TRHK-NAIYO-CD-DVCP  PIC  X(04)  VALUE  "DVCP".
  3590*----------  インカムゲインによる増加
  3591 20  CNS-TRHK-NAIYO-CD-DVRE  PIC  X(04)  VALUE  "DVRE".
  3592*----------  為替差損益
  3593 20  CNS-TRHK-NAIYO-CD-EXPL  PIC  X(04)  VALUE  "EXPL".
  3594*----------  源泉税還付予定額計上
  3595 20  CNS-TRHK-NAIYO-CD-EXTR  PIC  X(04)  VALUE  "EXTR".
  3596*----------  実行・現引・現渡
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  63
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/USCNS.cpy)py)py)
  3597 20  CNS-TRHK-NAIYO-CD-FEXE  PIC  X(04)  VALUE  "FEXE".
  3598*----------  ファンド欠損金
  3599 20  CNS-TRHK-NAIYO-CD-FLOS  PIC  X(04)  VALUE  "FLOS".
  3600*----------  信託利益調整損益
  3601 20  CNS-TRHK-NAIYO-CD-FTA   PIC  X(04)  VALUE  "FTA ".
  3602*----------  未収収益
  3603 20  CNS-TRHK-NAIYO-CD-FTC   PIC  X(04)  VALUE  "FTC ".
  3604*----------  評価損益
  3605 20  CNS-TRHK-NAIYO-CD-FTPL  PIC  X(04)  VALUE  "FTPL".
  3606*----------  配当付株数計上
  3607 20  CNS-TRHK-NAIYO-CD-FTSQ  PIC  X(04)  VALUE  "FTSQ".
  3608*----------  収益計上簿価増加(キャピタル)
  3609 20  CNS-TRHK-NAIYO-CD-GANC  PIC  X(04)  VALUE  "GANC".
  3610*----------  収益計上簿価増加(インカム)
  3611 20  CNS-TRHK-NAIYO-CD-GANI  PIC  X(04)  VALUE  "GANI".
  3612*----------  買現先エンド
  3613 20  CNS-TRHK-NAIYO-CD-GNBE  PIC  X(04)  VALUE  "GNBE".
  3614*----------  買現先スタ－ト
  3615 20  CNS-TRHK-NAIYO-CD-GNBS  PIC  X(04)  VALUE  "GNBS".
  3616*----------  売現先エンド
  3617 20  CNS-TRHK-NAIYO-CD-GNSE  PIC  X(04)  VALUE  "GNSE".
  3618*----------  売現先スタ－ト
  3619 20  CNS-TRHK-NAIYO-CD-GNSS  PIC  X(04)  VALUE  "GNSS".
  3620*----------  元本入金
  3621 20  CNS-TRHK-NAIYO-CD-INFL  PIC  X(04)  VALUE  "INFL".
  3622*----------  損失計上簿価減少(キャピタル)
  3623 20  CNS-TRHK-NAIYO-CD-LOOC  PIC  X(04)  VALUE  "LOOC".
  3624*----------  損失計上簿価減少(インカム)
  3625 20  CNS-TRHK-NAIYO-CD-LOOI  PIC  X(04)  VALUE  "LOOI".
  3626*----------  償還
  3627 20  CNS-TRHK-NAIYO-CD-MATU  PIC  X(04)  VALUE  "MATU".
  3628*----------  保証金等差入
  3629 20  CNS-TRHK-NAIYO-CD-MIN   PIC  X(04)  VALUE  "MIN ".
  3630*----------  代用有価証券差入
  3631 20  CNS-TRHK-NAIYO-CD-MINS  PIC  X(04)  VALUE  "MINS".
  3632*----------  代用有価証券回収
  3633 20  CNS-TRHK-NAIYO-CD-MOTS  PIC  X(04)  VALUE  "MOTS".
  3634*----------  保証金等回収
  3635 20  CNS-TRHK-NAIYO-CD-MOUT  PIC  X(04)  VALUE  "MOUT".
  3636*----------  会社合併交付金
  3637 20  CNS-TRHK-NAIYO-CD-MRCH  PIC  X(04)  VALUE  "MRCH".
  3638*----------  権利・義務消滅
  3639 20  CNS-TRHK-NAIYO-CD-OAB   PIC  X(04)  VALUE  "OAB ".
  3640*----------  現物割当
  3641 20  CNS-TRHK-NAIYO-CD-OATB  PIC  X(04)  VALUE  "OATB".
  3642*----------  権利行使・割当
  3643 20  CNS-TRHK-NAIYO-CD-OEXE  PIC  X(04)  VALUE  "OEXE".
  3644*----------  権利行使
  3645 20  CNS-TRHK-NAIYO-CD-OEXW  PIC  X(04)  VALUE  "OEXW".
  3646*----------  新規買建
  3647 20  CNS-TRHK-NAIYO-CD-OPB   PIC  X(04)  VALUE  "OPB ".
  3648*----------  権利新規買建/売建
  3649 20  CNS-TRHK-NAIYO-CD-OPR   PIC  X(04)  VALUE  "OPR ".
  3650*----------  新規売建
  3651 20  CNS-TRHK-NAIYO-CD-OPS   PIC  X(04)  VALUE  "OPS ".
  3652*----------  元本出金
  3653 20  CNS-TRHK-NAIYO-CD-OUFL  PIC  X(04)  VALUE  "OUFL".
  3654*----------  益入金
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  64
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/USCNS.cpy)py)py)
  3655 20  CNS-TRHK-NAIYO-CD-PROF  PIC  X(04)  VALUE  "PROF".
  3656*----------  キャッシュ支払簿価増加
  3657 20  CNS-TRHK-NAIYO-CD-PYIN  PIC  X(04)  VALUE  "PYIN".
  3658*----------  株式配当
  3659 20  CNS-TRHK-NAIYO-CD-QDIS  PIC  X(04)  VALUE  "QDIS".
  3660*----------  みなし配当
  3661 20  CNS-TRHK-NAIYO-CD-QDIV  PIC  X(04)  VALUE  "QDIV".
  3662*----------  キャッシュ受取簿価減少
  3663 20  CNS-TRHK-NAIYO-CD-RCOT  PIC  X(04)  VALUE  "RCOT".
  3664*----------  インカムゲイン計上
  3665 20  CNS-TRHK-NAIYO-CD-RCP   PIC  X(04)  VALUE  "RCP ".
  3666*----------  ファンド収益払出
  3667 20  CNS-TRHK-NAIYO-CD-REV   PIC  X(04)  VALUE  "REV ".
  3668*----------  ファンド損益繰越
  3669 20  CNS-TRHK-NAIYO-CD-REVC  PIC  X(04)  VALUE  "REVC".
  3670*----------  ファンド収益元加
  3671 20  CNS-TRHK-NAIYO-CD-REVI  PIC  X(04)  VALUE  "REVI".
  3672*----------  担保金等受入
  3673 20  CNS-TRHK-NAIYO-CD-SDIN  PIC  X(04)  VALUE  "SDIN".
  3674*----------  担保金等返戻
  3675 20  CNS-TRHK-NAIYO-CD-SDOT  PIC  X(04)  VALUE  "SDOT".
  3676*----------  有価証券借入
  3677 20  CNS-TRHK-NAIYO-CD-SECB  PIC  X(04)  VALUE  "SECB".
  3678*----------  有価証券返戻
  3679 20  CNS-TRHK-NAIYO-CD-SECR  PIC  X(04)  VALUE  "SECR".
  3680*----------  売却
  3681 20  CNS-TRHK-NAIYO-CD-SELL  PIC  X(04)  VALUE  "SELL".
  3682*----------  反対売買・相殺・決済
  3683 20  CNS-TRHK-NAIYO-CD-SET   PIC  X(04)  VALUE  "SET ".
  3684*----------  買戻し
  3685 20  CNS-TRHK-NAIYO-CD-SHBY  PIC  X(04)  VALUE  "SHBY".
  3686*----------  空売り
  3687 20  CNS-TRHK-NAIYO-CD-SHSL  PIC  X(04)  VALUE  "SHSL".
  3688*----------  現物による元本受入
  3689 20  CNS-TRHK-NAIYO-CD-SIN   PIC  X(04)  VALUE  "SIN ".
  3690*----------  元本受入による増加
  3691 20  CNS-TRHK-NAIYO-CD-SINI  PIC  X(04)  VALUE  "SINI".
  3692*----------  有価証券貸付
  3693 20  CNS-TRHK-NAIYO-CD-SLIN  PIC  X(04)  VALUE  "SLIN".
  3694*----------  有価証券回収
  3695 20  CNS-TRHK-NAIYO-CD-SLOT  PIC  X(04)  VALUE  "SLOT".
  3696*----------  元本返戻による減少
  3697 20  CNS-TRHK-NAIYO-CD-SOUT  PIC  X(04)  VALUE  "SOUT".
  3698*----------  源泉税還付金入金
  3699 20  CNS-TRHK-NAIYO-CD-TAXR  PIC  X(04)  VALUE  "TAXR".
  3700******************************************************************
  3701*                O3WチェックルーチンRTN戻り値
  3702******************************************************************
  3703 20  CNS-NORMAL              PIC  X(01)  VALUE  "0".
  3704 20  CNS-ERR-1               PIC  X(01)  VALUE  "1".
  3705 20  CNS-ERR-9               PIC  X(01)  VALUE  "9".
  3706******************************************************************
  3707*----------      集計用国
  3708******************************************************************
  3709*----------  JPN
  3710 20  CNS-SYUKEI-KUNI-JPN     PIC  X(04)  VALUE  "JPN ".
  3711******************************************************************
  3712*----------      起動処理分類
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  65
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/USCNS.cpy)py)py)
  3713******************************************************************
  3714*----------  一括処理
  3715 20  CNS-KIDOU-KIRO-B        PIC  X(01)  VALUE  "B".
  3716*----------  アップロード
  3717 20  CNS-KIDOU-KIRO-U        PIC  X(01)  VALUE  "U".
  3718*----------  ダウンロード
  3719 20  CNS-KIDOU-KIRO-D        PIC  X(01)  VALUE  "D".
  3720*----------  帳票リクエスト
  3721 20  CNS-KIDOU-KIRO-R        PIC  X(01)  VALUE  "R".
  3722*----------  データ更新
  3723 20  CNS-KIDOU-KIRO-K        PIC  X(01)  VALUE  "K".
  3724*----------  外部送受信
  3725 20  CNS-KIDOU-KIRO-A        PIC  X(01)  VALUE  "A".
  3726******************************************************************
  3727*----------      商品区分
  3728******************************************************************
  3729*----------   株式
  3730 20  CNS-SYOHIN-KBN-11       PIC  X(02)  VALUE  "11".
  3731*----------   債券
  3732 20  CNS-SYOHIN-KBN-12       PIC  X(02)  VALUE  "12".
  3733*----------   CB/WB
  3734 20  CNS-SYOHIN-KBN-13       PIC  X(02)  VALUE  "13".
  3735*----------   証券投資信託受益証券
  3736 20  CNS-SYOHIN-KBN-14       PIC  X(02)  VALUE  "14".
  3737*----------   現金
  3738 20  CNS-SYOHIN-KBN-15       PIC  X(02)  VALUE  "15".
  3739*----------   短期金融商品
  3740 20  CNS-SYOHIN-KBN-16       PIC  X(02)  VALUE  "16".
  3741*----------   差入証拠金
  3742 20  CNS-SYOHIN-KBN-17       PIC  X(02)  VALUE  "17".
  3743*----------   不動産
  3744 20  CNS-SYOHIN-KBN-18       PIC  X(02)  VALUE  "18".
  3745*----------   オプション取引
  3746 20  CNS-SYOHIN-KBN-19       PIC  X(02)  VALUE  "19".
  3747*----------   先物取引
  3748 20  CNS-SYOHIN-KBN-20       PIC  X(02)  VALUE  "20".
  3749*----------   為替直物
  3750 20  CNS-SYOHIN-KBN-21       PIC  X(02)  VALUE  "21".
  3751*----------   為替予約
  3752 20  CNS-SYOHIN-KBN-22       PIC  X(02)  VALUE  "22".
  3753*----------   ＴＢＡ
  3754 20  CNS-SYOHIN-KBN-23       PIC  X(02)  VALUE  "23".
  3755*----------   株式信用取引
  3756 20  CNS-SYOHIN-KBN-24       PIC  X(02)  VALUE  "24".
  3757*----------   元本
  3758 20  CNS-SYOHIN-KBN-25       PIC  X(02)  VALUE  "25".
  3759*----------   貸付有価証券残高
  3760 20  CNS-SYOHIN-KBN-26       PIC  X(02)  VALUE  "26".
  3761*----------   貸有担保金(負債)
  3762 20  CNS-SYOHIN-KBN-27       PIC  X(02)  VALUE  "27".
  3763*----------   その他商品
  3764 20  CNS-SYOHIN-KBN-28       PIC  X(02)  VALUE  "28".
  3765*----------   ファンド全体
  3766 20  CNS-SYOHIN-KBN-29       PIC  X(02)  VALUE  "29".
  3767*----------   その他資産
  3768 20  CNS-SYOHIN-KBN-30       PIC  X(02)  VALUE  "30".
  3769*----------   代用有価証券
  3770 20  CNS-SYOHIN-KBN-31       PIC  X(02)  VALUE  "31".
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  66
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/USCNS.cpy)py)py)
  3771******************************************************************
  3772*----------      実行可能区分
  3773******************************************************************
  3774*----------  続行可能
  3775 20  CNS-CONTINUE-KBN-0      PIC  X(01)  VALUE  "0".
  3776*----------  一時停止
  3777 20  CNS-CONTINUE-KBN-1      PIC  X(01)  VALUE  "1".
  3778*----------  強制停止
  3779 20  CNS-CONTINUE-KBN-2      PIC  X(01)  VALUE  "2".
  3780*----------  ポートフォリオ処理中
  3781 20  CNS-CONTINUE-KBN-3      PIC  X(01)  VALUE  "3".
  3782******************************************************************
  3783*                BT戻り値
  3784******************************************************************
  3785 20  CNS-RTN-BT10            PIC  9(02)  VALUE  10.
  3786******************************************************************
  3787*----------      全て取引内容
  3788******************************************************************
  3789 20  CNS-ALL-TRHK-NAIYO-ABON PIC  X(04)  VALUE  "ABON".
  3790 20  CNS-ALL-TRHK-NAIYO-ACS  PIC  X(04)  VALUE  "ACS ".
  3791 20  CNS-ALL-TRHK-NAIYO-ADIV PIC  X(04)  VALUE  "ADIV".
  3792 20  CNS-ALL-TRHK-NAIYO-ADVR PIC  X(04)  VALUE  "ADVR".
  3793 20  CNS-ALL-TRHK-NAIYO-AIAD PIC  X(04)  VALUE  "AIAD".
  3794 20  CNS-ALL-TRHK-NAIYO-AIN  PIC  X(04)  VALUE  "AIN ".
  3795 20  CNS-ALL-TRHK-NAIYO-AOUT PIC  X(04)  VALUE  "AOUT".
  3796 20  CNS-ALL-TRHK-NAIYO-AUCO PIC  X(04)  VALUE  "AUCO".
  3797 20  CNS-ALL-TRHK-NAIYO-BC   PIC  X(04)  VALUE  "BC  ".
  3798 20  CNS-ALL-TRHK-NAIYO-BE   PIC  X(04)  VALUE  "BE  ".
  3799 20  CNS-ALL-TRHK-NAIYO-BNK  PIC  X(04)  VALUE  "BNK ".
  3800 20  CNS-ALL-TRHK-NAIYO-BO   PIC  X(04)  VALUE  "BO  ".
  3801 20  CNS-ALL-TRHK-NAIYO-BUY  PIC  X(04)  VALUE  "BUY ".
  3802 20  CNS-ALL-TRHK-NAIYO-BV   PIC  X(04)  VALUE  "BV  ".
  3803 20  CNS-ALL-TRHK-NAIYO-BVIN PIC  X(04)  VALUE  "BVIN".
  3804 20  CNS-ALL-TRHK-NAIYO-BVOT PIC  X(04)  VALUE  "BVOT".
  3805 20  CNS-ALL-TRHK-NAIYO-BYBK PIC  X(04)  VALUE  "BYBK".
  3806 20  CNS-ALL-TRHK-NAIYO-CALL PIC  X(04)  VALUE  "CALL".
  3807 20  CNS-ALL-TRHK-NAIYO-CBB  PIC  X(04)  VALUE  "CBB ".
  3808 20  CNS-ALL-TRHK-NAIYO-CBC  PIC  X(04)  VALUE  "CBC ".
  3809 20  CNS-ALL-TRHK-NAIYO-CBND PIC  X(04)  VALUE  "CBND".
  3810 20  CNS-ALL-TRHK-NAIYO-CBON PIC  X(04)  VALUE  "CBON".
  3811 20  CNS-ALL-TRHK-NAIYO-CCBW PIC  X(04)  VALUE  "CCBW".
  3812 20  CNS-ALL-TRHK-NAIYO-CDI  PIC  X(04)  VALUE  "CDI ".
  3813 20  CNS-ALL-TRHK-NAIYO-CEX  PIC  X(04)  VALUE  "CEX ".
  3814 20  CNS-ALL-TRHK-NAIYO-CEXL PIC  X(04)  VALUE  "CEXL".
  3815 20  CNS-ALL-TRHK-NAIYO-CFEE PIC  X(04)  VALUE  "CFEE".
  3816 20  CNS-ALL-TRHK-NAIYO-CI   PIC  X(04)  VALUE  "CI  ".
  3817 20  CNS-ALL-TRHK-NAIYO-CID  PIC  X(04)  VALUE  "CID ".
  3818 20  CNS-ALL-TRHK-NAIYO-CII  PIC  X(04)  VALUE  "CII ".
  3819 20  CNS-ALL-TRHK-NAIYO-CIP  PIC  X(04)  VALUE  "CIP ".
  3820 20  CNS-ALL-TRHK-NAIYO-COM  PIC  X(04)  VALUE  "COM ".
  3821 20  CNS-ALL-TRHK-NAIYO-COMR PIC  X(04)  VALUE  "COMR".
  3822 20  CNS-ALL-TRHK-NAIYO-CONS PIC  X(04)  VALUE  "CONS".
  3823 20  CNS-ALL-TRHK-NAIYO-COST PIC  X(04)  VALUE  "COST".
  3824 20  CNS-ALL-TRHK-NAIYO-CPGA PIC  X(04)  VALUE  "CPGA".
  3825 20  CNS-ALL-TRHK-NAIYO-CPLO PIC  X(04)  VALUE  "CPLO".
  3826 20  CNS-ALL-TRHK-NAIYO-CPRO PIC  X(04)  VALUE  "CPRO".
  3827 20  CNS-ALL-TRHK-NAIYO-CRSS PIC  X(04)  VALUE  "CRSS".
  3828 20  CNS-ALL-TRHK-NAIYO-CSDV PIC  X(04)  VALUE  "CSDV".
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  67
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/USCNS.cpy)py)py)
  3829 20  CNS-ALL-TRHK-NAIYO-CSIN PIC  X(04)  VALUE  "CSIN".
  3830 20  CNS-ALL-TRHK-NAIYO-CSLO PIC  X(04)  VALUE  "CSLO".
  3831 20  CNS-ALL-TRHK-NAIYO-CSOT PIC  X(04)  VALUE  "CSOT".
  3832 20  CNS-ALL-TRHK-NAIYO-CSPR PIC  X(04)  VALUE  "CSPR".
  3833 20  CNS-ALL-TRHK-NAIYO-CSTX PIC  X(04)  VALUE  "CSTX".
  3834 20  CNS-ALL-TRHK-NAIYO-CTAX PIC  X(04)  VALUE  "CTAX".
  3835 20  CNS-ALL-TRHK-NAIYO-CTXC PIC  X(04)  VALUE  "CTXC".
  3836 20  CNS-ALL-TRHK-NAIYO-CWRT PIC  X(04)  VALUE  "CWRT".
  3837 20  CNS-ALL-TRHK-NAIYO-CZKN PIC  X(04)  VALUE  "CZKN".
  3838 20  CNS-ALL-TRHK-NAIYO-DEPO PIC  X(04)  VALUE  "DEPO".
  3839 20  CNS-ALL-TRHK-NAIYO-DIN  PIC  X(04)  VALUE  "DIN ".
  3840 20  CNS-ALL-TRHK-NAIYO-DIV  PIC  X(04)  VALUE  "DIV ".
  3841 20  CNS-ALL-TRHK-NAIYO-DOUT PIC  X(04)  VALUE  "DOUT".
  3842 20  CNS-ALL-TRHK-NAIYO-EBUY PIC  X(04)  VALUE  "EBUY".
  3843 20  CNS-ALL-TRHK-NAIYO-ESEL PIC  X(04)  VALUE  "ESEL".
  3844 20  CNS-ALL-TRHK-NAIYO-ETXR PIC  X(04)  VALUE  "ETXR".
  3845 20  CNS-ALL-TRHK-NAIYO-FADJ PIC  X(04)  VALUE  "FADJ".
  3846 20  CNS-ALL-TRHK-NAIYO-FBUY PIC  X(04)  VALUE  "FBUY".
  3847 20  CNS-ALL-TRHK-NAIYO-FCH2 PIC  X(04)  VALUE  "FCH2".
  3848 20  CNS-ALL-TRHK-NAIYO-FCHG PIC  X(04)  VALUE  "FCHG".
  3849 20  CNS-ALL-TRHK-NAIYO-FCST PIC  X(04)  VALUE  "FCST".
  3850 20  CNS-ALL-TRHK-NAIYO-FDP  PIC  X(04)  VALUE  "FDP ".
  3851 20  CNS-ALL-TRHK-NAIYO-FEXE PIC  X(04)  VALUE  "FEXE".
  3852 20  CNS-ALL-TRHK-NAIYO-FH   PIC  X(04)  VALUE  "FH  ".
  3853 20  CNS-ALL-TRHK-NAIYO-FLOS PIC  X(04)  VALUE  "FLOS".
  3854 20  CNS-ALL-TRHK-NAIYO-FODL PIC  X(04)  VALUE  "FODL".
  3855 20  CNS-ALL-TRHK-NAIYO-FODS PIC  X(04)  VALUE  "FODS".
  3856 20  CNS-ALL-TRHK-NAIYO-FSEL PIC  X(04)  VALUE  "FSEL".
  3857 20  CNS-ALL-TRHK-NAIYO-FSET PIC  X(04)  VALUE  "FSET".
  3858 20  CNS-ALL-TRHK-NAIYO-FTA  PIC  X(04)  VALUE  "FTA ".
  3859 20  CNS-ALL-TRHK-NAIYO-FTAR PIC  X(04)  VALUE  "FTAR".
  3860 20  CNS-ALL-TRHK-NAIYO-FTBV PIC  X(04)  VALUE  "FTBV".
  3861 20  CNS-ALL-TRHK-NAIYO-FTC  PIC  X(04)  VALUE  "FTC ".
  3862 20  CNS-ALL-TRHK-NAIYO-FTDV PIC  X(04)  VALUE  "FTDV".
  3863 20  CNS-ALL-TRHK-NAIYO-FTF  PIC  X(04)  VALUE  "FTF ".
  3864 20  CNS-ALL-TRHK-NAIYO-FTGA PIC  X(04)  VALUE  "FTGA".
  3865 20  CNS-ALL-TRHK-NAIYO-FTGP PIC  X(04)  VALUE  "FTGP".
  3866 20  CNS-ALL-TRHK-NAIYO-FTIC PIC  X(04)  VALUE  "FTIC".
  3867 20  CNS-ALL-TRHK-NAIYO-FTLO PIC  X(04)  VALUE  "FTLO".
  3868 20  CNS-ALL-TRHK-NAIYO-FTLP PIC  X(04)  VALUE  "FTLP".
  3869 20  CNS-ALL-TRHK-NAIYO-FTML PIC  X(04)  VALUE  "FTML".
  3870 20  CNS-ALL-TRHK-NAIYO-FTMS PIC  X(04)  VALUE  "FTMS".
  3871 20  CNS-ALL-TRHK-NAIYO-FTOL PIC  X(04)  VALUE  "FTOL".
  3872 20  CNS-ALL-TRHK-NAIYO-FTOS PIC  X(04)  VALUE  "FTOS".
  3873 20  CNS-ALL-TRHK-NAIYO-FTP2 PIC  X(04)  VALUE  "FTP2".
  3874 20  CNS-ALL-TRHK-NAIYO-FTPL PIC  X(04)  VALUE  "FTPL".
  3875 20  CNS-ALL-TRHK-NAIYO-FW   PIC  X(04)  VALUE  "FW  ".
  3876 20  CNS-ALL-TRHK-NAIYO-FWRD PIC  X(04)  VALUE  "FWRD".
  3877 20  CNS-ALL-TRHK-NAIYO-GINT PIC  X(04)  VALUE  "GINT".
  3878 20  CNS-ALL-TRHK-NAIYO-GTAX PIC  X(04)  VALUE  "GTAX".
  3879 20  CNS-ALL-TRHK-NAIYO-IACS PIC  X(04)  VALUE  "IACS".
  3880 20  CNS-ALL-TRHK-NAIYO-IBND PIC  X(04)  VALUE  "IBND".
  3881 20  CNS-ALL-TRHK-NAIYO-IBNK PIC  X(04)  VALUE  "IBNK".
  3882 20  CNS-ALL-TRHK-NAIYO-ICAL PIC  X(04)  VALUE  "ICAL".
  3883 20  CNS-ALL-TRHK-NAIYO-ICBW PIC  X(04)  VALUE  "ICBW".
  3884 20  CNS-ALL-TRHK-NAIYO-ICDI PIC  X(04)  VALUE  "ICDI".
  3885 20  CNS-ALL-TRHK-NAIYO-ICOM PIC  X(04)  VALUE  "ICOM".
  3886 20  CNS-ALL-TRHK-NAIYO-ICTX PIC  X(04)  VALUE  "ICTX".
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  68
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/USCNS.cpy)py)py)
  3887 20  CNS-ALL-TRHK-NAIYO-IDIV PIC  X(04)  VALUE  "IDIV".
  3888 20  CNS-ALL-TRHK-NAIYO-IDPO PIC  X(04)  VALUE  "IDPO".
  3889 20  CNS-ALL-TRHK-NAIYO-IEXL PIC  X(04)  VALUE  "IEXL".
  3890 20  CNS-ALL-TRHK-NAIYO-IEXP PIC  X(04)  VALUE  "IEXP".
  3891 20  CNS-ALL-TRHK-NAIYO-IFDP PIC  X(04)  VALUE  "IFDP".
  3892 20  CNS-ALL-TRHK-NAIYO-IGEN PIC  X(04)  VALUE  "IGEN".
  3893 20  CNS-ALL-TRHK-NAIYO-ILOS PIC  X(04)  VALUE  "ILOS".
  3894 20  CNS-ALL-TRHK-NAIYO-ILPO PIC  X(04)  VALUE  "ILPO".
  3895 20  CNS-ALL-TRHK-NAIYO-INFL PIC  X(04)  VALUE  "INFL".
  3896 20  CNS-ALL-TRHK-NAIYO-INIT PIC  X(04)  VALUE  "INIT".
  3897 20  CNS-ALL-TRHK-NAIYO-INT  PIC  X(04)  VALUE  "INT ".
  3898 20  CNS-ALL-TRHK-NAIYO-IOCS PIC  X(04)  VALUE  "IOCS".
  3899 20  CNS-ALL-TRHK-NAIYO-IOGI PIC  X(04)  VALUE  "IOGI".
  3900 20  CNS-ALL-TRHK-NAIYO-IOPF PIC  X(04)  VALUE  "IOPF".
  3901 20  CNS-ALL-TRHK-NAIYO-IPAY PIC  X(04)  VALUE  "IPAY".
  3902 20  CNS-ALL-TRHK-NAIYO-IPRO PIC  X(04)  VALUE  "IPRO".
  3903 20  CNS-ALL-TRHK-NAIYO-IREV PIC  X(04)  VALUE  "IREV".
  3904 20  CNS-ALL-TRHK-NAIYO-ISD  PIC  X(04)  VALUE  "ISD ".
  3905 20  CNS-ALL-TRHK-NAIYO-ISHT PIC  X(04)  VALUE  "ISHT".
  3906 20  CNS-ALL-TRHK-NAIYO-ISI  PIC  X(04)  VALUE  "ISI ".
  3907 20  CNS-ALL-TRHK-NAIYO-ISTX PIC  X(04)  VALUE  "ISTX".
  3908 20  CNS-ALL-TRHK-NAIYO-ITAX PIC  X(04)  VALUE  "ITAX".
  3909 20  CNS-ALL-TRHK-NAIYO-ITRU PIC  X(04)  VALUE  "ITRU".
  3910 20  CNS-ALL-TRHK-NAIYO-ITST PIC  X(04)  VALUE  "ITST".
  3911 20  CNS-ALL-TRHK-NAIYO-IWRT PIC  X(04)  VALUE  "IWRT".
  3912 20  CNS-ALL-TRHK-NAIYO-IZKN PIC  X(04)  VALUE  "IZKN".
  3913 20  CNS-ALL-TRHK-NAIYO-LPRO PIC  X(04)  VALUE  "LPRO".
  3914 20  CNS-ALL-TRHK-NAIYO-MATU PIC  X(04)  VALUE  "MATU".
  3915 20  CNS-ALL-TRHK-NAIYO-MBUS PIC  X(04)  VALUE  "MBUS".
  3916 20  CNS-ALL-TRHK-NAIYO-MBUY PIC  X(04)  VALUE  "MBUY".
  3917 20  CNS-ALL-TRHK-NAIYO-MCI  PIC  X(04)  VALUE  "MCI ".
  3918 20  CNS-ALL-TRHK-NAIYO-MDIV PIC  X(04)  VALUE  "MDIV".
  3919 20  CNS-ALL-TRHK-NAIYO-MDP  PIC  X(04)  VALUE  "MDP ".
  3920 20  CNS-ALL-TRHK-NAIYO-MFLO PIC  X(04)  VALUE  "MFLO".
  3921 20  CNS-ALL-TRHK-NAIYO-MIN  PIC  X(04)  VALUE  "MIN ".
  3922 20  CNS-ALL-TRHK-NAIYO-MINT PIC  X(04)  VALUE  "MINT".
  3923 20  CNS-ALL-TRHK-NAIYO-MLO  PIC  X(04)  VALUE  "MLO ".
  3924 20  CNS-ALL-TRHK-NAIYO-MOUT PIC  X(04)  VALUE  "MOUT".
  3925 20  CNS-ALL-TRHK-NAIYO-MPAY PIC  X(04)  VALUE  "MPAY".
  3926 20  CNS-ALL-TRHK-NAIYO-MPF  PIC  X(04)  VALUE  "MPF ".
  3927 20  CNS-ALL-TRHK-NAIYO-MRCH PIC  X(04)  VALUE  "MRCH".
  3928 20  CNS-ALL-TRHK-NAIYO-MREI PIC  X(04)  VALUE  "MREI".
  3929 20  CNS-ALL-TRHK-NAIYO-MREP PIC  X(04)  VALUE  "MREP".
  3930 20  CNS-ALL-TRHK-NAIYO-MRG  PIC  X(04)  VALUE  "MRG ".
  3931 20  CNS-ALL-TRHK-NAIYO-MRGD PIC  X(04)  VALUE  "MRGD".
  3932 20  CNS-ALL-TRHK-NAIYO-MRI  PIC  X(04)  VALUE  "MRI ".
  3933 20  CNS-ALL-TRHK-NAIYO-MSEL PIC  X(04)  VALUE  "MSEL".
  3934 20  CNS-ALL-TRHK-NAIYO-MSES PIC  X(04)  VALUE  "MSES".
  3935 20  CNS-ALL-TRHK-NAIYO-MSI  PIC  X(04)  VALUE  "MSI ".
  3936 20  CNS-ALL-TRHK-NAIYO-MSIN PIC  X(04)  VALUE  "MSIN".
  3937 20  CNS-ALL-TRHK-NAIYO-MSLO PIC  X(04)  VALUE  "MSLO".
  3938 20  CNS-ALL-TRHK-NAIYO-MSOT PIC  X(04)  VALUE  "MSOT".
  3939 20  CNS-ALL-TRHK-NAIYO-MSOU PIC  X(04)  VALUE  "MSOU".
  3940 20  CNS-ALL-TRHK-NAIYO-MSPF PIC  X(04)  VALUE  "MSPF".
  3941 20  CNS-ALL-TRHK-NAIYO-MSPL PIC  X(04)  VALUE  "MSPL".
  3942 20  CNS-ALL-TRHK-NAIYO-MTCI PIC  X(04)  VALUE  "MTCI".
  3943 20  CNS-ALL-TRHK-NAIYO-MWD  PIC  X(04)  VALUE  "MWD ".
  3944 20  CNS-ALL-TRHK-NAIYO-OABD PIC  X(04)  VALUE  "OABD".
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  69
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/USCNS.cpy)py)py)
  3945 20  CNS-ALL-TRHK-NAIYO-OASG PIC  X(04)  VALUE  "OASG".
  3946 20  CNS-ALL-TRHK-NAIYO-OBE  PIC  X(04)  VALUE  "OBE ".
  3947 20  CNS-ALL-TRHK-NAIYO-OBM  PIC  X(04)  VALUE  "OBM ".
  3948 20  CNS-ALL-TRHK-NAIYO-OBO  PIC  X(04)  VALUE  "OBO ".
  3949 20  CNS-ALL-TRHK-NAIYO-OBUS PIC  X(04)  VALUE  "OBUS".
  3950 20  CNS-ALL-TRHK-NAIYO-OBUY PIC  X(04)  VALUE  "OBUY".
  3951 20  CNS-ALL-TRHK-NAIYO-OCI  PIC  X(04)  VALUE  "OCI ".
  3952 20  CNS-ALL-TRHK-NAIYO-ODIV PIC  X(04)  VALUE  "ODIV".
  3953 20  CNS-ALL-TRHK-NAIYO-ODL  PIC  X(04)  VALUE  "ODL ".
  3954 20  CNS-ALL-TRHK-NAIYO-ODS  PIC  X(04)  VALUE  "ODS ".
  3955 20  CNS-ALL-TRHK-NAIYO-OEXE PIC  X(04)  VALUE  "OEXE".
  3956 20  CNS-ALL-TRHK-NAIYO-OGI  PIC  X(04)  VALUE  "OGI ".
  3957 20  CNS-ALL-TRHK-NAIYO-OPEN PIC  X(04)  VALUE  "OPEN".
  3958 20  CNS-ALL-TRHK-NAIYO-OSE  PIC  X(04)  VALUE  "OSE ".
  3959 20  CNS-ALL-TRHK-NAIYO-OSEL PIC  X(04)  VALUE  "OSEL".
  3960 20  CNS-ALL-TRHK-NAIYO-OSES PIC  X(04)  VALUE  "OSES".
  3961 20  CNS-ALL-TRHK-NAIYO-OSI  PIC  X(04)  VALUE  "OSI ".
  3962 20  CNS-ALL-TRHK-NAIYO-OSM  PIC  X(04)  VALUE  "OSM ".
  3963 20  CNS-ALL-TRHK-NAIYO-OSO  PIC  X(04)  VALUE  "OSO ".
  3964 20  CNS-ALL-TRHK-NAIYO-OSOT PIC  X(04)  VALUE  "OSOT".
  3965 20  CNS-ALL-TRHK-NAIYO-OUFL PIC  X(04)  VALUE  "OUFL".
  3966 20  CNS-ALL-TRHK-NAIYO-PO   PIC  X(04)  VALUE  "PO  ".
  3967 20  CNS-ALL-TRHK-NAIYO-PPAY PIC  X(04)  VALUE  "PPAY".
  3968 20  CNS-ALL-TRHK-NAIYO-PROF PIC  X(04)  VALUE  "PROF".
  3969 20  CNS-ALL-TRHK-NAIYO-QDIV PIC  X(04)  VALUE  "QDIV".
  3970 20  CNS-ALL-TRHK-NAIYO-RCTX PIC  X(04)  VALUE  "RCTX".
  3971 20  CNS-ALL-TRHK-NAIYO-RDIV PIC  X(04)  VALUE  "RDIV".
  3972 20  CNS-ALL-TRHK-NAIYO-RED  PIC  X(04)  VALUE  "RED ".
  3973 20  CNS-ALL-TRHK-NAIYO-REDD PIC  X(04)  VALUE  "REDD".
  3974 20  CNS-ALL-TRHK-NAIYO-REQ  PIC  X(04)  VALUE  "REQ ".
  3975 20  CNS-ALL-TRHK-NAIYO-RETR PIC  X(04)  VALUE  "RETR".
  3976 20  CNS-ALL-TRHK-NAIYO-REV  PIC  X(04)  VALUE  "REV ".
  3977 20  CNS-ALL-TRHK-NAIYO-RPAY PIC  X(04)  VALUE  "RPAY".
  3978 20  CNS-ALL-TRHK-NAIYO-RQBK PIC  X(04)  VALUE  "RQBK".
  3979 20  CNS-ALL-TRHK-NAIYO-RTXC PIC  X(04)  VALUE  "RTXC".
  3980 20  CNS-ALL-TRHK-NAIYO-SC   PIC  X(04)  VALUE  "SC  ".
  3981 20  CNS-ALL-TRHK-NAIYO-SDIV PIC  X(04)  VALUE  "SDIV".
  3982 20  CNS-ALL-TRHK-NAIYO-SE   PIC  X(04)  VALUE  "SE  ".
  3983 20  CNS-ALL-TRHK-NAIYO-SELL PIC  X(04)  VALUE  "SELL".
  3984 20  CNS-ALL-TRHK-NAIYO-SHSL PIC  X(04)  VALUE  "SHSL".
  3985 20  CNS-ALL-TRHK-NAIYO-SHT  PIC  X(04)  VALUE  "SHT ".
  3986 20  CNS-ALL-TRHK-NAIYO-SIN  PIC  X(04)  VALUE  "SIN ".
  3987 20  CNS-ALL-TRHK-NAIYO-SO   PIC  X(04)  VALUE  "SO  ".
  3988 20  CNS-ALL-TRHK-NAIYO-SOUT PIC  X(04)  VALUE  "SOUT".
  3989 20  CNS-ALL-TRHK-NAIYO-SPAY PIC  X(04)  VALUE  "SPAY".
  3990 20  CNS-ALL-TRHK-NAIYO-STAX PIC  X(04)  VALUE  "STAX".
  3991 20  CNS-ALL-TRHK-NAIYO-TAX  PIC  X(04)  VALUE  "TAX ".
  3992 20  CNS-ALL-TRHK-NAIYO-TAXR PIC  X(04)  VALUE  "TAXR".
  3993 20  CNS-ALL-TRHK-NAIYO-TRAN PIC  X(04)  VALUE  "TRAN".
  3994 20  CNS-ALL-TRHK-NAIYO-TREN PIC  X(04)  VALUE  "TREN".
  3995 20  CNS-ALL-TRHK-NAIYO-TRU  PIC  X(04)  VALUE  "TRU ".
  3996 20  CNS-ALL-TRHK-NAIYO-TST  PIC  X(04)  VALUE  "TST ".
  3997 20  CNS-ALL-TRHK-NAIYO-UCHG PIC  X(04)  VALUE  "UCHG".
  3998******************************************************************
  3999*----------      順区分
  4000******************************************************************
  4001*----------  銘柄（通貨）順
  4002 20  CNS-ORDER-KBN-1         PIC  X(01)  VALUE  "1".
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  70
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/USCNS.cpy)py)py)
  4003*----------  銘柄（発行国）順
  4004 20  CNS-ORDER-KBN-2         PIC  X(01)  VALUE  "2".
  4005*----------  日付順
  4006 20  CNS-ORDER-KBN-3         PIC  X(01)  VALUE  "3".
  4007******************************************************************
  4008*----------      取引実績報告書の編集項目
  4009******************************************************************
  4010*---------- 単価
  4011 20  CNS-TORI-TNK            PIC  X(03)  VALUE  "TNK".
  4012*---------- 額面
  4013 20  CNS-TORI-GAKUMEN        PIC  X(07)  VALUE  "GAKUMEN".
  4014*---------- 株数
  4015 20  CNS-TORI-KABSU          PIC  X(05)  VALUE  "KABSU".
  4016*---------- 数量
  4017 20  CNS-TORI-SRY            PIC  X(03)  VALUE  "SRY".
  4018*---------- 権利数量
  4019 20  CNS-TORI-KENRI-SURYO    PIC  X(11)  VALUE  "KENRI_SURYO".
  4020*---------- 数量単位
  4021 20  CNS-TORI-SURYO-TANI     PIC  X(10)  VALUE  "SURYO_TANI".
  4022*---------- 手数料
  4023 20  CNS-TORI-TSR            PIC  X(03)  VALUE  "TSR".
  4024*---------- 消費税
  4025 20  CNS-TORI-SHZ            PIC  X(03)  VALUE  "SHZ".
  4026*---------- その他費用
  4027 20  CNS-TORI-THY            PIC  X(03)  VALUE  "THY".
  4028*---------- 精算金額
  4029 20  CNS-TORI-SEISAN-KN      PIC  X(09)  VALUE  "SEISAN_KN".
  4030*---------- 約定金額
  4031 20  CNS-TORI-YKJ-KN         PIC  X(06)  VALUE  "YKJ_KN".
  4032*---------- 売買損益
  4033 20  CNS-TORI-BBSONEKI       PIC  X(08)  VALUE  "BBSONEKI".
  4034*---------- 為替差損益
  4035 20  CNS-TORI-UYTK-KWS-SNEKI PIC  X(14)  VALUE  "UYTK_KWS_SNEKI".
  4036*---------- 約定為替レート
  4037 20  CNS-TORI-YKJ-KWS        PIC  X(07)  VALUE  "YKJ_KWS".
  4038*---------- 経過利息為替レート
  4039 20  CNS-TORI-KEKA-RSK-KWS   PIC  X(12)  VALUE  "KEKA_RSK_KWS".
  4040*---------- 経過利息金額
  4041 20  CNS-TORI-KEKA-RSK-KGK   PIC  X(12)  VALUE  "KEKA_RSK_KGK".
  4042*---------- 前払金異動額
  4043 20  CNS-TORI-PPAYIDOG       PIC  X(08)  VALUE  "PPAYIDOG".
  4044*---------- 異動簿価
  4045 20  CNS-TORI-IDO-BOKA       PIC  X(08)  VALUE  "IDO_BOKA".
  4046*---------- 利金等損益勘定
  4047 20  CNS-TORI-RKSEKJ         PIC  X(06)  VALUE  "RKSEKJ".
  4048*---------- 引継前受・前払
  4049 20  CNS-TORI-HKTG-MEUKBRI   PIC  X(12)  VALUE  "HKTG_MEUKBRI".
  4050*---------- ストライクプライス
  4051 20  CNS-TORI-STRIKEPRICE    PIC  X(11)  VALUE  "STRIKEPRICE".
  4052*---------- スポットレート
  4053 20  CNS-TORI-SPOT-RATE      PIC  X(09)  VALUE  "SPOT_RATE".
  4054*---------- 予約レート
  4055 20  CNS-TORI-YOYAKU-RATE    PIC  X(11)  VALUE  "YOYAKU_RATE".
  4056*---------- 予約金額
  4057 20  CNS-TORI-YOYAKU-KN      PIC  X(09)  VALUE  "YOYAKU_KN".
  4058*---------- 建時予約金額
  4059 20  CNS-TORI-KZ-YOYAKU-KN   PIC  X(12)  VALUE  "KZ_YOYAKU_KN".
  4060*---------- 連動係数
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  71
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/USCNS.cpy)py)py)
  4061 20  CNS-TORI-FAKUTA-RENKSU  PIC  X(13)  VALUE  "FAKUTA_RENKSU".
  4062*---------- 口数
  4063 20  CNS-TORI-KOZU           PIC  X(04)  VALUE  "KOZU".
  4064*---------- 建時費用
  4065 20  CNS-TORI-TATE-HY        PIC  X(07)  VALUE  "TATE_HY".
  4066*---------- 利率
  4067 20  CNS-TORI-RRT            PIC  X(03)  VALUE  "RRT".
  4068*---------- 相殺予約レート
  4069 20  CNS-TORI-SS-YYK-RT      PIC  X(18)
  4070                             VALUE  "SOUSAI_YOYAKU_RATE".
  4071*---------- 相殺/実行金額
  4072 20  CNS-TORI-SS-JK-KN       PIC  X(15)  VALUE  "SOUSAI_JIKOU_KN".
  4073*---------- 利金等損益
  4074 20  CNS-TORI-RKN-SNEKI      PIC  X(09)  VALUE  "RKN_SNEKI".
  4075*---------- 経過利息
  4076 20  CNS-TORI-KKRS           PIC  X(04)  VALUE  "KKRS".
  4077*---------- 前払金異動
  4078 20  CNS-TORI-PPAY-IDO       PIC  X(08)  VALUE  "PPAY_IDO".
  4079*---------- 実現損益
  4080 20  CNS-TORI-JTG-SNEKI      PIC  X(09)  VALUE  "JTG_SNEKI".
  4081*---------- 建時約定金額
  4082 20  CNS-TORI-KSG-YJKG       PIC  X(08)  VALUE  "KSG_YJKG".
  4083*---------- 数量/額面
  4084 20  CNS-TORI-SURYO-GKM      PIC  X(09)  VALUE  "SURYO_GKM".
  4085******************************************************************
  4086*----------      残高実績報告書の編集項目
  4087******************************************************************
  4088*---------- 簿価単価
  4089 20  CNS-BOKA-TNK            PIC  X(08)  VALUE  "BOKA_TNK".
  4090*---------- 評価損益(市場通貨)
  4091 20  CNS-HYK-SNEKI-BC        PIC  X(12)  VALUE  "HYK_SNEKI_BC".
  4092*---------- 経過利息
  4093 20  CNS-KEKA-RS             PIC  X(07)  VALUE  "KEKA_RS".
  4094*---------- 未払費用
  4095 20  CNS-MIHA-HIYO           PIC  X(09)  VALUE  "MIHA_HIYO".
  4096*---------- 未払費用評価
  4097 20  CNS-MIHA-HIYO-HYK-SEK   PIC  X(17)
  4098                             VALUE  "MIHA_HIYO_HYK_SEK".
  4099*---------- 未払評価損益
  4100 20  CNS-MIHA-HYK-SNEKI      PIC  X(14)  VALUE  "MIHA_HYK_SNEKI".
  4101*---------- 前受払プレミアム
  4102 20  CNS-MAE-UKE-HARAI       PIC  X(13)  VALUE  "MAE_UKE_HARAI".
  4103*---------- 還付予定評価
  4104 20  CNS-KANNPU-YOTEI-HYK    PIC  X(16)
  4105                             VALUE  "KANNPU_YOTEI_HYK".
  4106*---------- 前払金評価額
  4107 20  CNS-KPPAY-HYK-GK        PIC  X(12)  VALUE  "KPPAY_HYK_GK".
  4108*---------- 還付評価損益
  4109 20  CNS-KANNPU-HYK-SNEKI    PIC  X(16)
  4110                             VALUE  "KANNPU_HYK_SNEKI".
  4111*---------- 前払評価損益
  4112 20  CNS-KPPAY-HYK-SEK       PIC  X(13)  VALUE  "KPPAY_HYK_SEK".
  4113*---------- 数量
  4114 20  CNS-ZNDK-SRY            PIC  X(03)  VALUE  "SRY".
  4115*---------- 数量単位
  4116 20  CNS-ZNDK-SURYO-TANI     PIC  X(10)  VALUE  "SURYO_TANI".
  4117*---------- 株数
  4118 20  CNS-ZNDK-KABSU          PIC  X(05)  VALUE  "KABSU".
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  72
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/USCNS.cpy)py)py)
  4119*---------- 額面
  4120 20  CNS-ZNDK-GAKUMEN        PIC  X(07)  VALUE  "GAKUMEN".
  4121*---------- 口数
  4122 20  CNS-ZNDK-KOZU           PIC  X(04)  VALUE  "KOZU".
  4123*---------- 数量／額面
  4124 20  CNS-ZNDK-SRY-GAKUME     PIC  X(10)  VALUE  "SRY_GAKUME".
  4125*---------- 予約レート
  4126 20  CNS-ZNDK-YOYAKU-RATE    PIC  X(11)  VALUE  "YOYAKU_RATE".
  4127*---------- 時価単価
  4128 20  CNS-ZNDK-CP-TNK         PIC  X(06)  VALUE  "CP_TNK".
  4129*---------- 簿価金額(市場通貨)
  4130 20  CNS-ZNDK-BOKA-KN-BC     PIC  X(10)  VALUE  "BOKA_KN_BC".
  4131*---------- 簿価金額(運用通貨)
  4132 20  CNS-ZNDK-BOKA-KN-LC     PIC  X(10)  VALUE  "BOKA_KN_LC".
  4133*---------- 評価金額(対象通貨)
  4134 20  CNS-ZNDK-HYK-KN-TARGET  PIC  X(13)  VALUE  "HYK_KN_TARGET".
  4135*---------- 評価金額(市場通貨)
  4136 20  CNS-ZNDK-HYK-KN-BC      PIC  X(09)  VALUE  "HYK_KN_BC".
  4137*---------- 評価金額(運用通貨)
  4138 20  CNS-ZNDK-HYK-KN-LC      PIC  X(09)  VALUE  "HYK_KN_LC".
  4139*---------- 評価損益(対象通貨)
  4140 20  CNS-ZNDK-HYK-SNEKI-TARGET
  4141                             PIC  X(16)
  4142                             VALUE  "HYK_SNEKI_TARGET".
  4143*---------- 評価損益(運用通貨)
  4144 20  CNS-ZNDK-HYK-SNEKI-UNYO
  4145                             PIC  X(14)
  4146                             VALUE  "HYK_SNEKI_UNYO".
  4147*---------- 損益率(対象通貨)
  4148 20  CNS-ZNDK-SEK-RT-TARGET  PIC  X(13)  VALUE  "SEK_RT_TARGET".
  4149*---------- 損益率(運用通貨)
  4150 20  CNS-ZNDK-SEK-RT-UNYO    PIC  X(11)  VALUE  "SEK_RT_UNYO".
  4151*---------- 予約金額(取引)
  4152 20  CNS-ZNDK-YOYAKU-KN-TRHK PIC  X(14)
  4153                             VALUE  "YOYAKU_KN_TRHK".
  4154*---------- 予約金額(対象)
  4155 20  CNS-ZNDK-YOYAKU-KN-TARGE
  4156                             PIC  X(15)
  4157                             VALUE  "YOYAKU_KN_TARGE".
  4158*---------- 予約金額(運用)
  4159 20  CNS-ZNDK-YOYAKU-KN-UNYO PIC  X(14)
  4160                             VALUE  "YOYAKU_KN_UNYO".
  4161*---------- 取引－対象(F)
  4162 20  CNS-ZNDK-TRHK-TARGET-F  PIC  X(13)
  4163                             VALUE  "TRHK_TARGET_F".
  4164*---------- 対象－運用(S)
  4165 20  CNS-ZNDK-TARGET-UNYO-F  PIC  X(13)
  4166                             VALUE  "TARGET_UNYO_F".
  4167*---------- 未収配当金(市場通貨)
  4168 20  CNS-ZNDK-MISYU-HAITKN-BC
  4169                             PIC  X(15)
  4170                             VALUE  "MISYU_HAITKN_BC".
  4171*---------- 未収配当金(運用通貨)
  4172 20  CNS-ZNDK-MISYU-HAITKN-LC
  4173                             PIC  X(15)
  4174                             VALUE  "MISYU_HAITKN_LC".
  4175*---------- 未収収益(市場通貨)
  4176 20  CNS-ZNDK-MISYU-SYUEKI-BC
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  73
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/USCNS.cpy)py)py)
  4177                             PIC  X(15)
  4178                             VALUE  "MISYU_SYUEKI_BC".
  4179*---------- 未収収益(運用通貨)
  4180 20  CNS-ZNDK-MISYU-SYUEKI-LC
  4181                             PIC  X(15)
  4182                             VALUE  "MISYU_SYUEKI_LC".
  4183*---------- 未収分配金(市場通貨)
  4184 20  CNS-ZNDK-MISYU-BUPAIKI-BC
  4185                             PIC  X(16)
  4186                             VALUE  "MISYU_BUPAIKI_BC".
  4187*---------- 未収分配金(運用通貨)
  4188 20  CNS-ZNDK-MISYU-BUPAIKI-LC
  4189                             PIC  X(16)
  4190                             VALUE  "MISYU_BUPAIKI_LC".
  4191*---------- 前払金(市場通貨)
  4192 20  CNS-ZNDK-MAEBR-KIN-BC   PIC  X(12) VALUE  "MAEBR_KIN_BC".
  4193*---------- 前払金(運用通貨)
  4194 20  CNS-ZNDK-MAEBR-KIN-LC   PIC  X(12) VALUE  "MAEBR_KIN_LC".
  4195*---------- 源泉税額(市場通貨)
  4196 20  CNS-ZNDK-GENSEN-ZEGAKU-BC
  4197                             PIC  X(16) VALUE  "GENSEN_ZEGAKU_BC".
  4198*---------- 源泉税額(運用通貨)
  4199 20  CNS-ZNDK-GENSEN-ZEGAKU-LC
  4200                             PIC  X(16) VALUE  "GENSEN_ZEGAKU_LC".
  4201*---------- 還付予定(市場通貨)
  4202 20  CNS-ZNDK-KANNPU-YOTEI-BC
  4203                             PIC  X(15) VALUE  "KANNPU_YOTEI_BC".
  4204*---------- 還付予定(運用通貨)
  4205 20  CNS-ZNDK-KANNPU-YOTEI-LC
  4206                             PIC  X(15) VALUE  "KANNPU_YOTEI_LC".
  4207*---------- 建玉約定金額(市場通貨)
  4208 20  CNS-ZNDK-TGYK-BC        PIC  X(07) VALUE  "TGYK_BC".
  4209*---------- 建玉約定金額(運用通貨)
  4210 20  CNS-ZNDK-TGYK-LC        PIC  X(07) VALUE  "TGYK_LC".
  4211*---------- 建玉手数料(市場通貨)
  4212 20  CNS-ZNDK-TGTESRY-BC     PIC  X(10) VALUE  "TGTESRY_BC".
  4213*---------- 建玉手数料(運用通貨)
  4214 20  CNS-ZNDK-TGTESRY-LC     PIC  X(10) VALUE  "TGTESRY_LC".
  4215*---------- 建玉消費税(市場通貨)
  4216 20  CNS-ZNDK-SJTK-TG-S-TAX
  4217                             PIC  X(13) VALUE  "SJTK_TG_S_TAX".
  4218*---------- 建玉消費税(運用通貨)
  4219 20  CNS-ZNDK-UYTK-TG-S-TAX
  4220                             PIC  X(13) VALUE  "UYTK_TG_S_TAX".
  4221*---------- 建玉その他費用(市場)
  4222 20  CNS-ZNDK-SJTK-TG-ELS-HIYO
  4223                             PIC  X(16) VALUE  "SJTK_TG_ELS_HIYO".
  4224*---------- 建玉その他費用(運用)
  4225 20  CNS-ZNDK-UYTK-TG-ELS-HIYO
  4226                             PIC  X(16) VALUE  "UYTK_TG_ELS_HIYO".
  4227*---------- 評価レート
  4228 20  CNS-ZNDK-HYK-KN-RATE    PIC  X(11) VALUE  "HYK_KN_RATE".
  4229*---------- 未収収益評価レート
  4230 20  CNS-ZNDK-MSY-SYK-HYK-RT PIC  X(14) VALUE  "MSY_SYK_HYK_RT".
  4231*---------- 源泉税評価レート
  4232 20  CNS-ZNDK-GENSEN-TAX-HYK PIC  X(14) VALUE  "GENSEN_TAX_HYK".
  4233*---------- 利率
  4234 20  CNS-ZNDK-RRT            PIC  X(03) VALUE  "RRT".
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  74
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/USCNS.cpy)py)py)
  4235*---------- ストライクプライス
  4236 20  CNS-ZNDK-STRIKEPRICE    PIC  X(11)  VALUE  "STRIKEPRICE".
  4237*---------- ファクター・連動係数
  4238 20  CNS-ZNDK-FAKUTA-RENKSU  PIC  X(13)  VALUE  "FAKUTA_RENKSU".
  4239******************************************************************
  4240*----------      帳票名称（略式、40バイト以内）
  4241******************************************************************
  4242*----------  取引実績（国内株式）
  4243 20  CNS-PUS0101-NM-RYAKU    PIC  X(20)
  4244     VALUE  "取引実績（国内株式）".
  4245*----------  取引実績（円貨建債券）
  4246 20  CNS-PUS0102-NM-RYAKU    PIC  X(22)
  4247     VALUE  "取引実績（円貨建債券）".
  4248*----------  取引実績（投資信託）
  4249 20  CNS-PUS0103-NM-RYAKU    PIC  X(20)
  4250     VALUE  "取引実績（投資信託）".
  4251*----------  取引実績（為替先物）
  4252 20  CNS-PUS0104-NM-RYAKU    PIC  X(20)
  4253     VALUE  "取引実績（為替先物）".
  4254*----------  取引実績（先物）
  4255 20  CNS-PUS0105-NM-RYAKU    PIC  X(16)
  4256     VALUE  "取引実績（先物）".
  4257*----------  取引実績（オプション）
  4258 20  CNS-PUS0106-NM-RYAKU    PIC  X(22)
  4259     VALUE  "取引実績（オプション）".
  4260*----------  取引実績（外国株式）
  4261 20  CNS-PUS0107-NM-RYAKU    PIC  X(20)
  4262     VALUE  "取引実績（外国株式）".
  4263*----------  取引実績（外貨建債券）
  4264 20  CNS-PUS0108-NM-RYAKU    PIC  X(22)
  4265     VALUE  "取引実績（外貨建債券）".
  4266*----------  取引実績（その他）
  4267 20  CNS-PUS0198-NM-RYAKU    PIC  X(18)
  4268     VALUE  "取引実績（その他）".
  4269*----------  取引実績（その他先物・オプション）
  4270 20  CNS-PUS0199-NM-RYAKU    PIC  X(34)
  4271     VALUE  "取引実績（その他先物・オプション）".
  4272*----------  銘柄別残高実績（国内株式）
  4273 20  CNS-PUS0201-NM-RYAKU    PIC  X(26)
  4274     VALUE  "銘柄別残高実績（国内株式）".
  4275*----------  銘柄別残高実績（円貨建債券）
  4276 20  CNS-PUS0202-NM-RYAKU    PIC  X(28)
  4277     VALUE  "銘柄別残高実績（円貨建債券）".
  4278*----------  銘柄別残高実績（投信）
  4279 20  CNS-PUS0203-NM-RYAKU    PIC  X(22)
  4280     VALUE  "銘柄別残高実績（投信）".
  4281*----------  銘柄別残高実績（為替先物）
  4282 20  CNS-PUS0204-NM-RYAKU    PIC  X(26)
  4283     VALUE  "銘柄別残高実績（為替先物）".
  4284*----------  銘柄別残高実績（先物）
  4285 20  CNS-PUS0205-NM-RYAKU    PIC  X(22)
  4286     VALUE  "銘柄別残高実績（先物）".
  4287*----------  銘柄別残高実績（オプション）
  4288 20  CNS-PUS0206-NM-RYAKU    PIC  X(28)
  4289     VALUE  "銘柄別残高実績（オプション）".
  4290*----------  銘柄別残高実績（外国株式）
  4291 20  CNS-PUS0207-NM-RYAKU    PIC  X(26)
  4292     VALUE  "銘柄別残高実績（外国株式）".
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  75
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/USCNS.cpy)py)py)
  4293*----------  銘柄別残高実績（外貨建債券）
  4294 20  CNS-PUS0208-NM-RYAKU    PIC  X(28)
  4295     VALUE  "銘柄別残高実績（外貨建債券）".
  4296*----------  銘柄別残高実績（その他）
  4297 20  CNS-PUS0298-NM-RYAKU    PIC  X(24)
  4298     VALUE  "銘柄別残高実績（その他）".
  4299*----------  銘柄別残高実績（その他先物・オプション）
  4300 20  CNS-PUS0299-NM-RYAKU    PIC  X(40)
  4301     VALUE  "銘柄別残高実績（その他先物・オプション）".
  4302*----------  取引集計表（ファンド・商品別）
  4303 20  CNS-PUS0301-NM-RYAKU    PIC  X(30)
  4304     VALUE  "取引集計表（ファンド・商品別）".
  4305*----------  取引集計表（ファンド・ブローカー別）
  4306 20  CNS-PUS0302-NM-RYAKU    PIC  X(36)
  4307     VALUE  "取引集計表（ファンド・ブローカー別）".
  4308*----------  取引集計表（商品別）
  4309 20  CNS-PUS0303-NM-RYAKU    PIC  X(20)
  4310     VALUE  "取引集計表（商品別）".
  4311*----------  取引集計表（ブローカー別）
  4312 20  CNS-PUS0304-NM-RYAKU    PIC  X(26)
  4313     VALUE  "取引集計表（ブローカー別）".
  4314*----------  運用実績表（資産運用状況報告書）
  4315 20  CNS-PUS0401-NM-RYAKU    PIC  X(32)
  4316     VALUE  "運用実績表（資産運用状況報告書）".
  4317*----------  運用実績表（資産運用状況表）
  4318 20  CNS-PUS0402-NM-RYAKU    PIC  X(28)
  4319     VALUE  "運用実績表（資産運用状況表）".
  4320*----------  運用実績表（収益状況表）
  4321 20  CNS-PUS0403-NM-RYAKU    PIC  X(24)
  4322     VALUE  "運用実績表（収益状況表）".
  4323*----------  残高損益構成表
  4324 20  CNS-PUS0501-NM-RYAKU    PIC  X(14)
  4325     VALUE  "残高損益構成表".
  4326*----------  国別・資産別運用状況
  4327 20  CNS-PUS0601-NM-RYAKU    PIC  X(20)
  4328     VALUE  "国別・資産別運用状況".
  4329*----------  国別・資産別運用状況（内訳）
  4330 20  CNS-PUS0602-NM-RYAKU    PIC  X(28)
  4331     VALUE  "国別・資産別運用状況（内訳）".
  4332*----------  取引状況表（ファンド個別）
  4333 20  CNS-PUS0701-NM-RYAKU    PIC  X(26)
  4334     VALUE  "取引状況表（ファンド個別）".
  4335*----------  取引状況表（ファンド集計）
  4336 20  CNS-PUS0702-NM-RYAKU    PIC  X(26)
  4337     VALUE  "取引状況表（ファンド集計）".
  4338*----------  配当金実績（国内株式）
  4339 20  CNS-PUS0801-NM-RYAKU    PIC  X(22)
  4340     VALUE  "配当金実績（国内株式）".
  4341*----------  配当金実績（外国株式）
  4342 20  CNS-PUS0802-NM-RYAKU    PIC  X(22)
  4343     VALUE  "配当金実績（外国株式）".
  4344*----------  利金実績（円貨建債券）
  4345 20  CNS-PUS0803-NM-RYAKU    PIC  X(22)
  4346     VALUE  "利金実績（円貨建債券）".
  4347*----------  利金実績（外貨建債券）
  4348 20  CNS-PUS0804-NM-RYAKU    PIC  X(22)
  4349     VALUE  "利金実績（外貨建債券）".
  4350******************************************************************
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  76
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/USCNS.cpy)py)py)
  4351*----------      US証券種別コンスタント
  4352******************************************************************
  4353*----------  未収金
  4354 20  CNS-SKSBT-ACR           PIC  X(04)  VALUE  "ACR ".
  4355*----------  未払金
  4356 20  CNS-SKSBT-ACP           PIC  X(04)  VALUE  "ACP ".
  4357*----------  未収金（証拠金）
  4358 20  CNS-SKSBT-MACR          PIC  X(04)  VALUE  "MACR".
  4359*----------  未払金（証拠金）
  4360 20  CNS-SKSBT-MACP          PIC  X(04)  VALUE  "MACP".
  4361*----------  その他外国株式（還付金）
  4362 20  CNS-SKSBT-ETRS          PIC  X(04)  VALUE  "ETRS".
  4363*----------  その他外国債券（還付金）
  4364 20  CNS-SKSBT-ETRB          PIC  X(04)  VALUE  "ETRB".
  4365*----------   証券種別(その他資産)
  4366 20  CNS-SKSBT-OOET          PIC  X(04)  VALUE  "OOET".
  4367*----------  決算処理
  4368 20  CNS-SKSBT-KSSL          PIC  X(04)  VALUE  "KSSL".
  4369*----------  ファンド全体（ファンド費用・利益）
  4370 20  CNS-SKSBT-FAEP          PIC  X(04)  VALUE  "FAEP".
  4371*----------  プログラムID
  4372   05  CNS-PGM-ID            PIC  X(08)  VALUE  "MUSR2651".
  4373*----------  運用成果残高
  4374   05  CNS-TBL-TKUSZT01      PIC  X(08)  VALUE  "TKUSZT01".
  4375*----------  進捗管理
  4376   05  CNS-TBL-TKDYAA40      PIC  X(08)  VALUE  "TKDYAA40".
  4377*----------  ポートフォリオ評価系列
  4378*******         テーマ2693     20100404 修正  開始        ********
  4379   05  CNS-TBL-TKPFZK04      PIC  X(08)  VALUE  "TKPFZK04".
  4380*******         テーマ2693     20100404 修正  終了        ********
  4381*******         テーマ3406     20130117 修正  開始        ********
  4382*----------  ＳＢＡ残高データ接続
  4383   05  CNS-SBA-ZANDAKA-SETUZOKU
  4384                             PIC  X(07)  VALUE  "T6820US".
  4385*******         テーマ3406     20130117 修正  終了        ********
  4386   05  CNS-BL0001            PIC  X(06)  VALUE  "BL0001".
  4387   05  CNS-RS                PIC  X(02)  VALUE  "RS".
  4388   05  CNS-R                 PIC  X(01)  VALUE  "R".
  4389   05  CNS-RX-TEXT           PIC  X(02)  VALUE  "RX".
  4390   05  CNS-PATH-05           PIC  X(02)  VALUE  "05".
  4391   05  CNS-TEXT-OTHR         PIC  X(04)  VALUE  "OTHR".
  4392   05  CNS-TEXT-OTH          PIC  X(04)  VALUE  "OTH ".
  4393   05  CNS-TEXT-WR           PIC  X(04)  VALUE  "WR  ".
  4394   05  CNS-TEXT-WRD          PIC  X(04)  VALUE  "WRD ".
  4395   05  CNS-TEXT-SUPN         PIC  X(04)  VALUE  "SUPN".
  4396   05  CNS-TEXT-SUP          PIC  X(04)  VALUE  "SUP ".
  4397   05  CNS-OTHR              PIC  X(04)  VALUE  "OTHR".
  4398*------------------ <連結障害841の対応 START>---------------------
  4399   05  CNS-SPACE-99          PIC  X(04)  VALUE  "99  ".
  4400*------------------ <連結障害841の対応 END>-----------------------
  4401*----------  置換文字
  4402   05  CNS-TEXT-1            PIC  X(30)  VALUE
  4403                                 "処理対象実行状況管理明細データ".
  4404*----------  最大連番
  4405   05  CNS-SAIDAI-RBN-08     PIC  9(01)  VALUE  8.
  4406*----------  拠点サーバ区分
  4407   05  CNS-KYOTEN-KBN-02     PIC  X(02)  VALUE  "02".
  4408   05  CNS-TEXT-TK1          PIC  X(14)  VALUE  "運用通貨コード".
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  77
* MUSR2651.cob                                                     )py)py)
  4409   05  CNS-BIKKOU-1          PIC  X(07)  VALUE  "備考_１".
  4410   05  CNS-D001              PIC  X(04)  VALUE  "$001".
  4411   05  CNS-TEXT-T            PIC  X(01)  VALUE  "T".
  4412   05  CNS-MEG-RECVLC        PIC  X(06)  VALUE  "RECVLC".
  4413   05  CNS-MEG-RECVBC        PIC  X(06)  VALUE  "RECVBC".
  4414   05  CNS-MEG-PAYLC         PIC  X(05)  VALUE  "PAYLC".
  4415   05  CNS-MEG-PAYBC         PIC  X(05)  VALUE  "PAYBC".
  4416   05  CNS-MEG-PAYLC2        PIC  X(06)  VALUE  "PAYLC2".
  4417   05  CNS-MEG-PAYBC2        PIC  X(06)  VALUE  "PAYBC2".
  4418   05  CNS-MEG-PAYLC3        PIC  X(06)  VALUE  "PAYLC3".
  4419   05  CNS-MEG-PAYBC3        PIC  X(06)  VALUE  "PAYBC3".
  4420   05  CNS-MEG-ACRECVLC      PIC  X(08)  VALUE  "ACRECVLC".
  4421   05  CNS-MEG-ACPAYLC       PIC  X(07)  VALUE  "ACPAYLC".
  4422   05  CNS-MEG-MARECVLC      PIC  X(08)  VALUE  "MARECVLC".
  4423   05  CNS-MEG-MARECVBC      PIC  X(08)  VALUE  "MARECVBC".
  4424   05  CNS-MEG-MAPAYLC       PIC  X(07)  VALUE  "MAPAYLC".
  4425   05  CNS-MEG-MAPAYBC       PIC  X(07)  VALUE  "MAPAYBC".
  4426   05  CNS-EX                PIC  X(02)  VALUE  "EX".
  4427   05  CNS-CASH              PIC  X(04)  VALUE  "CASH".
  4428   05  CNS-SJTK              PIC  X(11)  VALUE  "unpaid cost".
  4429   05  CNS-MEG-SJTK-J        PIC  X(08)  VALUE  "未払費用".
  4430   05  CNS-UNPAIDCOST        PIC  X(10)  VALUE  "UNPAIDCOST".
  4431   05  CNS-ACSU              PIC  X(04)  VALUE  "ACSU".
  4432   05  CNS-CFEU              PIC  X(04)  VALUE  "CFEU".
  4433   05  CNS-CSOU              PIC  X(04)  VALUE  "CSOU".
  4434   05  CNS-CSTU              PIC  X(04)  VALUE  "CSTU".
  4435   05  CNS-STXU              PIC  X(04)  VALUE  "STXU".
  4436   05  CNS-TSTU              PIC  X(04)  VALUE  "TSTU".
  4437   05  CNS-DATA-TEXT         PIC  X(14)
  4438                             VALUE  "進捗管理データ".
  4439   05  CNS-RTN-112           PIC  X(03)  VALUE  "112".
  4440   05  CNS-TR-UN             PIC  X(20)
  4441                             VALUE  "取引運用為替換算情報".
  4442*******         テーマ3422              修正  開始        ********
  4443   05  CNS-KS-UN             PIC  X(20)
  4444                             VALUE  "取引決済為替換算情報".
  4445*******         テーマ3422              修正  終了        ********
  4446   05  CNS-HYK-EX            PIC  X(16)
  4447                             VALUE  "評価為替取得方法".
  4448   05  CNS-EX-KRTU           PIC  X(08)  VALUE  "為替系列".
  4449   05  CNS-TASK-T7080US      PIC  X(07)  VALUE  "T7080US".
  4450   05  CNS-KUNI-CD-RYAKU     PIC  X(13)  VALUE  "国コード_略式".
  4451   05  CNS-MISYU-GAIKA-J     PIC  X(14)  VALUE  "未収金（外貨）".
  4452   05  CNS-MISYU-GAIKA-E     PIC  X(14)  VALUE  "recievable(LC)".
  4453   05  CNS-MISYU-UNYO-J      PIC  X(14)  VALUE  "未収金（運用）".
  4454   05  CNS-MISYU-UNYO-E      PIC  X(14)  VALUE  "recievable(BC)".
  4455   05  CNS-MIBARAI-GAIKA-J   PIC  X(14)  VALUE  "未払金（外貨）".
  4456   05  CNS-MIBARAI-GAIKA-E   PIC  X(11)  VALUE  "payable(LC)".
  4457   05  CNS-MIBARAI-UNYO-J    PIC  X(14)  VALUE  "未払金（運用）".
  4458   05  CNS-MIBARAI-UNYO-E    PIC  X(11)  VALUE  "payable(BC)".
  4459   05  CNS-YKJ               PIC  X(08)  VALUE  "基準日：".
  4460   05  CNS-MEG-CD-AIFA       PIC  X(26)
  4461                             VALUE  "銘柄コードリファレンス情報".
  4462   05  CNS-GAIBU-CD          PIC  X(14)  VALUE  "；外部コード：".
  4463   05  CNS-MEG-CD            PIC  X(10)  VALUE  "銘柄コード".
  4464   05  CNS-GX-ZANKO          PIC  X(22)
  4465                             VALUE  "ＧＸ残高（全ファイル）".
  4466   05  CNS-TRHK-TUKA-CD      PIC  X(16)
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  78
* MUSR2651.cob                                                     )py)py)
  4467                             VALUE  "取引通貨コード：".
  4468   05  CNS-KZYN-YMD          PIC  X(10)  VALUE  "；基準日：".
  4469   05  CNS-PRI-J             PIC  X(04)  VALUE  "元本".
  4470   05  CNS-PRI-E             PIC  X(09)  VALUE  "PRINCIPAL".
  4471   05  CNS-18-10             PIC  S9(08)V9(10)
  4472                             VALUE  99999999.9999999999.
  4473   05  CNS-18-10-2           PIC  S9(08)V9(10)
  4474                             VALUE  -99999999.9999999999.
  4475   05  CNS-MEG-TEXT          PIC  X(12)  VALUE  "銘柄コード：".
  4476   05  CNS-TUK-TEXT          PIC  X(12)  VALUE  "；銘柄通貨：".
  4477   05  CNS-SEC-TEXT          PIC  X(12)  VALUE  "；証券種別：".
  4478   05  CNS-SSE-TEXT          PIC  X(12)  VALUE  "；株式種別：".
  4479*----------  GX残高データ接続
  4480   05  CNS-ST01100           PIC  X(07)  VALUE  "ST01100".
  4481   05  CNS-MSG-E000355       PIC  X(07)  VALUE  "E000355".
  4482   05  CNS-MSG-I000653       PIC  X(07)  VALUE  "I000653".
  4483*----------  テーマ3276　開始
  4484   05  CNS-CMP-1054          PIC  X(04)  VALUE  "1054".
  4485   05  CNS-MEG-RES1          PIC  X(04)  VALUE  "RES1".
  4486   05  CNS-SEC-XMOS          PIC  X(04)  VALUE  "XMOS".
  4487   05  CNS-SEC-S             PIC  X(01)  VALUE  "S".
  4488*----------  テーマ3276　終了
  4489******************************************************************
  4490*                フラグエリア
  4491******************************************************************
  4492 01  FLG-AREA.
  4493*---------- デフォルトリファレンスコードフラグ
  4494   05  FLG-DEFAULT-KRTU-CD   PIC  9(01).
  4495*----------  オラクル接続フラグ
  4496   05  FLG-ORA-CONNECT       PIC  9(01).
  4497*----------  カーソルオープンフラグ
  4498   05  FLG-CR-OPEN           PIC  9(01).
  4499*----------  カーソルオープンフラグ
  4500   05  FLG-CR-OPEN2          PIC  9(01).
  4501*******         テーマ2693     20100404 修正  開始        ********
  4502*----------  カーソルオープンフラグ
  4503   05  FLG-CR-OPEN3          PIC  9(01).
  4504*******         テーマ2693     20100404 修正  終了        ********
  4505*----------  STOP
  4506   05  FLG-STOP              PIC  9(01).
  4507*----------  STOP
  4508   05  FLG-STOP-2            PIC  9(01).
  4509*----------  FETCH-END
  4510   05  FLG-FETCH-END2        PIC  9(01).
  4511*----------  システムエラーフラグ
  4512   05  FLG-SYSTEM-ERR        PIC  9(01).
  4513*----------  後処理業務エラーフラグ
  4514   05  FLG-GYOMU-ERR         PIC  9(01).
  4515*----------  明細業務エラーフラグ
  4516   05  FLG-MEISAI-GYOMU-ERR  PIC  9(01).
  4517*----------  ファイルオープンフラグ
  4518   05  FLG-FILE-OPEN         PIC  9(01).
  4519*----------  ファイルオープンフラグ
  4520   05  FLG-FILE-OPEN-2       PIC  9(01).
  4521*----------  ファイルオープンフラグ
  4522   05  FLG-FILE-OPEN-3       PIC  9(01).
  4523*----------  ファイルオープンフラグ
  4524   05  FLG-FILE-OPEN-4       PIC  9(01).
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  79
* MUSR2651.cob                                                     )py)py)
  4525*----------  ファイルオープンフラグ
  4526   05  FLG-FILE-OPEN-5       PIC  9(01).
  4527*----------  ファイルオープンフラグ
  4528   05  FLG-FILE-OPEN-6       PIC  9(01).
  4529*----------  ファイルオープンフラグ
  4530   05  FLG-FILE-OPEN-7       PIC  9(01).
  4531*----------  ファイルオープンフラグ
  4532   05  FLG-FILE-OPEN-8       PIC  9(01).
  4533*----------  ワーク進捗フラグ
  4534   05  FLG-UPD               PIC  9(01).
  4535*----------  DATA-OUT判断フラグ
  4536   05  FLG-DATA-OUT          PIC  9(01).
  4537*----------  次のワークポートフォリオ明細ド
  4538   05  FLG-NEXT-MEISAI       PIC  9(01).
  4539******************************************************************
  4540*                SQL  エリア
  4541******************************************************************
  4542 01  SQL-AREA.
  4543   05  SQL-SELECT.
  4544*----------  SELECT
  4545     10  FILLER              PIC  X(07)
  4546         VALUE  "SELECT ".
  4547*----------  利用会社コード
  4548     10  FILLER              PIC  X(13)
  4549         VALUE  " RIYO_CMP_CD,".
  4550*----------  ファンドコード
  4551     10  FILLER              PIC  X(09)
  4552         VALUE  " FUND_CD,".
  4553*----------  ポートフォリオコード
  4554     10  FILLER              PIC  X(08)
  4555         VALUE  " PTF_CD,".
  4556*----------  約定受渡区分
  4557     10  FILLER              PIC  X(11)
  4558         VALUE  " YJ_UW_KBN,".
  4559*----------  残高日付
  4560     10  FILLER              PIC  X(11)
  4561         VALUE  " ZANTK_YMD,".
  4562*----------  決算日断面区分
  4563     10  FILLER              PIC  X(17)
  4564         VALUE  " KSN_YMD_DMN_KBN,".
  4565*----------  評価系列コード
  4566     10  FILLER              PIC  X(13)
  4567         VALUE  " HYK_KRTU_CD,".
  4568*----------  証券種別コード
  4569     10  FILLER              PIC  X(11)
  4570         VALUE  "SEC_SBT_CD,".
  4571*----------  取消フラグ
  4572     10  FILLER              PIC  X(09)
  4573         VALUE  " DEL_KBN,".
  4574*----------  確定フラグ
  4575     10  FILLER              PIC  X(08)
  4576         VALUE  " KT_KBN,".
  4577*----------  取引通貨
  4578     10  FILLER              PIC  X(11)
  4579         VALUE  " TRHK_TUKA,".
  4580*----------  為替取引決済通貨
  4581     10  FILLER              PIC  X(16)
  4582         VALUE  " KWS_TH_TUKA_CD,".
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  80
* MUSR2651.cob                                                     )py)py)
  4583*----------  発行国コード
  4584     10  FILLER              PIC  X(09)
  4585         VALUE  " HAKO_CD,".
  4586*----------  銘柄コード
  4587     10  FILLER              PIC  X(08)
  4588         VALUE  " MEG_CD,".
  4589*----------  資産負債・買建売建フラグ
  4590     10  FILLER              PIC  X(10)
  4591         VALUE  " TATE_FLG,".
  4592*----------  個別建玉約定日
  4593     10  FILLER              PIC  X(12)
  4594         VALUE  " TG_YKJ_YMD,".
  4595*----------  個別玉管理番号
  4596     10  FILLER              PIC  X(13)
  4597         VALUE  " KB_KANRI_ID,".
  4598*----------  カストディコード
  4599     10  FILLER              PIC  X(09)
  4600         VALUE  " CAST_CD,".
  4601*----------  保有数量
  4602     10  FILLER              PIC  X(11)
  4603         VALUE  " HOU_SURYO,".
  4604*----------  数量単位
  4605     10  FILLER              PIC  X(12)
  4606         VALUE  " SURYO_TANI,".
  4607*----------  取得金額(取引通貨)
  4608     10  FILLER              PIC  X(13)
  4609         VALUE  " THTK_ST_KNG,".
  4610*----------  取得単価(取引通貨)
  4611     10  FILLER              PIC  X(13)
  4612         VALUE  " THTK_ST_TNK,".
  4613*----------  時価(取引通貨)
  4614     10  FILLER              PIC  X(12)
  4615         VALUE  " CP_KRTU_CD,".
  4616*----------  時価採用日付
  4617     10  FILLER              PIC  X(14)
  4618         VALUE  " CP_SAIYO_YMD,".
  4619*----------  時価採用市場
  4620     10  FILLER              PIC  X(15)
  4621         VALUE  " CP_SAIYO_SIJO,".
  4622*----------  評価金額(取引通貨)
  4623     10  FILLER              PIC  X(13)
  4624         VALUE  " THTK_HYK_KN,".
  4625*----------  評価損益(取引通貨)
  4626     10  FILLER              PIC  X(16)
  4627         VALUE  " THTK_HYK_SNEKI,".
  4628*----------  前払金残(取引通貨)
  4629     10  FILLER              PIC  X(13)
  4630         VALUE  " THTK_PPAYZN,".
  4631*----------  経過利息金額(取引通貨)
  4632     10  FILLER              PIC  X(14)
  4633         VALUE  " THTK_KEKA_RS,".
  4634*----------  未収収益(取引通貨)
  4635     10  FILLER              PIC  X(13)
  4636         VALUE  " THTK_MS_EKI,".
  4637*----------  評価為替レート
  4638     10  FILLER              PIC  X(09)
  4639         VALUE  " HYK_KWS,".
  4640*----------  為替採用日付
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  81
* MUSR2651.cob                                                     )py)py)
  4641     10  FILLER              PIC  X(15)
  4642         VALUE  " KWS_SAIYO_YMD,".
  4643*----------  為替採用ソース
  4644     10  FILLER              PIC  X(18)
  4645         VALUE  " KWS_SAIYO_SOURCE,".
  4646*----------  取得金額(運用通貨為替換算額)
  4647     10  FILLER              PIC  X(17)
  4648         VALUE  " UYTK_KWS_BOKAZN,".
  4649*----------  取得金額(運用通貨)
  4650     10  FILLER              PIC  X(12)
  4651         VALUE  " SHTK_KN_LC,".
  4652*----------  取得単価(運用通貨)
  4653     10  FILLER              PIC  X(13)
  4654         VALUE  " UYTK_ST_TNK,".
  4655*----------  評価金額(運用通貨)
  4656     10  FILLER              PIC  X(11)
  4657         VALUE  " HYK_KN_LC,".
  4658*----------  評価損益(運用通貨)
  4659     10  FILLER              PIC  X(14)
  4660         VALUE  " HYK_SNEKI_LC,".
  4661*----------  前払金残(運用通貨)
  4662     10  FILLER              PIC  X(14)
  4663         VALUE  " UYTK_PPAY_ZN,".
  4664*----------  経過利息金額(運用通貨)
  4665     10  FILLER              PIC  X(14)
  4666         VALUE  " UYTK_KEKA_RS,".
  4667*----------  未収収益(運用通貨)
  4668     10  FILLER              PIC  X(13)
  4669         VALUE  " UYTK_MS_EKI,".
  4670*----------  備考１
  4671     10  FILLER              PIC  X(08)
  4672         VALUE  " BIKOU1,".
  4673*----------  備考２
  4674     10  FILLER              PIC  X(08)
  4675         VALUE  " BIKOU2,".
  4676*----------  備考３
  4677     10  FILLER              PIC  X(08)
  4678         VALUE  " BIKOU3,".
  4679*----------  備考４
  4680     10  FILLER              PIC  X(08)
  4681         VALUE  " BIKOU4,".
  4682*----------  備考５
  4683     10  FILLER              PIC  X(08)
  4684         VALUE  " BIKOU5,".
  4685*----------  備考６
  4686     10  FILLER              PIC  X(08)
  4687         VALUE  " BIKOU6,".
  4688*----------  備考７
  4689     10  FILLER              PIC  X(08)
  4690         VALUE  " BIKOU7,".
  4691*----------  備考８
  4692     10  FILLER              PIC  X(08)
  4693         VALUE  " BIKOU8,".
  4694*----------  備考９
  4695     10  FILLER              PIC  X(08)
  4696         VALUE  " BIKOU9,".
  4697*----------  投資対象国
  4698     10  FILLER              PIC  X(16)
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  82
* MUSR2651.cob                                                     )py)py)
  4699         VALUE  " TS_TARGET_KUNI,".
  4700*----------  未払費用残(取引通貨)
  4701     10  FILLER              PIC  X(14)
  4702         VALUE  " SJTK_MBHY_ZN,".
  4703*----------  未払費用残(運用通貨)
  4704     10  FILLER              PIC  X(14)
  4705         VALUE  " UYTK_MBHY_ZN,".
  4706*----------  建玉為替レート
  4707     10  FILLER              PIC  X(17)
  4708         VALUE  " TGYOKU_KWS_RATE,".
  4709*----------  建玉約定金額残(取引通貨)
  4710     10  FILLER              PIC  X(17)
  4711         VALUE  " THTK_TG_YJKN_ZN,".
  4712*----------  建玉約定金額残(運用通貨)
  4713     10  FILLER              PIC  X(17)
  4714         VALUE  " UYTK_TG_YJKN_ZN,".
  4715*----------  建玉手数料残(取引通貨)
  4716     10  FILLER              PIC  X(16)
  4717         VALUE  " THTK_TG_TSR_ZN,".
  4718*----------  建玉手数料残(運用通貨)
  4719     10  FILLER              PIC  X(16)
  4720         VALUE  " UYTK_TG_TSR_ZN,".
  4721*----------  建玉消費税残(取引通貨)
  4722     10  FILLER              PIC  X(18)
  4723         VALUE  " THTK_TG_S_TAX_ZN,".
  4724*----------  建玉消費税残(運用通貨)
  4725     10  FILLER              PIC  X(18)
  4726         VALUE  " UYTK_TG_S_TAX_ZN,".
  4727*----------  建玉その他費用残(取引通貨)
  4728     10  FILLER              PIC  X(21)
  4729         VALUE  " THTK_TG_ELS_HIYO_ZN,".
  4730*----------  建玉その他費用残(運用通貨)
  4731     10  FILLER              PIC  X(21)
  4732         VALUE  " UYTK_TG_ELS_HIYO_ZN,".
  4733*----------  建玉精算金額残(取引通貨)
  4734     10  FILLER              PIC  X(17)
  4735         VALUE  " THTK_TG_SSKG_ZN,".
  4736*----------  建玉精算金額残(運用通貨)
  4737     10  FILLER              PIC  X(17)
  4738         VALUE  " UYTK_TG_SSKG_ZN,".
  4739*----------  前受金残(取引通貨)
  4740     10  FILLER              PIC  X(14)
  4741         VALUE  " THTK_AREC_ZN,".
  4742*----------  前受金残(運用通貨)
  4743     10  FILLER              PIC  X(14)
  4744         VALUE  " UYTK_AREC_ZN,".
  4745*----------  仮払金残(取引通貨)
  4746     10  FILLER              PIC  X(14)
  4747         VALUE  " THTK_SPAY_ZN,".
  4748*----------  仮払金残(運用通貨)
  4749     10  FILLER              PIC  X(14)
  4750         VALUE  " UYTK_SPAY_ZN,".
  4751*----------  源泉税(取引通貨)
  4752     10  FILLER              PIC  X(10)
  4753         VALUE  " THTK_GSZ,".
  4754*----------  源泉税(運用通貨)
  4755     10  FILLER              PIC  X(15)
  4756         VALUE  " GENSEN_TAX_LC,".
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  83
* MUSR2651.cob                                                     )py)py)
  4757*----------  源泉税還付予定額残高(取引通貨)
  4758     10  FILLER              PIC  X(18)
  4759         VALUE  " THTK_GSZKP_YT_ZN,".
  4760*----------  源泉税還付予定額残高(運用通貨)
  4761     10  FILLER              PIC  X(18)
  4762         VALUE  " UYTK_GSZKP_YT_ZN,".
  4763*----------  簿価為替レート
  4764     10  FILLER              PIC  X(10)
  4765         VALUE  " BOKA_KWS,".
  4766*----------  移管評価損益残(取引通貨)
  4767     10  FILLER              PIC  X(20)
  4768         VALUE  " THTK_IKAN_HYK_SEZN,".
  4769*----------  移管評価損益残(運用通貨)
  4770     10  FILLER              PIC  X(20)
  4771         VALUE  " UYTK_IKAN_HYK_SEZN,".
  4772*----------  移管未収収益(取引通貨)
  4773     10  FILLER              PIC  X(19)
  4774         VALUE  " SJTK_IKAN_MSSHEKI,".
  4775*----------  移管未収収益(運用通貨)
  4776     10  FILLER              PIC  X(19)
  4777         VALUE  " UYTK_IKAN_MSSHEKI,".
  4778*----------  移管前払金評価損益残(運用通貨)
  4779     10  FILLER              PIC  X(18)
  4780         VALUE  " UYTK_IKAN_PPHKZN,".
  4781*----------  ＯＰ資産負債・買建売建フラグ
  4782     10  FILLER              PIC  X(13)
  4783         VALUE  " OP_TATE_FLG,".
  4784*----------  時価系列コード
  4785     10  FILLER              PIC  X(14)
  4786         VALUE  " JIKA_KRTU_CD,".
  4787*----------  取得時遡及有無
  4788     10  FILLER              PIC  X(14)
  4789         VALUE  " SKYU_UMU_FLG,".
  4790*----------  時価種類
  4791     10  FILLER              PIC  X(11)
  4792         VALUE  " JIKA_SHRU,".
  4793*----------  ソース区分
  4794     10  FILLER              PIC  X(12)
  4795         VALUE  " SOURCE_KBN,".
  4796*----------  前払金評価額(運用通貨)
  4797     10  FILLER              PIC  X(19)
  4798         VALUE  " UYTK_KPPAY_HYK_GK,".
  4799*----------  前払金評価損益(運用通貨)
  4800     10  FILLER              PIC  X(17)
  4801         VALUE  " UYTK_PPAY_SNEKI,".
  4802*----------  未収収益評価為替レート
  4803     10  FILLER              PIC  X(18)
  4804         VALUE  " MS_SHEKI_HYK_KWS,".
  4805*----------  源泉税評価為替レート
  4806     10  FILLER              PIC  X(18)
  4807         VALUE  " GENS_TAX_HYK_KWS,".
  4808*----------  データ区分
  4809     10  FILLER              PIC  X(10)
  4810         VALUE  " DATA_KBN,".
  4811*----------  商品区分
  4812     10  FILLER              PIC  X(12)
  4813         VALUE  " SYOHIN_KBN,".
  4814*----------  帳票出力区分
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  84
* MUSR2651.cob                                                     )py)py)
  4815     10  FILLER              PIC  X(09)
  4816         VALUE  " REP_KBN,".
  4817*----------  項目コード１
  4818     10  FILLER              PIC  X(08)
  4819         VALUE  " KODE_1,".
  4820*----------  数値１１
  4821     10  FILLER              PIC  X(09)
  4822         VALUE  " SUJI_11,".
  4823*----------  数値１２
  4824     10  FILLER              PIC  X(09)
  4825         VALUE  " SUJI_12,".
  4826*----------  数値１３
  4827     10  FILLER              PIC  X(09)
  4828         VALUE  " SUJI_13,".
  4829*----------  項目コード２
  4830     10  FILLER              PIC  X(08)
  4831         VALUE  " KODE_2,".
  4832*----------  数値２１
  4833     10  FILLER              PIC  X(09)
  4834         VALUE  " SUJI_21,".
  4835*----------  数値２２
  4836     10  FILLER              PIC  X(09)
  4837         VALUE  " SUJI_22,".
  4838*----------  数値２３
  4839     10  FILLER              PIC  X(09)
  4840         VALUE  " SUJI_23,".
  4841*----------  項目コード３
  4842     10  FILLER              PIC  X(08)
  4843         VALUE  " KODE_3,".
  4844*----------  数値３１
  4845     10  FILLER              PIC  X(09)
  4846         VALUE  " SUJI_31,".
  4847*----------  数値３２
  4848     10  FILLER              PIC  X(09)
  4849         VALUE  " SUJI_32,".
  4850*----------  数値３３
  4851     10  FILLER              PIC  X(09)
  4852         VALUE  " SUJI_33,".
  4853*----------  予備１
  4854     10  FILLER              PIC  X(07)
  4855         VALUE  " YOBI1,".
  4856*----------  予備２
  4857     10  FILLER              PIC  X(07)
  4858         VALUE  " YOBI2,".
  4859*----------  作成フラグ
  4860     10  FILLER              PIC  X(08)
  4861         VALUE  " SK_FLG,".
  4862*----------  作成画面ＩＤ
  4863     10  FILLER              PIC  X(10)
  4864         VALUE  " SK_GAMEN,".
  4865*----------  作成ファイル名
  4866     10  FILLER              PIC  X(09)
  4867         VALUE  " SK_FILE,".
  4868*----------  作成日時
  4869     10  FILLER              PIC  X(09)
  4870         VALUE  " SK_DATE,".
  4871*----------  作成ログインユーザ会社コード
  4872     10  FILLER              PIC  X(17)
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  85
* MUSR2651.cob                                                     )py)py)
  4873         VALUE  " SK_LOGIN_CMP_CD,".
  4874*----------  作成ユーザＩＤ
  4875     10  FILLER              PIC  X(08)
  4876         VALUE  " SK_SID,".
  4877*----------  作成プログラムＩＤ
  4878     10  FILLER              PIC  X(10)
  4879         VALUE  " SK_PGMID,".
  4880*----------  更新フラグ
  4881     10  FILLER              PIC  X(09)
  4882         VALUE  " UPD_FLG,".
  4883*----------  更新画面ＩＤ
  4884     10  FILLER              PIC  X(11)
  4885         VALUE  " UPD_GAMEN,".
  4886*----------  更新ファイル名
  4887     10  FILLER              PIC  X(10)
  4888         VALUE  " UPD_FILE,".
  4889*----------  更新日時
  4890     10  FILLER              PIC  X(10)
  4891         VALUE  " UPD_DATE,".
  4892*----------  更新ログインユーザ会社コード
  4893     10  FILLER              PIC  X(18)
  4894         VALUE  " UPD_LOGIN_CMP_CD,".
  4895*----------  更新ユーザＩＤ
  4896     10  FILLER              PIC  X(09)
  4897         VALUE  " UPD_SID,".
  4898*----------  更新プログラムＩＤ
  4899     10  FILLER              PIC  X(10)
  4900         VALUE  " UPD_PGMID".
  4901*----------  FROM テーブルTKUSZT01
  4902     10  FILLER              PIC  X(06)
  4903         VALUE  " FROM ".
  4904     10  SQL-TBL-TKUSZT01    PIC  X(13).
  4905*----------  WHERE
  4906     10  FILLER              PIC  X(07)
  4907         VALUE  " WHERE ".
  4908*----------  利用会社コード
  4909     10  FILLER              PIC  X(17)
  4910         VALUE  "RIYO_CMP_CD = :V1".
  4911*----------  ファンドコード
  4912     10  FILLER              PIC  X(18)
  4913         VALUE  " AND FUND_CD = :V2".
  4914*----------  ポートフォリオコード
  4915     10  FILLER              PIC  X(17)
  4916         VALUE  " AND PTF_CD = :V3".
  4917*----------  期間FROM
  4918     10  FILLER              PIC  X(21)
  4919         VALUE  " AND ZANTK_YMD >= :V4".
  4920*----------  期間TO
  4921     10  FILLER              PIC  X(21)
  4922         VALUE  " AND ZANTK_YMD <= :V5".
  4923*----------  決算日断面区分
  4924     10  FILLER              PIC  X(06)  VALUE  " AND (".
  4925*----------  決算日断面区分(1)
  4926     10  FILLER              PIC  X(26)
  4927         VALUE  " KSN_YMD_DMN_KBN = '1' OR ".
  4928*----------  決算日断面区分(2)
  4929     10  FILLER              PIC  X(24)
  4930         VALUE  " KSN_YMD_DMN_KBN =  '0' ".
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  86
* MUSR2651.cob                                                     )py)py)
  4931     10  FILLER              PIC  X(03)  VALUE  " ) ".
  4932*----------  評価系列コード
  4933     10  FILLER              PIC  X(22)
  4934         VALUE  " AND HYK_KRTU_CD = :V6".
  4935*----------  残高日付
  4936     10  FILLER              PIC  X(20)
  4937         VALUE  " AND ZANTK_YMD = :V7".
  4938*----------  ORDER BY
  4939     10  FILLER              PIC  X(19)
  4940         VALUE  " ORDER BY ZANTK_YMD".
  4941     10  FILLER              PIC  X(10)
  4942         VALUE  ",TRHK_TUKA".
  4943     10  FILLER              PIC  X(11)
  4944         VALUE  ",SEC_SBT_CD".
  4945     10  FILLER              PIC  X(07)
  4946         VALUE  ",MEG_CD".
  4947     10  FILLER              PIC  X(09)
  4948         VALUE  ",TATE_FLG".
  4949     10  FILLER              PIC  X(12)
  4950         VALUE  ",KB_KANRI_ID".
  4951     10  FILLER              PIC  X(08)
  4952         VALUE  ",CAST_CD".
  4953   05  SQL-SELECT-2.
  4954*----------  SELECT
  4955     10  FILLER              PIC  X(07)
  4956         VALUE  "SELECT ".
  4957*----------  残高日付
  4958     10  FILLER              PIC  X(18)
  4959         VALUE  "DISTINCT ZANTK_YMD".
  4960*----------  FROM テーブルTKUSZT01
  4961     10  FILLER              PIC  X(06)
  4962         VALUE  " FROM ".
  4963     10  SQL-TBL-TKUSZT01    PIC  X(13).
  4964*----------  WHERE
  4965     10  FILLER              PIC  X(07)
  4966         VALUE  " WHERE ".
  4967*----------  利用会社コード
  4968     10  FILLER              PIC  X(17)
  4969         VALUE  "RIYO_CMP_CD = :V1".
  4970*----------  ファンドコード
  4971     10  FILLER              PIC  X(18)
  4972         VALUE  " AND FUND_CD = :V2".
  4973*----------  ポートフォリオコード
  4974     10  FILLER              PIC  X(17)
  4975         VALUE  " AND PTF_CD = :V3".
  4976*----------  期間FROM
  4977     10  FILLER              PIC  X(21)
  4978         VALUE  " AND ZANTK_YMD >= :V4".
  4979*----------  期間TO
  4980     10  FILLER              PIC  X(21)
  4981         VALUE  " AND ZANTK_YMD <= :V5".
  4982*----------  決算日断面区分
  4983     10  FILLER              PIC  X(06)  VALUE  " AND (".
  4984*----------  決算日断面区分(1)
  4985     10  FILLER              PIC  X(26)
  4986         VALUE  " KSN_YMD_DMN_KBN = '1' OR ".
  4987*----------  決算日断面区分(2)
  4988     10  FILLER              PIC  X(24)
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  87
* MUSR2651.cob                                                     )py)py)
  4989         VALUE  " KSN_YMD_DMN_KBN =  '0' ".
  4990     10  FILLER              PIC  X(03)  VALUE  " ) ".
  4991*----------  評価系列コード
  4992     10  FILLER              PIC  X(22)
  4993         VALUE  " AND HYK_KRTU_CD = :V6".
  4994*----------  ORDER BY
  4995     10  FILLER              PIC  X(19)
  4996         VALUE  " ORDER BY ZANTK_YMD".
  4997   05  SQL-SELECT-TKDYAA40.
  4998*----------  NVL(MAX(基準日), 0)
  4999     10  FILLER              PIC  X(39)
  5000         VALUE  " BEGIN SELECT NVL(MAX(SS_SYORI_YMD), 0)".
  5001     10  FILLER              PIC  X(09)
  5002         VALUE  " INTO :V1".
  5003*----------  FROM テーブルTKDYAA40
  5004     10  FILLER              PIC  X(06)
  5005         VALUE  " FROM ".
  5006     10  SQL-TBL-TKDYAA40    PIC  X(13).
  5007*----------  WHERE
  5008     10  FILLER              PIC  X(07)
  5009         VALUE  " WHERE ".
  5010*----------  利用会社コード
  5011     10  FILLER              PIC  X(17)
  5012         VALUE  "RIYO_CMP_CD = :V2".
  5013*----------  ファンドコード
  5014     10  FILLER              PIC  X(18)
  5015         VALUE  " AND FUND_CD = :V3".
  5016*----------  ポートフォリオコード
  5017     10  FILLER              PIC  X(17)
  5018         VALUE  " AND PTF_CD = :V4".
  5019*----------  評価系列コード
  5020     10  FILLER              PIC  X(22)
  5021         VALUE  " AND HYK_KRTU_CD = :V5".
  5022*----------  進捗タスクID
  5023     10  FILLER              PIC  X(25)
  5024         VALUE  " AND SHINTK_TASK_ID = :V6".
  5025*----------  進捗ステータス
  5026     10  FILLER              PIC  X(27)
  5027         VALUE  " AND SHINTK_STS = :V7;END; ".
  5028*******         テーマ2693     20100404 修正  開始        ********
  5029*----------  デフォルト評価系列で確定済みチェック
  5030   05  SQL-SELECT-3.
  5031*----------  SELECT
  5032     10  FILLER              PIC  X(21)
  5033         VALUE  " SELECT B.TEKIYO_FROM".
  5034*----------  FROM テーブルTKUSZT01
  5035     10  FILLER              PIC  X(06)
  5036         VALUE  " FROM ".
  5037     10  SQL-TBL-TKDYAA40    PIC  X(13).
  5038     10  FILLER              PIC  X(04)
  5039         VALUE  " A, ".
  5040     10  SQL-TBL-TKPFZK04    PIC  X(13).
  5041     10  FILLER              PIC  X(03)
  5042         VALUE  " B ".
  5043*----------  WHERE
  5044     10  FILLER              PIC  X(07)
  5045         VALUE  " WHERE ".
  5046*----------  利用会社コード
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  88
* MUSR2651.cob                                                     )py)py)
  5047     10  FILLER              PIC  X(20)
  5048         VALUE  " A.RIYO_CMP_CD = :V1".
  5049*----------  利用会社コード
  5050     10  FILLER              PIC  X(24)
  5051         VALUE  " AND B.RIYO_CMP_CD = :V2".
  5052*----------  ファンドコード
  5053     10  FILLER              PIC  X(20)
  5054         VALUE  " AND B.FUND_CD = :V3".
  5055*----------  ポートフォリオコード
  5056     10  FILLER              PIC  X(19)
  5057         VALUE  " AND B.PTF_CD = :V4".
  5058*----------  ファンドコード
  5059     10  FILLER              PIC  X(26)
  5060         VALUE  " AND A.FUND_CD = B.FUND_CD".
  5061*----------  ポートフォリオコード
  5062     10  FILLER              PIC  X(24)
  5063         VALUE  " AND A.PTF_CD = B.PTF_CD".
  5064*----------  評価系列コード
  5065     10  FILLER              PIC  X(34)
  5066         VALUE  " AND A.HYK_KRTU_CD = B.HYK_KRTU_CD".
  5067*----------  進捗タスクID
  5068     10  FILLER              PIC  X(27)
  5069         VALUE  " AND A.SHINTK_TASK_ID = :V6".
  5070*----------  進捗ステータス
  5071     10  FILLER              PIC  X(25)
  5072         VALUE  " AND A.SHINTK_STS = '000'".
  5073*----------  デフォルト評価系列区分
  5074     10  FILLER              PIC  X(28)
  5075         VALUE  " AND B.DEFAULT_HYK_FLG = '1'".
  5076*----------  最終処理年月日
  5077     10  FILLER              PIC  X(36)
  5078         VALUE  " AND A.SS_SYORI_YMD >= B.TEKIYO_FROM".
  5079*----------  最終処理年月日
  5080     10  FILLER              PIC  X(26)
  5081         VALUE  " AND A.SS_SYORI_YMD >= :V7".
  5082*----------  最終処理年月日
  5083     10  FILLER              PIC  X(26)
  5084         VALUE  " AND A.SS_SYORI_YMD <= :V8".
  5085     10  FILLER              PIC  X(15)
  5086         VALUE  " AND ROWNUM = 1".
  5087*******         テーマ2693     20100404 修正  終了        ********
  5088******************************************************************
  5089*                SQL通信領域
  5090******************************************************************
  5091*----------  SQLコミュニケーション領域
  5092*    EXEC  SQL  INCLUDE  SQLCA             END-EXEC.
  5093 01  SQLCA GLOBAL.
  5094     05  SQLCAID               PIC X(8).
  5095     05  SQLCABC               PIC S9(9) COMP-5.
  5096     05  SQLCODE               PIC S9(9) COMP-5.
  5097     05  SQLERRM.
  5098         49 SQLERRML           PIC S9(4) COMP-5.
  5099         49 SQLERRMC           PIC X(70).
  5100     05  SQLERRP               PIC X(8).
  5101     05  SQLERRD OCCURS 6 TIMES
  5102                               PIC S9(9) COMP-5.
  5103     05  SQLWARN.
  5104         10 SQLWARN0           PIC X(1).
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  89
* MUSR2651.cob                                                     )py)py)
  5105         10 SQLWARN1           PIC X(1).
  5106         10 SQLWARN2           PIC X(1).
  5107         10 SQLWARN3           PIC X(1).
  5108         10 SQLWARN4           PIC X(1).
  5109         10 SQLWARN5           PIC X(1).
  5110         10 SQLWARN6           PIC X(1).
  5111         10 SQLWARN7           PIC X(1).
  5112     05  SQLEXT                PIC X(8).
  5113*    EXEC  SQL  INCLUDE  ORACA             END-EXEC.
  5114 01  ORACA GLOBAL.
  5115     05  ORACAID               PIC X(8).
  5116     05  ORACABC               PIC S9(9) COMP-5.
  5117     05  ORACCHF               PIC S9(9) COMP-5.
  5118     05  ORADBGF               PIC S9(9) COMP-5.
  5119     05  ORAHCHF               PIC S9(9) COMP-5.
  5120     05  ORASTXTF              PIC S9(9) COMP-5.
  5121     05  ORASTXT.
  5122         49 ORASTXTL           PIC S9(4) COMP-5.
  5123         49 ORASTXTC           PIC X(70).
  5124     05  ORASFNM.
  5125         49 ORASFNML           PIC S9(4) COMP-5.
  5126         49 ORASFNMC           PIC X(70).
  5127     05  ORASLNR               PIC S9(9) COMP-5.
  5128     05  ORAHOC                PIC S9(9) COMP-5.
  5129     05  ORAMOC                PIC S9(9) COMP-5.
  5130     05  ORACOC                PIC S9(9) COMP-5.
  5131     05  ORANOR                PIC S9(9) COMP-5.
  5132     05  ORANPR                PIC S9(9) COMP-5.
  5133     05  ORANEX                PIC S9(9) COMP-5.
  5134*    EXEC  SQL  BEGIN   DECLARE   SECTION  END-EXEC.
  5135 01  HST-AREA.
  5136*----------  ORACLE接続ユーザ領域
  5137   05  H-ORA-USER            PIC  X(80).
  5138   05  HST-TBL-TKDYAA40-SELECT.
  5139*----------  基準日
  5140     10  H-KJN-YMD           PIC  S9(08).
  5141   05  HST-SEL-TKDYAA40-WHERE.
  5142*----------  利用会社コード
  5143     10  H-RIYO-CMP-CD       PIC  X(04).
  5144*----------  ファンドコード
  5145     10  H-FUND-CD           PIC  X(12).
  5146*----------  ポートフォリオコード
  5147     10  H-PTF-CD            PIC  X(04).
  5148*----------  評価系列コード
  5149     10  H-HYK-KRTU-CD       PIC  X(04).
  5150*----------  進捗タスクID
  5151     10  H-SHINTK-TASK-ID    PIC  X(07).
  5152*----------  進捗ステータス
  5153     10  H-SHINTK-STS        PIC  X(03).
  5154   05  HST-TBL-SELECT.
  5155*----------  利用会社コード
  5156     10  H-RIYO-CMP-CD       PIC  X(04).
  5157*----------  ファンドコード
  5158     10  H-FUND-CD           PIC  X(12).
  5159*----------  ポートフォリオコード
  5160     10  H-PTF-CD            PIC  X(04).
  5161*----------  約定受渡区分
  5162     10  H-YJ-UW-KBN         PIC  X(01).
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  90
* MUSR2651.cob                                                     )py)py)
  5163*----------  残高日付
  5164     10  H-ZANTK-YMD         PIC  S9(08).
  5165*----------  決算日断面区分
  5166     10  H-KSN-YMD-DMN-KBN   PIC  X(01).
  5167*----------  評価系列コード
  5168     10  H-HYK-KRTU-CD       PIC  X(04).
  5169*----------  証券種別コード
  5170     10  H-SEC-SBT-CD        PIC  X(04).
  5171*----------  取消フラグ
  5172     10  H-DEL-KBN           PIC  X(01).
  5173*----------  確定フラグ
  5174     10  H-KT-KBN            PIC  X(01).
  5175*----------  取引通貨
  5176     10  H-TRHK-TUKA         PIC  X(04).
  5177*----------  為替取引決済通貨
  5178     10  H-KWS-TH-TUKA-CD    PIC  X(04).
  5179*----------  発行国コード
  5180     10  H-HAKO-CD           PIC  X(04).
  5181*----------  銘柄コード
  5182     10  H-MEG-CD            PIC  X(15).
  5183*----------  資産負債・買建売建フラグ
  5184     10  H-TATE-FLG          PIC  X(01).
  5185*----------  個別建玉約定日
  5186     10  H-TG-YKJ-YMD        PIC  S9(08).
  5187*----------  個別玉管理番号
  5188     10  H-KB-KANRI-ID       PIC  X(10).
  5189*----------  カストディコード
  5190     10  H-CAST-CD           PIC  X(04).
  5191*----------  保有数量
  5192     10  H-HOU-SURYO         PIC  S9(12)V9(06).
  5193*----------  数量単位
  5194     10  H-SURYO-TANI        PIC  S9(12)V9(06).
  5195*----------  取得金額(取引通貨)
  5196     10  H-THTK-ST-KNG       PIC  S9(15)V9(03).
  5197*----------  取得単価(取引通貨)
  5198     10  H-THTK-ST-TNK       PIC  S9(08)V9(10).
  5199*----------  時価(取引通貨)
  5200     10  H-CP-KRTU-CD        PIC  S9(08)V9(10).
  5201*----------  時価採用日付
  5202     10  H-CP-SAIYO-YMD      PIC  S9(08).
  5203*----------  時価採用市場
  5204     10  H-CP-SAIYO-SIJO     PIC  X(04).
  5205*----------  評価金額(取引通貨)
  5206     10  H-THTK-HYK-KN       PIC  S9(15)V9(03).
  5207*----------  評価損益(取引通貨)
  5208     10  H-THTK-HYK-SNEKI    PIC  S9(15)V9(03).
  5209*----------  前払金残(取引通貨)
  5210     10  H-THTK-PPAYZN       PIC  S9(15)V9(03).
  5211*----------  経過利息金額(取引通貨)
  5212     10  H-THTK-KKRS         PIC  S9(12)V9(06).
  5213*----------  未収収益(取引通貨)
  5214     10  H-THTK-MS-EKI       PIC  S9(15)V9(03).
  5215*----------  評価為替レート
  5216     10  H-HYK-KWS           PIC  S9(08)V9(10).
  5217*----------  為替採用日付
  5218     10  H-KWS-SAIYO-YMD     PIC  S9(08).
  5219*----------  為替採用ソース
  5220     10  H-KWS-SAIYO-SOURCE  PIC  X(04).
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  91
* MUSR2651.cob                                                     )py)py)
  5221*----------  取得金額(運用通貨為替換算額)
  5222     10  H-UYTK-KWS-BOKAZN   PIC  S9(15)V9(03).
  5223*----------  取得金額(運用通貨)
  5224     10  H-SHTK-KN-LC        PIC  S9(15)V9(03).
  5225*----------  取得単価(運用通貨)
  5226     10  H-UYTK-ST-TNK       PIC  S9(08)V9(10).
  5227*----------  評価金額(運用通貨)
  5228     10  H-HYK-KN-LC         PIC  S9(15)V9(03).
  5229*----------  評価損益(運用通貨)
  5230     10  H-HYK-SNEKI-LC      PIC  S9(15)V9(03).
  5231*----------  前払金残(運用通貨)
  5232     10  H-UYTK-PPAY-ZN      PIC  S9(15)V9(03).
  5233*----------  経過利息(運用通貨)
  5234     10  H-KEKA-RSK-LC       PIC  S9(12)V9(06).
  5235*----------  未収収益(運用通貨)
  5236     10  H-UYTK-MS-EKI       PIC  S9(15)V9(03).
  5237*----------  備考１
  5238     10  H-BIKOU-1           PIC  X(20).
  5239*----------  備考２
  5240     10  H-BIKOU-2           PIC  X(20).
  5241*----------  備考３
  5242     10  H-BIKOU-3           PIC  X(12).
  5243*----------  備考４
  5244     10  H-BIKOU-4           PIC  X(12).
  5245*----------  備考５
  5246     10  H-BIKOU-5           PIC  S9(12)V9(06).
  5247*----------  備考６
  5248     10  H-BIKOU-6           PIC  S9(12)V9(06).
  5249*----------  備考７
  5250     10  H-BIKOU-7           PIC  S9(12)V9(06).
  5251*----------  備考８
  5252     10  H-BIKOU-8           PIC  S9(08)V9(10).
  5253*----------  備考９
  5254     10  H-BIKOU-9           PIC  S9(12)V9(06).
  5255*----------  投資対象国
  5256     10  H-TS-TARGET-KUNI    PIC  X(04).
  5257*----------  未払費用残(取引通貨)
  5258     10  H-SJTK-MBHY-ZN      PIC  S9(15)V9(03).
  5259*----------  未払費用残(運用通貨)
  5260     10  H-UYTK-MBHY-ZN      PIC  S9(15)V9(03).
  5261*----------  建玉為替レート
  5262     10  H-TGYOKU-KWS-RATE   PIC  S9(08)V9(10).
  5263*----------  建玉約定金額残(取引通貨)
  5264     10  H-THTK-TG-YJKN-ZN   PIC  S9(15)V9(03).
  5265*----------  建玉約定金額残(運用通貨)
  5266     10  H-UYTK-TG-YJKN-ZN   PIC  S9(15)V9(03).
  5267*----------  建玉手数料残(取引通貨)
  5268     10  H-THTK-TG-TSR-ZN    PIC  S9(15)V9(03).
  5269*----------  建玉手数料残(運用通貨)
  5270     10  H-UYTK-TG-TSR-ZN    PIC  S9(15)V9(03).
  5271*----------  建玉消費税残(取引通貨)
  5272     10  H-THTK-TG-S-TAX-ZN  PIC  S9(15)V9(03).
  5273*----------  建玉消費税残(運用通貨)
  5274     10  H-UYTK-TG-S-TAX-ZN  PIC  S9(15)V9(03).
  5275*----------  建玉その他費用残(取引通貨)
  5276     10  H-THTK-TG-ELS-HIYO-ZN
  5277                             PIC  S9(15)V9(03).
  5278*----------  建玉その他費用残(運用通貨)
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  92
* MUSR2651.cob                                                     )py)py)
  5279     10  H-UYTK-TG-ELS-HIYO-ZN
  5280                             PIC  S9(15)V9(03).
  5281*----------  建玉精算金額残(取引通貨)
  5282     10  H-THTK-TG-SSKG-ZN   PIC  S9(15)V9(03).
  5283*----------  建玉精算金額残(運用通貨)
  5284     10  H-UYTK-TG-SSKG-ZN   PIC  S9(15)V9(03).
  5285*----------  前受金残(取引通貨)
  5286     10  H-THTK-AREC-ZN      PIC  S9(15)V9(03).
  5287*----------  前受金残(運用通貨)
  5288     10  H-UYTK-AREC-ZN      PIC  S9(15)V9(03).
  5289*----------  仮払金残(取引通貨)
  5290     10  H-THTK-SPAY-ZN      PIC  S9(15)V9(03).
  5291*----------  仮払金残(運用通貨)
  5292     10  H-UYTK-SPAY-ZN      PIC  S9(15)V9(03).
  5293*----------  源泉税(取引通貨)
  5294     10  H-THTK-GSZ          PIC  S9(15)V9(03).
  5295*----------  源泉税(運用通貨)
  5296     10  H-GENSEN-TAX-LC     PIC  S9(15)V9(03).
  5297*----------  源泉税還付予定額残高(取引通貨)
  5298     10  H-THTK-GSZKP-YT-ZN  PIC  S9(15)V9(03).
  5299*----------  源泉税還付予定額残高(運用通貨)
  5300     10  H-UYTK-GSZKP-YT-ZN  PIC  S9(15)V9(03).
  5301*----------  簿価為替レート
  5302     10  H-BOKA-KWS          PIC  S9(08)V9(10).
  5303*----------  移管評価損益残(取引通貨)
  5304     10  H-THTK-IKAN-HYK-SEZN
  5305                             PIC  S9(15)V9(03).
  5306*----------  移管評価損益残(運用通貨)
  5307     10  H-UYTK-IKAN-HYK-SEZN
  5308                             PIC  S9(15)V9(03).
  5309*----------  移管未収収益(取引通貨)
  5310     10  H-SJTK-IKAN-MSSHEKI
  5311                             PIC  S9(15)V9(03).
  5312*----------  移管未収収益(運用通貨)
  5313     10  H-UYTK-IKAN-MSSHEKI
  5314                             PIC  S9(15)V9(03).
  5315*----------  移管前払金評価損益残(運用通貨)
  5316     10  H-UYTK-IKAN-PPHKZN
  5317                             PIC  S9(15)V9(03).
  5318*----------  ＯＰ資産負債・買建売建フラグ
  5319     10  H-OP-TATE-FLG       PIC  X(01).
  5320*----------  時価系列コード
  5321     10  H-JIKA-KRTU-CD      PIC  X(04).
  5322*----------  取得時遡及有無
  5323     10  H-SKYU-UMU-FLG      PIC  X(01).
  5324*----------  時価種類
  5325     10  H-JIKA-SHRU         PIC  X(04).
  5326*----------  ソース区分
  5327     10  H-SOURCE-KBN        PIC  X(02).
  5328*----------  前払金評価額(運用通貨)
  5329     10  H-UYTK-KPPAY-HYK-GK PIC  S9(15)V9(03).
  5330*----------  前払金評価損益(運用通貨)
  5331     10  H-UYTK-PPAY-SNEKI   PIC  S9(15)V9(03).
  5332*----------  未収収益評価為替レート
  5333     10  H-MS-SHEKI-HYK-KWS  PIC  S9(08)V9(10).
  5334*----------  源泉税評価為替レート
  5335     10  H-GENS-TAX-HYK-KWS  PIC  S9(08)V9(10).
  5336*----------  データ区分
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  93
* MUSR2651.cob                                                     )py)py)
  5337     10  H-DATA-KBN          PIC  X(01).
  5338*----------  商品区分
  5339     10  H-SYOHIN-KBN        PIC  X(02).
  5340*----------  帳票出力区分
  5341     10  H-REP-KBN           PIC  X(01).
  5342*----------  項目コード１
  5343     10  H-KODE-1            PIC  X(20).
  5344*----------  数値１１
  5345*------------------ <残タスク129の対応 START>---------------------
  5346     10  H-SUJI-11           PIC  S9(15)V9(03).
  5347*------------------ <残タスク129の対応 END>-----------------------
  5348*----------  数値１２
  5349     10  H-SUJI-12           PIC  S9(15)V9(03).
  5350*----------  数値１３
  5351     10  H-SUJI-13           PIC  S9(15)V9(03).
  5352*----------  項目コード２
  5353     10  H-KODE-2            PIC  X(20).
  5354*----------  数値２１
  5355     10  H-SUJI-21           PIC  S9(15)V9(03).
  5356*----------  数値２２
  5357     10  H-SUJI-22           PIC  S9(15)V9(03).
  5358*----------  数値２３
  5359     10  H-SUJI-23           PIC  S9(15)V9(03).
  5360*----------  項目コード３
  5361     10  H-KODE-3            PIC  X(20).
  5362*----------  数値３１
  5363     10  H-SUJI-31           PIC  S9(15)V9(03).
  5364*----------  数値３２
  5365     10  H-SUJI-32           PIC  S9(15)V9(03).
  5366*----------  数値３３
  5367     10  H-SUJI-33           PIC  S9(15)V9(03).
  5368*----------  予備１
  5369     10  H-YOBI1             PIC  X(20).
  5370*----------  予備２
  5371     10  H-YOBI2             PIC  X(20).
  5372*----------  作成フラグ
  5373     10  H-SK-FLG            PIC  X(01).
  5374*----------  作成画面ＩＤ
  5375     10  H-SK-GAMEN          PIC  X(08).
  5376*----------  作成ファイル名
  5377     10  H-SK-FILE           PIC  X(20).
  5378*----------  作成日時
  5379     10  H-SK-DATE           PIC  X(14).
  5380*----------  作成ログインユーザ会社コード
  5381     10  H-SK-LOGIN-CMP-CD   PIC  X(04).
  5382*----------  作成ユーザＩＤ
  5383     10  H-SK-SID            PIC  X(20).
  5384*----------  作成プログラムＩＤ
  5385     10  H-SK-PGMID          PIC  X(16).
  5386*----------  更新フラグ
  5387     10  H-UPD-FLG           PIC  X(01).
  5388*----------  更新画面ＩＤ
  5389     10  H-UPD-GAMEN         PIC  X(08).
  5390*----------  更新ファイル名
  5391     10  H-UPD-FILE          PIC  X(20).
  5392*----------  更新日時
  5393     10  H-UPD-DATE          PIC  X(14).
  5394*----------  更新ログインユーザ会社コード
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  94
* MUSR2651.cob                                                     )py)py)
  5395     10  H-UPD-LOGIN-CMP-CD  PIC  X(04).
  5396*----------  更新ユーザＩＤ
  5397     10  H-UPD-SID           PIC  X(20).
  5398*----------  更新プログラムＩＤ
  5399     10  H-UPD-PGMID         PIC  X(16).
  5400   05  HST-SELECT-WHERE.
  5401*----------  利用会社コード
  5402     10  H-RIYO-CMP-CD       PIC  X(04).
  5403*----------  ファンドコード
  5404     10  H-FUND-CD           PIC  X(12).
  5405*----------  ポートフォリオコード
  5406     10  H-PTF-CD            PIC  X(04).
  5407*----------  期間FROM
  5408     10  H-KIKAN-FR          PIC  S9(08).
  5409*----------  期間TO
  5410     10  H-KIKAN-TO          PIC  S9(08).
  5411*----------  評価系列コード
  5412     10  H-HYK-KRTU-CD       PIC  X(04).
  5413*----------  残高日付
  5414     10  H-ZANTK-YMD         PIC  S9(08).
  5415*******         テーマ2693     20100404 修正  開始        ********
  5416   05  HST-SELECT-3-WHERE.
  5417*----------  利用会社コード1
  5418     10  H-RIYO-CMP-CD-1     PIC  X(04).
  5419*----------  利用会社コード2
  5420     10  H-RIYO-CMP-CD-2     PIC  X(04).
  5421*----------  ファンドコード
  5422     10  H-FUND-CD           PIC  X(12).
  5423*----------  ポートフォリオコード
  5424     10  H-PTF-CD            PIC  X(04).
  5425*----------  進捗タスクID
  5426     10  H-SHINTK-TASK-ID    PIC  X(07).
  5427*----------  期間FROM
  5428     10  H-KIKAN-FR          PIC  S9(08).
  5429*----------  期間TO
  5430     10  H-KIKAN-TO          PIC  S9(08).
  5431*******         テーマ2693     20100404 修正  終了        ********
  5432   05  HST-TBL-SELECT-2.
  5433*----------  残高日付
  5434     10  H-ZANTK-YMD         PIC  S9(08).
  5435*******         テーマ2693     20100404 修正  開始        ********
  5436   05  HST-TBL-SELECT-3.
  5437*----------  適用FROM
  5438     10  H-TEKIYO-FR         PIC  S9(08).
  5439*******         テーマ2693     20100404 修正  終了        ********
  5440*----------  SQLSTMT-S
  5441   05  SQLSTMT-S             PIC  X(3000).
  5442*----------  SQLSTMT-S2
  5443   05  SQLSTMT-S2            PIC  X(3000).
  5444*******         テーマ2693     20100404 修正  開始        ********
  5445*----------  SQLSTMT-S3
  5446   05  SQLSTMT-S3            PIC  X(3000).
  5447*******         テーマ2693     20100404 修正  終了        ********
  5448*----------  SQLSTMT-S-TKDYAA40
  5449   05  SQLSTMT-S-TKDYAA40    PIC  X(3000).
  5450*    EXEC  SQL  END     DECLARE   SECTION  END-EXEC.
  5451******************************************************************
  5452*                ワーク  エリア
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  95
* MUSR2651.cob                                                     )py)py)
  5453******************************************************************
  5454 01  WK-DENBUN-AREA.
  5455   05  WK-RUN-SDATETIME      PIC  X(14).                          GUT2013
  5456   05  WK-RUN-EDATETIME      PIC  X(14).                          GUT2013
  5457*----------  AIFA情報
  5458   05  WK-AIFA.
* 5459       COPY  "WOMCMAIFA.CPY".
  5460*
  5461* システムID   :WOM
  5462* システム名称 :サーバ基盤ミドルソフト
  5463* プログラムID :WOMCMAIFA.CPY
  5464* 処理概要(目的,使用法,重要な変数など):
  5465*     ＡＩＦＡ定義ヘッダ
  5466*
  5467
  5468* 改訂履歴
  5469* 年月日   区分 所属　　 担当　　内容
  5470* -------- ---- -------- ------- --------------------------------
  5471* 19950406 新規 S銀13    鮫島    新規
  5472* 95.06.28 修正 S銀13    小柳    コーディング基準に準拠
  5473* 95.07.06 修正 S銀13    小柳    業務ランク変更 #PSD-201
  5474* 95.10.17 修正 S金13    木村    AIFA V0201支援 #PCL301
  5475* 95.10.17 修正 S金13    木村    TP1ｴﾗｰｺｰﾄﾞ支援 #PCL309
  5476* 96.02.20 修正 S金13    河原    VALUE句削除    #PSD333
  5477*
  5478
  5479*
  5480* Copyright (C) 1995 by Nomura Research Institute,Ltd.
  5481* All rights reserved.
  5482*
  5483** WOMAIFA **
  5484***  AIFA-ST.
  5485     10  AIFA-SIZE           PIC  S9(4)
  5486                             USAGE IS COMP-5.
  5487*    * ＡＩＦＡサイズ
  5488     10  VR-NO               PIC  X(4).
  5489*    * バージョン番号
  5490     10  ON-LINE-DATE        PIC  X(8).
  5491*    * オンライン日付
  5492     10  PROC-DATE           PIC  X(8).
  5493*    * 処理年月日
  5494     10  APL-DATE            PIC  X(6).
  5495*    * ＡＰ起動時刻
  5496     10  SV-HOST-NAME        PIC  X(32).
  5497*    * 自サーバ名称
  5498     10  CLT-APL-NAME        PIC  X(8).
  5499*    * クライアントＡＰＬ名称
  5500     10  ON-LUNE-NAME        PIC  X(2).
  5501*    * 自オンライン名称
  5502     10  FILLER              PIC  X(6).
  5503*    * 予備１
  5504     10  SV-GROUP            PIC  X(31).
  5505*    * サービスグループ
  5506     10  SV-NAME             PIC  X(31).
  5507*    * サービス名称
  5508     10  START-TYPE          PIC  X(2).
  5509*    * サービス起動形態
  5510     10  PROC-NAME           PIC  X(16).
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  96
* MUSR2651.cob (/opt/wom/copy/WOMCMAIFA.CPY)                       )py)py)
  5511*    * プロセス名称
  5512     10  ORG-SV-GROUP        PIC  X(31).
  5513*    * オリジナルサービスグループ名称
  5514     10  ORG-SV-NAME         PIC  X(31).
  5515*    * オリジナルサービス名称
  5516     10  ORG-START-TYPE      PIC  X(2).
  5517*    * オリジナル起動形態
  5518     10  MONITER-SW          PIC  X(1).
  5519*    * モニタ取得区分
  5520     10  AP-COMPLETE-ST      PIC  X(1).
  5521*    * ＡＰ終了ステータス
  5522     10  MDL-COMPL-ST        PIC  X(1).
  5523*    * ミドル終了ステータス
  5524     10  TROUBLE-SW          PIC  X(1).
  5525*    * 障害区分
  5526     10  FORCE-SW            PIC  X(1).
  5527*    * 強制区分
  5528     10  FILLER              PIC  X(3).
  5529*    * 予備２
  5530     10  IN-NO               PIC  S9(4)
  5531                             USAGE IS COMP-5.
  5532*    * 入力通番
  5533     10  IN-HOST-NAME        PIC  X(32).
  5534*    * 入力端末のコンピュータ名称
  5535     10  COMPANY-CODE        PIC  X(4).
  5536*    * 会社コード
  5537     10  IN-ST-CODE          PIC  X(4).
  5538*    * 顧客処理部店コード
  5539     10  IN-ST-DBNAME        PIC  X(32).
  5540*    * 営業店ＤＢサーバ名称
  5541     10  FILLER              PIC  X(6).
  5542*    * 予備３
  5543     10  JOB-USER-ID         PIC  X(8).
  5544*    * 端末利用者の業務ユーザＩＤ
  5545     10  JOB-RANK-01         PIC  X(2).
  5546*    * 端末利用者の業務ランク０１ #PSD-201
  5547     10  JOB-RANK-02         PIC  X(2).
  5548*    * 端末利用者の業務ランク０２ #PSD-201
  5549     10  JOB-RANK-03         PIC  X(2).
  5550*    * 端末利用者の業務ランク０３ #PSD-201
  5551     10  JOB-RANK-04         PIC  X(2).
  5552*    * 端末利用者の業務ランク０４ #PSD-201
  5553     10  JOB-RANK-05         PIC  X(2).
  5554*    * 端末利用者の業務ランク０５ #PSD-201
  5555     10  JOB-RANK-06         PIC  X(2).
  5556*    * 端末利用者の業務ランク０６ #PSD-201
  5557     10  JOB-RANK-07         PIC  X(2).
  5558*    * 端末利用者の業務ランク０７ #PSD-201
  5559     10  JOB-RANK-08         PIC  X(2).
  5560*    * 端末利用者の業務ランク０８ #PSD-201
  5561     10  JOB-RANK-09         PIC  X(2).
  5562*    * 端末利用者の業務ランク０９ #PSD-201
  5563     10  JOB-RANK-10         PIC  X(2).
  5564*    * 端末利用者の業務ランク１０ #PSD-201
  5565     10  USER-IN-ST          PIC  X(4).
  5566*    * ユーザ所属部店
  5567     10  SV-ERR-CD           PIC  X(4).
  5568*    *サーバ詳細コード      #PCL309
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  97
* MUSR2651.cob (/opt/wom/copy/WOMCMAIFA.CPY)                       )py)py)
  5569     10  RLY-RPC-TM          PIC  S9(4)
  5570                             USAGE IS COMP-5.
  5571*    *問合せ応答タイマ      #PCL301
  5572     10  FILLER              PIC  X(54).
  5573*    * 予備５ #PSD-201 #PCL301,#PCL309
  5574*----------  共通ヘッダ
  5575   05  WK-HEADER.
* 5576       COPY  "CZCOMMONHEADER.cpy".
  5577******************************************************************
  5578*
  5579*  システムＩＤ   : T-STAR
  5580*  システム名称   : 新有価証券バックオフィスシステム
  5581*  コピー句ＩＤ   : CZCOMMONHEADER.cpy
  5582*  コピー句名称   : 共通ヘッダ
  5583*
  5584*  改訂履歴
  5585*  年月日     所属       担当者  内容
  5586*  ---------- ---------- ------  ----------------------------
  5587*  2006/08/21 SCS                新規
  5588*
  5589******************************************************************
  5590*----------  リクエストID
  5591 10  REQUEST-ID                        PIC  X(32).
  5592*----------  システム日付
  5593 10  SYS-DATE                          PIC  X(08).
  5594*----------  ログインユーザ会社業務形態区分
  5595 10  COMPANY-TYPE                      PIC  X(01).
  5596*----------  ユーザー名称
  5597 10  USER-NAME                         PIC  X(40).
  5598*----------  ユーザー種別
  5599 10  USER-TYPE                         PIC  X(01).
  5600*----------  業務グループコード
  5601 10  GYOUMU-GROUP-CODE                 PIC  X(10).
  5602*----------  業務グループ名称
  5603 10  GYOUMU-GROUP-NAME                 PIC  X(40).
  5604*----------  メニュー利用制限区分
  5605 10  ALL-MENU-USABLE                   PIC  X(01).
  5606*----------  業務タスク利用制限区分
  5607 10  ALL-TASK-USABLE                   PIC  X(01).
  5608*----------  帳票利用制限区分
  5609 10  ALL-REPORT-USABLE                 PIC  X(01).
  5610*----------  利用会社コード
  5611 10  RIYO-COMPANY-CODE                 PIC  X(04).
  5612*----------  利用会社名称
  5613 10  RIYO-COMPANY-NAME                 PIC  X(60).
  5614*----------  利用会社業務形態区分
  5615 10  RIYO-COMPANY-TYPE                 PIC  X(01).
  5616*----------  委託会社コード
  5617 10  ITAKU-CODE                        PIC  X(03).
  5618*----------  受託銀行コード
  5619 10  JYUTAKU-CODE                      PIC  X(02).
  5620*----------  システムエラーメッセージ
  5621 10  SYSTEM-ERROR-MSG                  PIC  X(60).
  5622*----------  予備
  5623 10  FILLER                            PIC  X(35).
  5624*----------  上り電文情報
  5625   05  WK-DENBUN-INFO.
* 5626       COPY  "INMUSR2610_COBOL.cpy".
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  98
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/INMUSR2610_COBOL.cpy)
  5627*<INMUSR2610用COBOLCopy句>*
  5628     10  INMUSR2610.
  5629       20  FILLER SIGN IS LEADING SEPARATE CHARACTER.
  5630         30  I-KJN-YMD-FR PIC X(8).
  5631         30  I-KJN-YMD-TO PIC X(8).
  5632         30  I-CD-REF-KRTU-CD PIC X(4).
  5633         30  I-PTF-SYORI-KBN PIC X(1).
  5634         30  I-FUND-PTF-GRP-COUNT PIC 9(5) VALUE 10.
  5635         30  I-FUND-PTF-GRP OCCURS 10.
  5636           40  I-FUND-PTF-KBN PIC X(1).
  5637           40  I-FUND-CD PIC X(12).
  5638           40  I-PTF-CD PIC X(4).
  5639         30  I-HYK-KRTU-KBN PIC X(1).
  5640         30  I-HYK-KRTU-GRP-COUNT PIC 9(5) VALUE 10.
  5641         30  I-HYK-KRTU-GRP OCCURS 10.
  5642           40  I-HYK-KRTU-CD PIC X(4).
  5643         30  I-FLG-KEISAN PIC X(1).
  5644         30  I-GX-KANSI-JIKAN-RX PIC X(4).
  5645         30  TABLE-COUNT PIC X(4).
  5646         30  SRC-MENU-ID PIC X(6).
  5647         30  MENU-ID PIC X(6).
  5648         30  BUS-LOG-PK PIC X(10).
  5649 01  WORK-AREA.
  5650*---------- 株式種別（リファレンス情報）
  5651   05  WK-RF-KABU-SBT        PIC  X(02).
  5652*----------  ＧＸ債券キャッシュフロー
  5653   05  WK-CASH-FLOW-KBN      PIC  X(01).
  5654   05  WK-TEMP-MSG.
  5655     10  WK-TEMP-MSG-TEXT    PIC  X(08).
  5656     10  WK-TEMP-MSG-YKJ     PIC  X(08).
  5657*----------  運用通貨コード
  5658   05  WK-CAPITAL-TUKA-CD    PIC  X(04).
  5659   05  WK-TEMP-DATA.
  5660*----------  時価(取引通貨)
  5661     10  WK-CP-KRTU-CD       PIC  S9(08)V9(10).
  5662*----------  評価為替レート
  5663     10  WK-HYK-KWS          PIC  S9(08)V9(10).
  5664*----------  取得単価(取引通貨)
  5665     10  WK-THTK-ST-TNK      PIC  S9(08)V9(10).
  5666*----------  保有数量
  5667     10  WK-HOU-SURYO        PIC  S9(15)V9(06).
  5668*----------  数量単位
  5669     10  WK-SURYO-TANI       PIC  S9(12)V9(06).
  5670*----------  取得金額(取引通貨)
  5671     10  WK-THTK-ST-KNG      PIC  S9(15)V9(03).
  5672*----------  評価金額(取引通貨)
  5673     10  WK-THTK-HYK-KN      PIC  S9(15)V9(03).
  5674*----------  評価金額(運用通貨)
  5675     10  WK-HYK-KN-LC        PIC  S9(15)V9(03).
  5676*----------  備考１
  5677     10  WK-BIKOU-1          PIC  X(20).
  5678   05  WK-SUM-DATA.
  5679*----------  保有数量
  5680     10  WK-HOU-SURYO-SUM    PIC  S9(15)V9(06).
  5681*----------  取得金額(取引通貨)
  5682     10  WK-THTK-ST-KNG-SUM  PIC  S9(15)V9(03).
  5683*----------  評価金額(取引通貨)
  5684     10  WK-THTK-HYK-KN-SUM  PIC  S9(15)V9(03).
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page  99
* MUSR2651.cob                                                     0_COBOL.cpy)
  5685*----------  評価損益(取引通貨)
  5686     10  WK-THTK-HYK-SNEKI-SUM
  5687                             PIC  S9(15)V9(03).
  5688*----------  取得金額(運用通貨為替換算額)
  5689     10  WK-UYTK-KWS-BOKAZN-SUM
  5690                             PIC  S9(15)V9(03).
  5691*----------  取得金額(運用通貨)
  5692     10  WK-SHTK-KN-LC-SUM   PIC  S9(15)V9(03).
  5693*----------  評価金額(運用通貨)
  5694     10  WK-HYK-KN-LC-SUM    PIC  S9(15)V9(03).
  5695*----------  評価損益(運用通貨)
  5696     10  WK-HYK-SNEKI-LC-SUM PIC  S9(15)V9(03).
  5697*----------  現金集計出力フラグ
  5698     10  WK-GENKIN-OUT       PIC  X(01).
  5699   05  WK-SUM-DATA-2.
  5700     10  WK-SUM-DATA2        OCCURS  10.
  5701*----------  保有数量
  5702       15  WK-HOU-SURYO-SUM-2
  5703                             PIC  S9(15)V9(06).
  5704*----------  取得金額(取引通貨)
  5705       15  WK-THTK-ST-KNG-SUM-2
  5706                             PIC  S9(15)V9(03).
  5707*----------  評価金額(取引通貨)
  5708       15  WK-THTK-HYK-KN-SUM-2
  5709                             PIC  S9(15)V9(03).
  5710*----------  評価損益(取引通貨)
  5711       15  WK-THTK-HYK-SNEKI-SUM-2
  5712                             PIC  S9(15)V9(03).
  5713*----------  取得金額(運用通貨為替換算額)
  5714       15  WK-UYTK-KWS-BOKAZN-SUM-2
  5715                             PIC  S9(15)V9(03).
  5716*----------  取得金額(運用通貨)
  5717       15  WK-SHTK-KN-LC-SUM-2
  5718                             PIC  S9(15)V9(03).
  5719*----------  評価金額(運用通貨)
  5720       15  WK-HYK-KN-LC-SUM-2
  5721                             PIC  S9(15)V9(03).
  5722*----------  評価損益(運用通貨)
  5723       15  WK-HYK-SNEKI-LC-SUM-2
  5724                             PIC  S9(15)V9(03).
  5725*----------  銘柄コード
  5726       15  WK-MEG-CD-2       PIC  X(20).
  5727*----------  証券発行元の所属する国
  5728       15  WK-HAKO-CD-CD-2   PIC  X(02).
  5729*---------- 銘柄名称(日本語)
  5730       15  WK-MEG-MEI-JP-2   PIC  X(80).
  5731*---------- 銘柄名称(英語)
  5732       15  WK-MEG-MEI-EN-2   PIC  X(40).
  5733*----------  現金集計出力フラグ
  5734       15  WK-GENKIN-OUT-2   PIC  X(01).
  5735   05  WK-SUM-DATA-3.
  5736     10  WK-SUM-DATA3        OCCURS  3.
  5737*----------  保有数量
  5738       15  WK-HOU-SURYO-SUM-3
  5739                             PIC  S9(15)V9(06).
  5740*----------  取得金額(取引通貨)
  5741       15  WK-THTK-ST-KNG-SUM-3
  5742                             PIC  S9(15)V9(03).
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 100
* MUSR2651.cob                                                     0_COBOL.cpy)
  5743*----------  評価金額(取引通貨)
  5744       15  WK-THTK-HYK-KN-SUM-3
  5745                             PIC  S9(15)V9(03).
  5746*----------  評価損益(取引通貨)
  5747       15  WK-THTK-HYK-SNEKI-SUM-3
  5748                             PIC  S9(15)V9(03).
  5749*----------  取得金額(運用通貨為替換算額)
  5750       15  WK-UYTK-KWS-BOKAZN-SUM-3
  5751                             PIC  S9(15)V9(03).
  5752*----------  取得金額(運用通貨)
  5753       15  WK-SHTK-KN-LC-SUM-3
  5754                             PIC  S9(15)V9(03).
  5755*----------  評価金額(運用通貨)
  5756       15  WK-HYK-KN-LC-SUM-3
  5757                             PIC  S9(15)V9(03).
  5758*----------  評価損益(運用通貨)
  5759       15  WK-HYK-SNEKI-LC-SUM-3
  5760                             PIC  S9(15)V9(03).
  5761*----------  銘柄コード
  5762       15  WK-MEG-CD-3       PIC  X(20).
  5763*----------  証券発行元の所属する国
  5764       15  WK-HAKO-CD-3      PIC  X(02).
  5765*---------- 銘柄名称(日本語)
  5766       15  WK-MEG-MEI-JP-3   PIC  X(80).
  5767*---------- 銘柄名称(英語)
  5768       15  WK-MEG-MEI-EN-3   PIC  X(40).
  5769*----------  現金集計出力フラグ
  5770       15  WK-GENKIN-OUT-3   PIC  X(01).
  5771   05  WK-SUM-DATA-4.
  5772     10  WK-SUM-DATA4        OCCURS  2.
  5773*----------  保有数量
  5774       15  WK-HOU-SURYO-SUM-4
  5775                             PIC  S9(15)V9(06).
  5776*----------  取得金額(取引通貨)
  5777       15  WK-THTK-ST-KNG-SUM-4
  5778                             PIC  S9(15)V9(03).
  5779*----------  評価金額(取引通貨)
  5780       15  WK-THTK-HYK-KN-SUM-4
  5781                             PIC  S9(15)V9(03).
  5782*----------  評価損益(取引通貨)
  5783       15  WK-THTK-HYK-SNEKI-SUM-4
  5784                             PIC  S9(15)V9(03).
  5785*----------  取得金額(運用通貨為替換算額)
  5786       15  WK-UYTK-KWS-BOKAZN-SUM-4
  5787                             PIC  S9(15)V9(03).
  5788*----------  取得金額(運用通貨)
  5789       15  WK-SHTK-KN-LC-SUM-4
  5790                             PIC  S9(15)V9(03).
  5791*----------  評価金額(運用通貨)
  5792       15  WK-HYK-KN-LC-SUM-4
  5793                             PIC  S9(15)V9(03).
  5794*----------  評価損益(運用通貨)
  5795       15  WK-HYK-SNEKI-LC-SUM-4
  5796                             PIC  S9(15)V9(03).
  5797*----------  銘柄コード
  5798       15  WK-MEG-CD-4       PIC  X(20).
  5799*----------  証券種別
  5800       15  WK-SEC-SBT-CD-4   PIC  X(04).
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 101
* MUSR2651.cob                                                     0_COBOL.cpy)
  5801*----------  証券発行元の所属する国
  5802       15  WK-HAKO-CD-4      PIC  X(02).
  5803*---------- 銘柄名称(日本語)
  5804       15  WK-MEG-MEI-JP-4   PIC  X(80).
  5805*---------- 銘柄名称(英語)
  5806       15  WK-MEG-MEI-EN-4   PIC  X(40).
  5807*----------  現金集計出力フラグ
  5808       15  WK-GENKIN-OUT-4   PIC  X(01).
  5809*----------  為替乗算/除算区分（評価為替レート用）
  5810   05  WK-KWS-ZYOUHO-JZS     PIC  X(01).
  5811*----------  為替乗算/除算区分（時価（取引通貨）用）
  5812   05  WK-KWS-ZYOUHO-JZS-2   PIC  X(01).
  5813*----------  約定主義会計フラグ
  5814   05  WK-YKJ-SYUGI-KAIKEI   PIC  X(01).
  5815*----------  仕訳基準パターンコード
  5816   05  WK-SWK-KJN-PTN-CD     PIC  X(08).
  5817   05  WK-UPD-TIME           PIC  X(06).
  5818   05  WK-UPD-TIME-9
  5819                             REDEFINES  WK-UPD-TIME
  5820                             PIC  9(06).
  5821*---------- ヘッダー
  5822   05  WK-HEADER-TITLE.
  5823     10  FILLER              PIC  X(06)  VALUE  "IAFPOH".
  5824     10  FILLER              PIC  X(01)  VALUE  X'09'.
  5825     10  WK-KJN-YMD          PIC  9(08).
  5826     10  FILLER              PIC  9(02)  VALUE  0.
  5827     10  FILLER              PIC  X(01)  VALUE  X'09'.
  5828     10  WK-Y-U-FLG          PIC  X(01).
  5829*---------- ヘッダー
  5830   05  WK-FOOT.
  5831     10  FILLER              PIC  X(06)  VALUE  "IAFPOF".
  5832     10  FILLER              PIC  X(01)  VALUE  X'09'.
  5833     10  WK-FILE-KENSUU      PIC  X(18).
  5834*---------- 銘柄名称(日本語)
  5835   05  WK-MEG-MEI-JP         PIC  X(60).
  5836*---------- 銘柄名称(英語)
  5837   05  WK-MEG-MEI-EN         PIC  X(60).
  5838*---------- 債券ｸｰﾎﾟﾝ
  5839   05  WK-SAKEN-KP-KBN       PIC  S9(12)V9(06).
  5840*---------- 債券償還日
  5841   05  WK-SAKEN-SK-YMD       PIC  9(08).
  5842*---------- 資産分類コード
  5843   05  WK-SISAN-BUNRUI-CD    PIC  X(04).
  5844*---------- コールプット区分
  5845   05  WK-CALL-PUT-KBN       PIC  X(01).
  5846*------------------ <連結障害841の対応 START>---------------------
  5847*----------  証券種別_外部コード
  5848   05  WK-SEC-SBT-CD-2       PIC  X(04).
  5849   05  WK-SEC-SBT-CD-3       PIC  X(04).
  5850   05  WK-GAIBU-CD           PIC  X(04).
  5851*------------------ <連結障害841の対応 END>-----------------------
  5852*----------  ｶｽﾄﾃﾞｨｺｰﾄ
  5853   05  WK-CAST-CD-2          PIC  X(11).
  5854*---------- 外部銘柄コード
  5855   05  WK-GAIBU-MEG-CD       PIC  X(20).
  5856   05  WK-GAIBU-MEG-CD1      PIC  X(20).
  5857*---------- コードリファレンス系列コード
  5858   05  WK-CD-REF-KRTU-CD     PIC  X(04).
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 102
* MUSR2651.cob                                                     0_COBOL.cpy)
  5859*---------- デフォルトコードリファレンス系列コード
  5860   05  WK-DEFAULT-KRTU-CD    PIC  X(04).
  5861*---------- 証券種別コード
  5862   05  WK-SEC-SBT-CD         PIC  X(04).
  5863*---------- 発行体国コード
  5864   05  WK-HAKO-CD            PIC  X(04).
  5865*---------- 投資対象国コード
  5866   05  WK-TS-TARGET-KUNI     PIC  X(04).
  5867*---------- 自社コードフラグ
  5868   05  WK-JS-CD-FLG          PIC  X(01).
  5869*----------  国コード略式
  5870   05  WK-HAKO-CD-2          PIC  X(02).
  5871*------------------ <残タスク135の対応 START>---------------------
  5872*----------  ワーク商品区分
  5873   05  WK-SYOHIN-KBN         PIC  X(02).
  5874*------------------ <残タスク135の対応 END>-----------------------
  5875*----------  管理数量単位
  5876   05  WK-KANRI-SURYO-TANI   PIC  S9(12)V9(06).
  5877   05  WK-J                  PIC  9(05).
  5878*----------  DATファイル名
  5879   05  WK-FILE-NAME          PIC  X(255).
  5880*----------  DATファイル名2
  5881   05  WK-FILE-2-NAME        PIC  X(255).
  5882*----------  DATファイル名3
  5883   05  WK-FILE-3-NAME        PIC  X(255).
  5884*----------  DATファイル名4
  5885   05  WK-FILE-4-NAME        PIC  X(255).
  5886*----------  DATファイル名5
  5887   05  WK-FILE-5-NAME        PIC  X(255).
  5888*----------  DATファイル名6
  5889   05  WK-FILE-6-NAME        PIC  X(255).
  5890*----------  DATファイル名7
  5891   05  WK-FILE-7-NAME        PIC  X(255).
  5892*----------  DATファイル名8
  5893   05  WK-FILE-8-NAME        PIC  X(255).
  5894*----------  ファイルパス
  5895   05  WK-FILE-PASS          PIC  X(256).
  5896*----------  パス付けDATファイル
  5897   05  WK-PSACT-DAT-FILE     PIC  X(256).
  5898*----------  ファイルリターン
  5899   05  WK-FILE-STATUS        PIC  X(02).
  5900*----------  パス付けDATファイル
  5901   05  WK-PSACT-DAT-FILE-2   PIC  X(256).
  5902*----------  パス付けDATファイル3
  5903   05  WK-PSACT-DAT-FILE-3   PIC  X(256).
  5904*----------  パス付けDATファイル4
  5905   05  WK-PSACT-DAT-FILE-4   PIC  X(256).
  5906*----------  パス付けDATファイル5
  5907   05  WK-PSACT-DAT-FILE-5   PIC  X(256).
  5908*----------  パス付けDATファイル6
  5909   05  WK-PSACT-DAT-FILE-6   PIC  X(256).
  5910*----------  パス付けDATファイル7
  5911   05  WK-PSACT-DAT-FILE-7   PIC  X(256).
  5912*----------  パス付けDATファイル8
  5913   05  WK-PSACT-DAT-FILE-8   PIC  X(256).
  5914*----------  ファイルリターン
  5915   05  WK-FILE-STATUS-2      PIC  X(02).
  5916*----------  ファイルリターン
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 103
* MUSR2651.cob                                                     0_COBOL.cpy)
  5917   05  WK-FILE-STATUS-3      PIC  X(02).
  5918*----------  ファイルリターン
  5919   05  WK-FILE-STATUS-4      PIC  X(02).
  5920*----------  ファイルリターン
  5921   05  WK-FILE-STATUS-5      PIC  X(02).
  5922*----------  ファイルリターン
  5923   05  WK-FILE-STATUS-6      PIC  X(02).
  5924*----------  ファイルリターン
  5925   05  WK-FILE-STATUS-7      PIC  X(02).
  5926*----------  ファイルリターン
  5927   05  WK-FILE-STATUS-8      PIC  X(02).
  5928*----------  接続引数
  5929   05  WK-ARGUMENT.
  5930*----------  利用会社コード
  5931     10  WK-RIYO-CMP-CD      PIC  X(04).
  5932*----------  処理実行日
  5933     10  WK-SHORI-YMD        PIC  X(08).
  5934     10  WK-SHORI-YMD-9
  5935                             REDEFINES  WK-SHORI-YMD
  5936                             PIC  9(08).
  5937*----------  業務タスクID
  5938     10  WK-GYOMU-TASK-ID    PIC  X(07).
  5939*----------  起動ID
  5940     10  WK-KIDOU-ID         PIC  X(04).
  5941*----------  LOOP
  5942   05  WK-LOOP.
  5943     10  WK-IDX-J            PIC  9(05).
  5944     10  WK-IDX-K            PIC  9(02).
  5945     10  WK-IDX-M            PIC  9(02).
  5946     10  WK-IDX-I            PIC  9(02).
  5947     10  WK-IDX-P            PIC  9(02).
  5948     10  WK-IDX-Q            PIC  9(02).
  5949     10  WK-IDX-X            PIC  9(02).
  5950     10  WK-IDX-Y            PIC  9(02).
  5951     10  WK-IDX-C            PIC  9(02).
  5952     10  WK-IDX-D            PIC  9(02).
  5953*----------  COUNT
  5954   05  WK-COUNT.
  5955     10  WK-COUNT-1          PIC  9(02).
  5956*----------  件数
  5957   05  WK-KENSUU.
  5958*----------  書き込む件数
  5959     10  WK-WRITE-KENSUU     PIC  9(09).
  5960     10  WK-WRITE-KENSUU2    PIC  9(09).
  5961     10  WK-WRITE-KENSUU3    PIC  9(09).
  5962     10  WK-WRITE-KENSUU4    PIC  9(09).
  5963     10  WK-WRITE-KENSUU5    PIC  9(09).
  5964     10  WK-WRITE-KENSUU6    PIC  9(09).
  5965     10  WK-WRITE-KENSUU7    PIC  9(09).
  5966     10  WK-WRITE-KENSUU8    PIC  9(09).
  5967     10  WK-WRITE-TEMP       PIC  9(09).
  5968     10  WK-WRITE-TEMP2      PIC  9(09).
  5969     10  WK-WRITE-TEMP3      PIC  9(09).
  5970     10  WK-WRITE-TEMP4      PIC  9(09).
  5971     10  WK-FETCH-KENSUU     PIC  9(09).
  5972     10  WK-SELECT-KENSUU    PIC  9(09).
  5973     10  WK-STOP-KENSUU      PIC  9(03).
  5974*----------  エラーフリーメッセージ
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 104
* MUSR2651.cob                                                     0_COBOL.cpy)
  5975   05  WK-SQL-ERR-MSG.
  5976*----------  SELECTリーメッセージ
  5977     10  WK-SELECT-FREE-MSG  PIC  X(5000).
  5978     10  WK-SELECT-FREE-MSG2 PIC  X(5000).
  5979*******         テーマ2693     20100404 修正  開始        ********
  5980     10  WK-SELECT-FREE-MSG3 PIC  X(5000).
  5981*******         テーマ2693     20100404 修正  終了        ********
  5982*----------  TKDYAA40リーメッセージ
  5983     10  WK-SEL-TKDYAA40-FREE-MSG
  5984                             PIC  X(3000).
  5985*----------  日付
  5986   05  WK-DATE.
  5987*----------  マシン日付時刻
  5988     10  WK-MAC-DATE-TIME    PIC  X(14).
  5989*----------  ファンド&ポートフォリオオ明細
  5990   05  WK-FUND-PTF-DETAIL.
  5991*----------  ヒット件数
  5992     10  WK-HIT-KENSU        PIC  9(05).
  5993*----------  返却データ
  5994     10  WK-PTF-ATT-DATA     OCCURS  50000.
  5995*----------  ファンドコード
  5996       15  WK-FUND-CD-DETAIL PIC  X(12).
  5997*----------  ファンド名（日）
  5998       15  WK-FND-MEI-JPN-DETAIL
  5999                             PIC  X(60).
  6000*----------  ポートフォリオコード
  6001       15  WK-PTF-CD-DETAIL  PIC  X(04).
  6002*----------  ポートフォリオ名（日）
  6003       15  WK-PTF-MEI-JPN-DETAIL
  6004                             PIC  X(60).
  6005*----------  デフォルト評価系列コード
  6006       15  WK-DEFAUL-THYK-CD
  6007                             PIC  X(04).
  6008*----------基準日From
  6009       15  WK-KZYN-YMD-FROM  PIC  9(08).
  6010*----------基準日To
  6011       15  WK-KZYN-YMD-TO    PIC  9(08).
  6012*----------  ワークシステムエラー情報
  6013   05  WK-SYS-ERR-INFO.
  6014*---------- エラー検知プログラム名
  6015     10  WK-ERR-PGM-ID       PIC  X(16).
  6016*---------- ポジション
  6017     10  WK-ERR-POS          PIC  X(04).
  6018*---------- リターンコード
  6019     10  WK-RTN-CD           PIC  X(03).
  6020*---------- 詳細リターンコード
  6021     10  WK-DETAIL-RTN-CD    PIC  S9(09).
  6022*----------  詳細リターンコードデコードフラグ
  6023     10  WK-DETAIL-RTN-CD-FLG
  6024                             PIC  X(01).
  6025*---------- フリーメッセージ
  6026     10  WK-FREE-MSG         PIC  X(2000).
  6027*---------- ワーク業務エラー情報
  6028   05  WK-GYOMU-ERR-INFO.
  6029     10  WK-MESSAGE-AREA     OCCURS  999.
  6030*---------- ファンドコード
  6031       15  WK-GYOMU-FUND-CD  PIC  X(12).
  6032*---------- ポートフォリオコード
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 105
* MUSR2651.cob                                                     0_COBOL.cpy)
  6033       15  WK-GYOMU-PTF-CD   PIC  X(04).
  6034*---------- 評価系列コード
  6035       15  WK-GYOMU-HYK-KRTU-CD
  6036                             PIC  X(04).
  6037*---------- 帳票ID
  6038       15  WK-GYOMU-REP-ID   PIC  X(08).
  6039*---------- 帳票任意コード
  6040       15  WK-GYOMU-REP-ANY-CD
  6041                             PIC  X(50).
  6042*---------- 基準日From
  6043       15  WK-GYOMU-KJN-YMD-FROM
  6044                             PIC  X(08).
  6045*---------- 基準日To
  6046       15  WK-GYOMU-KJN-YMD-TO
  6047                             PIC  X(08).
  6048*---------- メッセージID
  6049       15  WK-GYOMU-MSG-ID   PIC  X(07).
  6050*---------- 置換文字
  6051       15  WK-GYOMU-TIKAN-MOJI.
  6052         20  WK-GYOMU-TK-MOJI
  6053                             OCCURS  5
  6054                             PIC  X(30).
  6055*---------- フリーメッセージ
  6056       15  WK-GYOMU-FREE-MSG PIC  X(200).
  6057*----------  ワーク期間
  6058   05  WK-KIKAN.
  6059*----------  期間FROM
  6060     10  WK-KIKAN-FR         PIC  X(08).
  6061     10  WK-KIKAN-FR-9
  6062                             REDEFINES  WK-KIKAN-FR
  6063                             PIC  9(08).
  6064*----------  期間TO
  6065     10  WK-KIKAN-TO         PIC  X(08).
  6066     10  WK-KIKAN-TO-9
  6067                             REDEFINES  WK-KIKAN-TO
  6068                             PIC  9(08).
  6069*----------  基準日
  6070   05  WK-END-YMD-KJN.
  6071     10  WK-END-YY-KJN       PIC  9(04).
  6072     10  WK-END-MM-KJN       PIC  9(02).
  6073     10  WK-END-DD-KJN       PIC  9(02).
  6074   05  WK-END-YMD-KJN-9
  6075                             REDEFINES  WK-END-YMD-KJN
  6076                             PIC  9(08).
  6077*----------  TABLE-NAME
  6078   05  WK-TBL-NAME.
  6079*----------  運用成果残高
  6080     10  WK-TBL-TKUSZT01     PIC  X(13).
  6081*----------  進捗管理
  6082     10  WK-TBL-TKDYAA40     PIC  X(13).
  6083*******         テーマ2693     20100404 修正  開始        ********
  6084*----------  ポートフォリオ評価系列
  6085     10  WK-TBL-TKPFZK04     PIC  X(13).
  6086*******         テーマ2693     20100404 修正  終了        ********
  6087*----------  リターンコード
  6088   05  WK-RTN-CODE           PIC  9(02).
  6089*----------  実行ステータス
  6090   05  WK-STATUS             PIC  9(02).
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 106
* MUSR2651.cob                                                     0_COBOL.cpy)
  6091   05  WK-1190-STATUS        PIC  9(02).
  6092*----------  エラー種別
  6093   05  WK-ERR-SYUBETU        PIC  X(01).
  6094*----------  SCZY1020取得日付
  6095   05  WK-FROM1020-DATE      PIC  9(08).
  6096*---------- ポートフォリオコードTEMP
  6097   05  WK-TEMP-PTF-CD        PIC  X(20).
  6098*----------  約定受渡区分
  6099   05  WK-YJ-UW-KBN-NEW      PIC  X(01).
  6100   05  WK-YJ-UW-KBN-OLD      PIC  X(01).
  6101*----------  ワークブレイクキーNEW
  6102   05  WK-BREAK-KEY-NEW.
  6103*---------- 証券種別コード
  6104     10  WK-SEC-SBT-CD-NEW   PIC  X(04).
  6105*---------- 取引通貨
  6106     10  WK-TRHK-TUKA-NEW    PIC  X(04).
  6107*---------- 銘柄コード
  6108     10  WK-MEG-CD-NEW       PIC  X(15).
  6109*---------- 資産負債・買建売建フラグ
  6110     10  WK-TATE-FLG-NEW     PIC  X(01).
  6111*----------  ワークブレイクキーOLD
  6112   05  WK-BREAK-KEY-OLD.
  6113*---------- 証券種別コード
  6114     10  WK-SEC-SBT-CD-OLD   PIC  X(04).
  6115*---------- 取引通貨
  6116     10  WK-TRHK-TUKA-OLD    PIC  X(04).
  6117*---------- 銘柄コード
  6118     10  WK-MEG-CD-OLD       PIC  X(15).
  6119*---------- 資産負債・買建売建フラグ
  6120     10  WK-TATE-FLG-OLD     PIC  X(01).
  6121*----------  FILE
  6122   05  WK-REC.
* 6123     COPY  "MUSRGXZT.cpy".
  6124******************************************************************
  6125* $Header$
  6126******************************************************************
  6127*
  6128* システムＩＤ   : T-STAR
  6129* システム名称   : 次期TSTARシステム
  6130* コピー句ＩＤ   : MUSRGXZT.cpy
  6131* コピー句名称   : MUSR2651文件出力コピー句
  6132*
  6133* 改訂履歴
  6134* 年月日   区分 所属     担当者  内容
  6135* -------- ---- -------- ------- ---------------------------------
  6136* 20080610 新規 SCS      徐勝飛  新規作成
  6137* 20081231 修正 SCS      馬輝    連結障害493の対応
  6138*
  6139******************************************************************
  6140*----------  (メッセージコード)
  6141       15  MSG-CODE          PIC  X(06).
  6142       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6143*----------  自社コード(出力側)
  6144       15  ZISYA-CODE        PIC  X(11).
  6145       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6146*----------  ポートフォリオコード
  6147       15  PTF-CD            PIC  X(20).
  6148       15  FILLER            PIC  X(01)  VALUE  X'09'.
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 107
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/MUSRGXZT.cpy)BOL.cpy)
  6149*----------  約定/受渡区分
  6150       15  YJ-UW-KBN         PIC  X(01).
  6151       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6152*----------  残高日付
  6153       15  ZANTK-YMD         PIC  S9(08).
  6154       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6155*----------  証券種別
  6156       15  SEC-SBT-CD        PIC  X(04).
  6157       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6158*----------  取消フラグ
  6159       15  DEL-KBN           PIC  X(01).
  6160       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6161*----------  確定フラグ
  6162       15  KT-KBN            PIC  X(01).
  6163       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6164*----------  取引通貨
  6165       15  TRHK-TUKA         PIC  X(03).
  6166       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6167*----------  為替決済通貨
  6168       15  KWS-TH-TUKA-CD    PIC  X(03).
  6169       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6170*----------  証券発行元の所属する国
  6171       15  HAKO-CD           PIC  X(02).
  6172       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6173*----------  銘柄コード体系
  6174       15  MEG-CD-GRP        PIC  X(01).
  6175       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6176*----------  銘柄コード
  6177       15  MEG-CD            PIC  X(20).
  6178       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6179*----------  買建/売建フラグ
  6180       15  TATE-FLG          PIC  X(01).
  6181       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6182*----------  作成/更新年月日
  6183       15  UPD-YMD           PIC  S9(08).
  6184       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6185*----------  作成/更新時刻
  6186       15  UPD-TIME          PIC  S9(06).
  6187       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6188*----------  約定日
  6189       15  YAKU-NITI         PIC  S9(08).
  6190       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6191*----------  建玉/約定番号
  6192       15  KB-KANRI-ID       PIC  X(10).
  6193       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6194*----------  カストディコード
  6195       15  CAST-CD           PIC  X(11).
  6196       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6197*----------  保有数量
  6198       15  HOU-SURYO         PIC  X(30).
  6199       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6200*----------  数量単位
  6201       15  SURYO-TANI        PIC  X(30).
  6202       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6203*----------  取得金額(取引通貨)
  6204       15  THTK-ST-KNG       PIC  X(30).
  6205       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6206*----------  取得単価(取引通貨)
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 108
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/MUSRGXZT.cpy)BOL.cpy)
  6207       15  THTK-ST-TNK       PIC  X(30).
  6208       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6209*----------  時価(取引通貨)
  6210       15  CP-KRTU-CD        PIC  X(30).
  6211       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6212*----------  時価採用日付
  6213       15  CP-SAIYO-YMD      PIC  S9(08).
  6214       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6215*----------  時価採用市場
  6216       15  CP-SAIYO-SIJO     PIC  X(05).
  6217       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6218*----------  評価金額(取引通貨)
  6219       15  THTK-HYK-KN       PIC  X(30).
  6220       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6221*----------  評価損益(取引通貨)
  6222       15  THTK-HYK-SNEKI    PIC  X(30).
  6223       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6224*----------  前払金残(取引通貨)
  6225       15  THTK-PPAYZN       PIC  X(30).
  6226       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6227*----------  経過利息金額(取引通貨)
  6228       15  THTK-KKRS         PIC  X(30).
  6229       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6230*----------  未収収益(取引通貨)
  6231       15  THTK-MS-EKI       PIC  X(30).
  6232       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6233*----------  評価為替レート
  6234       15  HYK-KWS           PIC  X(30).
  6235       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6236*----------  為替採用日付
  6237       15  KWS-SAIYO-YMD     PIC  S9(08).
  6238       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6239*----------  為替採用ソース
  6240       15  KWS-SAIYO-SOURCE  PIC  X(05).
  6241       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6242*----------  取得金額(運用通貨為替換算額)
  6243       15  UYTK-KWS-BOKAZN   PIC  X(30).
  6244       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6245*----------  取得金額(運用通貨)
  6246       15  SHTK-KN-LC        PIC  X(30).
  6247       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6248*----------  取得単価(運用通貨)
  6249       15  UYTK-ST-TNK       PIC  X(30).
  6250       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6251*----------  評価金額(運用通貨)
  6252       15  HYK-KN-LC         PIC  X(30).
  6253       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6254*----------  評価損益(運用通貨)
  6255       15  HYK-SNEKI-LC      PIC  X(30).
  6256       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6257*----------  前払金残(運用通貨)
  6258       15  UYTK-PPAY-ZN      PIC  X(30).
  6259       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6260*----------  経過利息金額(運用通貨)
  6261       15  KEKA-RSK-LC       PIC  X(30).
  6262       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6263*----------  未収収益(運用通貨)
  6264       15  UYTK-MS-EKI       PIC  X(30).
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 109
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/MUSRGXZT.cpy)BOL.cpy)
  6265       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6266*----------  送付側銘柄コード
  6267       15  SEND-MEG-CD       PIC  X(20).
  6268       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6269*---------- 銘柄名称(日本語)
  6270       15  MEG-MEI-JP        PIC  X(80).
  6271       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6272*---------- 銘柄名称(英語)
  6273       15  MEG-MEI-EN        PIC  X(40).
  6274       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6275*---------- 債券ｸｰﾎﾟﾝ
  6276       15  SK-KP             PIC  X(30).
  6277       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6278*---------- 債券償還日
  6279       15  SHOKAN-YMD        PIC  S9(08).
  6280       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6281*----------  備考１
  6282       15  BIKOU-1           PIC  X(20).
  6283       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6284*----------  備考２
  6285       15  BIKOU-2           PIC  X(20).
  6286       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6287*----------  備考３
  6288       15  BIKOU-3           PIC  X(20).
  6289       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6290*----------  備考４
  6291       15  BIKOU-4           PIC  X(20).
  6292       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6293*----------  備考５
  6294       15  BIKOU-5           PIC  X(30).
  6295       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6296*----------  備考６
  6297       15  BIKOU-6           PIC  X(30).
  6298       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6299*----------  備考７
  6300       15  BIKOU-7           PIC  X(30).
  6301       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6302*----------  備考８
  6303       15  BIKOU-8           PIC  X(30).
  6304       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6305*----------  備考９
  6306       15  BIKOU-9           PIC  X(30).
  6307*---------- 合計用
  6308   05  WK-REC2.
* 6309     COPY  "MUSRGXZT.cpy".
  6310******************************************************************
  6311* $Header$
  6312******************************************************************
  6313*
  6314* システムＩＤ   : T-STAR
  6315* システム名称   : 次期TSTARシステム
  6316* コピー句ＩＤ   : MUSRGXZT.cpy
  6317* コピー句名称   : MUSR2651文件出力コピー句
  6318*
  6319* 改訂履歴
  6320* 年月日   区分 所属     担当者  内容
  6321* -------- ---- -------- ------- ---------------------------------
  6322* 20080610 新規 SCS      徐勝飛  新規作成
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 110
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/MUSRGXZT.cpy)BOL.cpy)
  6323* 20081231 修正 SCS      馬輝    連結障害493の対応
  6324*
  6325******************************************************************
  6326*----------  (メッセージコード)
  6327       15  MSG-CODE          PIC  X(06).
  6328       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6329*----------  自社コード(出力側)
  6330       15  ZISYA-CODE        PIC  X(11).
  6331       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6332*----------  ポートフォリオコード
  6333       15  PTF-CD            PIC  X(20).
  6334       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6335*----------  約定/受渡区分
  6336       15  YJ-UW-KBN         PIC  X(01).
  6337       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6338*----------  残高日付
  6339       15  ZANTK-YMD         PIC  S9(08).
  6340       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6341*----------  証券種別
  6342       15  SEC-SBT-CD        PIC  X(04).
  6343       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6344*----------  取消フラグ
  6345       15  DEL-KBN           PIC  X(01).
  6346       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6347*----------  確定フラグ
  6348       15  KT-KBN            PIC  X(01).
  6349       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6350*----------  取引通貨
  6351       15  TRHK-TUKA         PIC  X(03).
  6352       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6353*----------  為替決済通貨
  6354       15  KWS-TH-TUKA-CD    PIC  X(03).
  6355       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6356*----------  証券発行元の所属する国
  6357       15  HAKO-CD           PIC  X(02).
  6358       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6359*----------  銘柄コード体系
  6360       15  MEG-CD-GRP        PIC  X(01).
  6361       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6362*----------  銘柄コード
  6363       15  MEG-CD            PIC  X(20).
  6364       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6365*----------  買建/売建フラグ
  6366       15  TATE-FLG          PIC  X(01).
  6367       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6368*----------  作成/更新年月日
  6369       15  UPD-YMD           PIC  S9(08).
  6370       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6371*----------  作成/更新時刻
  6372       15  UPD-TIME          PIC  S9(06).
  6373       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6374*----------  約定日
  6375       15  YAKU-NITI         PIC  S9(08).
  6376       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6377*----------  建玉/約定番号
  6378       15  KB-KANRI-ID       PIC  X(10).
  6379       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6380*----------  カストディコード
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 111
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/MUSRGXZT.cpy)BOL.cpy)
  6381       15  CAST-CD           PIC  X(11).
  6382       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6383*----------  保有数量
  6384       15  HOU-SURYO         PIC  X(30).
  6385       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6386*----------  数量単位
  6387       15  SURYO-TANI        PIC  X(30).
  6388       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6389*----------  取得金額(取引通貨)
  6390       15  THTK-ST-KNG       PIC  X(30).
  6391       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6392*----------  取得単価(取引通貨)
  6393       15  THTK-ST-TNK       PIC  X(30).
  6394       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6395*----------  時価(取引通貨)
  6396       15  CP-KRTU-CD        PIC  X(30).
  6397       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6398*----------  時価採用日付
  6399       15  CP-SAIYO-YMD      PIC  S9(08).
  6400       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6401*----------  時価採用市場
  6402       15  CP-SAIYO-SIJO     PIC  X(05).
  6403       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6404*----------  評価金額(取引通貨)
  6405       15  THTK-HYK-KN       PIC  X(30).
  6406       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6407*----------  評価損益(取引通貨)
  6408       15  THTK-HYK-SNEKI    PIC  X(30).
  6409       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6410*----------  前払金残(取引通貨)
  6411       15  THTK-PPAYZN       PIC  X(30).
  6412       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6413*----------  経過利息金額(取引通貨)
  6414       15  THTK-KKRS         PIC  X(30).
  6415       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6416*----------  未収収益(取引通貨)
  6417       15  THTK-MS-EKI       PIC  X(30).
  6418       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6419*----------  評価為替レート
  6420       15  HYK-KWS           PIC  X(30).
  6421       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6422*----------  為替採用日付
  6423       15  KWS-SAIYO-YMD     PIC  S9(08).
  6424       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6425*----------  為替採用ソース
  6426       15  KWS-SAIYO-SOURCE  PIC  X(05).
  6427       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6428*----------  取得金額(運用通貨為替換算額)
  6429       15  UYTK-KWS-BOKAZN   PIC  X(30).
  6430       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6431*----------  取得金額(運用通貨)
  6432       15  SHTK-KN-LC        PIC  X(30).
  6433       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6434*----------  取得単価(運用通貨)
  6435       15  UYTK-ST-TNK       PIC  X(30).
  6436       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6437*----------  評価金額(運用通貨)
  6438       15  HYK-KN-LC         PIC  X(30).
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 112
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/MUSRGXZT.cpy)BOL.cpy)
  6439       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6440*----------  評価損益(運用通貨)
  6441       15  HYK-SNEKI-LC      PIC  X(30).
  6442       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6443*----------  前払金残(運用通貨)
  6444       15  UYTK-PPAY-ZN      PIC  X(30).
  6445       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6446*----------  経過利息金額(運用通貨)
  6447       15  KEKA-RSK-LC       PIC  X(30).
  6448       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6449*----------  未収収益(運用通貨)
  6450       15  UYTK-MS-EKI       PIC  X(30).
  6451       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6452*----------  送付側銘柄コード
  6453       15  SEND-MEG-CD       PIC  X(20).
  6454       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6455*---------- 銘柄名称(日本語)
  6456       15  MEG-MEI-JP        PIC  X(80).
  6457       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6458*---------- 銘柄名称(英語)
  6459       15  MEG-MEI-EN        PIC  X(40).
  6460       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6461*---------- 債券ｸｰﾎﾟﾝ
  6462       15  SK-KP             PIC  X(30).
  6463       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6464*---------- 債券償還日
  6465       15  SHOKAN-YMD        PIC  S9(08).
  6466       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6467*----------  備考１
  6468       15  BIKOU-1           PIC  X(20).
  6469       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6470*----------  備考２
  6471       15  BIKOU-2           PIC  X(20).
  6472       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6473*----------  備考３
  6474       15  BIKOU-3           PIC  X(20).
  6475       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6476*----------  備考４
  6477       15  BIKOU-4           PIC  X(20).
  6478       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6479*----------  備考５
  6480       15  BIKOU-5           PIC  X(30).
  6481       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6482*----------  備考６
  6483       15  BIKOU-6           PIC  X(30).
  6484       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6485*----------  備考７
  6486       15  BIKOU-7           PIC  X(30).
  6487       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6488*----------  備考８
  6489       15  BIKOU-8           PIC  X(30).
  6490       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6491*----------  備考９
  6492       15  BIKOU-9           PIC  X(30).
  6493   05  WK-REC3.
  6494     10  WK-REC-REC          OCCURS  10.
* 6495       COPY  "MUSRGXZT.cpy".
  6496******************************************************************
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 113
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/MUSRGXZT.cpy)BOL.cpy)
  6497* $Header$
  6498******************************************************************
  6499*
  6500* システムＩＤ   : T-STAR
  6501* システム名称   : 次期TSTARシステム
  6502* コピー句ＩＤ   : MUSRGXZT.cpy
  6503* コピー句名称   : MUSR2651文件出力コピー句
  6504*
  6505* 改訂履歴
  6506* 年月日   区分 所属     担当者  内容
  6507* -------- ---- -------- ------- ---------------------------------
  6508* 20080610 新規 SCS      徐勝飛  新規作成
  6509* 20081231 修正 SCS      馬輝    連結障害493の対応
  6510*
  6511******************************************************************
  6512*----------  (メッセージコード)
  6513       15  MSG-CODE          PIC  X(06).
  6514       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6515*----------  自社コード(出力側)
  6516       15  ZISYA-CODE        PIC  X(11).
  6517       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6518*----------  ポートフォリオコード
  6519       15  PTF-CD            PIC  X(20).
  6520       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6521*----------  約定/受渡区分
  6522       15  YJ-UW-KBN         PIC  X(01).
  6523       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6524*----------  残高日付
  6525       15  ZANTK-YMD         PIC  S9(08).
  6526       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6527*----------  証券種別
  6528       15  SEC-SBT-CD        PIC  X(04).
  6529       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6530*----------  取消フラグ
  6531       15  DEL-KBN           PIC  X(01).
  6532       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6533*----------  確定フラグ
  6534       15  KT-KBN            PIC  X(01).
  6535       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6536*----------  取引通貨
  6537       15  TRHK-TUKA         PIC  X(03).
  6538       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6539*----------  為替決済通貨
  6540       15  KWS-TH-TUKA-CD    PIC  X(03).
  6541       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6542*----------  証券発行元の所属する国
  6543       15  HAKO-CD           PIC  X(02).
  6544       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6545*----------  銘柄コード体系
  6546       15  MEG-CD-GRP        PIC  X(01).
  6547       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6548*----------  銘柄コード
  6549       15  MEG-CD            PIC  X(20).
  6550       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6551*----------  買建/売建フラグ
  6552       15  TATE-FLG          PIC  X(01).
  6553       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6554*----------  作成/更新年月日
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 114
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/MUSRGXZT.cpy)BOL.cpy)
  6555       15  UPD-YMD           PIC  S9(08).
  6556       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6557*----------  作成/更新時刻
  6558       15  UPD-TIME          PIC  S9(06).
  6559       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6560*----------  約定日
  6561       15  YAKU-NITI         PIC  S9(08).
  6562       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6563*----------  建玉/約定番号
  6564       15  KB-KANRI-ID       PIC  X(10).
  6565       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6566*----------  カストディコード
  6567       15  CAST-CD           PIC  X(11).
  6568       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6569*----------  保有数量
  6570       15  HOU-SURYO         PIC  X(30).
  6571       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6572*----------  数量単位
  6573       15  SURYO-TANI        PIC  X(30).
  6574       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6575*----------  取得金額(取引通貨)
  6576       15  THTK-ST-KNG       PIC  X(30).
  6577       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6578*----------  取得単価(取引通貨)
  6579       15  THTK-ST-TNK       PIC  X(30).
  6580       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6581*----------  時価(取引通貨)
  6582       15  CP-KRTU-CD        PIC  X(30).
  6583       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6584*----------  時価採用日付
  6585       15  CP-SAIYO-YMD      PIC  S9(08).
  6586       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6587*----------  時価採用市場
  6588       15  CP-SAIYO-SIJO     PIC  X(05).
  6589       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6590*----------  評価金額(取引通貨)
  6591       15  THTK-HYK-KN       PIC  X(30).
  6592       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6593*----------  評価損益(取引通貨)
  6594       15  THTK-HYK-SNEKI    PIC  X(30).
  6595       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6596*----------  前払金残(取引通貨)
  6597       15  THTK-PPAYZN       PIC  X(30).
  6598       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6599*----------  経過利息金額(取引通貨)
  6600       15  THTK-KKRS         PIC  X(30).
  6601       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6602*----------  未収収益(取引通貨)
  6603       15  THTK-MS-EKI       PIC  X(30).
  6604       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6605*----------  評価為替レート
  6606       15  HYK-KWS           PIC  X(30).
  6607       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6608*----------  為替採用日付
  6609       15  KWS-SAIYO-YMD     PIC  S9(08).
  6610       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6611*----------  為替採用ソース
  6612       15  KWS-SAIYO-SOURCE  PIC  X(05).
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 115
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/MUSRGXZT.cpy)BOL.cpy)
  6613       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6614*----------  取得金額(運用通貨為替換算額)
  6615       15  UYTK-KWS-BOKAZN   PIC  X(30).
  6616       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6617*----------  取得金額(運用通貨)
  6618       15  SHTK-KN-LC        PIC  X(30).
  6619       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6620*----------  取得単価(運用通貨)
  6621       15  UYTK-ST-TNK       PIC  X(30).
  6622       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6623*----------  評価金額(運用通貨)
  6624       15  HYK-KN-LC         PIC  X(30).
  6625       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6626*----------  評価損益(運用通貨)
  6627       15  HYK-SNEKI-LC      PIC  X(30).
  6628       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6629*----------  前払金残(運用通貨)
  6630       15  UYTK-PPAY-ZN      PIC  X(30).
  6631       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6632*----------  経過利息金額(運用通貨)
  6633       15  KEKA-RSK-LC       PIC  X(30).
  6634       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6635*----------  未収収益(運用通貨)
  6636       15  UYTK-MS-EKI       PIC  X(30).
  6637       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6638*----------  送付側銘柄コード
  6639       15  SEND-MEG-CD       PIC  X(20).
  6640       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6641*---------- 銘柄名称(日本語)
  6642       15  MEG-MEI-JP        PIC  X(80).
  6643       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6644*---------- 銘柄名称(英語)
  6645       15  MEG-MEI-EN        PIC  X(40).
  6646       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6647*---------- 債券ｸｰﾎﾟﾝ
  6648       15  SK-KP             PIC  X(30).
  6649       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6650*---------- 債券償還日
  6651       15  SHOKAN-YMD        PIC  S9(08).
  6652       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6653*----------  備考１
  6654       15  BIKOU-1           PIC  X(20).
  6655       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6656*----------  備考２
  6657       15  BIKOU-2           PIC  X(20).
  6658       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6659*----------  備考３
  6660       15  BIKOU-3           PIC  X(20).
  6661       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6662*----------  備考４
  6663       15  BIKOU-4           PIC  X(20).
  6664       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6665*----------  備考５
  6666       15  BIKOU-5           PIC  X(30).
  6667       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6668*----------  備考６
  6669       15  BIKOU-6           PIC  X(30).
  6670       15  FILLER            PIC  X(01)  VALUE  X'09'.
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 116
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/MUSRGXZT.cpy)BOL.cpy)
  6671*----------  備考７
  6672       15  BIKOU-7           PIC  X(30).
  6673       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6674*----------  備考８
  6675       15  BIKOU-8           PIC  X(30).
  6676       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6677*----------  備考９
  6678       15  BIKOU-9           PIC  X(30).
  6679   05  WK-REC4.
  6680     10  WK-REC-REC4         OCCURS  3.
* 6681       COPY  "MUSRGXZT.cpy".
  6682******************************************************************
  6683* $Header$
  6684******************************************************************
  6685*
  6686* システムＩＤ   : T-STAR
  6687* システム名称   : 次期TSTARシステム
  6688* コピー句ＩＤ   : MUSRGXZT.cpy
  6689* コピー句名称   : MUSR2651文件出力コピー句
  6690*
  6691* 改訂履歴
  6692* 年月日   区分 所属     担当者  内容
  6693* -------- ---- -------- ------- ---------------------------------
  6694* 20080610 新規 SCS      徐勝飛  新規作成
  6695* 20081231 修正 SCS      馬輝    連結障害493の対応
  6696*
  6697******************************************************************
  6698*----------  (メッセージコード)
  6699       15  MSG-CODE          PIC  X(06).
  6700       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6701*----------  自社コード(出力側)
  6702       15  ZISYA-CODE        PIC  X(11).
  6703       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6704*----------  ポートフォリオコード
  6705       15  PTF-CD            PIC  X(20).
  6706       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6707*----------  約定/受渡区分
  6708       15  YJ-UW-KBN         PIC  X(01).
  6709       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6710*----------  残高日付
  6711       15  ZANTK-YMD         PIC  S9(08).
  6712       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6713*----------  証券種別
  6714       15  SEC-SBT-CD        PIC  X(04).
  6715       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6716*----------  取消フラグ
  6717       15  DEL-KBN           PIC  X(01).
  6718       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6719*----------  確定フラグ
  6720       15  KT-KBN            PIC  X(01).
  6721       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6722*----------  取引通貨
  6723       15  TRHK-TUKA         PIC  X(03).
  6724       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6725*----------  為替決済通貨
  6726       15  KWS-TH-TUKA-CD    PIC  X(03).
  6727       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6728*----------  証券発行元の所属する国
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 117
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/MUSRGXZT.cpy)BOL.cpy)
  6729       15  HAKO-CD           PIC  X(02).
  6730       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6731*----------  銘柄コード体系
  6732       15  MEG-CD-GRP        PIC  X(01).
  6733       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6734*----------  銘柄コード
  6735       15  MEG-CD            PIC  X(20).
  6736       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6737*----------  買建/売建フラグ
  6738       15  TATE-FLG          PIC  X(01).
  6739       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6740*----------  作成/更新年月日
  6741       15  UPD-YMD           PIC  S9(08).
  6742       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6743*----------  作成/更新時刻
  6744       15  UPD-TIME          PIC  S9(06).
  6745       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6746*----------  約定日
  6747       15  YAKU-NITI         PIC  S9(08).
  6748       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6749*----------  建玉/約定番号
  6750       15  KB-KANRI-ID       PIC  X(10).
  6751       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6752*----------  カストディコード
  6753       15  CAST-CD           PIC  X(11).
  6754       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6755*----------  保有数量
  6756       15  HOU-SURYO         PIC  X(30).
  6757       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6758*----------  数量単位
  6759       15  SURYO-TANI        PIC  X(30).
  6760       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6761*----------  取得金額(取引通貨)
  6762       15  THTK-ST-KNG       PIC  X(30).
  6763       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6764*----------  取得単価(取引通貨)
  6765       15  THTK-ST-TNK       PIC  X(30).
  6766       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6767*----------  時価(取引通貨)
  6768       15  CP-KRTU-CD        PIC  X(30).
  6769       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6770*----------  時価採用日付
  6771       15  CP-SAIYO-YMD      PIC  S9(08).
  6772       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6773*----------  時価採用市場
  6774       15  CP-SAIYO-SIJO     PIC  X(05).
  6775       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6776*----------  評価金額(取引通貨)
  6777       15  THTK-HYK-KN       PIC  X(30).
  6778       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6779*----------  評価損益(取引通貨)
  6780       15  THTK-HYK-SNEKI    PIC  X(30).
  6781       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6782*----------  前払金残(取引通貨)
  6783       15  THTK-PPAYZN       PIC  X(30).
  6784       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6785*----------  経過利息金額(取引通貨)
  6786       15  THTK-KKRS         PIC  X(30).
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 118
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/MUSRGXZT.cpy)BOL.cpy)
  6787       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6788*----------  未収収益(取引通貨)
  6789       15  THTK-MS-EKI       PIC  X(30).
  6790       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6791*----------  評価為替レート
  6792       15  HYK-KWS           PIC  X(30).
  6793       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6794*----------  為替採用日付
  6795       15  KWS-SAIYO-YMD     PIC  S9(08).
  6796       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6797*----------  為替採用ソース
  6798       15  KWS-SAIYO-SOURCE  PIC  X(05).
  6799       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6800*----------  取得金額(運用通貨為替換算額)
  6801       15  UYTK-KWS-BOKAZN   PIC  X(30).
  6802       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6803*----------  取得金額(運用通貨)
  6804       15  SHTK-KN-LC        PIC  X(30).
  6805       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6806*----------  取得単価(運用通貨)
  6807       15  UYTK-ST-TNK       PIC  X(30).
  6808       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6809*----------  評価金額(運用通貨)
  6810       15  HYK-KN-LC         PIC  X(30).
  6811       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6812*----------  評価損益(運用通貨)
  6813       15  HYK-SNEKI-LC      PIC  X(30).
  6814       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6815*----------  前払金残(運用通貨)
  6816       15  UYTK-PPAY-ZN      PIC  X(30).
  6817       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6818*----------  経過利息金額(運用通貨)
  6819       15  KEKA-RSK-LC       PIC  X(30).
  6820       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6821*----------  未収収益(運用通貨)
  6822       15  UYTK-MS-EKI       PIC  X(30).
  6823       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6824*----------  送付側銘柄コード
  6825       15  SEND-MEG-CD       PIC  X(20).
  6826       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6827*---------- 銘柄名称(日本語)
  6828       15  MEG-MEI-JP        PIC  X(80).
  6829       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6830*---------- 銘柄名称(英語)
  6831       15  MEG-MEI-EN        PIC  X(40).
  6832       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6833*---------- 債券ｸｰﾎﾟﾝ
  6834       15  SK-KP             PIC  X(30).
  6835       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6836*---------- 債券償還日
  6837       15  SHOKAN-YMD        PIC  S9(08).
  6838       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6839*----------  備考１
  6840       15  BIKOU-1           PIC  X(20).
  6841       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6842*----------  備考２
  6843       15  BIKOU-2           PIC  X(20).
  6844       15  FILLER            PIC  X(01)  VALUE  X'09'.
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 119
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/MUSRGXZT.cpy)BOL.cpy)
  6845*----------  備考３
  6846       15  BIKOU-3           PIC  X(20).
  6847       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6848*----------  備考４
  6849       15  BIKOU-4           PIC  X(20).
  6850       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6851*----------  備考５
  6852       15  BIKOU-5           PIC  X(30).
  6853       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6854*----------  備考６
  6855       15  BIKOU-6           PIC  X(30).
  6856       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6857*----------  備考７
  6858       15  BIKOU-7           PIC  X(30).
  6859       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6860*----------  備考８
  6861       15  BIKOU-8           PIC  X(30).
  6862       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6863*----------  備考９
  6864       15  BIKOU-9           PIC  X(30).
  6865   05  WK-REC5.
  6866     10  WK-REC-REC5         OCCURS  2.
* 6867       COPY  "MUSRGXZT.cpy".
  6868******************************************************************
  6869* $Header$
  6870******************************************************************
  6871*
  6872* システムＩＤ   : T-STAR
  6873* システム名称   : 次期TSTARシステム
  6874* コピー句ＩＤ   : MUSRGXZT.cpy
  6875* コピー句名称   : MUSR2651文件出力コピー句
  6876*
  6877* 改訂履歴
  6878* 年月日   区分 所属     担当者  内容
  6879* -------- ---- -------- ------- ---------------------------------
  6880* 20080610 新規 SCS      徐勝飛  新規作成
  6881* 20081231 修正 SCS      馬輝    連結障害493の対応
  6882*
  6883******************************************************************
  6884*----------  (メッセージコード)
  6885       15  MSG-CODE          PIC  X(06).
  6886       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6887*----------  自社コード(出力側)
  6888       15  ZISYA-CODE        PIC  X(11).
  6889       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6890*----------  ポートフォリオコード
  6891       15  PTF-CD            PIC  X(20).
  6892       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6893*----------  約定/受渡区分
  6894       15  YJ-UW-KBN         PIC  X(01).
  6895       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6896*----------  残高日付
  6897       15  ZANTK-YMD         PIC  S9(08).
  6898       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6899*----------  証券種別
  6900       15  SEC-SBT-CD        PIC  X(04).
  6901       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6902*----------  取消フラグ
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 120
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/MUSRGXZT.cpy)BOL.cpy)
  6903       15  DEL-KBN           PIC  X(01).
  6904       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6905*----------  確定フラグ
  6906       15  KT-KBN            PIC  X(01).
  6907       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6908*----------  取引通貨
  6909       15  TRHK-TUKA         PIC  X(03).
  6910       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6911*----------  為替決済通貨
  6912       15  KWS-TH-TUKA-CD    PIC  X(03).
  6913       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6914*----------  証券発行元の所属する国
  6915       15  HAKO-CD           PIC  X(02).
  6916       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6917*----------  銘柄コード体系
  6918       15  MEG-CD-GRP        PIC  X(01).
  6919       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6920*----------  銘柄コード
  6921       15  MEG-CD            PIC  X(20).
  6922       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6923*----------  買建/売建フラグ
  6924       15  TATE-FLG          PIC  X(01).
  6925       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6926*----------  作成/更新年月日
  6927       15  UPD-YMD           PIC  S9(08).
  6928       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6929*----------  作成/更新時刻
  6930       15  UPD-TIME          PIC  S9(06).
  6931       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6932*----------  約定日
  6933       15  YAKU-NITI         PIC  S9(08).
  6934       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6935*----------  建玉/約定番号
  6936       15  KB-KANRI-ID       PIC  X(10).
  6937       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6938*----------  カストディコード
  6939       15  CAST-CD           PIC  X(11).
  6940       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6941*----------  保有数量
  6942       15  HOU-SURYO         PIC  X(30).
  6943       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6944*----------  数量単位
  6945       15  SURYO-TANI        PIC  X(30).
  6946       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6947*----------  取得金額(取引通貨)
  6948       15  THTK-ST-KNG       PIC  X(30).
  6949       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6950*----------  取得単価(取引通貨)
  6951       15  THTK-ST-TNK       PIC  X(30).
  6952       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6953*----------  時価(取引通貨)
  6954       15  CP-KRTU-CD        PIC  X(30).
  6955       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6956*----------  時価採用日付
  6957       15  CP-SAIYO-YMD      PIC  S9(08).
  6958       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6959*----------  時価採用市場
  6960       15  CP-SAIYO-SIJO     PIC  X(05).
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 121
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/MUSRGXZT.cpy)BOL.cpy)
  6961       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6962*----------  評価金額(取引通貨)
  6963       15  THTK-HYK-KN       PIC  X(30).
  6964       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6965*----------  評価損益(取引通貨)
  6966       15  THTK-HYK-SNEKI    PIC  X(30).
  6967       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6968*----------  前払金残(取引通貨)
  6969       15  THTK-PPAYZN       PIC  X(30).
  6970       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6971*----------  経過利息金額(取引通貨)
  6972       15  THTK-KKRS         PIC  X(30).
  6973       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6974*----------  未収収益(取引通貨)
  6975       15  THTK-MS-EKI       PIC  X(30).
  6976       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6977*----------  評価為替レート
  6978       15  HYK-KWS           PIC  X(30).
  6979       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6980*----------  為替採用日付
  6981       15  KWS-SAIYO-YMD     PIC  S9(08).
  6982       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6983*----------  為替採用ソース
  6984       15  KWS-SAIYO-SOURCE  PIC  X(05).
  6985       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6986*----------  取得金額(運用通貨為替換算額)
  6987       15  UYTK-KWS-BOKAZN   PIC  X(30).
  6988       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6989*----------  取得金額(運用通貨)
  6990       15  SHTK-KN-LC        PIC  X(30).
  6991       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6992*----------  取得単価(運用通貨)
  6993       15  UYTK-ST-TNK       PIC  X(30).
  6994       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6995*----------  評価金額(運用通貨)
  6996       15  HYK-KN-LC         PIC  X(30).
  6997       15  FILLER            PIC  X(01)  VALUE  X'09'.
  6998*----------  評価損益(運用通貨)
  6999       15  HYK-SNEKI-LC      PIC  X(30).
  7000       15  FILLER            PIC  X(01)  VALUE  X'09'.
  7001*----------  前払金残(運用通貨)
  7002       15  UYTK-PPAY-ZN      PIC  X(30).
  7003       15  FILLER            PIC  X(01)  VALUE  X'09'.
  7004*----------  経過利息金額(運用通貨)
  7005       15  KEKA-RSK-LC       PIC  X(30).
  7006       15  FILLER            PIC  X(01)  VALUE  X'09'.
  7007*----------  未収収益(運用通貨)
  7008       15  UYTK-MS-EKI       PIC  X(30).
  7009       15  FILLER            PIC  X(01)  VALUE  X'09'.
  7010*----------  送付側銘柄コード
  7011       15  SEND-MEG-CD       PIC  X(20).
  7012       15  FILLER            PIC  X(01)  VALUE  X'09'.
  7013*---------- 銘柄名称(日本語)
  7014       15  MEG-MEI-JP        PIC  X(80).
  7015       15  FILLER            PIC  X(01)  VALUE  X'09'.
  7016*---------- 銘柄名称(英語)
  7017       15  MEG-MEI-EN        PIC  X(40).
  7018       15  FILLER            PIC  X(01)  VALUE  X'09'.
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 122
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/MUSRGXZT.cpy)BOL.cpy)
  7019*---------- 債券ｸｰﾎﾟﾝ
  7020       15  SK-KP             PIC  X(30).
  7021       15  FILLER            PIC  X(01)  VALUE  X'09'.
  7022*---------- 債券償還日
  7023       15  SHOKAN-YMD        PIC  S9(08).
  7024       15  FILLER            PIC  X(01)  VALUE  X'09'.
  7025*----------  備考１
  7026       15  BIKOU-1           PIC  X(20).
  7027       15  FILLER            PIC  X(01)  VALUE  X'09'.
  7028*----------  備考２
  7029       15  BIKOU-2           PIC  X(20).
  7030       15  FILLER            PIC  X(01)  VALUE  X'09'.
  7031*----------  備考３
  7032       15  BIKOU-3           PIC  X(20).
  7033       15  FILLER            PIC  X(01)  VALUE  X'09'.
  7034*----------  備考４
  7035       15  BIKOU-4           PIC  X(20).
  7036       15  FILLER            PIC  X(01)  VALUE  X'09'.
  7037*----------  備考５
  7038       15  BIKOU-5           PIC  X(30).
  7039       15  FILLER            PIC  X(01)  VALUE  X'09'.
  7040*----------  備考６
  7041       15  BIKOU-6           PIC  X(30).
  7042       15  FILLER            PIC  X(01)  VALUE  X'09'.
  7043*----------  備考７
  7044       15  BIKOU-7           PIC  X(30).
  7045       15  FILLER            PIC  X(01)  VALUE  X'09'.
  7046*----------  備考８
  7047       15  BIKOU-8           PIC  X(30).
  7048       15  FILLER            PIC  X(01)  VALUE  X'09'.
  7049*----------  備考９
  7050       15  BIKOU-9           PIC  X(30).
  7051*------------------ <残タスク135の対応 START>---------------------
  7052*---------- 取引通貨
  7053   05  WK-TRHK-TUKA          PIC  X(04).
  7054*---------- 為替決済通貨
  7055   05  WK-KWS-TH-TUKA-CD     PIC  X(04).
  7056*------------------ <残タスク135の対応 END>-----------------------
  7057*----------  エラーカウンター数
  7058   05  WK-ERR-CNT            PIC  9(02).
  7059   05  WK-18-18-X
  7060       PIC  -----------------9.999999999999999999.
  7061   05  WK-NUM-1              PIC  9(02).
  7062   05  WK-NUM-LENGTH         PIC  9(02).
  7063   05  WK-NUM-FROM           PIC  9(02).
  7064   05  WK-HYK-EX-SHTK-PTN-CD PIC  X(04).
  7065   05  WK-PRIO-1-EX-KRTU     PIC  X(04).
  7066   05  WK-KUNI-CD-RYAKU      PIC  X(02).
  7067   05  WK-SEC-SBT-4156       PIC  X(04).
  7068   05  WK-MEG-CD-3002        PIC  X(15).
  7069   05  WK-SEC-SBT-3002       PIC  X(04).
  7070   05  WK-MEG-CD-3002-3      PIC  X(15).
  7071   05  WK-SEC-SBT-3002-3     PIC  X(04).
  7072   05  WK-MEG-CD-3004        PIC  X(15).
  7073   05  WK-HAKO-CD-4102       PIC  X(04).
  7074   05  WK-SEC-SBT-4182-2     PIC  X(04).
  7075   05  WK-HYK-EX-FLG         PIC  9(01).
  7076   05  WK-PRIO-1-FLG         PIC  9(01).
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 123
* MUSR2651.cob                                                     cpy)BOL.cpy)
  7077   05  WK-TRHK-TUKA-4012     PIC  X(04).
  7078   05  WK-KWS-ZYOUHO-FLG     PIC  9(01).
  7079   05  WK-PRIO-3017          PIC  X(04).
  7080   05  WK-TRHK-TUKA-3017     PIC  X(04).
  7081   05  WK-CAPITAL-TUKA-3017  PIC  X(04).
  7082   05  WK-BIKOU-FLG          PIC  9(01).
  7083   05  WK-BIKOU-4116         PIC  X(20).
  7084   05  WK-KUNI-FLG           PIC  9(01).
  7085   05  WK-TRHK-TUKA-0604     PIC  X(04).
  7086   05  WK-RTN-4156           PIC  X(03).
  7087   05  WK-RTN-3004           PIC  X(03).
  7088   05  WK-RTN-3002           PIC  X(03).
  7089   05  WK-RTN-4102           PIC  X(03).
  7090   05  WK-RTN-4182-2         PIC  X(03).
  7091   05  WK-RTN-3017           PIC  X(03).
  7092   05  WK-RTN-3017-2         PIC  X(03).
  7093   05  WK-RTN-4116           PIC  X(03).
  7094   05  WK-RTN-3002-3         PIC  X(03).
  7095   05  WK-RTN-4009           PIC  X(03).
  7096   05  WK-RTN-4012           PIC  X(03).
  7097   05  WK-RTN-0604           PIC  X(03).
  7098   05  WK-RTN-3002-2         PIC  X(03).
  7099*----------  テーマ3276　開始
  7100   05  WK-ITIOKU-TNK         PIC  S9(09)V9(09).
  7101   05  WK-ITIOKU-CP          PIC  S9(09)V9(09).
  7102   05  WK-ITIOKU-ST-TNK      PIC  S9(09)V9(09).
  7103*----------  テーマ3276　終了
  7104*******         テーマ3422              修正  開始        ********
  7105*----------  ワーク取引決済乗除区分フラグ
  7106   05  WK-TH-ZYOUHO-FLG      PIC  9(01).
  7107*----------  ワーク約定為替換算時採用系列_時価(取引通貨)用
  7108   05  WK-PRIO-CP            PIC  X(04).
  7109*----------  ワークベース通貨コード_時価(取引通貨)用
  7110   05  WK-BASE-TUKA-CP       PIC  X(04).
  7111*----------  ワーク目的通貨コード_時価(取引通貨)用
  7112   05  WK-MOKU-TUKA-CP       PIC  X(04).
  7113*******         テーマ3422              修正  終了        ********
  7114*----------　テーマ3344対応開始
  7115*----------  未収収益(取引通貨)
  7116   05  WK-THTK-MS-EKI        PIC  S9(15)V9(03).
  7117*----------  未収収益(運用通貨)
  7118   05  WK-UYTK-MS-EKI        PIC  S9(15)V9(03).
  7119*----------　テーマ3344対応終了
  7120******************************************************************
  7121*        共通関数引数用パラメータ エリア
  7122******************************************************************
  7123 01  PARM-SCZY3026-INOUT.
* 7124     COPY  "SCZY3026.cpy".
  7125******************************************************************
  7126* $Header$
  7127******************************************************************
  7128*
  7129* システムＩＤ   : T-STAR
  7130* システム名称   : 次期TSTARシステム
  7131* コピー句ＩＤ   : SCZY3026.cpy
  7132* コピー句名称   : GX接続用銘柄コード編集ルーチンコピー句
  7133*
  7134* 改訂履歴
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 124
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/SCZY3026.cpy)BOL.cpy)
  7135* 年月日   区分 所属     担当者  内容
  7136* -------- ---- -------- ------- ---------------------------------
  7137* 20100108 新規 ITS      譚      新規作成
  7138*
  7139******************************************************************
  7140******************************************************************
  7141*                入力パラメータ
  7142******************************************************************
  7143   05  PARM-SCZY3026-ARG1.
  7144*---------- 銘柄コード
  7145     10  MEG-CD              PIC  X(20).
  7146*---------- 銘柄通貨
  7147     10  MEG-TUKA-CD         PIC  X(04).
  7148*---------- 証券種別
  7149     10  SEC-SBT-CD          PIC  X(04).
  7150*---------- 株式種別
  7151     10  KABU-SBT            PIC  X(02).
  7152******************************************************************
  7153*                出力パラメータ
  7154******************************************************************
  7155   05  PARM-SCZY3026-ARG2.
  7156*---------- 銘柄コード
  7157     10  MEG-CD              PIC  X(20).
  7158*----------  カウンターパーティ全項目取得ルーチン
  7159 01  PARM-SCZY4116-INOUT.
* 7160     COPY  "SCZY4116.cpy".
  7161******************************************************************
  7162* $Header$
  7163******************************************************************
  7164*
  7165*  システムＩＤ   : T-STAR
  7166*  システム名称   : 次期TSTARシステム
  7167*  コピー句ＩＤ   : SCZY4116.cpy
  7168*  コピー句名称   : カウンターパーティ全項目取得
  7169*
  7170*  改訂履歴
  7171*  年月日     所属       担当者  内容
  7172*  ---------- ---------- ------  ----------------------------
  7173*  2008/03/25 SCS        張  春  新規
  7174******************************************************************
  7175 05  PARM-SCZY4116-ARG1.
  7176*----------  利用会社コード
  7177     10  RIYO-CMP-CD         PIC  X(04).
  7178*----------  カウンターパーティ分類
  7179     10  COUNTER-PARTY-BUNRUI
  7180                             PIC  X(01).
  7181*----------  適用開始日
  7182     10  TEKIYO-FROM         PIC  9(08).
  7183*----------  カウンターパーティコード
  7184     10  COUNTER-PARTY-CD    PIC  X(08).
  7185 05  PARM-SCZY4116-ARG2.
  7186*----------  カウンターパーティ分類
  7187     10  COUNTER-PARTY-BUNRUI
  7188                             PIC  X(01).
  7189*----------  適用開始日
  7190     10  TEKIYO-FROM         PIC  9(08).
  7191*----------  カウンターパーティコード
  7192     10  COUNTER-PARTY-CD    PIC  X(08).
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 125
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/SCZY4116.cpy)BOL.cpy)
  7193*----------  カウンターパーティ名称（日）
  7194     10  COUNT-PTY-NAME-J    PIC  X(60).
  7195*----------  カウンターパーティ名称（英）
  7196     10  COUNT-PTY-NAME-E    PIC  X(60).
  7197*----------  カウンターパーティ名称_略称（日）
  7198     10  COUNT-PTY-AB-NAME-J PIC  X(30).
  7199*----------  カウンターパーティ名称_略称（英）
  7200     10  COUNT-PTY-AB-NAME-E PIC  X(30).
  7201*----------  利害関係人区分
  7202     10  RIGAI-KANKEI-KBN    PIC  X(01).
  7203*----------  為替換算情報取得ルーチン
  7204 01  PARM-SCZY3017-INOUT.
* 7205     COPY  "SCZY3017.cpy".
  7206******************************************************************
  7207* $Header: /TSTAR2/apl/debug/JC/MAKE/src/copy/SCZY3017/SCZY3017.cpy,v 1.1.
  7208******************************************************************
  7209*
  7210* システムＩＤ   : T-STAR
  7211* システム名称   : 次期TSTARシステム
  7212* コピー句ＩＤ   : SCZY3017.cpy
  7213* コピー句名称   : 為替換算情報取得ルーチンコピー句
  7214*
  7215* 改訂履歴
  7216* 年月日   区分 所属     担当者  内容
  7217* -------- ---- -------- ------- ---------------------------------
  7218* 20080423 新規 ITS      王　懿  新規作成
  7219*
  7220******************************************************************
  7221******************************************************************
  7222*                入力パラメータ
  7223******************************************************************
  7224   05  PARM-SCZY3017-ARG1.
  7225*---------- 利用会社コード
  7226     10  RIYO-CMP-CD         PIC  X(04).
  7227*---------- 為替系列コード
  7228     10  KWS-KRTU-CD         PIC  X(04).
  7229*---------- ベース通貨コード
  7230     10  BASE-TUKA-CD        PIC  X(04).
  7231*---------- 目的通貨コード
  7232     10  MOKUTEKI-TUKA-CD    PIC  X(04).
  7233******************************************************************
  7234*                出力パラメータ
  7235******************************************************************
  7236   05  PARM-SCZY3017-ARG2.
  7237*---------- 媒介通貨
  7238     10  BAYIKAYI-TUKA       PIC  X(04).
  7239*---------- 乗算/除算区分
  7240     10  JZ-JS-KBN           PIC  X(01).
  7241*----------  ポートフォリオ属性テーブルからデータを取得
  7242 01  PARM-SCZY4007-INOUT.
* 7243     COPY  "SCZY4007.cpy".
  7244******************************************************************
  7245* $Header$
  7246******************************************************************
  7247*
  7248*  システムＩＤ   : T-STAR
  7249*  システム名称   : 次期TSTARシステム
  7250*  コピー句ＩＤ   : SCZY4007.cpy
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 126
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/SCZY4007.cpy)BOL.cpy)
  7251*  コピー句名称   : ポートフォリオ属性取得ルーチン
  7252*
  7253*  改訂履歴
  7254*  年月日     所属       担当者  内容
  7255*  ---------- ---------- ------  ----------------------------
  7256*  2008/01/08 SCS        趙迎慶  新規
  7257*
  7258******************************************************************
  7259 05  PARM-SCZY4007-ARG1.
  7260*----------  利用会社コード
  7261   10  RIYO-CMP-CD           PIC  X(04).
  7262*----------  ファンドコード
  7263   10  FUND-CD               PIC  X(12).
  7264*----------  ポートフォリオコード
  7265   10  PTF-CD                PIC  X(04).
  7266*----------  適用開始日
  7267   10  TEKIYO-FROM           PIC  9(08).
  7268 05  PARM-SCZY4007-ARG2.
  7269*----------  ポートフォリオ属性データ
  7270   10  TKPFZK01-DETAIL.
* 7271     COPY  "TKPFZK01.cpy".
  7272******************************************************************
  7273*
  7274*  システムＩＤ   : T-STAR
  7275*  システム名称   : 新有価証券バックオフィスシステム
  7276*  コピー句ＩＤ   : TKPFZK01.cpy
  7277*  コピー句名称   : ポートフォリオ属性
  7278*
  7279*  改訂履歴
  7280*  年月日     所属       担当者  内容
  7281*  ---------- ---------- ------  ----------------------------
  7282*  2010/05/11 NRI               新規
  7283*
  7284******************************************************************
  7285
  7286*----------  利用会社コード
  7287 20  RIYO-CMP-CD                             PIC  X(04).
  7288*----------  ファンドコード
  7289 20  FUND-CD                                 PIC  X(12).
  7290*----------  ポートフォリオコード
  7291 20  PTF-CD                                  PIC  X(04).
  7292*----------  適用開始日
  7293 20  TEKIYO-FROM                             PIC  S9(08).
  7294*----------  ファンド属性変更日
  7295 20  FUND-REVISE-YMD                         PIC  S9(08).
  7296*----------  サブポートフォリオ区分
  7297 20  SUB-PTF-KBN                             PIC  X(01).
  7298*----------  ダミーポートフォリオ区分
  7299 20  DUMMY-PTF-KBN                           PIC  X(01).
  7300*----------  ファンド名（日）
  7301 20  FND-MEI-JPN                             PIC  X(60).
  7302*----------  ファンド名（英）
  7303 20  FND-MEI-ENG                             PIC  X(60).
  7304*----------  マネージャーコード
  7305 20  MANAGER-CD                              PIC  X(04).
  7306*----------  設定日
  7307 20  SET-YMD                                 PIC  S9(08).
  7308*----------  保有目的
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 127
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/TKPFZK01.cpy)BOL.cpy)
  7309 20  POSSESSION-OBJECT                       PIC  X(01).
  7310*----------  決算回数
  7311 20  KESSAN-TIMES                            PIC  X(02).
  7312*----------  本決算月日
  7313 20  HON-KESSAN-MMDD                         PIC  S9(04).
  7314*----------  決算月日１
  7315 20  KESSAN-MMDD1                            PIC  S9(04).
  7316*----------  決算月日２
  7317 20  KESSAN-MMDD2                            PIC  S9(04).
  7318*----------  決算月日３
  7319 20  KESSAN-MMDD3                            PIC  S9(04).
  7320*----------  決算月日４
  7321 20  KESSAN-MMDD4                            PIC  S9(04).
  7322*----------  休日処理区分
  7323 20  KESSAN-QJT-SYRI                         PIC  X(01).
  7324*----------  運用国コード
  7325 20  OPER-KUNI-CD                            PIC  X(04).
  7326*----------  運用通貨コード
  7327 20  CAPITAL-TUKA-CD                         PIC  X(04).
  7328*----------  資金出資者区分
  7329 20  SIKIN-SYUSI-KBN                         PIC  X(01).
  7330*----------  財産区分
  7331 20  ZAISAN-KBN                              PIC  X(02).
  7332*----------  信託銀行コード
  7333 20  TRST-BNK-ID                             PIC  X(08).
  7334*----------  契約番号
  7335 20  TRST-CONTRACT-NO                        PIC  X(16).
  7336*----------  契約日
  7337 20  TRST-CONTRACT-DATE                      PIC  S9(08).
  7338*----------  料率パターンコード
  7339 20  COMMISSION-PATTERN                      PIC  X(04).
  7340*----------  運用区分１
  7341 20  TOKIN-UNYO-KBN1                         PIC  X(01).
  7342*----------  運用区分２
  7343 20  TOKIN-UNYO-KBN2                         PIC  X(01).
  7344*----------  運用区分３
  7345 20  TOKIN-UNYO-KBN3                         PIC  X(01).
  7346*----------  契約形態１
  7347 20  KEI-KEITAI1                             PIC  X(01).
  7348*----------  契約形態２
  7349 20  KEI-KEITAI2                             PIC  X(01).
  7350*----------  解約区分
  7351 20  CANCL-KBN                               PIC  X(01).
  7352*----------  解約日
  7353 20  CANCL-YMD                               PIC  S9(08).
  7354*----------  年金私募投信区分
  7355 20  NENKIN-TRST-KBN                         PIC  X(01).
  7356*----------  投信証券種別
  7357 20  TRST-SEC-SBT                            PIC  X(04).
  7358*----------  投信銘柄コード
  7359 20  TRST-MEG-CD                             PIC  X(15).
  7360*----------  投信計算口数
  7361 20  TRST-CALC-KUTISU                        PIC  S9(15)V9(03).
  7362*----------  ノンカバー取引区分
  7363 20  NONCOV-KBN                              PIC  X(01).
  7364*----------  為替換算方法（買）
  7365 20  BUY-KANSAN-HASU                         PIC  X(01).
  7366*----------  為替換算方法（売）
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 128
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/TKPFZK01.cpy)BOL.cpy)
  7367 20  SELL-KANNSAN-HASU                       PIC  X(01).
  7368*----------  評価換え方式
  7369 20  HYK-KAE-HOU                             PIC  X(01).
  7370*----------  約定為替換算時採用系列
  7371 20  YKJ-RATE-CD                             PIC  X(04).
  7372*----------  ポートフォリオ名（日）
  7373 20  PTF-MEI-JPN                             PIC  X(60).
  7374*----------  ポートフォリオ名（英）
  7375 20  PTF-MEI-ENG                             PIC  X(60).
  7376*----------  仕訳基準パターンコード
  7377 20  SWK-KJN-PTN-CD                          PIC  X(08).
  7378*----------  異動計算パターンコード
  7379 20  IDO-CALC-PATTERN-CD                     PIC  X(04).
  7380*----------  未収配当計上割合
  7381 20  MISYU-HAITOU-WARIAI                     PIC  S9(08)V9(10).
  7382*----------  利回り等端数
  7383 20  RIMAWARI-HASU                           PIC  X(01).
  7384*----------  カストディーフィー扱い区分
  7385 20  CUSTODY-FEE-ATUKAI                      PIC  X(01).
  7386*----------  利回り年率換算方法
  7387 20  RIMAWARI-KANSAN-HOU                     PIC  X(01).
  7388*----------  外貨預金為替差損益
  7389 20  G-YOKIN-KWS-SNEKI                       PIC  X(01).
  7390*----------  月中決算報告区分（月次）
  7391 20  KS-RPT-MONTH                            PIC  X(01).
  7392*----------  月中決算報告区分（四半期）
  7393 20  KS-RPT-QUARTER                          PIC  X(01).
  7394*----------  外貨決済取引区分
  7395 20  GAIKA-KESSAI-KBN                        PIC  X(01).
  7396*----------  日次評価法フラグ
  7397 20  NITIJI-HYK-FLG                          PIC  X(01).
  7398*----------  約定主義会計フラグ
  7399 20  YKJ-SYUGI-KAIKEI                        PIC  X(01).
  7400*----------  約定主義会計適用開始日
  7401 20  YKJ-SYUGI-KAIKEI-YMD                    PIC  S9(08).
  7402*----------  ＧＸ債券キャッシュフロー
  7403 20  CASH-FLOW-KBN                           PIC  X(01).
  7404*----------  経過利息計上レート区分
  7405 20  KJY-RATE                                PIC  X(01).
  7406*----------  特別イベント日１
  7407 20  EVENT-YMD1                              PIC  S9(08).
  7408*----------  特別イベント日２
  7409 20  EVENT-YMD2                              PIC  S9(08).
  7410*----------  特別イベント日３
  7411 20  EVENT-YMD3                              PIC  S9(08).
  7412*----------  備考
  7413 20  BIKOU                                   PIC  X(60).
  7414*----------  削除区分
  7415 20  SAKUJO-KBN                              PIC  X(01).
  7416*----------  元ファンドコード
  7417 20  MOTO-FUND-CD                            PIC  X(12).
  7418*----------  元ポートフォリオコード
  7419 20  MOTO-PTF-CD                             PIC  X(04).
  7420*----------  更新日時
  7421 20  UPD-DATE                                PIC  X(14).
  7422*----------  更新ログインユーザ会社コード
  7423 20  UPD-LOGIN-CMP-CD                        PIC  X(04).
  7424*----------  更新ユーザID
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 129
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/TKPFZK01.cpy)BOL.cpy)
  7425 20  UPD-SID                                 PIC  X(20).
  7426*----------  更新プログラムID
  7427 20  UPD-PGMID                               PIC  X(16).
  7428*----------  合成ファンド区分
  7429 20  COM-FND-KBN                             PIC  X(01).
  7430*----------  評価系列取得ルーチン
  7431 01  PARM-SCZY4009-INOUT.
* 7432     COPY  "SCZY4009.cpy".
  7433******************************************************************
  7434* $Header$
  7435******************************************************************
  7436*
  7437*  システムＩＤ   : T-STAR
  7438*  システム名称   : 次期TSTARシステム
  7439*  コピー句ＩＤ   : SCZY4009.cpy
  7440*  コピー句名称   : 評価系列取得ルーチン
  7441*
  7442*  改訂履歴
  7443*  年月日     所属       担当者  内容
  7444*  ---------- ---------- ------  ----------------------------
  7445*  2008/01/11 SCS        趙迎慶  新規
  7446*
  7447******************************************************************
  7448 05  PARM-SCZY4009-ARG1.
  7449*----------  利用会社コード
  7450   10  RIYO-CMP-CD           PIC  X(04).
  7451*----------  評価系列コード
  7452   10  HYK-KRTU-CD           PIC  X(04).
  7453 05  PARM-SCZY4009-ARG2.
  7454*----------  評価時価取得方法コード
  7455   10  HYK-CP-SHTK-PTN-CD    PIC  X(04).
  7456*----------  評価為替取得方法コード
  7457   10  HYK-EX-SHTK-PTN-CD    PIC  X(04).
  7458*----------  評価計算パターンコード
  7459   10  HYK-CALC-PTN-CD       PIC  X(04).
  7460*----------  評価系列名称
  7461   10  HYK-KRTU-NAME         PIC  X(60).
  7462*----------  評価為替取得方法パターン取得ルーチン
  7463 01  PARM-SCZY4012-INOUT.
* 7464     COPY  "SCZY4012.cpy".
  7465******************************************************************
  7466* $Header$
  7467******************************************************************
  7468*
  7469*  システムＩＤ   : T-STAR
  7470*  システム名称   : 次期TSTARシステム
  7471*  コピー句ＩＤ   : SCZY4012.cpy
  7472*  コピー句名称   : 評価為替取得方法パターン取得ルーチン
  7473*
  7474*  改訂履歴
  7475*  年月日     所属       担当    内容
  7476*  ---------- ---------- ------  ----------------------------
  7477*  2008/01/16 SCS        丁      新規
  7478******************************************************************
  7479 05  PARM-SCZY4012-ARG1.
  7480*----------  利用会社コード
  7481   10  RIYO-CMP-CD           PIC  X(04).
  7482*----------  評価為替取得方法コード
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 130
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/SCZY4012.cpy)BOL.cpy)
  7483   10  HYK-EX-SHTK-PTN-CD    PIC  X(04).
  7484*----------  市場通貨コード
  7485   10  SIJO-TUKA-CD          PIC  X(04).
  7486 05  PARM-SCZY4012-ARG2.
  7487*----------  優先順位１為替系列
  7488   10  PRIO-1-EX-KRTU        PIC  X(04).
  7489*----------  優先順位２為替系列
  7490   10  PRIO-2-EX-KRTU        PIC  X(04).
  7491*----------  優先順位３為替系列
  7492   10  PRIO-3-EX-KRTU        PIC  X(04).
  7493*----------  優先順位４為替系列
  7494   10  PRIO-4-EX-KRTU        PIC  X(04).
  7495*----------  優先順位５為替系列
  7496   10  PRIO-5-EX-KRTU        PIC  X(04).
  7497*----------  優先順位６為替系列
  7498   10  PRIO-6-EX-KRTU        PIC  X(04).
  7499*----------  優先順位７為替系列
  7500   10  PRIO-7-EX-KRTU        PIC  X(04).
  7501*----------  優先順位８為替系列
  7502   10  PRIO-8-EX-KRTU        PIC  X(04).
  7503*----------  優先順位９為替系列
  7504   10  PRIO-9-EX-KRTU        PIC  X(04).
  7505*----------  遡り方法
  7506   10  SOKYU-HOU             PIC  X(01).
  7507*----------  最大遡り日数
  7508   10  MAX-SOKYU-NISU        PIC  9(08).
  7509*----------  環境変数取得
  7510 01  PARM-SCZY4903-INOUT.
* 7511     COPY  "SCZY4903.cpy".
  7512******************************************************************
  7513* $Header$
  7514******************************************************************
  7515*
  7516* システムＩＤ   : T-STAR
  7517* システム名称   : 次期TSTARシステム
  7518* コピー句ＩＤ   : SCZY4903.cpy
  7519* コピー句名称   : PATH取得
  7520*
  7521* 改訂履歴
  7522* 年月日   区分 所属     担当    内容
  7523* -------- ---- -------- ------- -------------------------------
  7524* 20080721 新規 SCS      陸 委   新規作成
  7525*
  7526******************************************************************
  7527 05  PARM-SCZY4903-ARG1.
  7528*----------  利用会社コード
  7529   10  RIYO-CMP-CD           PIC  X(04).
  7530*----------  PATH区分
  7531   10  PATH-KBN              PIC  X(02).
  7532 05  PARM-SCZY4903-ARG2.
  7533*----------  返却PATH
  7534   10  RTN-PATH              PIC  X(256).
  7535*----------  処理対象実行状況管理明細ＧＥＴ
  7536 01  PARM-SCZY7200-INOUT.
* 7537     COPY  "SCZY7200.cpy".
  7538******************************************************************
  7539*
  7540*  システムＩＤ   : T-STAR
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 131
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/SCZY7200.cpy)BOL.cpy)
  7541*  システム名称   : 次期TSTARシステム
  7542*  コピー句ＩＤ   : SCZY7200.cpy
  7543*  コピー句名称   : 処理対象実行状況管理明細ＧＥＴルーチンコピー句
  7544*
  7545*  改訂履歴
  7546*  年月日     所属       担当者  内容
  7547*  ---------- ---------- ------  ----------------------------
  7548*  20070828   SCS        李傑    新規
  7549*
  7550******************************************************************
  7551
  7552 05  PARM-SCZY7200-ARG1.
  7553*----------  利用会社コード
  7554     10  RIYO-CMP-CD              PIC  X(04).
  7555*----------  処理実行日
  7556     10  SYORI-YMD                PIC  X(08).
  7557*----------  起動ID
  7558     10  KIDOU-ID                 PIC  X(04).
  7559*----------  帳票ID
  7560     10  REP-ID                   PIC  X(08).
  7561 05  PARM-SCZY7200-ARG2.
  7562*----------  取得件数
  7563     10  GET-KENSU                PIC  9(05).
  7564*----------  実行状況管理明細データ
  7565     10  JIKO-DATA  OCCURS  50000.
  7566*----------  ファンドコード
  7567         15  FUND-CD              PIC  X(12).
  7568*----------  ポートフォリオコード
  7569         15  PTF-CD               PIC  X(04).
  7570*----------  評価系列コード
  7571         15  HYK-KRTU-CD          PIC  X(04).
  7572*----------  帳票ID
  7573         15  REP-ID               PIC  X(08).
  7574*----------  帳票任意コード
  7575         15  REP-ANY-CD           PIC  X(50).
  7576*----------  基準日From
  7577         15  KJN-YMD-FROM         PIC  9(08).
  7578*----------  基準日To
  7579         15  KJN-YMD-TO           PIC  9(08).
  7580*----------  業務タスクID
  7581         15  GYOMU-TASK-ID        PIC  X(07).
  7582*----------  明細単位実行ステータス
  7583         15  JIKOU-STS            PIC  X(03).
  7584*----------  datファイル名
  7585         15  DAT-FILE-NAME        PIC  X(100).
  7586*----------  システム日付・マシン日付時刻ＧＥＴルーチン
  7587 01  PARM-SCZY1010-INOUT.
* 7588     COPY  "SCZY1010.cpy".
  7589******************************************************************
  7590*
  7591*  システムＩＤ   : T-STAR
  7592*  システム名称   : 次期TSTARシステム
  7593*  コピー句ＩＤ   : SCZY1010.cpy
  7594*  コピー句名称   : システム日付・マシン日付時刻ＧＥＴルーチンコピー句
  7595*
  7596*  改訂履歴
  7597*  年月日     所属       担当者  内容
  7598*  ---------- ---------- ------  ----------------------------
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 132
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/SCZY1010.cpy)BOL.cpy)
  7599*  20071003   SCS        呉聞杰  新規
  7600*
  7601******************************************************************
  7602
  7603   05  PARM-SCZY1010-ARG1.
  7604*---------- OL/BT区分
  7605     10  DATE-KBN            PIC  X(02).
  7606*---------- 時刻形式区分
  7607     10  TIME-FORM-KBN       PIC  X(01).
  7608*---------- 利用会社コード
  7609     10  RIYO-CMP-CD         PIC  X(04).
  7610   05  PARM-SCZY1010-ARG2.
  7611*---------- システム日付
  7612     10  SYS-DATE            PIC  X(08).
  7613*---------- マシン日付時刻
  7614     10  MAC-DATE-TIME       PIC  X(14).
  7615*----------  カレンダールーチン
  7616 01  PARM-SCZY1020-INOUT.
* 7617     COPY  "SCZY1020.cpy".
  7618******************************************************************
  7619*
  7620*  システムＩＤ   : T-STAR
  7621*  システム名称   : 次期TSTARシステム
  7622*  コピー句ＩＤ   : SCZY1020.cpy
  7623*  コピー句名称   : カレンダールーチンコピー句
  7624*
  7625*  改訂履歴
  7626*  年月日     所属       担当者  内容
  7627*  ---------- ---------- ------  ----------------------------
  7628*  20070926   SCS        厳偉偉   新規
  7629*
  7630******************************************************************
  7631
  7632   05  PARM-SCZY1020-ARG1.
  7633*---------- 機能区分
  7634       10  IXCAL-FUNCTION         PIC  X(01).
  7635*---------- 基準年月日１
  7636       10  IXCAL-KJN-YMD1.
  7637           15  IXCAL-YY-1         PIC  9(04).
  7638           15  IXCAL-MM-1         PIC  9(02).
  7639           15  IXCAL-DD-1         PIC  9(02).
  7640       10  IXCAL-KJN-YMD-1  REDEFINES  IXCAL-KJN-YMD1
  7641                                  PIC  9(08).
  7642*---------- 計算ベース区分
  7643       10  IXCAL-COMP-BASE        PIC  X(01).
  7644*---------- 前後区分１
  7645       10  IXCAL-ZENGO-KBN-1      PIC  X(01).
  7646*---------- 前後区分２
  7647       10  IXCAL-ZENGO-KBN-2      PIC  X(01).
  7648*---------- 単位区分
  7649       10  IXCAL-TANI-KBN         PIC  X(01).
  7650*---------- 日数
  7651       10  IXCAL-COMP-DAYS.
  7652           15  IXCAL-DAYS         PIC  S9(05)V9(06) COMP-3.
  7653*---------- 基準年月日２
  7654       10  IXCAL-KJN-YMD2.
  7655           15  IXCAL-YY-2         PIC  9(04).
  7656           15  IXCAL-MM-2         PIC  9(02).
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 133
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/SCZY1020.cpy)BOL.cpy)
  7657           15  IXCAL-DD-2         PIC  9(02).
  7658       10  IXCAL-KJN-YMD-2  REDEFINES  IXCAL-KJN-YMD2
  7659                                  PIC  9(08).
  7660*---------- 基準日２－曜日
  7661       10  IXCAL-KJN-2-YOBI       PIC  S9(02) COMP-3.
  7662*---------- 算出日付営業日暦日区分
  7663   05  PARM-SCZY1020-ARG2.
  7664       10  IXCAL-HIZUKE-KBN       PIC  X(04).
  7665
  7666*----------  テーブルID取得
  7667 01  PARM-SCZY1160-INOUT.
* 7668     COPY  "SCZY1160.cpy".
  7669******************************************************************
  7670*
  7671*  システムＩＤ   : T-STAR
  7672*  システム名称   : 次期TSTARシステム
  7673*  コピー句ＩＤ   : SCZY1160.cpy
  7674*  コピー句名称   : テーブルID取得ルーチン
  7675*
  7676*  改訂履歴
  7677*  年月日     所属       担当者  内容
  7678*  ---------- ---------- ------  ----------------------------
  7679*  2007/09/19 SCS        薛銀峰   新規
  7680*
  7681******************************************************************
  7682   05  PARM-SCZY1160-ARG1.
  7683*----------  利用会社コード
  7684     10  RIYO-CMP-CD         PIC  X(04).
  7685*----------  テーブルID
  7686     10  TBL-ID-GRP.
  7687       15  TBL-ID            OCCURS  20  PIC  X(08).
  7688   05  PARM-SCZY1160-ARG2.
  7689*----------  編集後テーブルID
  7690     10  HENSYUGO-TBL-ID     OCCURS  20  PIC  X(13).
  7691*----------  リターンパッケージセット
  7692 01  PARM-SCZY1170-IN.
* 7693     COPY  "SCZY1170.cpy".
  7694******************************************************************
  7695*
  7696*  システムＩＤ   : T-STAR
  7697*  システム名称   : 次期TSTARシステム
  7698*  コピー句ＩＤ   : SCZY1170.cpy
  7699*  コピー句名称   : リターンパッケージセットルーチン
  7700*
  7701*  改訂履歴
  7702*  年月日     所属       担当者  内容
  7703*  ---------- ---------- ------  ----------------------------
  7704*  2007/09/05 SCS        梁斌    新規
  7705*
  7706******************************************************************
  7707   05  PARM-SCZY1170-ARG1.
  7708     10 ERR-PACKAGE.
  7709*---------- エラー検知プログラム名
  7710       15  ERR-PGM-ID        PIC  X(16).
  7711*---------- ポジション
  7712       15  ERR-POS           PIC  X(04).
  7713*---------- リターンコード
  7714       15  RTN-CD            PIC  X(03).
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 134
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/SCZY1170.cpy)BOL.cpy)
  7715*---------- 詳細リターンコード
  7716       15  DETAIL-RTN-CD     PIC  S9(09).
  7717*---------- 詳細リターンコードデコードフラグ
  7718       15  DETAIL-RTN-CD-FLG PIC  X(01).
  7719*---------- フリーメッセージ
  7720       15  FREE-MSG          PIC  X(2000).
  7721 01  PARM-SCZY1170-RTNPKG.
  7722   05  PARM-SCZY1170-ARG2.
* 7723     COPY "CZRTNPACKAGE.cpy".
  7724******************************************************************
  7725*
  7726*  システムＩＤ   : T-STAR
  7727*  システム名称   : 新有価証券バックオフィスシステム
  7728*  コピー句ＩＤ   : CZRTNPACKAGE.cpy
  7729*  コピー句名称   : RTNパッケージコピー句
  7730*
  7731*  改訂履歴
  7732*  年月日     所属       担当者  内容
  7733*  ---------- ---------- ------  ----------------------------
  7734*  20060708   SCS                新規
  7735*
  7736******************************************************************
  7737
  7738*---------- カウンター
  7739         15  COUNTER                   PIC  9(02).
  7740*---------- RTNパッケージ詳細
  7741         15  RTN-PGM-DETAIL  OCCURS  10.
  7742*---------- エラー検知プログラム名
  7743           20  ERR-PGM-ID              PIC  X(16).
  7744*---------- ポジション
  7745           20  ERR-POS                 PIC  X(04).
  7746*---------- リターンコード
  7747           20  RTN-CD                  PIC  X(03).
  7748*---------- 詳細リターンコード
  7749           20  DETAIL-RTN-CD           PIC  S9(09).
  7750*---------- 詳細リターンコードデコードフラグ
  7751           20  DETAIL-RTN-CD-FLG       PIC  X(01).
  7752*---------- フリーメッセージ
  7753           20  FREE-MSG                PIC  X(2000).
  7754*----------  進捗管理ＩＮＳＵＰＤルーチン
  7755 01  PARM-SUSC0405-INOUT.
* 7756     COPY  "SUSC0405.cpy".
  7757******************************************************************
  7758* $Header$
  7759******************************************************************
  7760*
  7761*  システムＩＤ   : T-STAR
  7762*  システム名称   : 次期TSTARシステム
  7763*  コピー句ＩＤ   : SUSC0405.cpy
  7764*  コピー句名称   : 運用成果進捗更新処理
  7765*
  7766*  改訂履歴
  7767*  年月日     所属       担当者  内容
  7768*  ---------- ---------- ------  ----------------------------
  7769*  2009/02/11 SCS        劉新文    新規
  7770*
  7771******************************************************************
  7772   05  PARM-SUSC0405-ARG1.
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 135
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/SUSC0405.cpy)cpy)cpy)
  7773*----------  セッション区分
  7774     10  SESION-KBN          PIC  X(01).
  7775*----------  OL/BT区分
  7776     10  OLBT-KBN            PIC  X(02).
  7777   05  PARM-SUSC0405-ARG2.
  7778*----------  利用会社コード
  7779     10  RIYO-CMP-CD         PIC  X(04).
  7780*----------  処理実行日
  7781     10  SYORI-YMD           PIC  9(08).
  7782*----------  起動ID
  7783     10  KIDOU-ID            PIC  X(04).
  7784*----------  業務タスクID
  7785     10  GYOMU-TASK-ID       PIC  X(07).
  7786*----------  基準年月日/基準年月
  7787     10  KJN-YMD             PIC  9(08).
  7788*----------  最終処理基準日
  7789     10  SS-SYORI-YMD        PIC  9(08).
  7790*----------  ベビー未処理フラグ
  7791     10  BABY-MISYORI-FLG    PIC  X(01).
  7792*----------  ファンドコード
  7793     10  FUND-CD             PIC  X(12).
  7794*----------  ポートフォリオコード
  7795     10  PTF-CD              PIC  X(04).
  7796*----------  評価系列コード
  7797     10  HYK-KRTU-CD         PIC  X(04).
  7798*----------  帳票ID
  7799     10  REP-ID              PIC  X(08).
  7800*----------  帳票任意コード
  7801     10  REP-ANY-CD          PIC  X(50).
  7802*----------  基準日FROM
  7803     10  KJN-YMD-FROM        PIC  9(08).
  7804*----------  進捗ステータス
  7805     10  JIKOU-STS           PIC  X(03).
  7806   05  PARM-SUSC0405-ARG3.
  7807*----------  ポートフォリオ実行可能区分
  7808     10  PTF-JIKOU-KBN       PIC  X(01).
  7809*----------  ＧＸ用証券種別コード変換ルーチン
  7810 01  PARM-SUSC0603-INOUT.
* 7811     COPY  "SUSC0603.cpy".
  7812******************************************************************
  7813*
  7814*  システムＩＤ   : T-STAR
  7815*  システム名称   : 次期TSTARシステム
  7816*  コピー句ＩＤ   : SUSC0603.cpy
  7817*  コピー句名称   : その他商品のＧＸ用証券種別コード変換
  7818*
  7819*  改訂履歴
  7820*  年月日     所属       担当者  内容
  7821*  ---------- ---------- ------  ----------------------------
  7822*  20090713   SCS        朱  榮  新規
  7823*
  7824******************************************************************
  7825*----------  SUSC0603コピー句
  7826   20  PARM-SUSC0603-ARG1.
  7827*----------  証券種別コード
  7828     25  SEC-SBT-CD          PIC  X(04).
  7829*----------  資産分類コード
  7830     25  ASSETS-KBN-CD       PIC  X(04).
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 136
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/SUSC0603.cpy)cpy)cpy)
  7831*----------  コールプット区分
  7832     25  CP-KBN              PIC  X(01).
  7833   20  PARM-SUSC0603-ARG2.
  7834*----------  ＧＸ接続用証券種別コード
  7835     25  GX-SEC-SBT-CD       PIC  X(04).
  7836*----------  ＧＸ用通貨コード→国コード変換ルーチン
  7837 01  PARM-SUSC0604-INOUT.
* 7838     COPY  "SUSC0604.cpy".
  7839******************************************************************
  7840* $Header$
  7841******************************************************************
  7842*
  7843*  システムＩＤ   : T-STAR
  7844*  システム名称   : 次期TSTARシステム
  7845*  コピー句ＩＤ   : SUSC0604.cpy
  7846*  コピー句名称   : ＧＸ用通貨コード→国コード変換
  7847*
  7848*  改訂履歴
  7849*  年月日     所属       担当者  内容
  7850*  ---------- ---------- ------  ----------------------------
  7851*  20090715   SCS        馬松涛  新規
  7852*
  7853******************************************************************
  7854 05  PARM-SUSC0604-ARG1.
  7855*----------  利用会社コード
  7856   10  RIYO-CMP-CD           PIC  X(04).
  7857*----------  適用開始日
  7858   10  TEKIYO-FROM           PIC  9(08).
  7859*----------  通貨コード
  7860   10  TUKA-CD               PIC  X(04).
  7861 05  PARM-SUSC0604-ARG2.
  7862*----------  国コード
  7863   10  KUNI-CD               PIC  X(04).
  7864*----------  国コード-略式
  7865   10  KUNI-CD-RYAKU         PIC  X(02).
  7866*----------  GX集約データ生成処理起動単体チェック
  7867 01  PARM-SUSR2601-INOUT.
* 7868     COPY  "SUSR2601.cpy".
  7869******************************************************************
  7870* $Header$
  7871******************************************************************
  7872*
  7873* システムＩＤ   : T-STAR
  7874* システム名称   : 次期TSTARシステム
  7875* コピー句ＩＤ   : SUSR2601.cpy
  7876* コピー句名称   : SUSR2601コピー句
  7877*
  7878* 改訂履歴
  7879* 年月日   区分 所属     担当者  内容
  7880* -------- ---- -------- ------- ---------------------------------
  7881* 20080512 新規 SCS      馬松涛  新規作成
  7882* 20080724 修正 SCS      馬松涛　修正
  7883******************************************************************
  7884 05  PARM-SUSR2601-ARG1.
  7885*----------  SPP/バッチ起動区分
  7886   10  KIDOU-KBN             PIC  X(01).
  7887 05  PARM-SUSR2601-ARG2.
* 7888     COPY  "INMUSR2610_COBOL.cpy".
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 137
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/INMUSR2610_COBOL.cpy)
  7889*<INMUSR2610用COBOLCopy句>*
  7890     10  INMUSR2610.
  7891       20  FILLER SIGN IS LEADING SEPARATE CHARACTER.
  7892         30  I-KJN-YMD-FR PIC X(8).
  7893         30  I-KJN-YMD-TO PIC X(8).
  7894         30  I-CD-REF-KRTU-CD PIC X(4).
  7895         30  I-PTF-SYORI-KBN PIC X(1).
  7896         30  I-FUND-PTF-GRP-COUNT PIC 9(5) VALUE 10.
  7897         30  I-FUND-PTF-GRP OCCURS 10.
  7898           40  I-FUND-PTF-KBN PIC X(1).
  7899           40  I-FUND-CD PIC X(12).
  7900           40  I-PTF-CD PIC X(4).
  7901         30  I-HYK-KRTU-KBN PIC X(1).
  7902         30  I-HYK-KRTU-GRP-COUNT PIC 9(5) VALUE 10.
  7903         30  I-HYK-KRTU-GRP OCCURS 10.
  7904           40  I-HYK-KRTU-CD PIC X(4).
  7905         30  I-FLG-KEISAN PIC X(1).
  7906         30  I-GX-KANSI-JIKAN-RX PIC X(4).
  7907         30  TABLE-COUNT PIC X(4).
  7908         30  SRC-MENU-ID PIC X(6).
  7909         30  MENU-ID PIC X(6).
  7910         30  BUS-LOG-PK PIC X(10).
  7911 05  PARM-SUSR2601-ARG3.
  7912*----------  基準日TO-errflg
  7913   10  KJN-YMD-TO-ERRFLG     PIC  9(01).
  7914*----------  ポートフォリオエラーフラグ
  7915   10  FUND-PTF-CD-RT-ERRFLG    PIC  9(01).
  7916*----------  評価系列エラーフラグ
  7917   10  HYK-KRTU-ERRFLG              PIC  9(01).
  7918 05  PARM-SUSR2601-ARG4.
  7919   10  APL-STATUS            PIC  X(01).
  7920 05  PARM-SUSR2601-ARG5.
  7921*---------- 情報メッセージエリア
  7922       10  JYOHOU-AREA.
  7923         15  JYOHOU-MSG-AREA      OCCURS 100.
  7924*---------- 多行式の行番号
  7925           20  GYO-BANGOU-I            PIC  9(03).
  7926*---------- 情報メッセージID
  7927           20  JYOHOU-MSG-ID           PIC  X(07).
  7928*---------- 置換文字
  7929           20  TIKAN-MOJI-I.
  7930             25 TK-MOJI-I   OCCURS 5   PIC  X(30).
  7931*---------- エラーメッセージエリア
  7932       10  ERR-AREA.
  7933         15  ERR-MSG-AREA         OCCURS 100.
  7934*---------- 多行式の行番号
  7935           20  GYO-BANGOU-E            PIC  9(03).
  7936*---------- 該当行のエラーメッセージ
  7937           20  GAITOU-GYO-ERR.
  7938             25  GAITOU-GYO-ERR-MSG    OCCURS 20.
  7939*---------- エラーメッセージID
  7940               30  ERR-MSG-ID          PIC  X(07).
  7941*---------- 置換文字
  7942               30  TIKAN-MOJI-E.
  7943                 35 TK-MOJI-E OCCURS 5 PIC  X(30).
  7944*---------- 警告メッセージエリア
  7945       10  WARN-AREA.
  7946         15  WARN-MSG-AREA        OCCURS 100.
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 138
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/SUSR2601.cpy)BOL.cpy)
  7947*---------- 多行式の行番号
  7948           20  GYO-BANGOU-W            PIC  9(03).
  7949*---------- 該当行の警告メッセージ
  7950           20  GAITOU-GYO-WARN.
  7951             25  GAITOU-GYO-WARN-MSG   OCCURS 20.
  7952*---------- 警告メッセージID
  7953               30  WARN-MSG-ID         PIC  X(07).
  7954*---------- 置換文字
  7955               30  TIKAN-MOJI-W.
  7956                 35 TK-MOJI-W OCCURS 5 PIC  X(30).
  7957 05  PARM-SUSR2601-ARG6.
  7958*---------- メッセージエリア
  7959         10  MSG-AREA.
  7960           15  MESSAGE-AREA  OCCURS 999.
  7961*---------- ファンドコード
  7962             20  FUND-CD               PIC  X(12).
  7963*---------- ポートフォリオコード
  7964             20  PTF-CD                PIC  X(04).
  7965*---------- 評価系列コード
  7966             20  HYK-KRTU-CD           PIC  X(04).
  7967*---------- 帳票ID
  7968             20  REP-ID                PIC  X(08).
  7969*---------- 帳票任意コード
  7970             20  REP-ANY-CD            PIC  X(50).
  7971*---------- 基準日From
  7972             20  KJN-YMD-FROM          PIC  X(08).
  7973*---------- 基準日To
  7974             20  KJN-YMD-TO            PIC  X(08).
  7975*---------- メッセージID
  7976             20  MSG-ID                PIC  X(07).
  7977*---------- 置換文字
  7978             20  TIKAN-MOJI.
  7979               25 TK-MOJI  OCCURS  5   PIC  X(30).
  7980*---------- フリーメッセージ
  7981             20  FREE-MSG              PIC  X(200).
  7982*----------  GX集約データ生成処理起動O3Wチェックルーチン
  7983 01  PARM-AIFA-HDR.
* 7984     COPY  "WOMCMAIFA.CPY".
  7985*
  7986* システムID   :WOM
  7987* システム名称 :サーバ基盤ミドルソフト
  7988* プログラムID :WOMCMAIFA.CPY
  7989* 処理概要(目的,使用法,重要な変数など):
  7990*     ＡＩＦＡ定義ヘッダ
  7991*
  7992
  7993* 改訂履歴
  7994* 年月日   区分 所属　　 担当　　内容
  7995* -------- ---- -------- ------- --------------------------------
  7996* 19950406 新規 S銀13    鮫島    新規
  7997* 95.06.28 修正 S銀13    小柳    コーディング基準に準拠
  7998* 95.07.06 修正 S銀13    小柳    業務ランク変更 #PSD-201
  7999* 95.10.17 修正 S金13    木村    AIFA V0201支援 #PCL301
  8000* 95.10.17 修正 S金13    木村    TP1ｴﾗｰｺｰﾄﾞ支援 #PCL309
  8001* 96.02.20 修正 S金13    河原    VALUE句削除    #PSD333
  8002*
  8003
  8004*
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 139
* MUSR2651.cob (/opt/wom/copy/WOMCMAIFA.CPY)                       cpy)BOL.cpy)
  8005* Copyright (C) 1995 by Nomura Research Institute,Ltd.
  8006* All rights reserved.
  8007*
  8008** WOMAIFA **
  8009***  AIFA-ST.
  8010     10  AIFA-SIZE           PIC  S9(4)
  8011                             USAGE IS COMP-5.
  8012*    * ＡＩＦＡサイズ
  8013     10  VR-NO               PIC  X(4).
  8014*    * バージョン番号
  8015     10  ON-LINE-DATE        PIC  X(8).
  8016*    * オンライン日付
  8017     10  PROC-DATE           PIC  X(8).
  8018*    * 処理年月日
  8019     10  APL-DATE            PIC  X(6).
  8020*    * ＡＰ起動時刻
  8021     10  SV-HOST-NAME        PIC  X(32).
  8022*    * 自サーバ名称
  8023     10  CLT-APL-NAME        PIC  X(8).
  8024*    * クライアントＡＰＬ名称
  8025     10  ON-LUNE-NAME        PIC  X(2).
  8026*    * 自オンライン名称
  8027     10  FILLER              PIC  X(6).
  8028*    * 予備１
  8029     10  SV-GROUP            PIC  X(31).
  8030*    * サービスグループ
  8031     10  SV-NAME             PIC  X(31).
  8032*    * サービス名称
  8033     10  START-TYPE          PIC  X(2).
  8034*    * サービス起動形態
  8035     10  PROC-NAME           PIC  X(16).
  8036*    * プロセス名称
  8037     10  ORG-SV-GROUP        PIC  X(31).
  8038*    * オリジナルサービスグループ名称
  8039     10  ORG-SV-NAME         PIC  X(31).
  8040*    * オリジナルサービス名称
  8041     10  ORG-START-TYPE      PIC  X(2).
  8042*    * オリジナル起動形態
  8043     10  MONITER-SW          PIC  X(1).
  8044*    * モニタ取得区分
  8045     10  AP-COMPLETE-ST      PIC  X(1).
  8046*    * ＡＰ終了ステータス
  8047     10  MDL-COMPL-ST        PIC  X(1).
  8048*    * ミドル終了ステータス
  8049     10  TROUBLE-SW          PIC  X(1).
  8050*    * 障害区分
  8051     10  FORCE-SW            PIC  X(1).
  8052*    * 強制区分
  8053     10  FILLER              PIC  X(3).
  8054*    * 予備２
  8055     10  IN-NO               PIC  S9(4)
  8056                             USAGE IS COMP-5.
  8057*    * 入力通番
  8058     10  IN-HOST-NAME        PIC  X(32).
  8059*    * 入力端末のコンピュータ名称
  8060     10  COMPANY-CODE        PIC  X(4).
  8061*    * 会社コード
  8062     10  IN-ST-CODE          PIC  X(4).
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 140
* MUSR2651.cob (/opt/wom/copy/WOMCMAIFA.CPY)                       cpy)BOL.cpy)
  8063*    * 顧客処理部店コード
  8064     10  IN-ST-DBNAME        PIC  X(32).
  8065*    * 営業店ＤＢサーバ名称
  8066     10  FILLER              PIC  X(6).
  8067*    * 予備３
  8068     10  JOB-USER-ID         PIC  X(8).
  8069*    * 端末利用者の業務ユーザＩＤ
  8070     10  JOB-RANK-01         PIC  X(2).
  8071*    * 端末利用者の業務ランク０１ #PSD-201
  8072     10  JOB-RANK-02         PIC  X(2).
  8073*    * 端末利用者の業務ランク０２ #PSD-201
  8074     10  JOB-RANK-03         PIC  X(2).
  8075*    * 端末利用者の業務ランク０３ #PSD-201
  8076     10  JOB-RANK-04         PIC  X(2).
  8077*    * 端末利用者の業務ランク０４ #PSD-201
  8078     10  JOB-RANK-05         PIC  X(2).
  8079*    * 端末利用者の業務ランク０５ #PSD-201
  8080     10  JOB-RANK-06         PIC  X(2).
  8081*    * 端末利用者の業務ランク０６ #PSD-201
  8082     10  JOB-RANK-07         PIC  X(2).
  8083*    * 端末利用者の業務ランク０７ #PSD-201
  8084     10  JOB-RANK-08         PIC  X(2).
  8085*    * 端末利用者の業務ランク０８ #PSD-201
  8086     10  JOB-RANK-09         PIC  X(2).
  8087*    * 端末利用者の業務ランク０９ #PSD-201
  8088     10  JOB-RANK-10         PIC  X(2).
  8089*    * 端末利用者の業務ランク１０ #PSD-201
  8090     10  USER-IN-ST          PIC  X(4).
  8091*    * ユーザ所属部店
  8092     10  SV-ERR-CD           PIC  X(4).
  8093*    *サーバ詳細コード      #PCL309
  8094     10  RLY-RPC-TM          PIC  S9(4)
  8095                             USAGE IS COMP-5.
  8096*    *問合せ応答タイマ      #PCL301
  8097     10  FILLER              PIC  X(54).
  8098*    * 予備５ #PSD-201 #PCL301,#PCL309
  8099 01  PARM-USER-ATTR-HDR.
* 8100     COPY  "CZCOMMONHEADER.cpy".
  8101******************************************************************
  8102*
  8103*  システムＩＤ   : T-STAR
  8104*  システム名称   : 新有価証券バックオフィスシステム
  8105*  コピー句ＩＤ   : CZCOMMONHEADER.cpy
  8106*  コピー句名称   : 共通ヘッダ
  8107*
  8108*  改訂履歴
  8109*  年月日     所属       担当者  内容
  8110*  ---------- ---------- ------  ----------------------------
  8111*  2006/08/21 SCS                新規
  8112*
  8113******************************************************************
  8114*----------  リクエストID
  8115 10  REQUEST-ID                        PIC  X(32).
  8116*----------  システム日付
  8117 10  SYS-DATE                          PIC  X(08).
  8118*----------  ログインユーザ会社業務形態区分
  8119 10  COMPANY-TYPE                      PIC  X(01).
  8120*----------  ユーザー名称
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 141
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/CZCOMMONHEADER.cpy)y)
  8121 10  USER-NAME                         PIC  X(40).
  8122*----------  ユーザー種別
  8123 10  USER-TYPE                         PIC  X(01).
  8124*----------  業務グループコード
  8125 10  GYOUMU-GROUP-CODE                 PIC  X(10).
  8126*----------  業務グループ名称
  8127 10  GYOUMU-GROUP-NAME                 PIC  X(40).
  8128*----------  メニュー利用制限区分
  8129 10  ALL-MENU-USABLE                   PIC  X(01).
  8130*----------  業務タスク利用制限区分
  8131 10  ALL-TASK-USABLE                   PIC  X(01).
  8132*----------  帳票利用制限区分
  8133 10  ALL-REPORT-USABLE                 PIC  X(01).
  8134*----------  利用会社コード
  8135 10  RIYO-COMPANY-CODE                 PIC  X(04).
  8136*----------  利用会社名称
  8137 10  RIYO-COMPANY-NAME                 PIC  X(60).
  8138*----------  利用会社業務形態区分
  8139 10  RIYO-COMPANY-TYPE                 PIC  X(01).
  8140*----------  委託会社コード
  8141 10  ITAKU-CODE                        PIC  X(03).
  8142*----------  受託銀行コード
  8143 10  JYUTAKU-CODE                      PIC  X(02).
  8144*----------  システムエラーメッセージ
  8145 10  SYSTEM-ERROR-MSG                  PIC  X(60).
  8146*----------  予備
  8147 10  FILLER                            PIC  X(35).
  8148*----- 入出力パラメータ
  8149 01  PARM-SUSR2602-ARG-IN.
* 8150     COPY  "INMUSR2610_COBOL.cpy".
  8151*<INMUSR2610用COBOLCopy句>*
  8152     10  INMUSR2610.
  8153       20  FILLER SIGN IS LEADING SEPARATE CHARACTER.
  8154         30  I-KJN-YMD-FR PIC X(8).
  8155         30  I-KJN-YMD-TO PIC X(8).
  8156         30  I-CD-REF-KRTU-CD PIC X(4).
  8157         30  I-PTF-SYORI-KBN PIC X(1).
  8158         30  I-FUND-PTF-GRP-COUNT PIC 9(5) VALUE 10.
  8159         30  I-FUND-PTF-GRP OCCURS 10.
  8160           40  I-FUND-PTF-KBN PIC X(1).
  8161           40  I-FUND-CD PIC X(12).
  8162           40  I-PTF-CD PIC X(4).
  8163         30  I-HYK-KRTU-KBN PIC X(1).
  8164         30  I-HYK-KRTU-GRP-COUNT PIC 9(5) VALUE 10.
  8165         30  I-HYK-KRTU-GRP OCCURS 10.
  8166           40  I-HYK-KRTU-CD PIC X(4).
  8167         30  I-FLG-KEISAN PIC X(1).
  8168         30  I-GX-KANSI-JIKAN-RX PIC X(4).
  8169         30  TABLE-COUNT PIC X(4).
  8170         30  SRC-MENU-ID PIC X(6).
  8171         30  MENU-ID PIC X(6).
  8172         30  BUS-LOG-PK PIC X(10).
  8173 01  PARM-SUSR2602-ARG-OUT.
* 8174     COPY  "SUSR2602.cpy".
  8175******************************************************************
  8176* $Header$
  8177******************************************************************
  8178*
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 142
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/SUSR2602.cpy)BOL.cpy)
  8179* システムＩＤ   :  T-STAR
  8180* システム名称   :  次期TSTARシステム
  8181* コピー句名称   :  GX残高データ生成処理コピー句
  8182* コピー句ＩＤ   :  SUSR2602.cpy
  8183*
  8184******************************************************************
  8185* 改訂日     担当         内容
  8186* ---------- ------------ ----------------------------------------
  8187* 2008/11/04 SCS          新規作成
  8188*
  8189******************************************************************
  8190*
  8191*----- 出力パラメータ
  8192   05  SUSR2602-ARG1-OUT.
  8193*----- リターンコード
  8194     10  RTN-CD                        PIC  X(01).
  8195*----- ＳＰＰエラー詳細
  8196   05  SUSR2602-SPP-OUT.
  8197*---------- 情報メッセージエリア
  8198     10  JYOHOU-AREA.
  8199       15  JYOHOU-MSG-AREA      OCCURS 100.
  8200*---------- 多行式の行番号
  8201         20  GYO-BANGOU-I            PIC  9(03).
  8202*---------- 情報メッセージID
  8203         20  JYOHOU-MSG-ID           PIC  X(07).
  8204*---------- 置換文字
  8205         20  TIKAN-MOJI-I.
  8206           25 TK-MOJI-I   OCCURS 5   PIC  X(30).
  8207*---------- エラーメッセージエリア
  8208     10  ERR-AREA.
  8209       15  ERR-MSG-AREA         OCCURS 100.
  8210*---------- 多行式の行番号
  8211         20  GYO-BANGOU-E            PIC  9(03).
  8212*---------- 該当行のエラーメッセージ
  8213         20  GAITOU-GYO-ERR.
  8214           25  GAITOU-GYO-ERR-MSG    OCCURS 20.
  8215*---------- エラーメッセージID
  8216             30  ERR-MSG-ID          PIC  X(07).
  8217*---------- 置換文字
  8218             30  TIKAN-MOJI-E.
  8219               35 TK-MOJI-E OCCURS 5 PIC  X(30).
  8220*---------- 警告メッセージエリア
  8221     10  WARN-AREA.
  8222       15  WARN-MSG-AREA        OCCURS 100.
  8223*---------- 多行式の行番号
  8224         20  GYO-BANGOU-W            PIC  9(03).
  8225*---------- 該当行の警告メッセージ
  8226         20  GAITOU-GYO-WARN.
  8227           25  GAITOU-GYO-WARN-MSG   OCCURS 20.
  8228*---------- 警告メッセージID
  8229             30  WARN-MSG-ID         PIC  X(07).
  8230*---------- 置換文字
  8231             30  TIKAN-MOJI-W.
  8232               35 TK-MOJI-W OCCURS 5 PIC  X(30).
  8233*----- バッチエラー詳細
  8234   05  SUSR2602-BT-OUT.
  8235*---------- メッセージエリア
  8236     10  MSG-AREA.
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 143
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/SUSR2602.cpy)BOL.cpy)
  8237       15  MESSAGE-AREA  OCCURS 999.
  8238*---------- ファンドコード
  8239         20  FUND-CD                 PIC  X(12).
  8240*---------- ポートフォリオコード
  8241         20  PTF-CD                  PIC  X(04).
  8242*---------- 評価系列コード
  8243         20  HYK-KRTU-CD             PIC  X(04).
  8244*---------- 帳票ID
  8245         20  REP-ID                  PIC  X(08).
  8246*---------- 帳票任意コード
  8247         20  REP-ANY-CD              PIC  X(50).
  8248*---------- 基準日From
  8249         20  KJN-YMD-FROM            PIC  X(08).
  8250*---------- 基準日To
  8251         20  KJN-YMD-TO              PIC  X(08).
  8252*---------- メッセージID
  8253         20  MSG-ID                  PIC  X(07).
  8254*---------- 置換文字
  8255         20  TIKAN-MOJI.
  8256           25 TK-MOJI    OCCURS  5   PIC  X(30).
  8257*---------- フリーメッセージ
  8258         20  FREE-MSG                PIC  X(200).
  8259*----------  内部⇒外部銘柄コード変換ルーチン
  8260 01  PARM-SCZY3002-INOUT.
* 8261     COPY  "SCZY3002.cpy".
  8262******************************************************************
  8263* $Header: /TSTAR2/apl/debug/JC/MAKE/src/copy/SCZY3002/SCZY3002.cpy,v 1.1.
  8264******************************************************************
  8265*
  8266* システムＩＤ   : T-STAR
  8267* システム名称   : 次期TSTARシステム
  8268* コピー句ＩＤ   : SCZY3002.cpy
  8269* コピー句名称   : 内部⇒外部銘柄コード変換ルーチンコピー句
  8270*
  8271* 改訂履歴
  8272* 年月日   区分 所属     担当者  内容
  8273* -------- ---- -------- ------- ---------------------------------
  8274* 20080725 新規 ITS      王懿    新規作成
  8275*
  8276******************************************************************
  8277******************************************************************
  8278*                入力パラメータ
  8279******************************************************************
  8280   05  PARM-SCZY3002-ARG1.
  8281*---------- 利用会社コード
  8282     10  RIYO-CMP-CD         PIC  X(04).
  8283*---------- 内部銘柄コード
  8284     10  NAIBU-MEG-CD        PIC  X(15).
  8285*---------- 商品分類コード
  8286     10  SYOHIN-BUNRUI-CD    PIC  X(04).
  8287*---------- 証券種別コード
  8288     10  SEC-SBT-CD          PIC  X(04).
  8289*---------- 元証券種別コード
  8290     10  MOTO-SEC-SBT-CD     PIC  X(04).
  8291*---------- 銘柄通貨コード
  8292     10  MEG-TUKA-CD         PIC  X(04).
  8293*---------- コードリファレンス系列コード
  8294     10  CD-REF-KRTU-CD      PIC  X(04).
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 144
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/SCZY3002.cpy)BOL.cpy)
  8295*---------- 業務タスクID
  8296     10  GYOMU-TASK-ID       PIC  X(07).
  8297*---------- 基準日
  8298     10  KJN-YMD             PIC  S9(08).
  8299******************************************************************
  8300*                出力パラメータ
  8301******************************************************************
  8302   05  PARM-SCZY3002-ARG2.
  8303*---------- 外部銘柄コード
  8304     10  GAIBU-MEG-CD        PIC  X(20).
  8305*---------- 適用開始日
  8306     10  TEKIYO-FROM         PIC  S9(08).
  8307*---------- 適用終了日
  8308     10  TEKIYO-TO           PIC  S9(08).
  8309*---------- 商品分類コード
  8310     10  SYOHIN-BUNRUI-CD    PIC  X(04).
  8311*---------- 証券種別コード
  8312     10  SEC-SBT-CD          PIC  X(04).
  8313*---------- 元証券種別コード
  8314     10  MOTO-SEC-SBT-CD     PIC  X(04).
  8315*---------- 銘柄通貨コード
  8316     10  MEG-TUKA-CD         PIC  X(04).
  8317*---------- 投資対象国コード
  8318     10  TOUSI-TARGET-KUNI-CD
  8319                             PIC  X(04).
  8320*---------- 発行体国コード
  8321     10  HAKKO-TAI-KUNI-CD   PIC  X(04).
  8322*---------- 株式種別
  8323     10  KABU-SBT            PIC  X(02).
  8324*---------- 回
  8325     10  KAYI                PIC  X(04).
  8326*---------- 号
  8327     10  GOU                 PIC  X(04).
  8328*---------- 満期日
  8329     10  MNK-YMD             PIC  S9(08).
  8330*---------- 限月
  8331     10  GENGETSU            PIC  S9(06).
  8332*---------- ストライクプライス
  8333     10  STRIKEPRICE         PIC  S9(12)V9(06).
  8334*---------- コードリファレンス系列コード
  8335     10  CD-REF-KRTU-CD      PIC  X(04).
  8336*---------- 自社コードフラグ
  8337     10  JS-CD-FLG           PIC  X(01).
  8338*----------  銘柄属性取得ルーチン
  8339 01  PARM-SCZY3004-INOUT.
* 8340     COPY  "SCZY3004.cpy".
  8341******************************************************************
  8342* $Header: /TSTAR2/apl/debug/JC/MAKE/src/copy/SCZY3004/SCZY3004.cpy,v 1.1.
  8343******************************************************************
  8344*
  8345* システムＩＤ   : T-STAR
  8346* システム名称   : 次期TSTARシステム
  8347* コピー句ＩＤ   : SCZY3004.cpy
  8348* コピー句名称   : 銘柄属性取得ルーチンコピー句
  8349*
  8350* 改訂履歴
  8351* 年月日   区分 所属     担当者  内容
  8352* -------- ---- -------- ------- ---------------------------------
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 145
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/SCZY3004.cpy)BOL.cpy)
  8353* 20080829 新規 ITS      馬      新規作成
  8354*
  8355******************************************************************
  8356******************************************************************
  8357*                入力パラメータ
  8358******************************************************************
  8359   05  PARM-SCZY3004-ARG1.
  8360*---------- 利用会社コード
  8361     10  RIYO-CMP-CD         PIC  X(04).
  8362*---------- 内部銘柄コード
  8363     10  NAIBU-MEG-CD        PIC  X(15).
  8364*---------- 商品分類コード
  8365     10  SYOUHIN-CD          PIC  X(04).
  8366*---------- 証券種別コード
  8367     10  SYOUKEN-CD          PIC  X(04).
  8368*---------- 元証券種別コード
  8369     10  GEN-SYOUKEN-CD      PIC  X(04).
  8370*---------- 銘柄通貨コード
  8371     10  MEIGAR-TUKA-CD      PIC  X(04).
  8372*---------- コードリファレンス系列コード
  8373     10  KEIRETU-CD          PIC  X(04).
  8374*---------- 業務タスクID
  8375     10  GYOUMU-TASKU-CD     PIC  X(07).
  8376*---------- 基本属性取得用基準日
  8377     10  KIHON-KIJYUN-BI     PIC  S9(08).
  8378*---------- 付加属性取得用基準日
  8379     10  FUKA-KIJYUN-BI      PIC  S9(08).
  8380******************************************************************
  8381*                出力パラメータ
  8382******************************************************************
  8383   05  PARM-SCZY3004-ARG2.
  8384*---------- 各商品銘柄属性共通構造体
  8385     10  ALL-SYOHIN-KOUZOUTAI.
  8386*---------- 内部銘柄コード
  8387       15  NAIBU-MEG-CD      PIC  X(15).
  8388*---------- コードリファレンス系列コード（リファレンス情報）
  8389       15  RF-KEIRETU-CD     PIC  X(04).
  8390*---------- 外部銘柄コード（リファレンス情報）
  8391       15  RF-GAIBU-MEG-CD   PIC  X(20).
  8392*---------- 商品分類コード（リファレンス情報）
  8393       15  RF-SYOHIN-BUNRUI-CD
  8394                             PIC  X(04).
  8395*---------- 証券種別コード（リファレンス情報）
  8396       15  RF-SEC-SBT-CD     PIC  X(04).
  8397*---------- 銘柄通貨コード（リファレンス情報）
  8398       15  RF-MEG-TUKA-CD    PIC  X(04).
  8399*---------- 投資対象国コード（リファレンス情報）
  8400       15  RF-TOUSI-TARGET-KUNI-CD
  8401                             PIC  X(04).
  8402*---------- 発行体国コード（リファレンス情報）
  8403       15  RF-HAKKO-TAI-KUNI-CD
  8404                             PIC  X(04).
  8405*---------- 株式種別（リファレンス情報）
  8406       15  RF-KABU-SBT       PIC  X(02).
  8407*---------- 回（リファレンス情報）
  8408       15  RF-KAYI           PIC  X(04).
  8409*---------- 号（リファレンス情報）
  8410       15  RF-GOU            PIC  X(04).
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 146
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/SCZY3004.cpy)BOL.cpy)
  8411*---------- 満期日（リファレンス情報）
  8412       15  RF-MNK-YMD        PIC  S9(08).
  8413*---------- 限月（リファレンス情報）
  8414       15  RF-GENGETSU       PIC  S9(06).
  8415*---------- ストライクプライス（リファレンス情報）
  8416       15  RF-STRIKEPRICE    PIC  S9(12)V9(06).
  8417*---------- 適用開始日
  8418       15  TEKIYO-FROM       PIC  S9(08).
  8419*---------- 銘柄名称（日本語）
  8420       15  MEG-NAME-J        PIC  X(60).
  8421*---------- 銘柄名称（日本語略称）
  8422       15  MEG-NAME-J-RYAKU  PIC  X(40).
  8423*---------- 銘柄名称（英語）
  8424       15  MEG-NAME-E        PIC  X(60).
  8425*---------- 銘柄名称（英語略称）
  8426       15  MEG-NAME-E-RYAKU  PIC  X(40).
  8427*---------- 発行体名称（日本語）
  8428       15  HAKKO-TAI-NAME-J  PIC  X(60).
  8429*---------- 発行体名称（英語）
  8430       15  HAKKO-TAI-NAME-E  PIC  X(60).
  8431*---------- 上場区分
  8432       15  JYOJY-KBN         PIC  X(01).
  8433*---------- 保振対象区分
  8434       15  HOHURI-TARGET-KBN PIC  X(01).
  8435*---------- 現地源泉税非課税区分
  8436       15  LCL-GS-TAX-NOTAX-KBN
  8437                             PIC  X(01).
  8438*---------- 売買単位
  8439       15  BUY-SEL-TANI      PIC  S9(08)V9(10).
  8440*---------- 公募区分
  8441       15  PUB-KBN           PIC  X(01).
  8442*---------- 発行日
  8443       15  HAKKO-YMD         PIC  S9(08).
  8444*---------- 発行価格
  8445       15  HAKKO-KKK         PIC  S9(12)V9(06).
  8446*---------- 一口当り額面／単位額面
  8447       15  KUTI1-FACE        PIC  S9(12)V9(06).
  8448*---------- 決算・利払回数
  8449       15  KESSAN-RIBAR-KAISU
  8450                             PIC  X(02).
  8451*---------- 決算日／利払日１
  8452       15  KESSAN-RIBAR-YMD-1
  8453                             PIC  S9(04).
  8454*---------- 決算日／利払日２
  8455       15  KESSAN-RIBAR-YMD-2
  8456                             PIC  S9(04).
  8457*---------- 決算日／利払日３
  8458       15  KESSAN-RIBAR-YMD-3
  8459                             PIC  S9(04).
  8460*---------- 決算日／利払日４
  8461       15  KESSAN-RIBAR-YMD-4
  8462                             PIC  S9(04).
  8463*---------- 決算日／利払日休日処理区分
  8464       15  K-R-YMD-QJT-SYRI-KBN
  8465                             PIC  X(01).
  8466*---------- 付与率
  8467       15  HUYO-RT           PIC  S9(08)V9(10).
  8468*---------- 行使期間FROM
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 147
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/SCZY3004.cpy)BOL.cpy)
  8469       15  KOUSI-KKN-FROM    PIC  S9(08).
  8470*---------- 行使期間TO
  8471       15  KOUSI-KKN-TO      PIC  S9(08).
  8472*---------- 調印日
  8473       15  CHOUIN-YMD        PIC  S9(08).
  8474*---------- 格付
  8475       15  KAKUDSUKE         PIC  X(04).
  8476*---------- 最低取引単位
  8477       15  MIN-TRHK-TANI     PIC  S9(12)V9(06).
  8478*---------- 利付／割引区分
  8479       15  RITUKI-WARI-KBN   PIC  X(01).
  8480*---------- 固定変動区分
  8481       15  FIX-VRBL-KBN      PIC  X(01).
  8482*---------- 償還日
  8483       15  SHOKAN-YMD        PIC  S9(08).
  8484*---------- 利払通貨
  8485       15  RIBAR-TUKA        PIC  X(04).
  8486*---------- 経過日数計算方法
  8487       15  KEKA-NISU-CALC-HOU
  8488                             PIC  X(01).
  8489*---------- 経過日数計算方法１ヶ月３０日設定区分
  8490       15  KKNS-KSHH-1M30D-KBN
  8491                             PIC  X(01).
  8492*---------- 経過日数計算方法片端／両端区分
  8493       15  KKNS-KSHH-KTT-RT-KBN
  8494                             PIC  X(01).
  8495*---------- 年日数計算方法
  8496       15  NEN-CALC-HOU      PIC  X(01).
  8497*---------- 年日数計算方法片端／両端区分
  8498       15  NEN-KSHH-KTT-RT-KBN
  8499                             PIC  X(01).
  8500*---------- 単位１日あたり利息額
  8501       15  TANI-1-YMD-RSK-GAKU
  8502                             PIC  S9(08)V9(10).
  8503*---------- 経過利息計算方法
  8504       15  KEKA-RSK-CALC-HOU PIC  X(01).
  8505*---------- 満期日
  8506       15  MNK-YMD           PIC  S9(08).
  8507*---------- 転換先銘柄コード
  8508       15  TNKN-SAKI-MEG-CD  PIC  X(15).
  8509*---------- 転換先証券種別コード
  8510       15  TNKN-SAKI-SEC-SBT-CD
  8511                             PIC  X(04).
  8512*---------- 原証券コード
  8513       15  MOTO-SEC-CD       PIC  X(20).
  8514*---------- 市場コード
  8515       15  SIJO-CD           PIC  X(04).
  8516*---------- 取引期間（開始）
  8517       15  TRHK-KKN-KAISI    PIC  S9(08).
  8518*---------- 取引期間（終了）
  8519       15  TRHK-KKN-SYURYO   PIC  S9(08).
  8520*---------- 権利行使価格（分子）
  8521       15  KENRI-KOS-KKK-BUNSI
  8522                             PIC  S9(08)V9(10).
  8523*---------- 権利行使価格（分母）
  8524       15  KENRI-KOS-KKK-BUNBO
  8525                             PIC  S9(08)V9(10).
  8526*---------- 資産分類コード
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 148
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/SCZY3004.cpy)BOL.cpy)
  8527       15  SISAN-BUNRUI-CD   PIC  X(04).
  8528*---------- 行使価格
  8529       15  KOUSI-KKK         PIC  S9(12)V9(06).
  8530*---------- 行使為替レート
  8531       15  KOUSI-KWS         PIC  S9(08)V9(10).
  8532*---------- ユーロ債区分
  8533       15  EURO-BOND-KBN     PIC  X(01).
  8534*---------- 連動係数参照区分
  8535       15  RENKSU-REF-KBN    PIC  X(01).
  8536*---------- 連動係数／ファクター
  8537       15  RENKSU            PIC  S9(08)V9(10).
  8538*---------- 国債リオープン区分
  8539       15  KOKUSAI-REOPEN-KBN
  8540                             PIC  X(01).
  8541*---------- 償還単価
  8542       15  SHOKAN-TNK        PIC  S9(12)V9(06).
  8543*---------- 償還通貨
  8544       15  SHOKAN-TUKA       PIC  X(04).
  8545*---------- 償還日休日処理区分
  8546       15  SHOKAN-QJT-SYRI-KBN
  8547                             PIC  X(01).
  8548*---------- 利落日数
  8549       15  RIOTI-NISU        PIC  S9(02).
  8550*---------- 経過利息調整日数
  8551       15  KEKA-RSK-CHOSEI-NISU
  8552                             PIC  S9(03).
  8553*---------- 利率／割引率
  8554       15  RRT-WARI-RT       PIC  S9(08)V9(10).
  8555*---------- 端数処理桁数
  8556       15  HASU-SYRI-KETASU  PIC  S9(02).
  8557*---------- 端数処理１方法
  8558       15  HASU-SYRI-1-HOU   PIC  X(01).
  8559*---------- 端数処理１FROM
  8560       15  HASU-SYRI-1-FROM  PIC  S9(01).
  8561*---------- 端数処理１TO
  8562       15  HASU-SYRI-1-TO    PIC  S9(01).
  8563*---------- 端数処理１数字
  8564       15  HASU-SYRI-1-SU-JI PIC  S9(01).
  8565*---------- 端数処理２方法
  8566       15  HASU-SYRI-2-HOU   PIC  X(01).
  8567*---------- 端数処理２FROM
  8568       15  HASU-SYRI-2-FROM  PIC  S9(01).
  8569*---------- 端数処理２TO
  8570       15  HASU-SYRI-2-TO    PIC  S9(01).
  8571*---------- 端数処理２数字
  8572       15  HASU-SYRI-2-SU-JI PIC  S9(01).
  8573*---------- 端数処理３方法
  8574       15  HASU-SYRI-3-HOU   PIC  X(01).
  8575*---------- 端数処理３FROM
  8576       15  HASU-SYRI-3-FROM  PIC  S9(01).
  8577*---------- 端数処理３TO
  8578       15  HASU-SYRI-3-TO    PIC  S9(01).
  8579*---------- 端数処理３数字
  8580       15  HASU-SYRI-3-SU-JI PIC  S9(01).
  8581*---------- １００通貨端数処理桁数
  8582       15  T100-HASU-SYRI-KETA
  8583                             PIC  S9(02).
  8584*---------- １００通貨端数処理方法
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 149
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/SCZY3004.cpy)BOL.cpy)
  8585       15  T100-HASU-SYRI-HOU
  8586                             PIC  X(01).
  8587*---------- 初期利払日
  8588       15  SHOKI-RIBAR-YMD   PIC  S9(08).
  8589*---------- 初期利払起算日
  8590       15  SHOKI-RIBAR-KS-YMD
  8591                             PIC  S9(08).
  8592*---------- 初期利払経過日数計算方法
  8593       15  SHOKI-RB-KKNS-KSHH
  8594                             PIC  X(01).
  8595*---------- 初期利払経過日数１ヶ月３０日設定区分
  8596       15  SHOKI-RB-1M30D-KBN
  8597                             PIC  X(01).
  8598*---------- 初期利払経過日数片端／両端区分
  8599       15  SHOKI-RB-KKNS-KR-KBN
  8600                             PIC  X(01).
  8601*---------- 初期利払年日数計算方法
  8602       15  SHOKI-RIBAR-NEN-KSHH
  8603                             PIC  X(01).
  8604*---------- 初期利払年日数計算方法片端／両端区分
  8605       15  SHOKI-RB-KSHH-KR-KBN
  8606                             PIC  X(01).
  8607*---------- 初期利払日休日処理区分
  8608       15  SHOKI-RB-YMD-QJT-KBN
  8609                             PIC  X(01).
  8610*---------- 初期利払単位１日あたり利息額
  8611       15  SHOKI-RB-TANI-1D-RSK
  8612                             PIC  S9(08)V9(10).
  8613*---------- 初期１００通貨端数処理桁数
  8614       15  SHOKI-T100-HASU-SRKT
  8615                             PIC  S9(02).
  8616*---------- 初期１００通貨端数処理方法
  8617       15  SHOKI-T100-HASU-SRH
  8618                             PIC  X(01).
  8619*---------- 最終利払日
  8620       15  LAST-RIBAR-YMD    PIC  S9(08).
  8621*---------- 最終利払起算日
  8622       15  LAST-RIBAR-KISAN-YMD
  8623                             PIC  S9(08).
  8624*---------- 終期利払経過日数計算方法
  8625       15  SHUKI-RB-KKNS-KSHH
  8626                             PIC  X(01).
  8627*---------- 終期利払経過日数１ヶ月３０日設定区分
  8628       15  SHUKI-RB-1M30D-KBN
  8629                             PIC  X(01).
  8630*---------- 終期利払経過日数片端／両端区分
  8631       15  SHUKI-RB-KKNS-KR-KBN
  8632                             PIC  X(01).
  8633*---------- 終期利払年日数計算方法
  8634       15  SHUKI-RIBAR-NEN-KSHH
  8635                             PIC  X(01).
  8636*---------- 終期利払年日数計算方法片端／両端区分
  8637       15  SHUKI-RB-KSHH-KR-KBN
  8638                             PIC  X(01).
  8639*---------- 終期利払日休日処理区分
  8640       15  SHUKI-RB-YMD-QJT-KBN
  8641                             PIC  X(01).
  8642*---------- 終期利払単位１日あたり利息額
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 150
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/SCZY3004.cpy)BOL.cpy)
  8643       15  SHUKI-RB-TANI-1D-RSK
  8644                             PIC  S9(08)V9(10).
  8645*---------- 終期１００通貨端数処理桁数
  8646       15  SHUKI-T100-HASU-SRKT
  8647                             PIC  S9(02).
  8648*---------- 終期１００通貨端数処理方法
  8649       15  SHUKI-T100-HASU-SRH
  8650                             PIC  X(01).
  8651*---------- 権利行使価格
  8652       15  KRKS-KKK          PIC  S9(12)V9(06).
  8653*---------- 転換日
  8654       15  TENKAN-YMD        PIC  S9(08).
  8655*---------- 転換／行使レート
  8656       15  TENKAN-KOUSI-RATE PIC  S9(08)V9(10).
  8657*---------- 発行額
  8658       15  HAKKO-GK          PIC  S9(12)V9(06).
  8659*---------- 現存額
  8660       15  GENZON-GK         PIC  S9(12)V9(06).
  8661*---------- 外債補助区分
  8662       15  GAISAI-HOJO-KBN   PIC  X(02).
  8663*---------- 上場後時価自動振替
  8664       15  JIKA-AUTO-KAE     PIC  X(01).
  8665*---------- 設定日
  8666       15  SET-YMD           PIC  S9(08).
  8667*---------- 販売口数
  8668       15  HANBAI-KUTISU     PIC  S9(12)V9(06).
  8669*---------- 委託会社コード
  8670       15  ITK-CMP-CD        PIC  X(04).
  8671*---------- 保管先
  8672       15  HOKAN-SAKI        PIC  X(04).
  8673*---------- 端数処理FROM
  8674       15  HASU-SYRI-FROM    PIC  S9(01).
  8675*---------- 端数処理TO
  8676       15  HASU-SYRI-TO      PIC  S9(01).
  8677*---------- 端数処理方法
  8678       15  HASU-SYRI-HOU     PIC  X(01).
  8679*---------- 取引通貨コード
  8680       15  TRHK-TUKA-CD      PIC  X(04).
  8681*---------- コールプット区分
  8682       15  CALL-PUT-KBN      PIC  X(01).
  8683*---------- カウンターパーティ
  8684       15  COUNTER-PARTY     PIC  X(04).
  8685*---------- 用途
  8686       15  YOUTO             PIC  X(01).
  8687*---------- ヘッジ／カバー区分
  8688       15  HEDGE-COVER-KBN   PIC  X(01).
  8689*---------- 勘定科目出力商品名
  8690       15  KNJ-KAMK-OUT-SYOHIN
  8691                             PIC  X(04).
  8692*---------- 乗数（分子）
  8693       15  JYOUSUU-BUNSI     PIC  S9(08)V9(10).
  8694*---------- 乗数（分母）
  8695       15  JYOUSUU-BUNBO     PIC  S9(08)V9(10).
  8696*---------- 予備フラグ１
  8697       15  YOBI-FLG-1        PIC  X(01).
  8698*---------- 予備コード１
  8699       15  YOBI-CD-1         PIC  X(04).
  8700*---------- 予備数字１
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 151
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/SCZY3004.cpy)BOL.cpy)
  8701       15  YOBI-SU-JI-1      PIC  S9(08)V9(10).
  8702*---------- コメント１
  8703       15  COMENT-1          PIC  X(60).
  8704*---------- 予備フラグ２
  8705       15  YOBI-FLG-2        PIC  X(01).
  8706*---------- 予備コード２
  8707       15  YOBI-CD-2         PIC  X(04).
  8708*---------- 予備数字２
  8709       15  YOBI-SU-JI-2      PIC  S9(08)V9(10).
  8710*---------- コメント２
  8711       15  COMENT-2          PIC  X(60).
  8712*---------- 予備フラグ３
  8713       15  YOBI-FLG-3        PIC  X(01).
  8714*---------- 予備コード３
  8715       15  YOBI-CD-3         PIC  X(04).
  8716*---------- 予備数字３
  8717       15  YOBI-SU-JI-3      PIC  S9(08)V9(10).
  8718*---------- コメント３
  8719       15  COMENT-3          PIC  X(60).
  8720*---------- データソース
  8721       15  DATA-SOURCE       PIC  X(04).
  8722*---------- 削除区分
  8723       15  SAKUJO-KBN        PIC  X(01).
  8724*---------- 作成フラグ
  8725       15  SK-FLG            PIC  X(01).
  8726*---------- 作成画面ID
  8727       15  SK-GAMEN          PIC  X(08).
  8728*---------- 作成ファイル名
  8729       15  SK-FILE           PIC  X(20).
  8730*---------- 作成日時
  8731       15  SK-DATE           PIC  X(14).
  8732*---------- 作成ログインユーザ会社コード
  8733       15  SK-LOGIN-CMP-CD   PIC  X(04).
  8734*---------- 作成ユーザID
  8735       15  SK-SID            PIC  X(20).
  8736*---------- 作成プログラムID
  8737       15  SK-PGMID          PIC  X(16).
  8738*---------- 更新フラグ
  8739       15  UPD-FLG           PIC  X(01).
  8740*---------- 更新画面ＩＤ
  8741       15  UPD-GAMEN         PIC  X(08).
  8742*---------- 更新ファイル名
  8743       15  UPD-FILE          PIC  X(20).
  8744*---------- 更新日時
  8745       15  UPD-DATE          PIC  X(14).
  8746*---------- 更新ログインユーザ会社コード
  8747       15  UPD-LOGIN-CMP-CD  PIC  X(04).
  8748*---------- 更新ユーザＩＤ
  8749       15  UPD-SID           PIC  X(20).
  8750*---------- 更新プログラムＩＤ
  8751       15  UPD-PGMID         PIC  X(16).
  8752*----------  ポートフォリオと有効期間取得取得ルーチン
  8753 01  PARM-SCZY4002-INOUT.
* 8754     COPY  "SCZY4002.cpy".
  8755******************************************************************
  8756* $Header$
  8757******************************************************************
  8758*
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 152
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/SCZY4002.cpy)BOL.cpy)
  8759*  システムＩＤ   : T-STAR
  8760*  システム名称   : 次期TSTARシステム
  8761*  コピー句ＩＤ   : SCZY4002.cpy
  8762*  コピー句名称   : ポートフォリオと有効期間取得
  8763*
  8764*  改訂履歴
  8765*  年月日     所属       担当者  内容
  8766*  ---------- ---------- ------  ----------------------------
  8767*  2007/11/12 SCS        李嘉華  新規
  8768*  2008/04/24 SCS        張  春  修正
  8769*  2008/07/07 SCS        包香娟　修正
  8770******************************************************************
  8771 05  PARM-SCZY4002-ARG1.
  8772*----------  利用会社コード
  8773   10  RIYO-COMPANY-CODE     PIC  X(04).
  8774*----------  オール指定1
  8775   10  ALL-SITEI-1           PIC  X(01).
  8776*******    連結障害対応No.0000487  20081114 修正  開始    ********
  8777*----------  ポートフォリオ選択リスト
  8778   10  PTF-FUND-LIST.
  8779     15  FUND-PTF-GRP        OCCURS  10.
  8780*----------  ポートフォリオ区分
  8781       20  PTF-KBN           PIC  X(01).
  8782*----------  グループ又はファンドコード
  8783       20  GRP-FUND-CD       PIC  X(12).
  8784*----------  ポートフォリオコード
  8785       20  PTF-CD            PIC  X(04).
  8786*******    連結障害対応No.0000487  20081114 修正  終了    ********
  8787*----------  オール指定2
  8788   10  ALL-SITEI-2           PIC  X(01).
  8789*----------  評価系列
  8790   10  HYK-KRTU.
  8791*----------  評価系列コード
  8792     15 HYK-KRTU-CD          OCCURS  10
  8793                             PIC  X(04).
  8794*----------  基準日FROM
  8795   10  KZYN-YMD-FROM         PIC  9(08).
  8796*----------  基準日TO
  8797   10  KZYN-YMD-TO           PIC  9(08).
  8798*----------  権限チェック有無
  8799   10  KGN-CHK-UMU           PIC  X(01).
  8800*----------  メニューID
  8801   10  MENU-ID               PIC  X(08).
  8802*----------  画面アクション区分
  8803   10  GAMEN-ACT-KBN         PIC  X(01).
  8804*----------  業務タスクID
  8805   10  GYOMU-TASK-ID         PIC  X(07).
  8806*----------  日中夜間区分
  8807   10  NCHU-YAKN-KBN         PIC  X(01).
  8808*----------  APL指定出力件数
  8809   10  APL-OUT-CNT           PIC  9(08).
  8810 05  PARM-SCZY4002-ARG2.
  8811*----------  ヒット件数
  8812   10  HIT-KENSU             PIC  9(05).
  8813*----------  返却データ
  8814   10  PTF-ATT-DATA  OCCURS  50000.
  8815*----------  ファンドコード
  8816     15  FUND-CD             PIC  X(12).
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 153
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/SCZY4002.cpy)BOL.cpy)
  8817*----------  ファンド名（日）
  8818     15  FND-MEI-JPN         PIC  X(60).
  8819*----------  ポートフォリオコード
  8820     15  PTF-CD              PIC  X(04).
  8821*----------  ポートフォリオ名（日）
  8822     15  PTF-MEI-JPN         PIC  X(60).
  8823*----------  デフォルト評価系列コード
  8824     15  DEFAUL-THYK-CD      PIC  X(04).
  8825*----------基準日From
  8826     15  KZYN-YMD-FROM       PIC  9(08).
  8827*----------基準日To
  8828     15  KZYN-YMD-TO         PIC  9(08).
  8829 01  PARM-SCZY4002-AIFA-HEADER.
  8830   05  WK-IN-AIFA.
  8831*----------  AIFA情報
* 8832     COPY  "WOMCMAIFA.CPY".
  8833*
  8834* システムID   :WOM
  8835* システム名称 :サーバ基盤ミドルソフト
  8836* プログラムID :WOMCMAIFA.CPY
  8837* 処理概要(目的,使用法,重要な変数など):
  8838*     ＡＩＦＡ定義ヘッダ
  8839*
  8840
  8841* 改訂履歴
  8842* 年月日   区分 所属　　 担当　　内容
  8843* -------- ---- -------- ------- --------------------------------
  8844* 19950406 新規 S銀13    鮫島    新規
  8845* 95.06.28 修正 S銀13    小柳    コーディング基準に準拠
  8846* 95.07.06 修正 S銀13    小柳    業務ランク変更 #PSD-201
  8847* 95.10.17 修正 S金13    木村    AIFA V0201支援 #PCL301
  8848* 95.10.17 修正 S金13    木村    TP1ｴﾗｰｺｰﾄﾞ支援 #PCL309
  8849* 96.02.20 修正 S金13    河原    VALUE句削除    #PSD333
  8850*
  8851
  8852*
  8853* Copyright (C) 1995 by Nomura Research Institute,Ltd.
  8854* All rights reserved.
  8855*
  8856** WOMAIFA **
  8857***  AIFA-ST.
  8858     10  AIFA-SIZE           PIC  S9(4)
  8859                             USAGE IS COMP-5.
  8860*    * ＡＩＦＡサイズ
  8861     10  VR-NO               PIC  X(4).
  8862*    * バージョン番号
  8863     10  ON-LINE-DATE        PIC  X(8).
  8864*    * オンライン日付
  8865     10  PROC-DATE           PIC  X(8).
  8866*    * 処理年月日
  8867     10  APL-DATE            PIC  X(6).
  8868*    * ＡＰ起動時刻
  8869     10  SV-HOST-NAME        PIC  X(32).
  8870*    * 自サーバ名称
  8871     10  CLT-APL-NAME        PIC  X(8).
  8872*    * クライアントＡＰＬ名称
  8873     10  ON-LUNE-NAME        PIC  X(2).
  8874*    * 自オンライン名称
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 154
* MUSR2651.cob (/opt/wom/copy/WOMCMAIFA.CPY)                       cpy)BOL.cpy)
  8875     10  FILLER              PIC  X(6).
  8876*    * 予備１
  8877     10  SV-GROUP            PIC  X(31).
  8878*    * サービスグループ
  8879     10  SV-NAME             PIC  X(31).
  8880*    * サービス名称
  8881     10  START-TYPE          PIC  X(2).
  8882*    * サービス起動形態
  8883     10  PROC-NAME           PIC  X(16).
  8884*    * プロセス名称
  8885     10  ORG-SV-GROUP        PIC  X(31).
  8886*    * オリジナルサービスグループ名称
  8887     10  ORG-SV-NAME         PIC  X(31).
  8888*    * オリジナルサービス名称
  8889     10  ORG-START-TYPE      PIC  X(2).
  8890*    * オリジナル起動形態
  8891     10  MONITER-SW          PIC  X(1).
  8892*    * モニタ取得区分
  8893     10  AP-COMPLETE-ST      PIC  X(1).
  8894*    * ＡＰ終了ステータス
  8895     10  MDL-COMPL-ST        PIC  X(1).
  8896*    * ミドル終了ステータス
  8897     10  TROUBLE-SW          PIC  X(1).
  8898*    * 障害区分
  8899     10  FORCE-SW            PIC  X(1).
  8900*    * 強制区分
  8901     10  FILLER              PIC  X(3).
  8902*    * 予備２
  8903     10  IN-NO               PIC  S9(4)
  8904                             USAGE IS COMP-5.
  8905*    * 入力通番
  8906     10  IN-HOST-NAME        PIC  X(32).
  8907*    * 入力端末のコンピュータ名称
  8908     10  COMPANY-CODE        PIC  X(4).
  8909*    * 会社コード
  8910     10  IN-ST-CODE          PIC  X(4).
  8911*    * 顧客処理部店コード
  8912     10  IN-ST-DBNAME        PIC  X(32).
  8913*    * 営業店ＤＢサーバ名称
  8914     10  FILLER              PIC  X(6).
  8915*    * 予備３
  8916     10  JOB-USER-ID         PIC  X(8).
  8917*    * 端末利用者の業務ユーザＩＤ
  8918     10  JOB-RANK-01         PIC  X(2).
  8919*    * 端末利用者の業務ランク０１ #PSD-201
  8920     10  JOB-RANK-02         PIC  X(2).
  8921*    * 端末利用者の業務ランク０２ #PSD-201
  8922     10  JOB-RANK-03         PIC  X(2).
  8923*    * 端末利用者の業務ランク０３ #PSD-201
  8924     10  JOB-RANK-04         PIC  X(2).
  8925*    * 端末利用者の業務ランク０４ #PSD-201
  8926     10  JOB-RANK-05         PIC  X(2).
  8927*    * 端末利用者の業務ランク０５ #PSD-201
  8928     10  JOB-RANK-06         PIC  X(2).
  8929*    * 端末利用者の業務ランク０６ #PSD-201
  8930     10  JOB-RANK-07         PIC  X(2).
  8931*    * 端末利用者の業務ランク０７ #PSD-201
  8932     10  JOB-RANK-08         PIC  X(2).
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 155
* MUSR2651.cob (/opt/wom/copy/WOMCMAIFA.CPY)                       cpy)BOL.cpy)
  8933*    * 端末利用者の業務ランク０８ #PSD-201
  8934     10  JOB-RANK-09         PIC  X(2).
  8935*    * 端末利用者の業務ランク０９ #PSD-201
  8936     10  JOB-RANK-10         PIC  X(2).
  8937*    * 端末利用者の業務ランク１０ #PSD-201
  8938     10  USER-IN-ST          PIC  X(4).
  8939*    * ユーザ所属部店
  8940     10  SV-ERR-CD           PIC  X(4).
  8941*    *サーバ詳細コード      #PCL309
  8942     10  RLY-RPC-TM          PIC  S9(4)
  8943                             USAGE IS COMP-5.
  8944*    *問合せ応答タイマ      #PCL301
  8945     10  FILLER              PIC  X(54).
  8946*    * 予備５ #PSD-201 #PCL301,#PCL309
  8947   05  WK-IN-HEADER.
  8948*----------  共通ヘッダ
* 8949     COPY  "CZCOMMONHEADER.cpy".
  8950******************************************************************
  8951*
  8952*  システムＩＤ   : T-STAR
  8953*  システム名称   : 新有価証券バックオフィスシステム
  8954*  コピー句ＩＤ   : CZCOMMONHEADER.cpy
  8955*  コピー句名称   : 共通ヘッダ
  8956*
  8957*  改訂履歴
  8958*  年月日     所属       担当者  内容
  8959*  ---------- ---------- ------  ----------------------------
  8960*  2006/08/21 SCS                新規
  8961*
  8962******************************************************************
  8963*----------  リクエストID
  8964 10  REQUEST-ID                        PIC  X(32).
  8965*----------  システム日付
  8966 10  SYS-DATE                          PIC  X(08).
  8967*----------  ログインユーザ会社業務形態区分
  8968 10  COMPANY-TYPE                      PIC  X(01).
  8969*----------  ユーザー名称
  8970 10  USER-NAME                         PIC  X(40).
  8971*----------  ユーザー種別
  8972 10  USER-TYPE                         PIC  X(01).
  8973*----------  業務グループコード
  8974 10  GYOUMU-GROUP-CODE                 PIC  X(10).
  8975*----------  業務グループ名称
  8976 10  GYOUMU-GROUP-NAME                 PIC  X(40).
  8977*----------  メニュー利用制限区分
  8978 10  ALL-MENU-USABLE                   PIC  X(01).
  8979*----------  業務タスク利用制限区分
  8980 10  ALL-TASK-USABLE                   PIC  X(01).
  8981*----------  帳票利用制限区分
  8982 10  ALL-REPORT-USABLE                 PIC  X(01).
  8983*----------  利用会社コード
  8984 10  RIYO-COMPANY-CODE                 PIC  X(04).
  8985*----------  利用会社名称
  8986 10  RIYO-COMPANY-NAME                 PIC  X(60).
  8987*----------  利用会社業務形態区分
  8988 10  RIYO-COMPANY-TYPE                 PIC  X(01).
  8989*----------  委託会社コード
  8990 10  ITAKU-CODE                        PIC  X(03).
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 156
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/CZCOMMONHEADER.cpy)y)
  8991*----------  受託銀行コード
  8992 10  JYUTAKU-CODE                      PIC  X(02).
  8993*----------  システムエラーメッセージ
  8994 10  SYSTEM-ERROR-MSG                  PIC  X(60).
  8995*----------  予備
  8996 10  FILLER                            PIC  X(35).
  8997*----------  国全項目取得
  8998 01  PARM-SCZY4102-INOUT.
* 8999     COPY  "SCZY4102.cpy".
  9000******************************************************************
  9001* $Header$
  9002******************************************************************
  9003*
  9004*  システムＩＤ   : T-STAR
  9005*  システム名称   : 次期TSTARシステム
  9006*  コピー句ＩＤ   : SCZY4102.cpy
  9007*  コピー句名称   : 国名称取得
  9008*
  9009*  改訂履歴
  9010*  年月日     所属       担当者  内容
  9011*  ---------- ---------- ------  ----------------------------
  9012*  2008/03/25 SCS        張  春  新規
  9013******************************************************************
  9014 05  PARM-SCZY4102-ARG1.
  9015*----------  利用会社コード
  9016     10  RIYO-CMP-CD         PIC  X(04).
  9017*----------  国コード
  9018     10  KUNI-CD             PIC  X(04).
  9019*----------  適用開始日
  9020     10  TEKIYO-FROM         PIC  9(08).
  9021 05  PARM-SCZY4102-ARG2.
  9022*----------  国コード
  9023     10  KUNI-CD             PIC  X(04).
  9024*----------  適用開始日
  9025     10  TEKIYO-FROM         PIC  9(08).
  9026*----------  国コード_略式
  9027     10  KUNI-CD-RYAKU       PIC  X(02).
  9028*----------  国名称_全角（日）
  9029     10  KUNI-NAME-J-ZK      PIC  X(60).
  9030*----------  国名称_半角（日）
  9031     10  KUNI-NAME-J-HK      PIC  X(60).
  9032*----------  国名称（英）
  9033     10  KUNI-NAME-E         PIC  X(60).
  9034*----------  国名称_略称（日）
  9035     10  KUNI-AB-NAME-J      PIC  X(30).
  9036*----------  国名称_略称（英）
  9037     10  KUNI-AB-NAME-E      PIC  X(30).
  9038*----------  通貨コード
  9039     10  TUKA-CD             PIC  X(04).
  9040*----------  出力順
  9041     10  OUT-JUN             PIC  9(04).
  9042
  9043*----------  内部⇒外部コードリファレンス変換ルーチン
  9044 01  PARM-SCZY4182-INOUT.
* 9045     COPY  "SCZY4182.cpy".
  9046******************************************************************
  9047* $Header$
  9048******************************************************************
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 157
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/SCZY4182.cpy)R.cpy)y)
  9049*
  9050*  システムＩＤ   : T-STAR
  9051*  システム名称   : 次期TSTARシステム
  9052*  コピー句ＩＤ   : SCZY4182.cpy
  9053*  コピー句名称   : コードリファレンス変換ルーチン
  9054*
  9055*  改訂履歴
  9056*  年月日     所属       担当者  内容
  9057*  ---------- ---------- ------  ----------------------------
  9058*  2009/05/15 SCS        李峰    新規
  9059******************************************************************
  9060 05  PARM-SCZY4182-ARG1.
  9061*----------  利用会社コード
  9062   10  RIYO-CMP-CD           PIC  X(04).
  9063*----------  コード種類
  9064   10  CD-SHRU               PIC  X(02).
  9065*----------  コードリファレンス系列コード
  9066   10  CD-REF-KRTU-CD        PIC  X(04).
  9067*----------  業務タスクID
  9068   10  GYOMU-TASK-ID         PIC  X(07).
  9069*----------  変換元コード
  9070   10  NAIBU-CD              PIC  X(40).
  9071*----------  基準日
  9072   10  KJN-YMD               PIC  9(08).
  9073 05  PARM-SCZY4182-ARG2.
  9074*----------  変換先エリア
  9075   10  SAKI-AREA             OCCURS  20.
  9076*----------  変換先コード
  9077     15  GAIBU-CD            PIC  X(40).
  9078*----------  変換件数
  9079   10  HENKAN-KENSU          PIC  9(02).
  9080*------------------ <残タスク135の対応 START>---------------------
  9081*----------  商品属性全項目取得
  9082 01  PARM-SCZY4156-INOUT.
* 9083     COPY  "SCZY4156.cpy".
  9084******************************************************************
  9085* $Header$
  9086******************************************************************
  9087*
  9088* システムＩＤ   : T-STAR
  9089* システム名称   : 次期TSTARシステム
  9090* コピー句ＩＤ   : SCZY4156.cpy
  9091* コピー句名称   : 商品属性全項目取得
  9092*
  9093* 改訂履歴
  9094* 年月日   区分 所属     担当者  内容
  9095* -------- ---- -------- ------- ---------------------------------
  9096* 20080415 新規 SCS      李海中  新規作成
  9097* 20090806 修正 SCS      李峰    テーマNo.834
  9098******************************************************************
  9099 05  PARM-SCZY4156-ARG1.
  9100*----------  利用会社コード
  9101   10  RIYO-CMP-CD           PIC  X(04).
  9102*----------  証券種別コード
  9103   10  SEC-SBT-CD            PIC  X(04).
  9104 05  PARM-SCZY4156-ARG2.
  9105*----------  商品分類コード
  9106   10  SYOHIN-BUNRUI-CD      PIC  X(04).
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 158
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/SCZY4156.cpy)R.cpy)y)
  9107*----------  証券種別コード
  9108   10  SEC-SBT-CD            PIC  X(04).
  9109*----------  商品名称（日）
  9110   10  SHOHIN-NAME-J         PIC  X(60).
  9111*----------  商品名称（英）
  9112   10  SHOHIN-NAME-E         PIC  X(60).
  9113*----------  商品名称_略称（日）
  9114   10  SHOHIN-AB-NAME-J      PIC  X(30).
  9115*----------  商品名称_略称（英）
  9116   10  SHOHIN-AB-NAME-E      PIC  X(30).
  9117*----------  商品区分
  9118   10  SYOHIN-KBN            PIC  X(02).
  9119*----------  管理数量単位
  9120   10  KANRI-SURYO-TANI      PIC  S9(12)V9(06).
  9121*----------  属性管理区分
  9122   10  ZOUKUSEI-KANRI-KBN    PIC  X(02).
  9123*----------  時価等取得区分
  9124   10  JIKA-SHTK-KBN         PIC  X(06).
  9125*----------  評価パターンコード
  9126   10  HYK-PATTERN-CD        PIC  X(04).
  9127*----------  商品属性用途
  9128   10  SYOHIN-ZOK-YOUTO      PIC  X(01).
  9129*----------  属性参照先１
  9130   10  ZOK-SANS1             PIC  X(04).
  9131*----------  属性参照先２
  9132   10  ZOK-SANS2             PIC  X(04).
  9133*----------  属性参照先３
  9134   10  ZOK-SANS3             PIC  X(04).
  9135*----------  属性参照先４
  9136   10  ZOK-SANS4             PIC  X(04).
  9137*----------  属性参照先５
  9138   10  ZOK-SANS5             PIC  X(04).
  9139*----------  リファレンス項目管理可否
  9140   10  REF-MANA-KAHI         PIC  X(09).
  9141*----------  帳票出力分類
  9142   10  REP-OUT-BUNRUI        PIC  X(08).
  9143*----------  コメント
  9144   10  COMENT                PIC  X(20).
  9145*******    テーマNo.834  20090806 修正  開始    ******************
  9146*----------  出力順
  9147   10  OUT-JUN               PIC  S9(04).
  9148*******    テーマNo.834  20090806 修正  終了    ******************
  9149*------------------ <残タスク135の対応 END>-----------------------
  9150*----------  バッチ開始メッセージ出力ルーチン
  9151 01  PARM-SCZY7010-IN.
* 9152     COPY  "SCZY7010.cpy".
  9153******************************************************************
  9154*
  9155*  システムＩＤ   : T-STAR
  9156*  システム名称   : 次期TSTARシステム
  9157*  コピー句ＩＤ   : SCZY7010.cpy
  9158*  コピー句名称   : バッチ開始メッセージ出力ルーチンコピー句
  9159*
  9160*  改訂履歴
  9161*  年月日     所属       担当者  内容
  9162*  ---------- ---------- ------  ----------------------------
  9163*  20070910   NRI                新規
  9164*
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 159
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/SCZY7010.cpy)R.cpy)y)
  9165******************************************************************
  9166
  9167   05  PARM-SCZY7010-ARG1.
  9168*---------- プログラムID
  9169     10  PGM-ID                PIC  X(16).
  9170*----------  バッチ終了メッセージ出力ルーチン
  9171 01  PARM-SCZY7020-INOUT.
* 9172     COPY  "SCZY7020.cpy".
  9173******************************************************************
  9174*
  9175*  システムＩＤ   : T-STAR
  9176*  システム名称   : 次期TSTARシステム
  9177*  コピー句ＩＤ   : SCZY7020.cpy
  9178*  コピー句名称   : バッチ終了メッセージ出力ルーチコピー句
  9179*
  9180*  改訂履歴
  9181*  年月日     所属       担当者  内容
  9182*  ---------- ---------- ------  ----------------------------
  9183*  2007/09/17 SCS        劉鳳麗  新規
  9184*
  9185******************************************************************
  9186
  9187   05  PARM-SCZY7020-ARG1.
  9188*---------- エラー種別
  9189     10  ERR-SYUBETU              PIC  X(01).
  9190   05  PARM-SCZY7020-ARG2.
  9191*---------- プログラム名
  9192     10  PGM-ID                   PIC  X(16).
  9193*---------- 利用会社コード
  9194     10  RIYO-CMP-CD              PIC  X(04).
  9195*---------- 基準日
  9196     10  KJN-YMD                  PIC  X(08).
  9197*---------- 実行処理ID
  9198     10  JIKOU-SYORI-ID           PIC  X(07).
  9199*---------- 起動ID
  9200     10  KIDOU-ID                 PIC  X(04).
  9201*----------  バッチ処理件数出力ルーチン
  9202 01  PARM-SCZY7040-IN.
* 9203     COPY  "SCZY7040.cpy".
  9204******************************************************************
  9205*
  9206*  システムＩＤ   : T-STAR
  9207*  システム名称   : 次期ＴＳＴＡＲシステム
  9208*  コピー句ＩＤ   : SCZY7040.cpy
  9209*  コピー句名称   : バッチ処理件数出力ルーチン
  9210*
  9211*  改訂履歴
  9212*  年月日     所属       担当者  内容
  9213*  ---------- ---------- ------  ----------------------------
  9214*  20070914   SCS        趙 暘  新規
  9215*
  9216******************************************************************
  9217
  9218     10  ARG1.
  9219*----------  テーブル・ファイル数
  9220       15  TABLE-FILE-NUM    PIC  9(06).
  9221     10  ARG2.
  9222*----------  テーブル・ファイル情報
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 160
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/SCZY7040.cpy)R.cpy)y)
  9223       15  TABLE-FILE-MSG   OCCURS  999.
  9224*----------  識別子
  9225         20  IDENT-ID        PIC  X(256).
  9226*----------  対象処理
  9227         20  OBJECT-DISPOSAL PIC  X(06).
  9228*----------  処理件数
  9229         20  DISPOSAL-NUM    PIC  9(09).
  9230*----------  実行状況管理明細ＩＮＳルーチン
  9231 01  PARM-SCZY7050-IN.
* 9232     COPY  "SCZY7050.cpy".
  9233******************************************************************
  9234*
  9235*  システムＩＤ   : T-STAR
  9236*  システム名称   : 次期TSTARシステム
  9237*  コピー句ＩＤ   : SCZY7050.cpy
  9238*  コピー句名称   : 実行状況管理明細ＩＮＳルーチンコピー句
  9239*
  9240*  改訂履歴
  9241*  年月日     所属       担当者  内容
  9242*  ---------- ---------- ------  ----------------------------
  9243*  20080330   SCS        沈焔　  新規
  9244*
  9245******************************************************************
  9246
  9247   05  PARM-SCZY7050-ARG1.
  9248*----------  利用会社コード
  9249     10  RIYO-CMP-CD              PIC  X(04).
  9250*----------  処理実行日
  9251     10  SYORI-YMD                PIC  9(08).
  9252*----------  起動ID
  9253     10  KIDOU-ID                 PIC  X(04).
  9254*----------  業務タスクID
  9255     10  GYOMU-TASK-ID            PIC  X(07).
  9256*----------  ファンドコード
  9257     10  FUND-CD                  PIC  X(12).
  9258*----------  ポートフォリオコード
  9259     10  PTF-CD                   PIC  X(04).
  9260*----------  評価系列コード
  9261     10  HYK-KRTU-CD              PIC  X(04).
  9262*----------  帳票ID
  9263     10  REP-ID                   PIC  X(08).
  9264*----------  任意コード
  9265     10  REP-ANY-CD               PIC  X(50).
  9266*----------  基準日FROM
  9267     10  KJN-YMD-FROM             PIC  9(08).
  9268*----------  基準日TO
  9269     10  KJN-YMD-TO               PIC  9(08).
  9270*----------  実行状況管理SELルーチン
  9271 01  PARM-SCZY7060-INOUT.
* 9272     COPY  "SCZY7060.cpy".
  9273******************************************************************
  9274*
  9275*  システムＩＤ   : T-STAR
  9276*  システム名称   : 次期TSTARシステム
  9277*  コピー句ＩＤ   : SCZY7060.cpy
  9278*  コピー句名称   : 実行状況管理SELルーチンコピー句
  9279*
  9280*  改訂履歴
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 161
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/SCZY7060.cpy)R.cpy)y)
  9281*  年月日     所属       担当者  内容
  9282*  ---------- ---------- ------  ----------------------------
  9283*  20070820   SCS        呉聞傑  新規
  9284*
  9285******************************************************************
  9286
  9287   05  PARM-SCZY7060-ARG1.
  9288*----------  利用会社コード
  9289     10  RIYO-CMP-CD              PIC  X(04).
  9290*----------  処理実行日
  9291     10  SYORI-YMD                PIC  9(08).
  9292*----------  起動ID
  9293     10  KIDOU-ID                 PIC  X(04).
  9294   05  PARM-SCZY7060-ARG2.
  9295*----------  実行状況管理情報
  9296     10  PARM-TKDYAA31-LAYOUT.
* 9297       COPY  "TKDYAA31.cpy".
  9298******************************************************************
  9299*
  9300*  システムＩＤ   : T-STAR
  9301*  システム名称   : 新有価証券バックオフィスシステム
  9302*  コピー句ＩＤ   : TKDYAA31.cpy
  9303*  コピー句名称   : 実行状況管理
  9304*
  9305*  改訂履歴
  9306*  年月日     所属       担当者  内容
  9307*  ---------- ---------- ------  ----------------------------
  9308*  2011/10/10 NRI               新規
  9309*
  9310******************************************************************
  9311
  9312*----------  利用会社コード
  9313 20  RIYO-CMP-CD                             PIC  X(04).
  9314*----------  処理実行日
  9315 20  SYORI-YMD                               PIC  S9(08).
  9316*----------  起動ID
  9317 20  KIDOU-ID                                PIC  X(04).
  9318*----------  アクセス日時
  9319 20  ACC-TIME                                PIC  X(14).
  9320*----------  アクセスIPアドレス
  9321 20  ACC-IP                                  PIC  X(15).
  9322*----------  起動ログインユーザ会社コード
  9323 20  KIDOU-LOGIN-CMP-CD                      PIC  X(04).
  9324*----------  起動ユーザーID
  9325 20  KIDOU-SID                               PIC  X(20).
  9326*----------  起動業務グループコード
  9327 20  KIDOU-GYOMU-GRP-CD                      PIC  X(10).
  9328*----------  タスクスケジュール起動ID
  9329 20  TSK-SCHE-KIDOU-ID                       PIC  X(04).
  9330*----------  タスクスケジュールID
  9331 20  TSK-SCHE-ID                             PIC  X(07).
  9332*----------  タスクスケジュール明細ID
  9333 20  TSK-SCHE-MS-ID                          PIC  S9(03).
  9334*----------  業務タスクID
  9335 20  GYOMU-TASK-ID                           PIC  X(07).
  9336*----------  先行タスクスケジュール明細ID１
  9337 20  SK-TSK-SCHE-MS-ID1                      PIC  S9(03).
  9338*----------  先行タスクスケジュール明細ID２
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 162
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/TKDYAA31.cpy)R.cpy)y)
  9339 20  SK-TSK-SCHE-MS-ID2                      PIC  S9(03).
  9340*----------  先行タスクスケジュール明細ID３
  9341 20  SK-TSK-SCHE-MS-ID3                      PIC  S9(03).
  9342*----------  先行タスクスケジュール明細ID４
  9343 20  SK-TSK-SCHE-MS-ID4                      PIC  S9(03).
  9344*----------  先行タスクスケジュール明細ID５
  9345 20  SK-TSK-SCHE-MS-ID5                      PIC  S9(03).
  9346*----------  先行タスクスケジュール明細ID６
  9347 20  SK-TSK-SCHE-MS-ID6                      PIC  S9(03).
  9348*----------  先行タスクスケジュール明細ID７
  9349 20  SK-TSK-SCHE-MS-ID7                      PIC  S9(03).
  9350*----------  先行タスクスケジュール明細ID８
  9351 20  SK-TSK-SCHE-MS-ID8                      PIC  S9(03).
  9352*----------  先行タスクスケジュール明細ID９
  9353 20  SK-TSK-SCHE-MS-ID9                      PIC  S9(03).
  9354*----------  先行タスクスケジュール明細ID１０
  9355 20  SK-TSK-SCHE-MS-ID10                     PIC  S9(03).
  9356*----------  起動時刻
  9357 20  KIDOU-TIME                              PIC  X(06).
  9358*----------  起動経路
  9359 20  KIDOU-KEIRO                             PIC  X(01).
  9360*----------  待機ファイル有効区分
  9361 20  TAIKI-FILE-KBN                          PIC  X(01).
  9362*----------  タイムアウト時間（分）
  9363 20  TIMEOUT-MINUTES                         PIC  S9(04).
  9364*----------  集信区分
  9365 20  SYUSIN-KBN                              PIC  X(01).
  9366*----------  取得先区分
  9367 20  SYUTOKUSAKI-KBN                         PIC  X(01).
  9368*----------  取得方式
  9369 20  SYUTOKU-HOUSIKI                         PIC  X(01).
  9370*----------  取得ファイル区分
  9371 20  SYUTOKU-FILE-KBN                        PIC  X(01).
  9372*----------  起動処理分類
  9373 20  KIDOU-SYORI-BUNRUI                      PIC  X(01).
  9374*----------  実行ステータス
  9375 20  JIKOU-STS                               PIC  X(03).
  9376*----------  集信ステータス
  9377 20  SYUSIN-STS                              PIC  X(03).
  9378*----------  集信リトライ数
  9379 20  SYUSIN-RETRY-NUM                        PIC  S9(04).
  9380*----------  集信MAX回数
  9381 20  SYUSIN-MAX-NUM                          PIC  S9(04).
  9382*----------  集信終了日時
  9383 20  SYUSIN-END-TIME                         PIC  X(14).
  9384*----------  一時停止区分
  9385 20  ITIJI-TEISHI-KBN                        PIC  X(01).
  9386*----------  実行開始日時
  9387 20  JIKOU-START-TIME                        PIC  X(14).
  9388*----------  実行終了日時
  9389 20  JIKOU-END-TIME                          PIC  X(14).
  9390*----------  作表シェル終了日時
  9391 20  SHELL-END-TIME                          PIC  X(14).
  9392*----------  ダウンロードファイル名
  9393 20  DL-FILE-NAME                            PIC  X(100).
  9394*----------  ダウンロード出力区分
  9395 20  DL-FILE-KBN                             PIC  X(01).
  9396*----------  AQ投入ステータス
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 163
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/TKDYAA31.cpy)R.cpy)y)
  9397 20  AQ-TOUNYU-STS                           PIC  X(01).
  9398*----------  AQメッセージ
  9399 20  AQ-MSG                                  PIC  X(2000).
  9400*----------  アップロードファイル総件数
  9401 20  UPLOAD-FILE-KENSU                       PIC  S9(06).
  9402*----------  アップロードエラー件数
  9403 20  UPLOAD-ERR-KENSU                        PIC  S9(06).
  9404*----------  帳票作成単位
  9405 20  REP-CREATE-TANI                         PIC  X(01).
  9406*----------  ファイル種別
  9407 20  REP-OUT-KBN                             PIC  X(01).
  9408*----------  プリンタID
  9409 20  PRINTER-ID                              PIC  X(20).
  9410*----------  連続起動集約区分
  9411 20  SYUUYAKU-KBN                            PIC  X(01).
  9412*----------  親起動ID
  9413 20  OYA-KIDOU-ID                            PIC  X(04).
  9414*----------  削除区分
  9415 20  DEL-KBN                                 PIC  X(01).
  9416*----------  更新日時
  9417 20  UPD-DATE                                PIC  X(14).
  9418*----------  更新ログインユーザ会社コード
  9419 20  UPD-LOGIN-CMP-CD                        PIC  X(04).
  9420*----------  更新ユーザID
  9421 20  UPD-SID                                 PIC  X(20).
  9422*----------  更新プログラムID
  9423 20  UPD-PGMID                               PIC  X(16).
  9424*----------  自動運用カレンダーID
  9425 20  AUTO-CAL-ID                             PIC  X(08).
  9426*----------  タスクスケジュールNo
  9427 20  TSK-SCHE-NO                             PIC  S9(02).
  9428*----------  先行タスクスケジュールNo１
  9429 20  SK-TSK-SCHE-NO1                         PIC  S9(02).
  9430*----------  先行タスクスケジュールNo２
  9431 20  SK-TSK-SCHE-NO2                         PIC  S9(02).
  9432*----------  先行タスクスケジュールNo３
  9433 20  SK-TSK-SCHE-NO3                         PIC  S9(02).
  9434*----------  先行タスクスケジュールNo４
  9435 20  SK-TSK-SCHE-NO4                         PIC  S9(02).
  9436*----------  先行タスクスケジュールNo５
  9437 20  SK-TSK-SCHE-NO5                         PIC  S9(02).
  9438*----------  先行タスクスケジュールNo６
  9439 20  SK-TSK-SCHE-NO6                         PIC  S9(02).
  9440*----------  先行タスクスケジュールNo７
  9441 20  SK-TSK-SCHE-NO7                         PIC  S9(02).
  9442*----------  先行タスクスケジュールNo８
  9443 20  SK-TSK-SCHE-NO8                         PIC  S9(02).
  9444*----------  先行タスクスケジュールNo９
  9445 20  SK-TSK-SCHE-NO9                         PIC  S9(02).
  9446*----------  先行タスクスケジュールNo１０
  9447 20  SK-TSK-SCHE-NO10                        PIC  S9(02).
  9448*----------  AQ投入日時
  9449 20  AQ-TOUNYU-TIME                          PIC  X(14).
  9450*----------  AQ再投入日時
  9451 20  AQ-SAITOUNYU-TIME                       PIC  X(14).
  9452*----------  実行再開日時
  9453 20  JIKOU-RESTART-TIME                      PIC  X(14).
  9454*----------  停止受付日時
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 164
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/TKDYAA31.cpy)R.cpy)y)
  9455 20  TEISHI-UKETSUKE-TIME                    PIC  X(14).
  9456*----------  停止完了日時
  9457 20  TEISHI-KANRYOU-TIME                     PIC  X(14).
  9458*----------  親タスク終了日時
  9459 20  OYA-TSK-END-TIME                        PIC  X(14).
  9460     10  RX-CREATE-KBN            PIC  X(01).
  9461   05  PARM-SCZY7060-ARG3.
  9462*----------  電文情報
  9463     10  DENBUN-INFO              PIC  X(40960).
  9464
  9465*----------  ポートフォリオ別メッセージＩＮＳルーチン
  9466 01  PARM-SCZY7080-INOUT.
* 9467     COPY  "SCZY7080.cpy".
  9468******************************************************************
  9469*
  9470*  システムＩＤ   : T-STAR
  9471*  システム名称   : 次期TSTARシステム
  9472*  コピー句ＩＤ   : SCZY7080.cpy
  9473*  コピー句名称   : ポートフォリオ別メッセージＩＮＳルーチン
  9474*
  9475*  改訂履歴
  9476*  年月日     区分  所属       担当者  内容
  9477*  ---------- ----  ---------- ------  ---------------------------
  9478*  20070827   新規  SCS        銭曉鳴  新規
  9479*
  9480******************************************************************
  9481*---------- アーギュメントIN-1
  9482       05  PARM-SCZY7080-ARG1.
  9483*---------- 利用会社コード
  9484         10  RIYO-CMP-CD               PIC  X(04).
  9485*---------- 処理実行日
  9486         10  SYORI-YMD                 PIC  X(08).
  9487*---------- 起動ID
  9488         10  KIDOU-ID                  PIC  X(04).
  9489*---------- 業務タスクID
  9490         10  GYOMU-TASK-ID             PIC  X(07).
  9491*---------- アーギュメントIN-2
  9492       05  PARM-SCZY7080-ARG2.
  9493*---------- メッセージエリア
  9494         10  MSG-AREA.
  9495           15  MESSAGE-AREA  OCCURS 999.
  9496*---------- ファンドコード
  9497             20  FUND-CD               PIC  X(12).
  9498*---------- ポートフォリオコード
  9499             20  PTF-CD                PIC  X(04).
  9500*---------- 評価系列コード
  9501             20  HYK-KRTU-CD           PIC  X(04).
  9502*---------- 帳票ID
  9503             20  REP-ID                PIC  X(08).
  9504*---------- 帳票任意コード
  9505             20  REP-ANY-CD            PIC  X(50).
  9506*---------- 基準日From
  9507             20  KJN-YMD-FROM          PIC  X(08).
  9508*---------- 基準日To
  9509             20  KJN-YMD-TO            PIC  X(08).
  9510*---------- メッセージID
  9511             20  MSG-ID                PIC  X(07).
  9512*---------- 置換文字
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 165
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/SCZY7080.cpy)R.cpy)y)
  9513             20  TIKAN-MOJI.
  9514               25 TK-MOJI  OCCURS  5   PIC  X(30).
  9515*---------- フリーメッセージ
  9516             20  FREE-MSG              PIC  X(200).
  9517*----------  バッチ引数一括ＧＥＴルーチン
  9518 01  PARM-SCZY7090-INOUT.
* 9519     COPY  "SCZY7090.cpy".
  9520******************************************************************
  9521*
  9522*  システムＩＤ   : T-STAR
  9523*  システム名称   : 次期TSTARシステム
  9524*  コピー句ＩＤ   : SCZY7090.cpy
  9525*  コピー句名称   : バッチ引数一括取得ルーチンコピー句
  9526*
  9527*  改訂履歴
  9528*  年月日     所属       担当者  内容
  9529*  ---------- ---------- ------  ----------------------------
  9530*  20070911   SCS        李傑    新規
  9531*
  9532******************************************************************
  9533
  9534   05  PARM-SCZY7090-ARG1.
  9535*----------  引数個数
  9536     10  ARG-NUM             PIC  9(02).
  9537   05  PARM-SCZY7090-ARG2.
  9538*----------  引数内容
  9539     10  ARG-STRING          PIC  X(512)  OCCURS  20.
  9540*----------  バッチＤＢ接続情報取得
  9541 01  PARM-SCZY7100-INOUT.
* 9542     COPY  "SCZY7100.cpy".
  9543******************************************************************
  9544*
  9545*  システムＩＤ   : TSTAR
  9546*  システム名称   : 次期TSTARシステム
  9547*  コピー句ＩＤ   : SCZY7100.cpy
  9548*  コピー句名称   : バッチＤＢ接続情報取得ルーチンのコピー句
  9549*
  9550*  改訂履歴
  9551*  年月日     所属       担当者  内容
  9552*  ---------- ---------- ------  ----------------------------
  9553*  20070920   SCS        薛銀峰  新規
  9554*
  9555******************************************************************
  9556   05  PARM-SCZY7100-ARG1.
  9557*---------- 利用会社コード
  9558     10  RIYO-CMP-CD              PIC  X(04).
  9559   05  PARM-SCZY7100-ARG2.
  9560*----------  DB接続情報
  9561     10  DB-SETUZOKU-JYOUHOU      PIC  X(80).
  9562*----------  転送制御ファイル作成
  9563 01  PARM-SCZY7180-INOUT.
* 9564     COPY  "SCZY7180.cpy".
  9565******************************************************************
  9566*
  9567*     システムＩＤ   : T-STAR
  9568*     システム名称   : 次期TSTARシステム
  9569*     コピー句ＩＤ   : SCZY7180.cpy
  9570*     コピー句名称   : 転送制御ファイル作成ルーチン
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 166
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/SCZY7180.cpy)R.cpy)y)
  9571*
  9572*  改訂履歴
  9573*  年月日     所属       担当者      内容
  9574*  ---------- ---------- ------      ----------------------------
  9575*  2008/08/05 NRI        周立峰      新規
  9576*
  9577******************************************************************
  9578   05  PARM-SCZY7180-ARG1.
  9579*----------  利用会社
  9580     10  RIYO-CMP-CD              PIC  X(04).
  9581*----------  処理実行日
  9582     10  SYORI-YMD                PIC  X(08).
  9583*----------  起動ID
  9584     10  KIDOU-ID                 PIC  X(04).
  9585*----------  実行処理ID
  9586     10  JIKOU-SYORI-ID           PIC  X(07).
  9587*----------  拠点サーバ区分
  9588     10  KYOTEN-KBN               PIC  X(02).
  9589*----------  最大連番
  9590     10  SAIDAI-RBN               PIC  9(02).
  9591*----------  デスティネーションファイル名
  9592     10  DES-FILE-MEI             PIC  X(128).
  9593*----------  実行状況管理明細ＵＰＤルーチン
  9594 01  PARM-SCZY7210-INOUT.
* 9595     COPY  "SCZY7210.cpy".
  9596******************************************************************
  9597*
  9598*  システムＩＤ   : T-STAR
  9599*  システム名称   : 次期TSTARシステム
  9600*  コピー句ＩＤ   : SCZY7210.cpy
  9601*  コピー句名称   : 実行状況管理明細ＵＰＤルーチンコピー句
  9602*
  9603*  改訂履歴
  9604*  年月日     所属       担当者  内容
  9605*  ---------- ---------- ------  ----------------------------
  9606*  20060920   新規 SCS   王春媚  新規作成
  9607*
  9608******************************************************************
  9609   05  PARM-SCZY7210-ARG1.
  9610*----------  ARG1.セッション区分
  9611     10  SESSION-KBN              PIC  X(01).
  9612   05  PARM-SCZY7210-ARG2.
  9613*----------  ARG2.利用会社コード
  9614     10  RIYO-CMP-CD              PIC  X(04).
  9615*----------  ARG2.処理実行日
  9616     10  SYORI-YMD                PIC  9(08).
  9617*----------  ARG2.起動ID
  9618     10  KIDOU-ID                 PIC  X(04).
  9619*----------  ARG2.ファンドコード
  9620     10  FUND-CD                  PIC  X(12).
  9621*----------  ARG2.ポートフォリオコード
  9622     10  PTF-CD                   PIC  X(04).
  9623*----------  ARG2.評価系列コード
  9624     10  HYK-KRTU-CD              PIC  X(04).
  9625*----------  ARG2.帳票ID
  9626     10  REP-ID                   PIC  X(08).
  9627*----------  ARG2.帳票任意コード
  9628     10  REP-ANY-CD               PIC  X(50).
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 167
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/SCZY7210.cpy)R.cpy)y)
  9629*----------  ARG2.基準日FROM
  9630     10  KJN-YMD-FROM             PIC  9(08).
  9631*----------  ARG2.実行ステータス
  9632     10  JIKOU-STS                PIC  X(03).
  9633   05  PARM-SCZY7210-ARG3.
  9634*----------  ARG3.続行可能区分
  9635     10  CONTINUE-KBN             PIC  X(01).
  9636*----------  実行状況管理停止判断ルーチン
  9637 01  PARM-SCZY7220-INOUT.
* 9638     COPY  "SCZY7220.cpy".
  9639******************************************************************
  9640*
  9641*  システムＩＤ   : TSTAR
  9642*  システム名称   : 次期TSTARシステム
  9643*  コピー句ＩＤ   : SCZY7220.cpy
  9644*  コピー句名称   : 実行状況管理停止判断ルーチンのコピー句
  9645*
  9646*  改訂履歴
  9647*  年月日     所属       担当者  内容
  9648*  ---------- ---------- ------  ----------------------------
  9649*  20080625   SCS        王超    新規
  9650*
  9651******************************************************************
  9652   05  PARM-SCZY7220-ARG1.
  9653*---------- 利用会社コード
  9654     10  RIYO-CMP-CD              PIC  X(04).
  9655*---------- 処理実行日
  9656     10  SYORI-YMD                PIC  9(08).
  9657*---------- 起動ID
  9658     10  KIDOU-ID                 PIC  X(04).
  9659   05  PARM-SCZY7220-ARG2.
  9660*----------  続行可能区分
  9661     10  SOKO-KANO-KBN            PIC  X(01).
  9662*----------  RTNパッケージコピー句
  9663 01  PARM-RTNPKG.
  9664   05  PARM-RTNPKG-ARG.
* 9665     COPY  "CZRTNPACKAGE.cpy".
  9666******************************************************************
  9667*
  9668*  システムＩＤ   : T-STAR
  9669*  システム名称   : 新有価証券バックオフィスシステム
  9670*  コピー句ＩＤ   : CZRTNPACKAGE.cpy
  9671*  コピー句名称   : RTNパッケージコピー句
  9672*
  9673*  改訂履歴
  9674*  年月日     所属       担当者  内容
  9675*  ---------- ---------- ------  ----------------------------
  9676*  20060708   SCS                新規
  9677*
  9678******************************************************************
  9679
  9680*---------- カウンター
  9681         15  COUNTER                   PIC  9(02).
  9682*---------- RTNパッケージ詳細
  9683         15  RTN-PGM-DETAIL  OCCURS  10.
  9684*---------- エラー検知プログラム名
  9685           20  ERR-PGM-ID              PIC  X(16).
  9686*---------- ポジション
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 168
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/CZRTNPACKAGE.cpy)y)y)
  9687           20  ERR-POS                 PIC  X(04).
  9688*---------- リターンコード
  9689           20  RTN-CD                  PIC  X(03).
  9690*---------- 詳細リターンコード
  9691           20  DETAIL-RTN-CD           PIC  S9(09).
  9692*---------- 詳細リターンコードデコードフラグ
  9693           20  DETAIL-RTN-CD-FLG       PIC  X(01).
  9694*---------- フリーメッセージ
  9695           20  FREE-MSG                PIC  X(2000).
  9696*------------------ <残タスク129の対応 START>---------------------
  9697*----------  運用成果残高データHIGHVALUE変換
  9698 01  PARM-SUSC0057-INOUT.
* 9699     COPY  "SUSC0057.cpy".
  9700******************************************************************
  9701* $Header$
  9702******************************************************************
  9703*
  9704* システムＩＤ   : T-STAR
  9705* システム名称   : 次期TSTARシステム
  9706* コピー句ＩＤ   : SUSC0057.cpy
  9707* コピー句名称   : 運用成果残高データHIGHVALUE変換 用Copy句
  9708*
  9709* 改訂履歴
  9710* 年月日   区分 所属     担当    内容
  9711* -------- ---- -------- ------- -------------------------------
  9712* 20081204 新規 SCS      徐勝飛  新規作成
  9713******************************************************************
  9714 20  PARM-SUSC0057-ARG1.
  9715*----------  利用会社コード
  9716     25  I-RIYO-CMP-CD       PIC  X(04).
  9717*----------  ファンドコード
  9718     25  I-FUND-CD           PIC  X(12).
  9719*----------  ポートフォリオコード
  9720     25  I-PTF-CD            PIC  X(04).
  9721*----------  約定受渡区分
  9722     25  I-YJ-UW-KBN         PIC  X(01).
  9723*----------  残高日付
  9724     25  I-ZANTK-YMD         PIC  S9(08).
  9725*----------  決算日断面区分
  9726     25  I-KSN-YMD-DMN-KBN   PIC  X(01).
  9727*----------  評価系列コード
  9728     25  I-HYK-KRTU-CD       PIC  X(04).
  9729*----------  証券種別コード
  9730     25  I-SEC-SBT-CD        PIC  X(04).
  9731*----------  取消フラグ
  9732     25  I-DEL-KBN           PIC  X(01).
  9733*----------  確定フラグ
  9734     25  I-KT-KBN            PIC  X(01).
  9735*----------  取引通貨
  9736     25  I-TRHK-TUKA         PIC  X(04).
  9737*----------  為替取引決済通貨
  9738     25  I-KWS-TH-TUKA-CD    PIC  X(04).
  9739*----------  発行国コード
  9740     25  I-HAKO-CD           PIC  X(04).
  9741*----------  銘柄コード
  9742     25  I-MEG-CD            PIC  X(15).
  9743*----------  資産負債・買建売建フラグ
  9744     25  I-TATE-FLG          PIC  X(01).
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 169
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/SUSC0057.cpy)cpy)y)y)
  9745*----------  個別建玉約定日
  9746     25  I-TG-YKJ-YMD        PIC  S9(08).
  9747*----------  個別玉管理番号
  9748     25  I-KB-KANRI-ID       PIC  X(10).
  9749*----------  カストディコード
  9750     25  I-CAST-CD           PIC  X(04).
  9751*----------  保有数量
  9752     25  I-HOU-SURYO         PIC  S9(12)V9(06).
  9753*----------  数量単位
  9754     25  I-SURYO-TANI        PIC  S9(12)V9(06).
  9755*----------  取得金額(取引通貨)
  9756     25  I-THTK-ST-KNG       PIC  S9(15)V9(03).
  9757*----------  取得単価(取引通貨)
  9758     25  I-THTK-ST-TNK       PIC  S9(08)V9(10).
  9759*----------  時価(取引通貨)
  9760     25  I-CP-KRTU-CD        PIC  S9(08)V9(10).
  9761*----------  時価採用日付
  9762     25  I-CP-SAIYO-YMD      PIC  S9(08).
  9763*----------  時価採用市場
  9764     25  I-CP-SAIYO-SIJO     PIC  X(04).
  9765*----------  評価金額(取引通貨)
  9766     25  I-THTK-HYK-KN       PIC  S9(15)V9(03).
  9767*----------  評価損益(取引通貨)
  9768     25  I-THTK-HYK-SNEKI    PIC  S9(15)V9(03).
  9769*----------  前払金残(取引通貨)
  9770     25  I-THTK-PPAYZN       PIC  S9(15)V9(03).
  9771*----------  経過利息金額(取引通貨)
  9772     25  I-THTK-KEKA-RS         PIC  S9(12)V9(06).
  9773*----------  未収収益(取引通貨)
  9774     25  I-THTK-MS-EKI       PIC  S9(15)V9(03).
  9775*----------  評価為替レート
  9776     25  I-HYK-KWS           PIC  S9(08)V9(10).
  9777*----------  為替採用日付
  9778     25  I-KWS-SAIYO-YMD     PIC  S9(08).
  9779*----------  為替採用ソース
  9780     25  I-KWS-SAIYO-SOURCE  PIC  X(04).
  9781*----------  取得金額(運用通貨為替換算額)
  9782     25  I-UYTK-KWS-BOKAZN   PIC  S9(15)V9(03).
  9783*----------  取得金額(運用通貨)
  9784     25  I-SHTK-KN-LC        PIC  S9(15)V9(03).
  9785*----------  取得単価(運用通貨)
  9786     25  I-UYTK-ST-TNK       PIC  S9(08)V9(10).
  9787*----------  評価金額(運用通貨)
  9788     25  I-HYK-KN-LC         PIC  S9(15)V9(03).
  9789*----------  評価損益(運用通貨)
  9790     25  I-HYK-SNEKI-LC      PIC  S9(15)V9(03).
  9791*----------  前払金残(運用通貨)
  9792     25  I-UYTK-PPAY-ZN      PIC  S9(15)V9(03).
  9793*----------  経過利息(運用通貨)
  9794     25  I-UYTK-KEKA-RS       PIC  S9(12)V9(06).
  9795*----------  未収収益(運用通貨)
  9796     25  I-UYTK-MS-EKI       PIC  S9(15)V9(03).
  9797*----------  備考１
  9798     25  I-BIKOU1           PIC  X(20).
  9799*----------  備考２
  9800     25  I-BIKOU2           PIC  X(20).
  9801*----------  備考３
  9802     25  I-BIKOU3           PIC  X(12).
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 170
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/SUSC0057.cpy)cpy)y)y)
  9803*----------  備考４
  9804     25  I-BIKOU4           PIC  X(12).
  9805*----------  備考５
  9806     25  I-BIKOU5           PIC  S9(12)V9(06).
  9807*----------  備考６
  9808     25  I-BIKOU6           PIC  S9(12)V9(06).
  9809*----------  備考７
  9810     25  I-BIKOU7           PIC  S9(12)V9(06).
  9811*----------  備考８
  9812     25  I-BIKOU8           PIC  S9(08)V9(10).
  9813*----------  備考９
  9814     25  I-BIKOU9           PIC  S9(12)V9(06).
  9815*----------  投資対象国
  9816     25  I-TS-TARGET-KUNI    PIC  X(04).
  9817*----------  未払費用残(取引通貨)
  9818     25  I-SJTK-MBHY-ZN      PIC  S9(15)V9(03).
  9819*----------  未払費用残(運用通貨)
  9820     25  I-UYTK-MBHY-ZN      PIC  S9(15)V9(03).
  9821*----------  建玉為替レート
  9822     25  I-TGYOKU-KWS-RATE   PIC  S9(08)V9(10).
  9823*----------  建玉約定金額残(取引通貨)
  9824     25  I-THTK-TG-YJKN-ZN   PIC  S9(15)V9(03).
  9825*----------  建玉約定金額残(運用通貨)
  9826     25  I-UYTK-TG-YJKN-ZN   PIC  S9(15)V9(03).
  9827*----------  建玉手数料残(取引通貨)
  9828     25  I-THTK-TG-TSR-ZN    PIC  S9(15)V9(03).
  9829*----------  建玉手数料残(運用通貨)
  9830     25  I-UYTK-TG-TSR-ZN    PIC  S9(15)V9(03).
  9831*----------  建玉消費税残(取引通貨)
  9832     25  I-THTK-TG-S-TAX-ZN  PIC  S9(15)V9(03).
  9833*----------  建玉消費税残(運用通貨)
  9834     25  I-UYTK-TG-S-TAX-ZN  PIC  S9(15)V9(03).
  9835*----------  建玉その他費用残(取引通貨)
  9836     25  I-THTK-TG-ELS-HIYO-ZN
  9837                             PIC  S9(15)V9(03).
  9838*----------  建玉その他費用残(運用通貨)
  9839     25  I-UYTK-TG-ELS-HIYO-ZN
  9840                             PIC  S9(15)V9(03).
  9841*----------  建玉精算金額残(取引通貨)
  9842     25  I-THTK-TG-SSKG-ZN   PIC  S9(15)V9(03).
  9843*----------  建玉精算金額残(運用通貨)
  9844     25  I-UYTK-TG-SSKG-ZN   PIC  S9(15)V9(03).
  9845*----------  前受金残(取引通貨)
  9846     25  I-THTK-AREC-ZN      PIC  S9(15)V9(03).
  9847*----------  前受金残(運用通貨)
  9848     25  I-UYTK-AREC-ZN      PIC  S9(15)V9(03).
  9849*----------  仮払金残(取引通貨)
  9850     25  I-THTK-SPAY-ZN      PIC  S9(15)V9(03).
  9851*----------  仮払金残(運用通貨)
  9852     25  I-UYTK-SPAY-ZN      PIC  S9(15)V9(03).
  9853*----------  源泉税(取引通貨)
  9854     25  I-THTK-GSZ          PIC  S9(15)V9(03).
  9855*----------  源泉税(運用通貨)
  9856     25  I-GENSEN-TAX-LC     PIC  S9(15)V9(03).
  9857*----------  源泉税還付予定額残高(取引通貨)
  9858     25  I-THTK-GSZKP-YT-ZN  PIC  S9(15)V9(03).
  9859*----------  源泉税還付予定額残高(運用通貨)
  9860     25  I-UYTK-GSZKP-YT-ZN  PIC  S9(15)V9(03).
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 171
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/SUSC0057.cpy)cpy)y)y)
  9861*----------  簿価為替レート
  9862     25  I-BOKA-KWS          PIC  S9(08)V9(10).
  9863*----------  移管評価損益残(取引通貨)
  9864     25  I-THTK-IKAN-HYK-SEZN
  9865                             PIC  S9(15)V9(03).
  9866*----------  移管評価損益残(運用通貨)
  9867     25  I-UYTK-IKAN-HYK-SEZN
  9868                             PIC  S9(15)V9(03).
  9869*----------  移管未収収益(取引通貨)
  9870     25  I-SJTK-IKAN-MSSHEKI
  9871                             PIC  S9(15)V9(03).
  9872*----------  移管未収収益(運用通貨)
  9873     25  I-UYTK-IKAN-MSSHEKI
  9874                             PIC  S9(15)V9(03).
  9875*----------  移管前払金評価損益残(運用通貨)
  9876     25  I-UYTK-IKAN-PPHKZN
  9877                             PIC  S9(15)V9(03).
  9878*----------  ＯＰ資産負債・買建売建フラグ
  9879     25  I-OP-TATE-FLG       PIC  X(01).
  9880*----------  時価系列コード
  9881     25  I-JIKA-KRTU-CD      PIC  X(04).
  9882*----------  取得時遡及有無
  9883     25  I-SKYU-UMU-FLG      PIC  X(01).
  9884*----------  時価種類
  9885     25  I-JIKA-SHRU         PIC  X(04).
  9886*----------  ソース区分
  9887     25  I-SOURCE-KBN        PIC  X(02).
  9888*----------  前払金評価額(運用通貨)
  9889     25  I-UYTK-KPPAY-HYK-GK PIC  S9(15)V9(03).
  9890*----------  前払金評価損益(運用通貨)
  9891     25  I-UYTK-PPAY-SNEKI   PIC  S9(15)V9(03).
  9892*----------  未収収益評価為替レート
  9893     25  I-MS-SHEKI-HYK-KWS  PIC  S9(08)V9(10).
  9894*----------  源泉税評価為替レート
  9895     25  I-GENS-TAX-HYK-KWS  PIC  S9(08)V9(10).
  9896*----------  データ区分
  9897     25  I-DATA-KBN          PIC  X(01).
  9898*----------  商品区分
  9899     25  I-SYOHIN-KBN        PIC  X(02).
  9900*----------  帳票出力区分
  9901     25  I-REP-KBN           PIC  X(01).
  9902*----------  項目コード１
  9903     25  I-KODE-1            PIC  X(20).
  9904*----------  数値１１
  9905     25  I-SUJI-11           PIC  S9(15)V9(3).
  9906*----------  数値１２
  9907     25  I-SUJI-12           PIC  S9(15)V9(3).
  9908*----------  数値１３
  9909     25  I-SUJI-13           PIC  S9(15)V9(3).
  9910*----------  項目コード２
  9911     25  I-KODE-2            PIC  X(20).
  9912*----------  数値２１
  9913     25  I-SUJI-21           PIC  S9(15)V9(3).
  9914*----------  数値２２
  9915     25  I-SUJI-22           PIC  S9(15)V9(3).
  9916*----------  数値２３
  9917     25  I-SUJI-23           PIC  S9(15)V9(3).
  9918*----------  項目コード３
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 172
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/SUSC0057.cpy)cpy)y)y)
  9919     25  I-KODE-3            PIC  X(20).
  9920*----------  数値３１
  9921     25  I-SUJI-31           PIC  S9(15)V9(3).
  9922*----------  数値３２
  9923     25  I-SUJI-32           PIC  S9(15)V9(3).
  9924*----------  数値３３
  9925     25  I-SUJI-33           PIC  S9(15)V9(3).
  9926*----------  予備１
  9927     25  I-YOBI1             PIC  X(20).
  9928*----------  予備２
  9929     25  I-YOBI2             PIC  X(20).
  9930*----------  作成フラグ
  9931     25  I-SK-FLG            PIC  X(01).
  9932*----------  作成画面ＩＤ
  9933     25  I-SK-GAMEN          PIC  X(08).
  9934*----------  作成ファイル名
  9935     25  I-SK-FILE           PIC  X(20).
  9936*----------  作成日時
  9937     25  I-SK-DATE           PIC  X(14).
  9938*----------  作成ログインユーザ会社コード
  9939     25  I-SK-LOGIN-CMP-CD   PIC  X(04).
  9940*----------  作成ユーザＩＤ
  9941     25  I-SK-SID            PIC  X(20).
  9942*----------  作成プログラムＩＤ
  9943     25  I-SK-PGMID          PIC  X(16).
  9944*----------  更新フラグ
  9945     25  I-UPD-FLG           PIC  X(01).
  9946*----------  更新画面ＩＤ
  9947     25  I-UPD-GAMEN         PIC  X(08).
  9948*----------  更新ファイル名
  9949     25  I-UPD-FILE          PIC  X(20).
  9950*----------  更新日時
  9951     25  I-UPD-DATE          PIC  X(14).
  9952*----------  更新ログインユーザ会社コード
  9953     25  I-UPD-LOGIN-CMP-CD  PIC  X(04).
  9954*----------  更新ユーザＩＤ
  9955     25  I-UPD-SID           PIC  X(20).
  9956*----------  更新プログラムＩＤ
  9957     25  I-UPD-PGMID         PIC  X(16).
  9958 20  PARM-SUSC0057-ARG2.
  9959*----------  利用会社コード
  9960     25  O-RIYO-CMP-CD       PIC  X(04).
  9961*----------  ファンドコード
  9962     25  O-FUND-CD           PIC  X(12).
  9963*----------  ポートフォリオコード
  9964     25  O-PTF-CD            PIC  X(04).
  9965*----------  約定受渡区分
  9966     25  O-YJ-UW-KBN         PIC  X(01).
  9967*----------  残高日付
  9968     25  O-ZANTK-YMD         PIC  S9(08).
  9969*----------  決算日断面区分
  9970     25  O-KSN-YMD-DMN-KBN   PIC  X(01).
  9971*----------  評価系列コード
  9972     25  O-HYK-KRTU-CD       PIC  X(04).
  9973*----------  証券種別コード
  9974     25  O-SEC-SBT-CD        PIC  X(04).
  9975*----------  取消フラグ
  9976     25  O-DEL-KBN           PIC  X(01).
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 173
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/SUSC0057.cpy)cpy)y)y)
  9977*----------  確定フラグ
  9978     25  O-KT-KBN            PIC  X(01).
  9979*----------  取引通貨
  9980     25  O-TRHK-TUKA         PIC  X(04).
  9981*----------  為替取引決済通貨
  9982     25  O-KWS-TH-TUKA-CD    PIC  X(04).
  9983*----------  発行国コード
  9984     25  O-HAKO-CD           PIC  X(04).
  9985*----------  銘柄コード
  9986     25  O-MEG-CD            PIC  X(15).
  9987*----------  資産負債・買建売建フラグ
  9988     25  O-TATE-FLG          PIC  X(01).
  9989*----------  個別建玉約定日
  9990     25  O-TG-YKJ-YMD        PIC  S9(08).
  9991*----------  個別玉管理番号
  9992     25  O-KB-KANRI-ID       PIC  X(10).
  9993*----------  カストディコード
  9994     25  O-CAST-CD           PIC  X(04).
  9995*----------  保有数量
  9996     25  O-HOU-SURYO         PIC  S9(12)V9(06).
  9997*----------  数量単位
  9998     25  O-SURYO-TANI        PIC  S9(12)V9(06).
  9999*----------  取得金額(取引通貨)
 10000     25  O-THTK-ST-KNG       PIC  S9(15)V9(03).
 10001*----------  取得単価(取引通貨)
 10002     25  O-THTK-ST-TNK       PIC  S9(08)V9(10).
 10003*----------  時価(取引通貨)
 10004     25  O-CP-KRTU-CD        PIC  S9(08)V9(10).
 10005*----------  時価採用日付
 10006     25  O-CP-SAIYO-YMD      PIC  S9(08).
 10007*----------  時価採用市場
 10008     25  O-CP-SAIYO-SIJO     PIC  X(04).
 10009*----------  評価金額(取引通貨)
 10010     25  O-THTK-HYK-KN       PIC  S9(15)V9(03).
 10011*----------  評価損益(取引通貨)
 10012     25  O-THTK-HYK-SNEKI    PIC  S9(15)V9(03).
 10013*----------  前払金残(取引通貨)
 10014     25  O-THTK-PPAYZN       PIC  S9(15)V9(03).
 10015*----------  経過利息金額(取引通貨)
 10016     25  O-THTK-KEKA-RS         PIC  S9(12)V9(06).
 10017*----------  未収収益(取引通貨)
 10018     25  O-THTK-MS-EKI       PIC  S9(15)V9(03).
 10019*----------  評価為替レート
 10020     25  O-HYK-KWS           PIC  S9(08)V9(10).
 10021*----------  為替採用日付
 10022     25  O-KWS-SAIYO-YMD     PIC  S9(08).
 10023*----------  為替採用ソース
 10024     25  O-KWS-SAIYO-SOURCE  PIC  X(04).
 10025*----------  取得金額(運用通貨為替換算額)
 10026     25  O-UYTK-KWS-BOKAZN   PIC  S9(15)V9(03).
 10027*----------  取得金額(運用通貨)
 10028     25  O-SHTK-KN-LC        PIC  S9(15)V9(03).
 10029*----------  取得単価(運用通貨)
 10030     25  O-UYTK-ST-TNK       PIC  S9(08)V9(10).
 10031*----------  評価金額(運用通貨)
 10032     25  O-HYK-KN-LC         PIC  S9(15)V9(03).
 10033*----------  評価損益(運用通貨)
 10034     25  O-HYK-SNEKI-LC      PIC  S9(15)V9(03).
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 174
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/SUSC0057.cpy)cpy)y)y)
 10035*----------  前払金残(運用通貨)
 10036     25  O-UYTK-PPAY-ZN      PIC  S9(15)V9(03).
 10037*----------  経過利息(運用通貨)
 10038     25  O-UYTK-KEKA-RS       PIC  S9(12)V9(06).
 10039*----------  未収収益(運用通貨)
 10040     25  O-UYTK-MS-EKI       PIC  S9(15)V9(03).
 10041*----------  備考１
 10042     25  O-BIKOU1           PIC  X(20).
 10043*----------  備考２
 10044     25  O-BIKOU2           PIC  X(20).
 10045*----------  備考３
 10046     25  O-BIKOU3           PIC  X(12).
 10047*----------  備考４
 10048     25  O-BIKOU4           PIC  X(12).
 10049*----------  備考５
 10050     25  O-BIKOU5           PIC  S9(12)V9(06).
 10051*----------  備考６
 10052     25  O-BIKOU6           PIC  S9(12)V9(06).
 10053*----------  備考７
 10054     25  O-BIKOU7           PIC  S9(12)V9(06).
 10055*----------  備考８
 10056     25  O-BIKOU8           PIC  S9(08)V9(10).
 10057*----------  備考９
 10058     25  O-BIKOU9           PIC  S9(12)V9(06).
 10059*----------  投資対象国
 10060     25  O-TS-TARGET-KUNI    PIC  X(04).
 10061*----------  未払費用残(取引通貨)
 10062     25  O-SJTK-MBHY-ZN      PIC  S9(15)V9(03).
 10063*----------  未払費用残(運用通貨)
 10064     25  O-UYTK-MBHY-ZN      PIC  S9(15)V9(03).
 10065*----------  建玉為替レート
 10066     25  O-TGYOKU-KWS-RATE   PIC  S9(08)V9(10).
 10067*----------  建玉約定金額残(取引通貨)
 10068     25  O-THTK-TG-YJKN-ZN   PIC  S9(15)V9(03).
 10069*----------  建玉約定金額残(運用通貨)
 10070     25  O-UYTK-TG-YJKN-ZN   PIC  S9(15)V9(03).
 10071*----------  建玉手数料残(取引通貨)
 10072     25  O-THTK-TG-TSR-ZN    PIC  S9(15)V9(03).
 10073*----------  建玉手数料残(運用通貨)
 10074     25  O-UYTK-TG-TSR-ZN    PIC  S9(15)V9(03).
 10075*----------  建玉消費税残(取引通貨)
 10076     25  O-THTK-TG-S-TAX-ZN  PIC  S9(15)V9(03).
 10077*----------  建玉消費税残(運用通貨)
 10078     25  O-UYTK-TG-S-TAX-ZN  PIC  S9(15)V9(03).
 10079*----------  建玉その他費用残(取引通貨)
 10080     25  O-THTK-TG-ELS-HIYO-ZN
 10081                             PIC  S9(15)V9(03).
 10082*----------  建玉その他費用残(運用通貨)
 10083     25  O-UYTK-TG-ELS-HIYO-ZN
 10084                             PIC  S9(15)V9(03).
 10085*----------  建玉精算金額残(取引通貨)
 10086     25  O-THTK-TG-SSKG-ZN   PIC  S9(15)V9(03).
 10087*----------  建玉精算金額残(運用通貨)
 10088     25  O-UYTK-TG-SSKG-ZN   PIC  S9(15)V9(03).
 10089*----------  前受金残(取引通貨)
 10090     25  O-THTK-AREC-ZN      PIC  S9(15)V9(03).
 10091*----------  前受金残(運用通貨)
 10092     25  O-UYTK-AREC-ZN      PIC  S9(15)V9(03).
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 175
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/SUSC0057.cpy)cpy)y)y)
 10093*----------  仮払金残(取引通貨)
 10094     25  O-THTK-SPAY-ZN      PIC  S9(15)V9(03).
 10095*----------  仮払金残(運用通貨)
 10096     25  O-UYTK-SPAY-ZN      PIC  S9(15)V9(03).
 10097*----------  源泉税(取引通貨)
 10098     25  O-THTK-GSZ          PIC  S9(15)V9(03).
 10099*----------  源泉税(運用通貨)
 10100     25  O-GENSEN-TAX-LC     PIC  S9(15)V9(03).
 10101*----------  源泉税還付予定額残高(取引通貨)
 10102     25  O-THTK-GSZKP-YT-ZN  PIC  S9(15)V9(03).
 10103*----------  源泉税還付予定額残高(運用通貨)
 10104     25  O-UYTK-GSZKP-YT-ZN  PIC  S9(15)V9(03).
 10105*----------  簿価為替レート
 10106     25  O-BOKA-KWS          PIC  S9(08)V9(10).
 10107*----------  移管評価損益残(取引通貨)
 10108     25  O-THTK-IKAN-HYK-SEZN
 10109                             PIC  S9(15)V9(03).
 10110*----------  移管評価損益残(運用通貨)
 10111     25  O-UYTK-IKAN-HYK-SEZN
 10112                             PIC  S9(15)V9(03).
 10113*----------  移管未収収益(取引通貨)
 10114     25  O-SJTK-IKAN-MSSHEKI
 10115                             PIC  S9(15)V9(03).
 10116*----------  移管未収収益(運用通貨)
 10117     25  O-UYTK-IKAN-MSSHEKI
 10118                             PIC  S9(15)V9(03).
 10119*----------  移管前払金評価損益残(運用通貨)
 10120     25  O-UYTK-IKAN-PPHKZN
 10121                             PIC  S9(15)V9(03).
 10122*----------  ＯＰ資産負債・買建売建フラグ
 10123     25  O-OP-TATE-FLG       PIC  X(01).
 10124*----------  時価系列コード
 10125     25  O-JIKA-KRTU-CD      PIC  X(04).
 10126*----------  取得時遡及有無
 10127     25  O-SKYU-UMU-FLG      PIC  X(01).
 10128*----------  時価種類
 10129     25  O-JIKA-SHRU         PIC  X(04).
 10130*----------  ソース区分
 10131     25  O-SOURCE-KBN        PIC  X(02).
 10132*----------  前払金評価額(運用通貨)
 10133     25  O-UYTK-KPPAY-HYK-GK PIC  S9(15)V9(03).
 10134*----------  前払金評価損益(運用通貨)
 10135     25  O-UYTK-PPAY-SNEKI   PIC  S9(15)V9(03).
 10136*----------  未収収益評価為替レート
 10137     25  O-MS-SHEKI-HYK-KWS  PIC  S9(08)V9(10).
 10138*----------  源泉税評価為替レート
 10139     25  O-GENS-TAX-HYK-KWS  PIC  S9(08)V9(10).
 10140*----------  データ区分
 10141     25  O-DATA-KBN          PIC  X(01).
 10142*----------  商品区分
 10143     25  O-SYOHIN-KBN        PIC  X(02).
 10144*----------  帳票出力区分
 10145     25  O-REP-KBN           PIC  X(01).
 10146*----------  項目コード１
 10147     25  O-KODE-1            PIC  X(20).
 10148*----------  数値１１
 10149     25  O-SUJI-11           PIC  S9(15)V9(3).
 10150*----------  数値１２
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 176
* MUSR2651.cob (/eLIBSYS/T21/reference_space/ncc/make_inc/SUSC0057.cpy)cpy)y)y)
 10151     25  O-SUJI-12           PIC  S9(15)V9(3).
 10152*----------  数値１３
 10153     25  O-SUJI-13           PIC  S9(15)V9(3).
 10154*----------  項目コード２
 10155     25  O-KODE-2            PIC  X(20).
 10156*----------  数値２１
 10157     25  O-SUJI-21           PIC  S9(15)V9(3).
 10158*----------  数値２２
 10159     25  O-SUJI-22           PIC  S9(15)V9(3).
 10160*----------  数値２３
 10161     25  O-SUJI-23           PIC  S9(15)V9(3).
 10162*----------  項目コード３
 10163     25  O-KODE-3            PIC  X(20).
 10164*----------  数値３１
 10165     25  O-SUJI-31           PIC  S9(15)V9(3).
 10166*----------  数値３２
 10167     25  O-SUJI-32           PIC  S9(15)V9(3).
 10168*----------  数値３３
 10169     25  O-SUJI-33           PIC  S9(15)V9(3).
 10170*----------  予備１
 10171     25  O-YOBI1             PIC  X(20).
 10172*----------  予備２
 10173     25  O-YOBI2             PIC  X(20).
 10174*----------  作成フラグ
 10175     25  O-SK-FLG            PIC  X(01).
 10176*----------  作成画面ＩＤ
 10177     25  O-SK-GAMEN          PIC  X(08).
 10178*----------  作成ファイル名
 10179     25  O-SK-FILE           PIC  X(20).
 10180*----------  作成日時
 10181     25  O-SK-DATE           PIC  X(14).
 10182*----------  作成ログインユーザ会社コード
 10183     25  O-SK-LOGIN-CMP-CD   PIC  X(04).
 10184*----------  作成ユーザＩＤ
 10185     25  O-SK-SID            PIC  X(20).
 10186*----------  作成プログラムＩＤ
 10187     25  O-SK-PGMID          PIC  X(16).
 10188*----------  更新フラグ
 10189     25  O-UPD-FLG           PIC  X(01).
 10190*----------  更新画面ＩＤ
 10191     25  O-UPD-GAMEN         PIC  X(08).
 10192*----------  更新ファイル名
 10193     25  O-UPD-FILE          PIC  X(20).
 10194*----------  更新日時
 10195     25  O-UPD-DATE          PIC  X(14).
 10196*----------  更新ログインユーザ会社コード
 10197     25  O-UPD-LOGIN-CMP-CD  PIC  X(04).
 10198*----------  更新ユーザＩＤ
 10199     25  O-UPD-SID           PIC  X(20).
 10200*----------  更新プログラムＩＤ
 10201     25  O-UPD-PGMID         PIC  X(16).
 10202*------------------ <残タスク129の対応 END>-----------------------
 10203******************************************************************
 10204*        手 続 き 部
 10205******************************************************************
 10206 PROCEDURE              DIVISION.
 10207******************************************************************
 10208*    処理全体
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 177
* MUSR2651.cob                                                     cpy)cpy)y)y)
 10209******************************************************************
 10210 BASE-RTN               SECTION.
 10211*--------------------<DEBUG>--------------------------------------
 10212D    DISPLAY  CNS-PGM-ID  ":***  MUSR2651  START  ***"
 10213*-----------------------------------------------------------------
 10214     MOVE FUNCTION CURRENT-DATE(1:14) TO WK-RUN-SDATETIME
 10215*-------------------<DEBUG>---------------------------------------
 10216     DISPLAY "プログラムID:        ["CNS-PGM-ID"]"                GUT2013
 10217     DISPLAY "セクション:          [BASE-RTN]"                    GUT2013
 10218     DISPLAY "セクションの開始時間:["WK-RUN-SDATETIME"]"          GUT2013
 10219*-----------------------------------------------------------------
 10220*----------  前処理
 10221     PERFORM  INIT-RTN
 10222*----------  主処理
 10223     PERFORM  MAIN-RTN
 10224*--------------------<DEBUG>--------------------------------------
 10225D    DISPLAY  CNS-PGM-ID":WK-RTN-CODE          =["WK-RTN-CODE"]"
 10226*-----------------------------------------------------------------
 10227     IF  WK-RTN-CODE NOT = CNS-RTN-BT16
 10228     THEN
 10229*----------  後処理
 10230       PERFORM  END-RTN
 10231     ELSE
 10232*----------  エラー処理
 10233       PERFORM  ERR-RTN
 10234     END-IF
 10235*--------------------<DEBUG>--------------------------------------
 10236D    DISPLAY  CNS-PGM-ID  ":***  MUSR2651  END  ***"
 10237*-----------------------------------------------------------------
 10238     MOVE FUNCTION CURRENT-DATE(1:14) TO WK-RUN-EDATETIME
 10239*--------------------<DEBUG>--------------------------------------
 10240     DISPLAY "プログラムID:        ["CNS-PGM-ID"]"                GUT2013
 10241     DISPLAY "セクション:          [BASE-RTN]"                    GUT2013
 10242     DISPLAY "セクションの終了時間:["WK-RUN-EDATETIME"]"          GUT2013
 10243*-----------------------------------------------------------------
 10244     CONTINUE.
 10245 BASE-EXT.
 10246     EXIT.
 10247******************************************************************
 10248*    3.1.前処理
 10249******************************************************************
 10250 INIT-RTN               SECTION.
 10251*--------------------<DEBUG>--------------------------------------
 10252D    DISPLAY  CNS-PGM-ID":***  前処理  START  ***"
 10253*-----------------------------------------------------------------
 10254*----------  3.1.1.ワークエリアの初期化
 10255     PERFORM  INITIALIZE-RTN
 10256*----------  3.1.2.開始メッセージ出力
 10257     PERFORM  PUT-BIGN-MSG-RTN
 10258*----------  3.1.3.引数取得
 10259     PERFORM  EXEC-ARG-GET-RTN
 10260*----------  3.1.4.環境変数取得
 10261     PERFORM  ENV-STK-RTN
 10262*----------  3.1.5.ＤＢ接続情報取得
 10263     PERFORM  GET-DB-VAR-RTN
 10264*---------   3.1.6.オラクル接続
 10265     PERFORM  CONNECT-ORA-RTN
 10266*----------  3.1.7.システム日付取得
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 178
* MUSR2651.cob                                                     cpy)cpy)y)y)
 10267     PERFORM  SYS-DATE-RTN
 10268*----------  3.1.8.テーブルID取得
 10269     PERFORM  TBLID-GET-RTN
 10270*--------------------<DEBUG>--------------------------------------
 10271D    DISPLAY  CNS-PGM-ID":***  前処理  END  ***"
 10272*-----------------------------------------------------------------
 10273     CONTINUE.
 10274 INIT-EXT.
 10275     EXIT.
 10276******************************************************************
 10277*    3.1.1.ワークエリアの初期化
 10278******************************************************************
 10279 INITIALIZE-RTN         SECTION.
 10280*--------------------<DEBUG>--------------------------------------
 10281D    DISPLAY  CNS-PGM-ID":***  ワークエリアの初期化  START  ***"
 10282*-----------------------------------------------------------------
 10283*----------  ワークエリアの初期化
 10284     INITIALIZE     FLG-AREA
 10285                    SQL-AREA
 10286                    HST-AREA
 10287                    WK-DENBUN-AREA
 10288                    WORK-AREA
 10289                    PARM-SCZY3026-INOUT
 10290                    PARM-SCZY4116-INOUT
 10291                    PARM-SCZY3017-INOUT
 10292                    PARM-SCZY4007-INOUT
 10293                    PARM-SCZY4009-INOUT
 10294                    PARM-SCZY4012-INOUT
 10295                    PARM-SCZY1010-INOUT
 10296                    PARM-SCZY1020-INOUT
 10297                    PARM-SCZY1160-INOUT
 10298                    PARM-SCZY1170-IN
 10299                    PARM-SCZY1170-RTNPKG
 10300                    PARM-SUSC0405-INOUT
 10301                    PARM-SUSC0603-INOUT
 10302                    PARM-SUSC0604-INOUT
 10303                    PARM-SUSR2601-INOUT
 10304                    PARM-AIFA-HDR
 10305                    PARM-USER-ATTR-HDR
 10306                    PARM-SUSR2602-ARG-IN
 10307                    PARM-SUSR2602-ARG-OUT
 10308                    PARM-SCZY3002-INOUT
 10309                    PARM-SCZY3004-INOUT
 10310                    PARM-SCZY4002-INOUT
 10311                    PARM-SCZY4002-AIFA-HEADER
 10312                    PARM-SCZY4102-INOUT
 10313                    PARM-SCZY4182-INOUT
 10314                    PARM-SCZY4903-INOUT
 10315                    PARM-SCZY7010-IN
 10316                    PARM-SCZY7020-INOUT
 10317                    PARM-SCZY7040-IN
 10318                    PARM-SCZY7050-IN
 10319                    PARM-SCZY7060-INOUT
 10320                    PARM-SCZY7080-INOUT
 10321                    PARM-SCZY7090-INOUT
 10322                    PARM-SCZY7100-INOUT
 10323                    PARM-SCZY7180-INOUT
 10324                    PARM-SCZY7210-INOUT
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 179
* MUSR2651.cob                                                     cpy)cpy)y)y)
 10325                    PARM-SCZY7220-INOUT
 10326                    PARM-SCZY7200-INOUT
 10327                    PARM-SUSC0057-INOUT
 10328                    PARM-RTNPKG
 10329     MOVE  CNS-OFF           TO  WK-HYK-EX-FLG
 10330     MOVE  CNS-OFF           TO  WK-PRIO-1-FLG
 10331     MOVE  CNS-OFF           TO  WK-KWS-ZYOUHO-FLG
 10332     MOVE  CNS-OFF           TO  WK-BIKOU-FLG
 10333     MOVE  CNS-OFF           TO  WK-KUNI-FLG
 10334*******         テーマ3422              修正  開始        ********
 10335     MOVE  CNS-OFF           TO  WK-TH-ZYOUHO-FLG
 10336*******         テーマ3422              修正  終了        ********
 10337*--------------------<DEBUG>--------------------------------------
 10338D    DISPLAY  CNS-PGM-ID":***  ワークエリアの初期化  END  ***"
 10339*-----------------------------------------------------------------
 10340     CONTINUE.
 10341 INITIALIZE-EXT.
 10342     EXIT.
 10343******************************************************************
 10344*    3.1.2.開始メッセージ出力処理
 10345******************************************************************
 10346 PUT-BIGN-MSG-RTN       SECTION.
 10347*--------------------<DEBUG>--------------------------------------
 10348D    DISPLAY  CNS-PGM-ID":***  開始メッセージ出力処理  START  ***"
 10349*-----------------------------------------------------------------
 10350     INITIALIZE  PARM-SCZY7010-IN
 10351*----------  プログラムID
 10352     MOVE  CNS-PGM-ID
 10353       TO  PGM-ID                 OF  PARM-SCZY7010-ARG1
 10354*--------------------<DEBUG>--------------------------------------
 10355D    DISPLAY  CNS-PGM-ID":SCZY7010-ARG:"
 10356D    DISPLAY  CNS-PGM-ID":プログラムID=["
 10357D             PGM-ID              OF  PARM-SCZY7010-ARG1"]"
 10358D    DISPLAY  CNS-PGM-ID":***  CALL SCZY7010 START  ***"
 10359*-----------------------------------------------------------------
 10360     CALL  "SCZY7010"             USING  PARM-SCZY7010-IN
 10361*--------------------<DEBUG>--------------------------------------
 10362D    DISPLAY  CNS-PGM-ID":***  CALL SCZY7010 END  ***"
 10363D    DISPLAY  CNS-PGM-ID":***  開始メッセージ出力処理  END  ***"
 10364*-----------------------------------------------------------------
 10365     CONTINUE.
 10366 PUT-BIGN-MSG-EXT.
 10367     EXIT.
 10368******************************************************************
 10369*    3.1.3.引数取得
 10370******************************************************************
 10371 EXEC-ARG-GET-RTN       SECTION.
 10372*-------------------------DEBUG-----------------------------------
 10373D    DISPLAY  CNS-PGM-ID"*****   引数取得処理  START   *****"
 10374*-----------------------------------------------------------------
 10375     INITIALIZE               PARM-SCZY7090-INOUT
 10376                              PARM-RTNPKG
 10377*----------  引数NO（引数の何番目）
 10378     MOVE  CNS-4
 10379       TO  ARG-NUM                OF  PARM-SCZY7090-ARG1
 10380*-------------------------DEBUG-----------------------------------
 10381D    DISPLAY  CNS-PGM-ID":引数NO=["
 10382D             ARG-NUM             OF  PARM-SCZY7090-ARG1"]"
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 180
* MUSR2651.cob                                                     cpy)cpy)y)y)
 10383D    DISPLAY  CNS-PGM-ID  ":CALL SCZY7090 :バッチ引数取得ルーチン"
 10384*-----------------------------------------------------------------
 10385     CALL   "SCZY7090"            USING  PARM-SCZY7090-INOUT
 10386                                         PARM-RTNPKG
 10387*-------------------------DEBUG-----------------------------------
 10388D    DISPLAY  CNS-PGM-ID  ":RTN-CODE=["RTN-CD
 10389D        OF PARM-RTNPKG(COUNTER   OF  PARM-RTNPKG)"]"
 10390*-----------------------------------------------------------------
 10391     IF  RTN-CD OF PARM-RTNPKG(COUNTER   OF PARM-RTNPKG)
 10392      =  CNS-RTN-000
 10393     THEN
 10394*----------  ワーク利用会社コード
 10395       MOVE  ARG-STRING       OF  PARM-SCZY7090-ARG2(CNS-1)
 10396         TO  WK-RIYO-CMP-CD
 10397*----------  ワーク処理実行日
 10398       MOVE  ARG-STRING       OF  PARM-SCZY7090-ARG2(CNS-2)
 10399         TO  WK-SHORI-YMD
 10400*----------  ワーク業務タスクID
 10401       MOVE  ARG-STRING       OF  PARM-SCZY7090-ARG2(CNS-3)
 10402         TO  WK-GYOMU-TASK-ID OF  WK-ARGUMENT
 10403*----------  ワーク起動ＩＤ
 10404       MOVE  ARG-STRING       OF  PARM-SCZY7090-ARG2(CNS-4)
 10405         TO  WK-KIDOU-ID
 10406*-------------------------DEBUG-----------------------------------
 10407D    DISPLAY  CNS-PGM-ID
 10408D             ":*****   バッチ引数の取得正常   *****"
 10409D    DISPLAY  CNS-PGM-ID
 10410D             ":ワーク利用会社コード=["WK-RIYO-CMP-CD"]"
 10411D    DISPLAY  CNS-PGM-ID
 10412D             ":ワーク処理実行日    =["WK-SHORI-YMD"]"
 10413D    DISPLAY  CNS-PGM-ID
 10414D             ":ワーク業務タスクID  =["
 10415D             WK-GYOMU-TASK-ID     OF  WK-ARGUMENT"]"
 10416D    DISPLAY  CNS-PGM-ID
 10417D             ":ワーク起動ＩＤ      =["WK-KIDOU-ID"]"
 10418*-----------------------------------------------------------------
 10419     ELSE
 10420*--------------------<DEBUG>--------------------------------------
 10421D    DISPLAY  CNS-PGM-ID":バッチ引数取得 システムエラー"
 10422*-----------------------------------------------------------------
 10423*----------  ワークリターンコード
 10424       MOVE  CNS-RTN-BT16           TO  WK-RTN-CODE
 10425*----------  ワークエラーパッケージを編集
 10426       MOVE  PARM-RTNPKG            TO  PARM-SCZY1170-RTNPKG
 10427       INITIALIZE  WK-SYS-ERR-INFO
 10428*----------  エラー検知プログラムID
 10429       MOVE  CNS-PGM-ID             TO  WK-ERR-PGM-ID
 10430*----------  ポジション
 10431       MOVE  CNS-POS-001            TO  WK-ERR-POS
 10432*----------  リターンコード
 10433       MOVE  CNS-RTN-901            TO  WK-RTN-CD
 10434*----------  詳細リターンコード
 10435       MOVE  RTN-CD                 OF  PARM-RTNPKG
 10436                                        (COUNTER OF PARM-RTNPKG)
 10437                                    TO  WK-DETAIL-RTN-CD
 10438*----------  詳細リターンコードデコードフラグ
 10439       MOVE  CNS-DETAIL-0           TO  WK-DETAIL-RTN-CD-FLG
 10440*---------- フリーメッセージ
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 181
* MUSR2651.cob                                                     cpy)cpy)y)y)
 10441       MOVE  SPACE                  TO  WK-FREE-MSG
 10442*----------  エラー処理
 10443       PERFORM  ERR-RTN
 10444     END-IF
 10445*--------------------<DEBUG>--------------------------------------
 10446D    DISPLAY  CNS-PGM-ID":***  引数取得  END  ***"
 10447*-----------------------------------------------------------------
 10448     CONTINUE.
 10449 EXEC-ARG-GET-EXT.
 10450     EXIT.
 10451******************************************************************
 10452*    3.1.4.環境変数取得
 10453******************************************************************
 10454 ENV-STK-RTN            SECTION.
 10455*-------------------------DEBUG-----------------------------------
 10456D    DISPLAY  CNS-PGM-ID"*****   環境変数取得処理  START   *****"
 10457*-----------------------------------------------------------------
 10458*----------  環境変数からパスワードを取得する
 10459     INITIALIZE  PARM-SCZY4903-INOUT
 10460                 PARM-RTNPKG
 10461*----------  利用会社コード
 10462     MOVE  WK-RIYO-CMP-CD
 10463       TO  RIYO-CMP-CD            OF  PARM-SCZY4903-ARG1
 10464*----------  PATH区分
 10465     MOVE  CNS-PATH-05
 10466       TO  PATH-KBN               OF  PARM-SCZY4903-ARG1
 10467*--------------------<DEBUG>--------------------------------------
 10468D    DISPLAY  CNS-PGM-ID":SCZY4903-ARG:"
 10469D    DISPLAY  CNS-PGM-ID":RIYO-CMP-CD=["
 10470D             RIYO-CMP-CD         OF  PARM-SCZY4903-ARG1"]"
 10471D    DISPLAY  CNS-PGM-ID":PATH-KBN=["
 10472D             PATH-KBN            OF  PARM-SCZY4903-ARG1"]"
 10473D    DISPLAY  CNS-PGM-ID":***  CALL SCZY4903 START  ***"
 10474*-----------------------------------------------------------------
 10475     CALL  "SCZY4903"             USING  PARM-SCZY4903-INOUT
 10476                                         PARM-RTNPKG
 10477*--------------------<DEBUG>--------------------------------------
 10478D    DISPLAY  CNS-PGM-ID":***  CALL SCZY4903 END  ***"
 10479D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY4903)=["
 10480D             RTN-CD  OF  PARM-RTNPKG(COUNTER OF PARM-RTNPKG)"]"
 10481D    DISPLAY  CNS-PGM-ID":COUNTER OF PARM-RTNPKG=["
 10482D             COUNTER             OF PARM-RTNPKG"]"
 10483D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG=[" PARM-RTNPKG"]"
 10484*-----------------------------------------------------------------
 10485     EVALUATE  RTN-CD  OF  PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
 10486*----------  正常
 10487       WHEN  CNS-RTN-000
 10488*--------------------<DEBUG>--------------------------------------
 10489D    DISPLAY  CNS-PGM-ID":環境変数取得 正常"
 10490*-----------------------------------------------------------------
 10491         MOVE  RTN-PATH           OF  PARM-SCZY4903-ARG2
 10492           TO  WK-FILE-PASS
 10493*----------  取得できない場合
 10494       WHEN  OTHER
 10495*--------------------<DEBUG>--------------------------------------
 10496D    DISPLAY  CNS-PGM-ID":環境変数取得 取得できない"
 10497*-----------------------------------------------------------------
 10498*----------  ワークエラーパッケージを編集
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 182
* MUSR2651.cob                                                     cpy)cpy)y)y)
 10499         MOVE  PARM-RTNPKG        TO  PARM-SCZY1170-RTNPKG
 10500*----------  ワークリターンコード
 10501         MOVE  CNS-RTN-BT16       TO  WK-RTN-CODE
 10502*----------  ワークエラーパッケージを編集
 10503         INITIALIZE  WK-SYS-ERR-INFO
 10504*----------  エラー検知プログラムID
 10505         MOVE  CNS-PGM-ID         TO  WK-ERR-PGM-ID
 10506*----------  ポジション
 10507         MOVE  CNS-POS-002        TO  WK-ERR-POS
 10508*----------  リターンコード
 10509         MOVE  CNS-RTN-901        TO  WK-RTN-CD
 10510*----------  詳細リターンコード
 10511         MOVE  RTN-CD             OF  PARM-RTNPKG
 10512                                      (COUNTER OF PARM-RTNPKG)
 10513                                  TO  WK-DETAIL-RTN-CD
 10514*----------  詳細リターンコードデコードフラグ
 10515         MOVE  CNS-DETAIL-0       TO  WK-DETAIL-RTN-CD-FLG
 10516*---------- フリーメッセージ
 10517         MOVE  SPACE              TO  WK-FREE-MSG
 10518*----------  エラー処理
 10519         PERFORM  ERR-RTN
 10520     END-EVALUATE
 10521*--------------------<DEBUG>--------------------------------------
 10522D    DISPLAY  CNS-PGM-ID":WK-FILE-PASS=["WK-FILE-PASS"]"
 10523D    DISPLAY  CNS-PGM-ID":***  環境変数取得  END  ***"
 10524*-----------------------------------------------------------------
 10525     CONTINUE.
 10526 ENV-STK-EXT.
 10527     EXIT.
 10528******************************************************************
 10529*    3.1.5.バッチＤＢ接続情報取得
 10530******************************************************************
 10531 GET-DB-VAR-RTN         SECTION.
 10532*--------------------<DEBUG>--------------------------------------
 10533D    DISPLAY  CNS-PGM-ID":***  ＤＢ接続情報取得  START  ***"
 10534*-----------------------------------------------------------------
 10535     INITIALIZE  PARM-SCZY7100-INOUT
 10536                 PARM-RTNPKG
 10537*----------  利用会社コード
 10538     MOVE  WK-RIYO-CMP-CD
 10539       TO  RIYO-CMP-CD            OF  PARM-SCZY7100-ARG1
 10540*--------------------<DEBUG>--------------------------------------
 10541D    DISPLAY  CNS-PGM-ID":SCZY7100-ARG:"
 10542D    DISPLAY  CNS-PGM-ID":利用会社コード         =["
 10543D             RIYO-CMP-CD         OF  PARM-SCZY7100-ARG1 "]"
 10544D    DISPLAY  CNS-PGM-ID":***  CALL SCZY7100 START  ***"
 10545*-----------------------------------------------------------------
 10546     CALL  "SCZY7100"             USING  PARM-SCZY7100-INOUT
 10547                                         PARM-RTNPKG
 10548*--------------------<DEBUG>--------------------------------------
 10549D    DISPLAY  CNS-PGM-ID":***  CALL SCZY7100 END  ***"
 10550D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY7100)       =["
 10551D             RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)"]"
 10552D    DISPLAY  CNS-PGM-ID":COUNTER OF PARM-RTNPKG =["
 10553D             COUNTER             OF PARM-RTNPKG "]"
 10554*-----------------------------------------------------------------
 10555     IF  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
 10556      =  CNS-RTN-000
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 183
* MUSR2651.cob                                                     cpy)cpy)y)y)
 10557     THEN
 10558*----------  DB接続情報
 10559       MOVE  DB-SETUZOKU-JYOUHOU  OF PARM-SCZY7100-ARG2
 10560         TO  H-ORA-USER
 10561*--------------------<DEBUG>--------------------------------------
 10562D    DISPLAY  CNS-PGM-ID":ＤＢ接続情報取得 正常"
 10563D    DISPLAY  CNS-PGM-ID":H-ORA-USER         =["H-ORA-USER"]"
 10564*-----------------------------------------------------------------
 10565     ELSE
 10566*--------------------<DEBUG>--------------------------------------
 10567D    DISPLAY  CNS-PGM-ID":ＤＢ接続情報取得 システムエラー"
 10568*-----------------------------------------------------------------
 10569*----------  ワークリターンコード
 10570       MOVE  CNS-RTN-BT16         TO  WK-RTN-CODE
 10571*----------  ワークエラーパッケージを編集
 10572       MOVE  PARM-RTNPKG          TO  PARM-SCZY1170-RTNPKG
 10573       INITIALIZE  WK-SYS-ERR-INFO
 10574*----------  エラー検知プログラムID
 10575       MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
 10576*----------  ポジション
 10577       MOVE  CNS-POS-003          TO  WK-ERR-POS
 10578*----------  リターンコード
 10579       MOVE  CNS-RTN-901          TO  WK-RTN-CD
 10580*----------  詳細リターンコード
 10581       MOVE  RTN-CD               OF  PARM-RTNPKG
 10582                                      (COUNTER OF PARM-RTNPKG)
 10583                                  TO  WK-DETAIL-RTN-CD
 10584*----------  詳細リターンコードデコードフラグ
 10585       MOVE  CNS-DETAIL-0         TO  WK-DETAIL-RTN-CD-FLG
 10586*---------- フリーメッセージ
 10587       MOVE  SPACE                TO  WK-FREE-MSG
 10588*----------  エラー処理
 10589       PERFORM  ERR-RTN
 10590     END-IF
 10591*--------------------<DEBUG>--------------------------------------
 10592D    DISPLAY  CNS-PGM-ID":***   ＤＢ接続情報取得  END  ***"
 10593*-----------------------------------------------------------------
 10594     CONTINUE.
 10595 GET-DB-VAR-EXT.
 10596     EXIT.
 10597******************************************************************
 10598*    3.1.6.ORACLE接続
 10599******************************************************************
 10600 CONNECT-ORA-RTN        SECTION.
 10601*-------------------------DEBUG-----------------------------------
 10602D    DISPLAY  CNS-PGM-ID":*****   ORACLE接続  START   *****"
 10603*-----------------------------------------------------------------
 10604*----------  ORACLE接続
 10605*    EXEC SQL
 10606*      CONNECT :H-ORA-USER
 10607*    END-EXEC
 10608     MOVE 10 TO SQL-ITERS
 10609     MOVE 5 TO SQL-OFFSET
 10610     MOVE 0 TO SQL-OCCURS
 10611     CALL "SQLADR" USING
 10612         SQLCUD
 10613         SQL-CUD
 10614     CALL "SQLADR" USING
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 184
* MUSR2651.cob                                                     cpy)cpy)y)y)
 10615         SQLCA
 10616         SQL-SQLEST
 10617     MOVE 256 TO SQL-SQLETY
 10618     CALL "SQLADR" USING
 10619         H-ORA-USER IN
 10620         HST-AREA
 10621         SQL-SQHSTV(1)
 10622     MOVE 80 TO SQL-SQHSTL(1)
 10623     MOVE 0 TO SQL-SQHSTS(1)
 10624     MOVE 0 TO SQL-SQINDV(1)
 10625     MOVE 0 TO SQL-SQINDS(1)
 10626     MOVE 0 TO SQL-SQHARM(1)
 10627     CALL "SQLADR" USING
 10628         SQL-SQHSTV(1)
 10629         SQL-SQPHSV
 10630     CALL "SQLADR" USING
 10631         SQL-SQHSTL(1)
 10632         SQL-SQPHSL
 10633     CALL "SQLADR" USING
 10634         SQL-SQHSTS(1)
 10635         SQL-SQPHSS
 10636     CALL "SQLADR" USING
 10637         SQL-SQINDV(1)
 10638         SQL-SQPIND
 10639     CALL "SQLADR" USING
 10640         SQL-SQINDS(1)
 10641         SQL-SQPINS
 10642     CALL "SQLADR" USING
 10643         SQL-SQHARM(1)
 10644         SQL-SQPARM
 10645     CALL "SQLADR" USING
 10646         SQL-SQHARC(1)
 10647         SQL-SQPARC
 10648
 10649     CALL "SQLBEX" USING
 10650         SQLCTX
 10651         SQLEXD
 10652         SQLFPN
 10653     EVALUATE  SQLCODE
 10654*----------  SQLCODE=「0：正常終了」 の場合
 10655       WHEN  CNS-SQL-NORMAL
 10656*----------  ORACLE接続フラグON(接続成功)
 10657         MOVE  CNS-ON             TO  FLG-ORA-CONNECT
 10658*-------------------------DEBUG-----------------------------------
 10659D    DISPLAY  CNS-PGM-ID":ORACLE接続成功 :SQLCODE=["SQLCODE"]"
 10660D    DISPLAY  CNS-PGM-ID":FLG-ORA-CONNECT=["FLG-ORA-CONNECT"]"
 10661*-----------------------------------------------------------------
 10662*----------  SQLCODE≠「0：正常終了」 の場合
 10663       WHEN  OTHER
 10664*-------------------------DEBUG-----------------------------------
 10665D    DISPLAY  CNS-PGM-ID":ORACLE接続エラー:SQLCODE=["SQLCODE"]"
 10666*-----------------------------------------------------------------
 10667*----------  ワークリターンコード
 10668         MOVE  CNS-RTN-BT16      TO  WK-RTN-CODE
 10669*----------  ワークエラーパッケージを編集
 10670         INITIALIZE  WK-SYS-ERR-INFO
 10671*----------  エラー検知プログラムID
 10672         MOVE  CNS-PGM-ID        TO  WK-ERR-PGM-ID
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 185
* MUSR2651.cob                                                     cpy)cpy)y)y)
 10673*----------  ポジション
 10674         MOVE  CNS-POS-004       TO  WK-ERR-POS
 10675*----------  リターンコード
 10676         MOVE  CNS-RTN-900       TO  WK-RTN-CD
 10677*----------  詳細リターンコード
 10678         MOVE  SQLCODE           TO  WK-DETAIL-RTN-CD
 10679*----------  詳細リターンコードデコードフラグ
 10680         MOVE  CNS-DETAIL-1      TO  WK-DETAIL-RTN-CD-FLG
 10681*---------- フリーメッセージ
 10682         MOVE  CNS-CONNECT-ERR   TO  WK-FREE-MSG
 10683*----------  エラー処理
 10684         PERFORM  ERR-RTN
 10685     END-EVALUATE
 10686*-------------------------DEBUG-----------------------------------
 10687D    DISPLAY  CNS-PGM-ID"*****   ORACLE接続  END   *****"
 10688*-----------------------------------------------------------------
 10689     CONTINUE.
 10690 CONNECT-ORA-EXT.
 10691     EXIT.
 10692******************************************************************
 10693*    3.1.7.システム日付取得
 10694******************************************************************
 10695 SYS-DATE-RTN           SECTION.
 10696*--------------------<DEBUG>--------------------------------------
 10697D    DISPLAY  CNS-PGM-ID":***  システム日付取得  START  ***"
 10698*-----------------------------------------------------------------
 10699     INITIALIZE  PARM-SCZY1010-INOUT
 10700                 PARM-RTNPKG
 10701*----------  OL/BT区分
 10702     MOVE  CNS-BT
 10703       TO  DATE-KBN               OF  PARM-SCZY1010-ARG1
 10704*----------  時刻形式区分
 10705     MOVE  CNS-TIME-FORM-KBN-1
 10706       TO  TIME-FORM-KBN          OF  PARM-SCZY1010-ARG1
 10707*----------  利用会社コード
 10708     MOVE  WK-RIYO-CMP-CD
 10709       TO  RIYO-CMP-CD            OF  PARM-SCZY1010-ARG1
 10710*--------------------<DEBUG>--------------------------------------
 10711D    DISPLAY  CNS-PGM-ID":SCZY1010-ARG:"
 10712D    DISPLAY  CNS-PGM-ID":利用会社コード         =["
 10713D             RIYO-CMP-CD         OF  PARM-SCZY1010-ARG1 "]"
 10714D    DISPLAY  CNS-PGM-ID":OL/BT区分              =["
 10715D             DATE-KBN            OF  PARM-SCZY1010-ARG1 "]"
 10716D    DISPLAY  CNS-PGM-ID":時刻形式区分           =["
 10717D             TIME-FORM-KBN       OF  PARM-SCZY1010-ARG1 "]"
 10718D    DISPLAY  CNS-PGM-ID":***  CALL SCZY1010 START  ***"
 10719*-----------------------------------------------------------------
 10720     CALL  "SCZY1010"             USING  PARM-SCZY1010-INOUT
 10721                                         PARM-RTNPKG
 10722*--------------------<DEBUG>--------------------------------------
 10723D    DISPLAY  CNS-PGM-ID":***  CALL SCZY1010 END  ***"
 10724D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY1010)       =["
 10725D             RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)"]"
 10726D    DISPLAY  CNS-PGM-ID":COUNTER OF PARM-RTNPKG =["
 10727D             COUNTER             OF PARM-RTNPKG "]"
 10728*-----------------------------------------------------------------
 10729     IF  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
 10730      =  CNS-RTN-000
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 186
* MUSR2651.cob                                                     cpy)cpy)y)y)
 10731     THEN
 10732       MOVE  MAC-DATE-TIME        OF PARM-SCZY1010-ARG2
 10733         TO  WK-MAC-DATE-TIME
 10734*--------------------<DEBUG>--------------------------------------
 10735D    DISPLAY  CNS-PGM-ID":システム日付取得 正常"
 10736D    DISPLAY  CNS-PGM-ID":マシン日付時刻=["WK-MAC-DATE-TIME"]"
 10737*-----------------------------------------------------------------
 10738     ELSE
 10739*--------------------<DEBUG>--------------------------------------
 10740D    DISPLAY  CNS-PGM-ID":システム日付取得 システムエラー"
 10741*-----------------------------------------------------------------
 10742*----------  ワークリターンコード
 10743       MOVE  CNS-RTN-BT16         TO  WK-RTN-CODE
 10744*----------  ワークエラーパッケージを編集
 10745       MOVE  PARM-RTNPKG          TO  PARM-SCZY1170-RTNPKG
 10746       INITIALIZE  WK-SYS-ERR-INFO
 10747*----------  エラー検知プログラムID
 10748       MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
 10749*----------  ポジション
 10750       MOVE  CNS-POS-005          TO  WK-ERR-POS
 10751*----------  リターンコード
 10752       MOVE  CNS-RTN-901          TO  WK-RTN-CD
 10753*----------  詳細リターンコード
 10754       MOVE  RTN-CD               OF  PARM-RTNPKG
 10755                                      (COUNTER OF PARM-RTNPKG)
 10756                                  TO  WK-DETAIL-RTN-CD
 10757*----------  詳細リターンコードデコードフラグ
 10758       MOVE  CNS-DETAIL-0         TO  WK-DETAIL-RTN-CD-FLG
 10759*---------- フリーメッセージ
 10760       MOVE  SPACE                TO  WK-FREE-MSG
 10761*----------  エラー処理
 10762       PERFORM  ERR-RTN
 10763     END-IF
 10764*--------------------<DEBUG>--------------------------------------
 10765D    DISPLAY  CNS-PGM-ID":***  システム日付取得  END  ***"
 10766*-----------------------------------------------------------------
 10767     CONTINUE.
 10768 SYS-DATE-EXT.
 10769     EXIT.
 10770******************************************************************
 10771*    3.1.8.テーブルID取得
 10772******************************************************************
 10773 TBLID-GET-RTN          SECTION.
 10774*--------------------<DEBUG>--------------------------------------
 10775D    DISPLAY  CNS-PGM-ID":***  テーブルID取得  START  ***"
 10776*-----------------------------------------------------------------
 10777     INITIALIZE  PARM-SCZY1160-INOUT
 10778                 PARM-RTNPKG
 10779*----------  利用会社コード
 10780     MOVE  WK-RIYO-CMP-CD
 10781       TO  RIYO-CMP-CD            OF  PARM-SCZY1160-ARG1
 10782*----------  テーブルID(1)
 10783     MOVE  CNS-TBL-TKUSZT01
 10784       TO  TBL-ID                 OF  PARM-SCZY1160-ARG1(1)
 10785*----------  テーブルID(2)
 10786     MOVE  CNS-TBL-TKDYAA40
 10787       TO  TBL-ID                 OF  PARM-SCZY1160-ARG1(2)
 10788*******         テーマ2693     20100404 修正  開始        ********
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 187
* MUSR2651.cob                                                     cpy)cpy)y)y)
 10789*----------  テーブルID(3)
 10790     MOVE  CNS-TBL-TKPFZK04
 10791       TO  TBL-ID                 OF  PARM-SCZY1160-ARG1(3)
 10792*******         テーマ2693     20100404 修正  終了        ********
 10793*--------------------<DEBUG>--------------------------------------
 10794D    DISPLAY  CNS-PGM-ID":SCZY1160-ARG:"
 10795D    DISPLAY  CNS-PGM-ID":利用会社コード  =["
 10796D             RIYO-CMP-CD         OF  PARM-SCZY1160-ARG1   "]"
 10797D    DISPLAY  CNS-PGM-ID":テーブルID(1)   =["
 10798D             TBL-ID              OF  PARM-SCZY1160-ARG1(1)"]"
 10799D    DISPLAY  CNS-PGM-ID":テーブルID(2)   =["
 10800D             TBL-ID              OF  PARM-SCZY1160-ARG1(2)"]"
 10801*******         テーマ2693     20100404 修正  開始        ********
 10802D    DISPLAY  CNS-PGM-ID":テーブルID(3)   =["
 10803D             TBL-ID              OF  PARM-SCZY1160-ARG1(3)"]"
 10804*******         テーマ2693     20100404 修正  終了        ********
 10805D    DISPLAY  CNS-PGM-ID":***  CALL SCZY1160 START  ***"
 10806*-----------------------------------------------------------------
 10807     CALL  "SCZY1160"             USING  PARM-SCZY1160-INOUT
 10808                                         PARM-RTNPKG
 10809*--------------------<DEBUG>--------------------------------------
 10810D    DISPLAY  CNS-PGM-ID":***  CALL SCZY1160 END  ***"
 10811D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY1160)       =["
 10812D             RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)"]"
 10813D    DISPLAY  CNS-PGM-ID":COUNTER OF PARM-RTNPKG =["
 10814D             COUNTER             OF PARM-RTNPKG "]"
 10815*-----------------------------------------------------------------
 10816     IF  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
 10817      =  CNS-RTN-000
 10818     THEN
 10819*--------------------<DEBUG>--------------------------------------
 10820D    DISPLAY  CNS-PGM-ID":テーブルID取得 正常"
 10821*-----------------------------------------------------------------
 10822*----------  ワークテーブルID1
 10823       MOVE  HENSYUGO-TBL-ID      OF  PARM-SCZY1160-ARG2(1)
 10824         TO  WK-TBL-TKUSZT01
 10825*----------  ワークテーブルID2
 10826       MOVE  HENSYUGO-TBL-ID      OF  PARM-SCZY1160-ARG2(2)
 10827         TO  WK-TBL-TKDYAA40
 10828*******         テーマ2693     20100404 修正  開始        ********
 10829*----------  ワークテーブルID3
 10830       MOVE  HENSYUGO-TBL-ID      OF  PARM-SCZY1160-ARG2(3)
 10831         TO  WK-TBL-TKPFZK04
 10832*******         テーマ2693     20100404 修正  終了        ********
 10833     ELSE
 10834*--------------------<DEBUG>--------------------------------------
 10835D    DISPLAY  CNS-PGM-ID":テーブルID取得 システムエラー"
 10836*-----------------------------------------------------------------
 10837*----------  ワークリターンコード
 10838       MOVE  CNS-RTN-BT16         TO  WK-RTN-CODE
 10839*----------  ワークエラーパッケージを編集
 10840       MOVE  PARM-RTNPKG          TO  PARM-SCZY1170-RTNPKG
 10841       INITIALIZE  WK-SYS-ERR-INFO
 10842*----------  エラー検知プログラムID
 10843       MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
 10844*----------  ポジション
 10845       MOVE  CNS-POS-006          TO  WK-ERR-POS
 10846*----------  リターンコード
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 188
* MUSR2651.cob                                                     cpy)cpy)y)y)
 10847       MOVE  CNS-RTN-901          TO  WK-RTN-CD
 10848*----------  詳細リターンコード
 10849       MOVE  RTN-CD               OF  PARM-RTNPKG
 10850                                      (COUNTER OF PARM-RTNPKG)
 10851                                  TO  WK-DETAIL-RTN-CD
 10852*----------  詳細リターンコードデコードフラグ
 10853       MOVE  CNS-DETAIL-0         TO  WK-DETAIL-RTN-CD-FLG
 10854*---------- フリーメッセージ
 10855       MOVE  SPACE                TO  WK-FREE-MSG
 10856*----------  エラー処理
 10857       PERFORM  ERR-RTN
 10858     END-IF
 10859*--------------------<DEBUG>--------------------------------------
 10860D    DISPLAY  CNS-PGM-ID":SCZY1160取得テーブルID:"
 10861D    DISPLAY  CNS-PGM-ID":WK-TBL-TKUSZT01=["WK-TBL-TKUSZT01"]"
 10862*******         テーマ2693     20100404 修正  開始        ********
 10863D    DISPLAY  CNS-PGM-ID":WK-TBL-TKPFZK04=["WK-TBL-TKPFZK04"]"
 10864*******         テーマ2693     20100404 修正  終了        ********
 10865D    DISPLAY  CNS-PGM-ID":WK-TBL-TKDYAA40=["WK-TBL-TKDYAA40"]"
 10866D    DISPLAY  CNS-PGM-ID":***  テーブルID取得  END  ***"
 10867*-----------------------------------------------------------------
 10868     CONTINUE.
 10869 TBLID-GET-EXT.
 10870     EXIT.
 10871******************************************************************
 10872*    3.1.9.ファイル名作成処理
 10873******************************************************************
 10874 GET-FILE-NAME-RTN      SECTION.
 10875*--------------------<DEBUG>--------------------------------------
 10876D    DISPLAY  CNS-PGM-ID":ファイル名作成処理  START "
 10877*-----------------------------------------------------------------
 10878     STRING  CNS-RX-TEXT               DELIMITED BY SPACE
 10879             WK-RIYO-CMP-CD            DELIMITED BY SPACE
 10880             "_"                       DELIMITED BY SPACE
 10881             WK-SHORI-YMD              DELIMITED BY SPACE
 10882             "_"                       DELIMITED BY SPACE
 10883             WK-KIDOU-ID               DELIMITED BY SPACE
 10884             "_"                       DELIMITED BY SPACE
 10885             WK-GYOMU-TASK-ID          DELIMITED BY SPACE
 10886             "_01"                     DELIMITED BY SPACE
 10887                                       INTO  WK-FILE-NAME
 10888     END-STRING
 10889     STRING  WK-FILE-PASS              DELIMITED BY SPACE
 10890             "/"                       DELIMITED BY SPACE
 10891             WK-FILE-NAME              DELIMITED BY SPACE
 10892                                     INTO  WK-PSACT-DAT-FILE
 10893     END-STRING
 10894*--------------------<DEBUG>--------------------------------------
 10895D    DISPLAY  CNS-PGM-ID":W.ファイル名    =["WK-FILE-NAME"]"
 10896D    DISPLAY  CNS-PGM-ID":ファイルパス    =["WK-FILE-PASS"]"
 10897D    DISPLAY  CNS-PGM-ID":パス付けDATファイル=["
 10898D             WK-PSACT-DAT-FILE"]"
 10899D    DISPLAY  CNS-PGM-ID": ファイル名作成処理  END  *****"
 10900*-----------------------------------------------------------------
 10901     CONTINUE.
 10902 GET-FILE-NAME-EXT.
 10903     EXIT.
 10904******************************************************************
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 189
* MUSR2651.cob                                                     cpy)cpy)y)y)
 10905*    3.1.10.ファイルオープン
 10906******************************************************************
 10907 OPEN-FILE-RTN          SECTION.
 10908     MOVE FUNCTION CURRENT-DATE(1:14) TO WK-RUN-SDATETIME
 10909*-------------------<DEBUG>---------------------------------------
 10910     DISPLAY "プログラムID:        ["CNS-PGM-ID"]"                GUT2013
 10911     DISPLAY "セクション:          [OPEN-FILE-RTN]"               GUT2013
 10912     DISPLAY "セクションの開始時間:["WK-RUN-SDATETIME"]"          GUT2013
 10913*-----------------------------------------------------------------
 10914*--------------------<DEBUG>--------------------------------------
 10915D    DISPLAY   CNS-PGM-ID":ファイルオープン処理  START "
 10916*-----------------------------------------------------------------
 10917     MOVE  CNS-OFF                TO  FLG-FILE-OPEN
 10918     MOVE  WK-PSACT-DAT-FILE      TO  OUTFILE
 10919     OPEN  OUTPUT OUT-FILE
 10920*-------------------<DEBUG>---------------------------------------
 10921D    DISPLAY  CNS-PGM-ID":FILE-STATUS=[" WK-FILE-STATUS "]"
 10922*-----------------------------------------------------------------
 10923     EVALUATE  WK-FILE-STATUS
 10924       WHEN  CNS-FILE-NORMAL
 10925         MOVE  CNS-ON                  TO  FLG-FILE-OPEN
 10926*--------------------<DEBUG>--------------------------------------
 10927D    DISPLAY  CNS-PGM-ID":DATファイルオープン正常"
 10928*-----------------------------------------------------------------
 10929       WHEN  OTHER
 10930*--------------------<DEBUG>--------------------------------------
 10931D    DISPLAY  CNS-PGM-ID":DATファイルオープンエラー"
 10932*-----------------------------------------------------------------
 10933*----------  メッセージ出力用 RTNパッケージの設定
 10934*----------  ワークリターンコード
 10935       MOVE  CNS-RTN-BT16         TO  WK-RTN-CODE
 10936*----------  ワークエラーパッケージを編集
 10937       INITIALIZE  WK-SYS-ERR-INFO
 10938*----------  エラー検知プログラムID
 10939       MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
 10940*----------  ポジション
 10941       MOVE  CNS-POS-007          TO  WK-ERR-POS
 10942*----------  リターンコード
 10943       MOVE  CNS-RTN-200          TO  WK-RTN-CD
 10944*----------  詳細リターンコード
 10945*----------  詳細リターンコード
 10946       MOVE  FUNCTION NUMVAL(WK-FILE-STATUS)
 10947         TO  WK-DETAIL-RTN-CD
 10948*----------  詳細リターンコードデコードフラグ
 10949       MOVE  CNS-DETAIL-0         TO  WK-DETAIL-RTN-CD-FLG
 10950       STRING  "ファイル:["
 10951               WK-PSACT-DAT-FILE
 10952               "]オープンエラー"
 10953         DELIMITED BY SPACE       INTO  WK-FREE-MSG
 10954       END-STRING
 10955       PERFORM  ERR-RTN
 10956     END-EVALUATE
 10957*--------------------<DEBUG>--------------------------------------
 10958D    DISPLAY  CNS-PGM-ID":ファイルオープンフラグ=["
 10959D             FLG-FILE-OPEN "]"
 10960D    DISPLAY  CNS-PGM-ID":ファイルオープン処理  END "
 10961*-----------------------------------------------------------------
 10962     MOVE FUNCTION CURRENT-DATE(1:14) TO WK-RUN-EDATETIME
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 190
* MUSR2651.cob                                                     cpy)cpy)y)y)
 10963*--------------------<DEBUG>--------------------------------------
 10964     DISPLAY "プログラムID:        ["CNS-PGM-ID"]"                GUT2013
 10965     DISPLAY "セクション:          [OPEN-FILE-RTN]"               GUT2013
 10966     DISPLAY "セクションの終了時間:["WK-RUN-EDATETIME"]"          GUT2013
 10967*-----------------------------------------------------------------
 10968     CONTINUE.
 10969 OPEN-FILE-EXT.
 10970     EXIT.
 10971******************************************************************
 10972*    3.1.11.受渡ファイル名作成処理
 10973******************************************************************
 10974 GET-FILE-2-NAME-RTN    SECTION.
 10975*--------------------<DEBUG>--------------------------------------
 10976D    DISPLAY  CNS-PGM-ID":受渡ファイル名作成処理  START "
 10977*-----------------------------------------------------------------
 10978     STRING  CNS-RX-TEXT               DELIMITED BY SPACE
 10979             WK-RIYO-CMP-CD            DELIMITED BY SPACE
 10980             "_"                       DELIMITED BY SPACE
 10981             WK-SHORI-YMD              DELIMITED BY SPACE
 10982             "_"                       DELIMITED BY SPACE
 10983             WK-KIDOU-ID               DELIMITED BY SPACE
 10984             "_"                       DELIMITED BY SPACE
 10985             WK-GYOMU-TASK-ID          DELIMITED BY SPACE
 10986             "_02"                     DELIMITED BY SPACE
 10987                                       INTO  WK-FILE-2-NAME
 10988     END-STRING
 10989     STRING  WK-FILE-PASS              DELIMITED BY SPACE
 10990             "/"                       DELIMITED BY SPACE
 10991             WK-FILE-2-NAME            DELIMITED BY SPACE
 10992                                       INTO  WK-PSACT-DAT-FILE-2
 10993     END-STRING
 10994*--------------------<DEBUG>--------------------------------------
 10995D    DISPLAY  CNS-PGM-ID":W.受渡ファイル名=["WK-FILE-2-NAME"]"
 10996D    DISPLAY  CNS-PGM-ID":受渡ファイルパス=["WK-FILE-PASS"]"
 10997D    DISPLAY  CNS-PGM-ID":パス付けDAT受渡ファイル=["
 10998D             WK-PSACT-DAT-FILE-2"]"
 10999D    DISPLAY  CNS-PGM-ID": 受渡ファイル名作成処理  END  *****"
 11000*-----------------------------------------------------------------
 11001     CONTINUE.
 11002 GET-FILE-2-NAME-EXT.
 11003     EXIT.
 11004******************************************************************
 11005*    3.1.11.受渡ファイルオープン
 11006******************************************************************
 11007 OPEN-FILE-2-RTN        SECTION.
 11008     MOVE FUNCTION CURRENT-DATE(1:14) TO WK-RUN-SDATETIME
 11009*-------------------<DEBUG>---------------------------------------
 11010     DISPLAY "プログラムID:        ["CNS-PGM-ID"]"                GUT2013
 11011     DISPLAY "セクション:          [OPEN-FILE-2-RTN]"             GUT2013
 11012     DISPLAY "セクションの開始時間:["WK-RUN-SDATETIME"]"          GUT2013
 11013*-----------------------------------------------------------------
 11014*--------------------<DEBUG>--------------------------------------
 11015D    DISPLAY   CNS-PGM-ID":受渡ファイルオープン処理  START "
 11016*-----------------------------------------------------------------
 11017     MOVE  CNS-OFF                     TO  FLG-FILE-OPEN-2
 11018     MOVE  WK-PSACT-DAT-FILE-2         TO  OUTFILE-2
 11019     OPEN  OUTPUT OUT-FILE-2
 11020*-------------------<DEBUG>---------------------------------------
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 191
* MUSR2651.cob                                                     cpy)cpy)y)y)
 11021D    DISPLAY  CNS-PGM-ID":FILE-STATUS-2=[" WK-FILE-STATUS-2 "]"
 11022*-----------------------------------------------------------------
 11023     EVALUATE  WK-FILE-STATUS-2
 11024       WHEN  CNS-FILE-NORMAL
 11025         MOVE  CNS-ON                  TO  FLG-FILE-OPEN-2
 11026*--------------------<DEBUG>--------------------------------------
 11027D    DISPLAY  CNS-PGM-ID":DAT受渡ファイルオープン正常"
 11028*-----------------------------------------------------------------
 11029       WHEN  OTHER
 11030*--------------------<DEBUG>--------------------------------------
 11031D    DISPLAY  CNS-PGM-ID":DAT受渡ファイルオープンエラー"
 11032*-----------------------------------------------------------------
 11033*----------  メッセージ出力用 RTNパッケージの設定
 11034*----------  ワークリターンコード
 11035       MOVE  CNS-RTN-BT16         TO  WK-RTN-CODE
 11036       INITIALIZE  WK-SYS-ERR-INFO
 11037*----------  エラー検知プログラムID
 11038       MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
 11039*----------  ポジション
 11040       MOVE  CNS-POS-008          TO  WK-ERR-POS
 11041*----------  リターンコード
 11042       MOVE  CNS-RTN-200          TO  WK-RTN-CD
 11043*----------  詳細リターンコード
 11044       MOVE  FUNCTION NUMVAL(WK-FILE-STATUS-2)
 11045         TO  WK-DETAIL-RTN-CD
 11046*----------  詳細リターンコードデコードフラグ
 11047       MOVE  CNS-DETAIL-0         TO  WK-DETAIL-RTN-CD-FLG
 11048       MOVE  SPACE                TO  WK-FREE-MSG
 11049       STRING  "ファイル:["
 11050               WK-PSACT-DAT-FILE-2
 11051               "]オープンエラー"
 11052         DELIMITED BY SIZE         INTO  WK-FREE-MSG
 11053       END-STRING
 11054       PERFORM  ERR-RTN
 11055     END-EVALUATE
 11056*--------------------<DEBUG>--------------------------------------
 11057D    DISPLAY  CNS-PGM-ID":受渡ファイルオープンフラグ=["
 11058D             FLG-FILE-OPEN-2 "]"
 11059D    DISPLAY  CNS-PGM-ID":受渡ファイルオープン処理  END "
 11060*-----------------------------------------------------------------
 11061     MOVE FUNCTION CURRENT-DATE(1:14) TO WK-RUN-EDATETIME
 11062*--------------------<DEBUG>--------------------------------------
 11063     DISPLAY "プログラムID:        ["CNS-PGM-ID"]"                GUT2013
 11064     DISPLAY "セクション:          [OPEN-FILE-2-RTN]"             GUT2013
 11065     DISPLAY "セクションの終了時間:["WK-RUN-EDATETIME"]"          GUT2013
 11066*-----------------------------------------------------------------
 11067     CONTINUE.
 11068 OPEN-FILE-2-EXT.
 11069     EXIT.
 11070******************************************************************
 11071*    3.2.主処理
 11072******************************************************************
 11073 MAIN-RTN               SECTION.
 11074     MOVE FUNCTION CURRENT-DATE(1:14) TO WK-RUN-SDATETIME
 11075*-------------------<DEBUG>---------------------------------------
 11076     DISPLAY "プログラムID:        ["CNS-PGM-ID"]"                GUT2013
 11077     DISPLAY "セクション:          [MAIN-RTN]"                    GUT2013
 11078     DISPLAY "セクションの開始時間:["WK-RUN-SDATETIME"]"          GUT2013
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 192
* MUSR2651.cob                                                     cpy)cpy)y)y)
 11079*-----------------------------------------------------------------
 11080*--------------------<DEBUG>--------------------------------------
 11081D    DISPLAY  CNS-PGM-ID":***  主処理  START  ***"
 11082*-----------------------------------------------------------------
 11083*----------  3.2.1.処理対象取得処理
 11084     PERFORM  SHORI-KENRI-GET-RTN
 11085*----------  3.2.2.実行状況更新処理
 11086     PERFORM  STATUS-KOUSIN-1-RTN
 11087*----------  3.2.4.GAMMA残高データ出力処理
 11088     PERFORM                  VARYING  WK-IDX-J
 11089       FROM  CNS-1 BY CNS-1 UNTIL  WK-IDX-J > WK-HIT-KENSU
 11090          OR  WK-RTN-CODE NOT < CNS-16
 11091*-------------------<DEBUG>---------------------------------------
 11092D    DISPLAY  CNS-PGM-ID":WK-IDX-J=["WK-IDX-J"]"
 11093D    DISPLAY  CNS-PGM-ID":WK-GYOMU-TASK-ID=["
 11094D             WK-GYOMU-TASK-ID  OF  WK-ARGUMENT"]"
 11095*-----------------------------------------------------------------
 11096*******         テーマ2682     20100404 修正  開始        ********
 11097       IF  WK-GYOMU-TASK-ID  OF  WK-ARGUMENT  =  CNS-TASK-T7080US
 11098       THEN
 11099         PERFORM  SINU-CHECK-RTN
 11100       ELSE
 11101         CONTINUE
 11102       END-IF
 11103*-------------------<DEBUG>---------------------------------------
 11104D    DISPLAY  CNS-PGM-ID":WK-STATUS=["WK-STATUS"]"
 11105D    DISPLAY  CNS-PGM-ID":FLG-NEXT-MEISAI=["FLG-NEXT-MEISAI"]"
 11106*-----------------------------------------------------------------
 11107*******         テーマ2682     20100404 修正  終了        ********
 11108*----------  3)GAMMA残高データ出力処理
 11109       IF  WK-STATUS = CNS-0 AND FLG-NEXT-MEISAI = CNS-OFF
 11110       THEN
 11111         PERFORM  DATA-OUT-RTN
 11112       ELSE
 11113         CONTINUE
 11114       END-IF
 11115*----------  初期化
 11116       INITIALIZE  WK-J
 11117                   WK-STATUS
 11118                   WK-SELECT-KENSUU
 11119                   WK-GYOMU-ERR-INFO
 11120                   FLG-STOP-2
 11121                   FLG-MEISAI-GYOMU-ERR
 11122                   FLG-NEXT-MEISAI
 11123     END-PERFORM
 11124*----------  フッターをダウンロードファイルに書き
 11125     PERFORM  FOOT-OUT-RTN
 11126*-------------------<DEBUG>---------------------------------------
 11127D    DISPLAY  CNS-PGM-ID":FLG-UPD =["FLG-UPD"]"
 11128*-----------------------------------------------------------------
 11129*------------------ <連結障害1077の対応 START>--------------------
 11130*---------- ファイル出力件数処理
 11131     PERFORM  WRITE-KENSUU-RTN
 11132*------------------ <連結障害1077の対応 END>----------------------
 11133*---------- 実行状況更新処理2
 11134     PERFORM  STATUS-KOUSIN-2-RTN
 11135*--------------------<DEBUG>--------------------------------------
 11136D    DISPLAY  CNS-PGM-ID":***  主処理  END  ***"
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 193
* MUSR2651.cob                                                     cpy)cpy)y)y)
 11137*-----------------------------------------------------------------
 11138     MOVE FUNCTION CURRENT-DATE(1:14) TO WK-RUN-EDATETIME
 11139*--------------------<DEBUG>--------------------------------------
 11140     DISPLAY "プログラムID:        ["CNS-PGM-ID"]"                GUT2013
 11141     DISPLAY "セクション:          [MAIN-RTN]"                    GUT2013
 11142     DISPLAY "セクションの終了時間:["WK-RUN-EDATETIME"]"          GUT2013
 11143*-----------------------------------------------------------------
 11144     CONTINUE.
 11145 MAIN-EXT.
 11146     EXIT.
 11147******************************************************************
 11148*    3.2.1.処理対象取得処理
 11149******************************************************************
 11150 SHORI-KENRI-GET-RTN    SECTION.
 11151*--------------------<DEBUG>--------------------------------------
 11152D    DISPLAY  CNS-PGM-ID":***  処理対象取得処理  START  ***"
 11153*-----------------------------------------------------------------
 11154*----------  1) 電文情報取得とチェック処理
 11155     PERFORM  DENBUN-GET-CHECK-RTN
 11156*----------  4) ポートフォリオ明細取得処理
 11157     PERFORM  PTF-DETAIL-GET-RTN
 11158*--------------------<DEBUG>--------------------------------------
 11159D    DISPLAY  CNS-PGM-ID":***  処理対象取得処理  END  ***"
 11160*-----------------------------------------------------------------
 11161     CONTINUE.
 11162 SHORI-KENRI-GET-EXT.
 11163     EXIT.
 11164******************************************************************
 11165*    1) 電文情報取得とチェック処理
 11166******************************************************************
 11167 DENBUN-GET-CHECK-RTN   SECTION.
 11168*--------------------<DEBUG>--------------------------------------
 11169D    DISPLAY  CNS-PGM-ID":*** 電文情報取得とチェック処理START ***"
 11170*-----------------------------------------------------------------
 11171*----------  電文情報取得処理
 11172     PERFORM  DENBUN-INFO-GET-RTN
 11173*----------  汎用残高ダウンロード処理起動O3Wチェックルーチン
 11174     PERFORM  O3W-CHECK-RTN
 11175*----------  電文情報チェック処理
 11176     PERFORM  DAT-START-RTN
 11177*----------  2）期間取得
 11178     PERFORM  KIKAN-GET-RTN
 11179*----------  3）期間チェック処理
 11180     PERFORM  KIKAN-CHECK-RTN
 11181*----------  GXファイルをオープンする
 11182*------------------ <連結障害No.1577対応 START>-------------------
 11183     PERFORM  GX-FILE-OPEN-RTN
 11184*------------------ <連結障害No.1577対応   END>-------------------
 11185*--------------------<DEBUG>--------------------------------------
 11186D    DISPLAY  CNS-PGM-ID":*** 電文情報取得とチェック処理END ***"
 11187*-----------------------------------------------------------------
 11188     CONTINUE.
 11189 DENBUN-GET-CHECK-EXT.
 11190     EXIT.
 11191******************************************************************
 11192*    電文情報取得処理
 11193******************************************************************
 11194 DENBUN-INFO-GET-RTN    SECTION.
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 194
* MUSR2651.cob                                                     cpy)cpy)y)y)
 11195*--------------------<DEBUG>--------------------------------------
 11196D    DISPLAY  CNS-PGM-ID":***  電文情報取得処理 START  ***"
 11197*-----------------------------------------------------------------
 11198     MOVE FUNCTION CURRENT-DATE(1:14) TO WK-RUN-SDATETIME
 11199*-------------------<DEBUG>---------------------------------------
 11200     DISPLAY "プログラムID:        ["CNS-PGM-ID"]"                GUT2013
 11201     DISPLAY "セクション:          [DENBUN-INFO-GET-RTN]"         GUT2013
 11202     DISPLAY "セクションの開始時間:["WK-RUN-SDATETIME"]"          GUT2013
 11203*-----------------------------------------------------------------
 11204     INITIALIZE  PARM-SCZY7060-INOUT
 11205                 PARM-RTNPKG
 11206*----------  利用会社コード
 11207     MOVE  WK-RIYO-CMP-CD
 11208       TO  RIYO-CMP-CD            OF PARM-SCZY7060-ARG1
 11209*----------  処理実行日
 11210     MOVE  WK-SHORI-YMD-9
 11211       TO  SYORI-YMD              OF PARM-SCZY7060-ARG1
 11212*----------  起動ID
 11213     MOVE  WK-KIDOU-ID
 11214       TO  KIDOU-ID               OF PARM-SCZY7060-ARG1
 11215*--------------------<DEBUG>--------------------------------------
 11216D    DISPLAY  CNS-PGM-ID":SCZY7060-ARG:"
 11217D    DISPLAY  CNS-PGM-ID":RIYO-CMP-CD=["
 11218D             RIYO-CMP-CD         OF  PARM-SCZY7060-ARG1"]"
 11219D    DISPLAY  CNS-PGM-ID":SYORI-YMD=["
 11220D             SYORI-YMD           OF  PARM-SCZY7060-ARG1"]"
 11221D    DISPLAY  CNS-PGM-ID":KIDOU-ID=["
 11222D             KIDOU-ID            OF  PARM-SCZY7060-ARG1"]"
 11223D    DISPLAY  CNS-PGM-ID":***  CALL SCZY7060 START  ***"
 11224*-----------------------------------------------------------------
 11225     CALL  "SCZY7060"             USING  PARM-SCZY7060-INOUT
 11226                                         PARM-RTNPKG
 11227*--------------------<DEBUG>--------------------------------------
 11228D    DISPLAY  CNS-PGM-ID":***  CALL SCZY7060 END  ***"
 11229D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY7060)       =["
 11230D             RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)"]"
 11231D    DISPLAY  CNS-PGM-ID":COUNTER OF PARM-RTNPKG =["
 11232D             COUNTER             OF PARM-RTNPKG "]"
 11233*-----------------------------------------------------------------
 11234     IF  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
 11235      =  CNS-RTN-000
 11236     THEN
 11237       MOVE  DENBUN-INFO       OF  PARM-SCZY7060-ARG3
 11238         TO  WK-DENBUN-AREA
 11239*******         テーマ3406     20130117 修正  開始        ********
 11240*----------  ワーク業務タスクID＝"T6820US"（ＳＢＡ残高データ接続）
 11241*----------  の場合,ワーク電文情報．合成ポート再計算フラグ←"0"
 11242       IF  WK-GYOMU-TASK-ID     OF  WK-ARGUMENT
 11243        =  CNS-SBA-ZANDAKA-SETUZOKU
 11244       THEN
 11245         MOVE  CNS-X-0          TO  I-FLG-KEISAN
 11246                                OF  WK-DENBUN-AREA
 11247       ELSE
 11248         CONTINUE
 11249       END-IF
 11250*******         テーマ3406     20130117 修正  終了        ********
 11251*--------------------<DEBSUG>-------------------------------------
 11252D    DISPLAY  CNS-PGM-ID":電文情報取得処理  正常"
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 195
* MUSR2651.cob                                                     cpy)cpy)y)y)
 11253D    DISPLAY  CNS-PGM-ID":WK-AIFA=["WK-AIFA"]"
 11254D    DISPLAY  CNS-PGM-ID":WK-HEADER=["WK-HEADER"]"
 11255D    DISPLAY  CNS-PGM-ID":WK-DENBUN-INFO=["WK-DENBUN-INFO"]"
 11256*-----------------------------------------------------------------
 11257     ELSE
 11258*--------------------<DEBUG>--------------------------------------
 11259D    DISPLAY  CNS-PGM-ID":電文情報取得処理  エラー"
 11260*-----------------------------------------------------------------
 11261*----------  ワークリターンコード
 11262       MOVE  CNS-RTN-BT16         TO  WK-RTN-CODE
 11263*----------  ワークエラーパッケージを編集
 11264       MOVE  PARM-RTNPKG          TO  PARM-SCZY1170-RTNPKG
 11265       INITIALIZE  WK-SYS-ERR-INFO
 11266*----------  エラー検知プログラムID
 11267       MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
 11268*----------  ポジション
 11269       MOVE  CNS-POS-009          TO  WK-ERR-POS
 11270*----------  リターンコード
 11271       MOVE  CNS-RTN-901          TO  WK-RTN-CD
 11272*----------  詳細リターンコード
 11273       MOVE  RTN-CD               OF  PARM-RTNPKG
 11274                                      (COUNTER OF PARM-RTNPKG)
 11275                                  TO  WK-DETAIL-RTN-CD
 11276*----------  詳細リターンコードデコードフラグ
 11277       MOVE  CNS-DETAIL-0         TO  WK-DETAIL-RTN-CD-FLG
 11278*---------- フリーメッセージ
 11279       MOVE  SPACE                TO  WK-FREE-MSG
 11280*----------  エラー処理
 11281       PERFORM  ERR-RTN
 11282     END-IF
 11283*--------------------<DEBUG>--------------------------------------
 11284D    DISPLAY  CNS-PGM-ID":***  電文情報取得処理 END  ***"
 11285*-----------------------------------------------------------------
 11286     MOVE FUNCTION CURRENT-DATE(1:14) TO WK-RUN-EDATETIME
 11287*--------------------<DEBUG>--------------------------------------
 11288     DISPLAY "プログラムID:        ["CNS-PGM-ID"]"                GUT2013
 11289     DISPLAY "セクション:          [DENBUN-INFO-GET-RTN]"         GUT2013
 11290     DISPLAY "セクションの終了時間:["WK-RUN-EDATETIME"]"          GUT2013
 11291*-----------------------------------------------------------------
 11292     CONTINUE.
 11293 DENBUN-INFO-GET-EXT.
 11294     EXIT.
 11295******************************************************************
 11296*    汎用残高ダウンロード処理起動O3Wチェックルーチン
 11297******************************************************************
 11298 O3W-CHECK-RTN          SECTION.
 11299*--------------------<DEBUG>--------------------------------------
 11300D    DISPLAY  CNS-PGM-ID":汎用残高ダウンロード処理起動O3W START *"
 11301*-----------------------------------------------------------------
 11302     INITIALIZE  PARM-AIFA-HDR
 11303                 PARM-USER-ATTR-HDR
 11304                 PARM-SUSR2602-ARG-IN
 11305                 PARM-SUSR2602-ARG-OUT
 11306     MOVE  WK-AIFA               TO  PARM-AIFA-HDR
 11307     MOVE  WK-HEADER             TO  PARM-USER-ATTR-HDR
 11308     MOVE  WK-DENBUN-INFO
 11309       TO  PARM-SUSR2602-ARG-IN
 11310*--------------------<DEBUG>--------------------------------------
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 196
* MUSR2651.cob                                                     cpy)cpy)y)y)
 11311D    DISPLAY  CNS-PGM-ID":SUSR2602-ARG:"
 11312D    DISPLAY  CNS-PGM-ID":AIFA-HDR=["PARM-AIFA-HDR"]"
 11313D    DISPLAY  CNS-PGM-ID":USER-ATTR-HDR=["PARM-USER-ATTR-HDR"]"
 11314D    DISPLAY  CNS-PGM-ID":SUSR2602-ARG-IN=["
 11315D             PARM-SUSR2602-ARG-IN"]"
 11316D    DISPLAY  CNS-PGM-ID":***  CALL SUSR2602 START  ***"
 11317*-----------------------------------------------------------------
 11318     CALL  "SUSR2602"             USING PARM-AIFA-HDR
 11319                                        PARM-USER-ATTR-HDR
 11320                                        PARM-SUSR2602-ARG-IN
 11321                                        PARM-SUSR2602-ARG-OUT
 11322*--------------------<DEBUG>--------------------------------------
 11323D    DISPLAY  CNS-PGM-ID":***  CALL SUSR2602 END  ***"
 11324D    DISPLAY  CNS-PGM-ID":I-KJN-YMD-TO       =["
 11325D             I-KJN-YMD-TO OF PARM-SUSR2602-ARG-IN"]"
 11326D    DISPLAY  CNS-PGM-ID":RTN-CD(SUSR2602)       =["
 11327D             RTN-CD OF PARM-SUSR2602-ARG-OUT"]"
 11328*-----------------------------------------------------------------
 11329     EVALUATE  RTN-CD OF PARM-SUSR2602-ARG-OUT
 11330       WHEN   CNS-NORMAL
 11331*--------------------<DEBUG>--------------------------------------
 11332D    DISPLAY  CNS-PGM-ID":汎用残高ダウンロード処理起動O3W 正常 **"
 11333*-----------------------------------------------------------------
 11334         CONTINUE
 11335       WHEN  OTHER
 11336*--------------------<DEBUG>--------------------------------------
 11337D    DISPLAY  CNS-PGM-ID":汎用残高ダウンロード処理起動O3Wエラー *"
 11338*-----------------------------------------------------------------
 11339         MOVE  CNS-8              TO  WK-RTN-CODE
 11340*----------  ワーク業務エラーパッケージを編集
 11341         INITIALIZE  WK-GYOMU-ERR-INFO
 11342         MOVE  SUSR2602-BT-OUT
 11343           TO  WK-GYOMU-ERR-INFO
 11344*----------  後処理業務エラーフラグ
 11345         MOVE  CNS-ON             TO  FLG-GYOMU-ERR
 11346         PERFORM  END-RTN
 11347     END-EVALUATE
 11348*--------------------<DEBUG>--------------------------------------
 11349D    DISPLAY  CNS-PGM-ID":汎用残高ダウンロード処理起動O3W END  **"
 11350*-----------------------------------------------------------------
 11351     CONTINUE.
 11352 O3W-CHECK-EXT.
 11353     EXIT.
 11354******************************************************************
 11355*    GX集約データ生成処理起動単体チェック
 11356******************************************************************
 11357 DAT-START-RTN          SECTION.
 11358*--------------------<DEBUG>--------------------------------------
 11359D    DISPLAY  CNS-PGM-ID":GX集約データ生成単体チェック START ***"
 11360*-----------------------------------------------------------------
 11361     INITIALIZE  PARM-SUSR2601-INOUT
 11362                 PARM-RTNPKG
 11363*----------  SPP/バッチ起動区分
 11364     MOVE  CNS-KIDOU-KBN-B
 11365       TO  KIDOU-KBN              OF   PARM-SUSR2601-INOUT
 11366     MOVE  WK-DENBUN-INFO
 11367       TO  PARM-SUSR2601-ARG2     OF   PARM-SUSR2601-INOUT
 11368*--------------------<DEBUG>--------------------------------------
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 197
* MUSR2651.cob                                                     cpy)cpy)y)y)
 11369D    DISPLAY  CNS-PGM-ID":SUSR2601-ARG:"
 11370D    DISPLAY  CNS-PGM-ID":SPP/バッチ起動区分=["
 11371D             KIDOU-KBN              OF   PARM-SUSR2601-INOUT"]"
 11372D    DISPLAY  CNS-PGM-ID":PARM-SUSR2601-ARG2=["
 11373D             PARM-SUSR2601-ARG2     OF   PARM-SUSR2601-INOUT "]"
 11374D    DISPLAY  CNS-PGM-ID":***  CALL SUSR2601 START  ***"
 11375*-----------------------------------------------------------------
 11376     CALL  "SUSR2601"             USING  PARM-SUSR2601-INOUT
 11377                                         PARM-RTNPKG
 11378*--------------------<DEBUG>--------------------------------------
 11379D    DISPLAY  CNS-PGM-ID":***  CALL SUSR2601 END  ***"
 11380D    DISPLAY  CNS-PGM-ID":RTN-CD(SUSR2601)       =["
 11381D             RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)"]"
 11382D    DISPLAY  CNS-PGM-ID":COUNTER OF PARM-RTNPKG =["
 11383D             COUNTER             OF PARM-RTNPKG "]"
 11384*-----------------------------------------------------------------
 11385     EVALUATE  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
 11386       WHEN  CNS-RTN-000
 11387*--------------------<DEBUG>--------------------------------------
 11388D    DISPLAY  CNS-PGM-ID":GX残高データ生成単体チェック 正常 ***"
 11389*-----------------------------------------------------------------
 11390         CONTINUE
 11391       WHEN  CNS-RTN-800
 11392*--------------------<DEBUG>--------------------------------------
 11393D    DISPLAY  CNS-PGM-ID":GX残高チェック パラメータエラー ***"
 11394*-----------------------------------------------------------------
 11395*----------  ワークリターンコード
 11396         MOVE  CNS-RTN-BT8        TO  WK-RTN-CODE
 11397*----------  ワーク業務エラーパッケージを編集
 11398         INITIALIZE  WK-GYOMU-ERR-INFO
 11399*----------  ワーク業務エラーを編集
 11400         MOVE  PARM-SUSR2601-ARG6 TO  WK-GYOMU-ERR-INFO
 11401*----------  後処理業務エラーフラグ
 11402         MOVE  CNS-ON             TO  FLG-GYOMU-ERR
 11403         PERFORM  END-RTN
 11404       WHEN  OTHER
 11405*--------------------<DEBUG>--------------------------------------
 11406D    DISPLAY  CNS-PGM-ID":GX残高チェック システムエラー"
 11407*-----------------------------------------------------------------
 11408*----------  ワークエラーパッケージを編集
 11409         MOVE  PARM-RTNPKG          TO  PARM-SCZY1170-RTNPKG
 11410*----------  ワークリターンコード
 11411         MOVE  CNS-16               TO  WK-RTN-CODE
 11412*----------  ワークエラーパッケージを編集
 11413         INITIALIZE  WK-SYS-ERR-INFO
 11414*----------  エラー検知プログラムID
 11415         MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
 11416*----------  ポジション
 11417         MOVE  CNS-POS-010          TO  WK-ERR-POS
 11418*----------  リターンコード
 11419         MOVE  CNS-RTN-901          TO  WK-RTN-CD
 11420*----------  詳細リターンコード
 11421         MOVE  RTN-CD               OF  PARM-RTNPKG
 11422                                      (COUNTER OF PARM-RTNPKG)
 11423                                  TO  WK-DETAIL-RTN-CD
 11424*----------  詳細リターンコードデコードフラグ
 11425         MOVE  CNS-DETAIL-0         TO  WK-DETAIL-RTN-CD-FLG
 11426*---------- フリーメッセージ
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 198
* MUSR2651.cob                                                     cpy)cpy)y)y)
 11427         MOVE  SPACE                TO  WK-FREE-MSG
 11428*----------  エラー処理
 11429         PERFORM  ERR-RTN
 11430     END-EVALUATE
 11431*--------------------<DEBUG>--------------------------------------
 11432D    DISPLAY  CNS-PGM-ID":GX残高データ生成単体チェック END  ***"
 11433*-----------------------------------------------------------------
 11434     CONTINUE.
 11435 DAT-START-EXT.
 11436     EXIT.
 11437******************************************************************
 11438*    2）期間取得処理
 11439******************************************************************
 11440 KIKAN-GET-RTN          SECTION.
 11441*--------------------<DEBUG>--------------------------------------
 11442D    DISPLAY  CNS-PGM-ID":***  期間取得処理START  ***"
 11443*-----------------------------------------------------------------
 11444     INITIALIZE  WK-KIKAN
 11445     MOVE  I-KJN-YMD-FR             OF  WK-DENBUN-INFO
 11446       TO  WK-KIKAN-FR              OF  WK-KIKAN
 11447     MOVE  I-KJN-YMD-TO             OF  WK-DENBUN-INFO
 11448       TO  WK-KIKAN-TO              OF  WK-KIKAN
 11449*-------------------<DEBUG>---------------------------------------
 11450D    DISPLAY  CNS-PGM-ID":KJN-YMD-FR=["I-KJN-YMD-FR  OF
 11451D                                                WK-DENBUN-INFO"]"
 11452D    DISPLAY  CNS-PGM-ID":KJN-YMD-TO=["I-KJN-YMD-TO  OF
 11453D                                                WK-DENBUN-INFO"]"
 11454*-----------------------------------------------------------------
 11455*----------  期間FROM取得処理
 11456     INITIALIZE  PARM-SCZY1020-INOUT
 11457                 PARM-RTNPKG
 11458     IF   WK-KIKAN-FR  =  SPACE
 11459     THEN
 11460*----------  機能区分
 11461       MOVE  CNS-X-3
 11462         TO  IXCAL-FUNCTION         OF  PARM-SCZY1020-ARG1
 11463*---------- 基準年月日1
 11464       MOVE  WK-SHORI-YMD-9
 11465         TO  IXCAL-KJN-YMD1         OF  PARM-SCZY1020-ARG1
 11466*---------- 計算ベース区分
 11467       MOVE  CNS-X-2
 11468         TO  IXCAL-COMP-BASE        OF  PARM-SCZY1020-ARG1
 11469*---------- 前後区分1
 11470       MOVE  CNS-X-2
 11471         TO  IXCAL-ZENGO-KBN-1      OF  PARM-SCZY1020-ARG1
 11472*---------- 前後区分2
 11473       MOVE  CNS-X-0
 11474         TO  IXCAL-ZENGO-KBN-2      OF  PARM-SCZY1020-ARG1
 11475*---------- 単位区分
 11476       MOVE  CNS-X-1
 11477         TO  IXCAL-TANI-KBN         OF  PARM-SCZY1020-ARG1
 11478*---------- 日数
 11479       MOVE  CNS-1
 11480         TO  IXCAL-DAYS             OF  PARM-SCZY1020-ARG1
 11481       PERFORM   DATE-GET-RTN
 11482       MOVE  WK-FROM1020-DATE       TO  WK-KIKAN-FR-9
 11483     ELSE
 11484       CONTINUE
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 199
* MUSR2651.cob                                                     cpy)cpy)y)y)
 11485     END-IF
 11486*----------  期間TO取得処理
 11487     IF   WK-KIKAN-TO   =  SPACE
 11488     THEN
 11489*----------  機能区分
 11490       MOVE  CNS-X-3
 11491         TO  IXCAL-FUNCTION         OF  PARM-SCZY1020-ARG1
 11492*---------- 基準年月日1
 11493       MOVE  WK-SHORI-YMD-9
 11494         TO  IXCAL-KJN-YMD1         OF  PARM-SCZY1020-ARG1
 11495*---------- 計算ベース区分
 11496       MOVE  CNS-X-2
 11497         TO  IXCAL-COMP-BASE        OF  PARM-SCZY1020-ARG1
 11498*---------- 前後区分1
 11499       MOVE  CNS-X-2
 11500         TO  IXCAL-ZENGO-KBN-1      OF  PARM-SCZY1020-ARG1
 11501*---------- 前後区分2
 11502       MOVE  CNS-X-0
 11503         TO  IXCAL-ZENGO-KBN-2      OF  PARM-SCZY1020-ARG1
 11504*---------- 単位区分
 11505       MOVE  CNS-X-1
 11506         TO  IXCAL-TANI-KBN         OF  PARM-SCZY1020-ARG1
 11507*---------- 日数
 11508       MOVE  CNS-1
 11509         TO  IXCAL-DAYS             OF  PARM-SCZY1020-ARG1
 11510       PERFORM   DATE-GET-RTN
 11511       MOVE  WK-FROM1020-DATE       TO  WK-KIKAN-TO-9
 11512     ELSE
 11513       CONTINUE
 11514     END-IF
 11515*--------------------<DEBUG>--------------------------------------
 11516D    DISPLAY  CNS-PGM-ID":WK-KIKAN-FR-9=["WK-KIKAN-FR-9"]"
 11517D    DISPLAY  CNS-PGM-ID":WK-KIKAN-TO-9=["WK-KIKAN-TO-9"]"
 11518D    DISPLAY  CNS-PGM-ID":***  期間取得処理 END  ***"
 11519*-----------------------------------------------------------------
 11520     CONTINUE.
 11521 KIKAN-GET-EXT.
 11522     EXIT.
 11523******************************************************************
 11524*    日付取得処理
 11525******************************************************************
 11526 DATE-GET-RTN           SECTION.
 11527*-------------------<DEBUG>---------------------------------------
 11528D    DISPLAY  CNS-PGM-ID":*** 日付取得処理 START ***"
 11529D    DISPLAY  CNS-PGM-ID":機能区分      =["
 11530D             IXCAL-FUNCTION      OF  PARM-SCZY1020-ARG1"]"
 11531D    DISPLAY  CNS-PGM-ID":基準年月日1   =["
 11532D             IXCAL-KJN-YMD1      OF  PARM-SCZY1020-ARG1"]"
 11533D    DISPLAY  CNS-PGM-ID":計算ベース区分=["
 11534D             IXCAL-COMP-BASE     OF  PARM-SCZY1020-ARG1"]"
 11535D    DISPLAY  CNS-PGM-ID":前後区分1     =["
 11536D             IXCAL-ZENGO-KBN-1   OF  PARM-SCZY1020-ARG1"]"
 11537D    DISPLAY  CNS-PGM-ID":前後区分2     =["
 11538D             IXCAL-ZENGO-KBN-2   OF  PARM-SCZY1020-ARG1"]"
 11539D    DISPLAY  CNS-PGM-ID":単位区分      =["
 11540D             IXCAL-TANI-KBN      OF  PARM-SCZY1020-ARG1"]"
 11541D    DISPLAY  CNS-PGM-ID":日数          =["
 11542D             IXCAL-DAYS          OF  PARM-SCZY1020-ARG1"]"
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 200
* MUSR2651.cob                                                     cpy)cpy)y)y)
 11543*-----------------------------------------------------------------
 11544     INITIALIZE  WK-FROM1020-DATE
 11545     CALL  "SCZY1020"             USING  PARM-SCZY1020-INOUT
 11546                                         PARM-RTNPKG
 11547*-------------------<DEBUG>---------------------------------------
 11548D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY1020)            =["
 11549D             RTN-CD   OF PARM-RTNPKG( COUNTER OF  PARM-RTNPKG)"]"
 11550*-----------------------------------------------------------------
 11551     IF  RTN-CD  OF PARM-RTNPKG(COUNTER OF  PARM-RTNPKG)
 11552      =  CNS-RTN-000
 11553     THEN
 11554       MOVE  IXCAL-KJN-YMD-2      OF  PARM-SCZY1020-ARG1
 11555         TO  WK-FROM1020-DATE
 11556*-------------------<DEBUG>---------------------------------------
 11557D    DISPLAY  CNS-PGM-ID":日付取得 正常"
 11558*-----------------------------------------------------------------
 11559     ELSE
 11560*-------------------<DEBUG>---------------------------------------
 11561D    DISPLAY  CNS-PGM-ID":日付取得 異常"
 11562*-----------------------------------------------------------------
 11563*----------  ワークリターンコード
 11564       MOVE  CNS-RTN-BT16         TO  WK-RTN-CODE
 11565*----------  ワークエラーパッケージを編集
 11566       MOVE  PARM-RTNPKG          TO  PARM-SCZY1170-RTNPKG
 11567       INITIALIZE  WK-SYS-ERR-INFO
 11568*----------  エラー検知プログラムID
 11569       MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
 11570*----------  ポジション
 11571       MOVE  CNS-POS-011          TO  WK-ERR-POS
 11572*----------  リターンコード
 11573       MOVE  CNS-RTN-901          TO  WK-RTN-CD
 11574*----------  詳細リターンコード
 11575       MOVE  RTN-CD               OF  PARM-RTNPKG
 11576                                      (COUNTER OF PARM-RTNPKG)
 11577                                  TO  WK-DETAIL-RTN-CD
 11578*----------  詳細リターンコードデコードフラグ
 11579       MOVE  CNS-DETAIL-0         TO  WK-DETAIL-RTN-CD-FLG
 11580*---------- フリーメッセージ
 11581       MOVE  SPACE                TO  WK-FREE-MSG
 11582*----------  エラー処理
 11583       PERFORM  ERR-RTN
 11584     END-IF
 11585*-------------------<DEBUG>---------------------------------------
 11586D    DISPLAY  CNS-PGM-ID":*** 日付取得処理 END ***"
 11587*-----------------------------------------------------------------
 11588     CONTINUE.
 11589 DATE-GET-EXT.
 11590     EXIT.
 11591******************************************************************
 11592*    3) 期間チェック処理
 11593******************************************************************
 11594 KIKAN-CHECK-RTN        SECTION.
 11595*--------------------<DEBUG>--------------------------------------
 11596D    DISPLAY  CNS-PGM-ID":*** 期間チェック処理START ***"
 11597D    DISPLAY  CNS-PGM-ID":WK-KIKAN-FR-9=["WK-KIKAN-FR-9"]"
 11598D    DISPLAY  CNS-PGM-ID":WK-KIKAN-TO-9=["WK-KIKAN-TO-9"]"
 11599*-----------------------------------------------------------------
 11600     IF  WK-KIKAN-FR-9 > WK-KIKAN-TO-9
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 201
* MUSR2651.cob                                                     cpy)cpy)y)y)
 11601     THEN
 11602*----------  ワークリターンコード
 11603       MOVE  CNS-RTN-BT8            TO  WK-RTN-CODE
 11604*----------  ワーク業務エラーパッケージを編集
 11605       INITIALIZE  WK-GYOMU-ERR-INFO
 11606*---------- 基準日From
 11607       MOVE  WK-KIKAN-FR
 11608         TO  WK-GYOMU-KJN-YMD-FROM  OF  WK-GYOMU-ERR-INFO(CNS-1)
 11609*---------- 基準日To
 11610       MOVE  WK-KIKAN-TO
 11611         TO  WK-GYOMU-KJN-YMD-TO    OF  WK-GYOMU-ERR-INFO(CNS-1)
 11612*---------- メッセージID
 11613       MOVE  CNS-MSG-E000257
 11614         TO  WK-GYOMU-MSG-ID        OF  WK-GYOMU-ERR-INFO(CNS-1)
 11615*---------- 置換文字
 11616       MOVE  CNS-ZAN-KJN-TO
 11617         TO  WK-GYOMU-TK-MOJI
 11618         OF  WK-GYOMU-TIKAN-MOJI
 11619         OF  WK-GYOMU-ERR-INFO(CNS-1,CNS-1)
 11620       MOVE  CNS-ZAN-KJN-FROM
 11621         TO  WK-GYOMU-TK-MOJI
 11622         OF  WK-GYOMU-TIKAN-MOJI
 11623         OF  WK-GYOMU-ERR-INFO(CNS-1,CNS-2)
 11624*----------  後処理業務エラーフラグ
 11625       MOVE  CNS-ON                 TO  FLG-GYOMU-ERR
 11626*----------  後処理
 11627       PERFORM  END-RTN
 11628     ELSE
 11629       CONTINUE
 11630     END-IF
 11631*--------------------<DEBUG>--------------------------------------
 11632D    DISPLAY  CNS-PGM-ID":*** 期間チェック処理END ***"
 11633*-----------------------------------------------------------------
 11634     CONTINUE.
 11635 KIKAN-CHECK-EXT.
 11636     EXIT.
 11637******************************************************************
 11638*    4) 明細取得処理
 11639******************************************************************
 11640 PTF-DETAIL-GET-RTN     SECTION.
 11641*--------------------<DEBUG>--------------------------------------
 11642D    DISPLAY  CNS-PGM-ID":*** 明細取得処理 START ***"
 11643*-----------------------------------------------------------------
 11644*-----------  ファンドコード取得処理
 11645     PERFORM  SCZY4002-RTN
 11646*----------  実行状況管理明細インサート処理
 11647     PERFORM  SCZY7050-RTN
 11648*----------  ＤＢコミット処理
 11649     PERFORM  DB-COMMIT-RTN
 11650*----------  処理対象実行状況管理明細ＧＥＴルーチン
 11651     PERFORM  SCZY7200-RTN
 11652*--------------------<DEBUG>--------------------------------------
 11653D    DISPLAY  CNS-PGM-ID":*** 明細取得処理 END ***"
 11654*-----------------------------------------------------------------
 11655     CONTINUE.
 11656 PTF-DETAIL-GET-EXT.
 11657     EXIT.
 11658******************************************************************
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 202
* MUSR2651.cob                                                     cpy)cpy)y)y)
 11659*    SCZY4002ポートフォリオ明細取得処理
 11660******************************************************************
 11661 SCZY4002-RTN           SECTION.
 11662*--------------------<DEBUG>--------------------------------------
 11663D    DISPLAY  CNS-PGM-ID
 11664D             ":***  ポートフォリオと有効期間取得処理  START  ***"
 11665*-----------------------------------------------------------------
 11666     INITIALIZE  PARM-SCZY4002-INOUT
 11667                 PARM-RTNPKG
 11668*----------  LINK
 11669     MOVE  WK-AIFA
 11670       TO  WK-IN-AIFA             OF  PARM-SCZY4002-AIFA-HEADER
 11671     MOVE  WK-HEADER
 11672       TO  WK-IN-HEADER           OF  PARM-SCZY4002-AIFA-HEADER
 11673*----------  利用会社コー
 11674     MOVE  WK-RIYO-CMP-CD
 11675       TO  RIYO-COMPANY-CODE      OF  PARM-SCZY4002-ARG1
 11676*-------------------<DEBUG>---------------------------------------
 11677D    DISPLAY  CNS-PGM-ID":上り電文.ポートフォリオ区分=["
 11678D             I-PTF-SYORI-KBN     OF  WK-DENBUN-INFO"]"
 11679*-----------------------------------------------------------------
 11680*----------  オール指定1
 11681     EVALUATE  I-PTF-SYORI-KBN    OF  WK-DENBUN-INFO
 11682       WHEN  CNS-X-1
 11683         MOVE  CNS-X-2
 11684           TO  ALL-SITEI-1        OF  PARM-SCZY4002-ARG1
 11685       WHEN  CNS-X-2
 11686         MOVE  CNS-X-1
 11687           TO  ALL-SITEI-1        OF  PARM-SCZY4002-ARG1
 11688       WHEN  OTHER
 11689         CONTINUE
 11690     END-EVALUATE
 11691*------------------ <連結障害211の対応 START>---------------------
 11692     IF  I-PTF-SYORI-KBN  OF  WK-DENBUN-INFO   =  CNS-X-1
 11693     THEN
 11694       INITIALIZE  WK-COUNT-1
 11695                   WK-IDX-K
 11696     MOVE FUNCTION CURRENT-DATE(1:14) TO WK-RUN-SDATETIME
 11697*-------------------<DEBUG>---------------------------------------
 11698     DISPLAY "プログラムID:        ["CNS-PGM-ID"]"                GUT2013
 11699     DISPLAY "セクション:          [SCZY4002-RTN_1]"              GUT2013
 11700     DISPLAY "セクションの開始時間:["WK-RUN-SDATETIME"]"          GUT2013
 11701*-----------------------------------------------------------------
 11702       PERFORM  VARYING  WK-IDX-K  FROM  CNS-1  BY  CNS-1
 11703         UNTIL  WK-IDX-K > CNS-10
 11704         COMPUTE  WK-COUNT-1 = WK-COUNT-1 + CNS-1
 11705*-------------------<DEBUG>---------------------------------------
 11706D    DISPLAY  CNS-PGM-ID":WK-IDX-K=["WK-IDX-K"]"
 11707D    DISPLAY  CNS-PGM-ID":WK-COUNT-1=["WK-COUNT-1"]"
 11708*-----------------------------------------------------------------
 11709*----------  ポートフォリオ区分
 11710         MOVE  I-FUND-PTF-KBN     OF  WK-DENBUN-INFO(WK-IDX-K)
 11711           TO  PTF-KBN        OF  PARM-SCZY4002-ARG1(WK-COUNT-1)
 11712*----------  グループ又はファンドコード
 11713         MOVE  I-FUND-CD          OF  WK-DENBUN-INFO(WK-IDX-K)
 11714           TO  GRP-FUND-CD    OF  PARM-SCZY4002-ARG1(WK-COUNT-1)
 11715*----------  ポートフォリオコード
 11716         MOVE  I-PTF-CD           OF  WK-DENBUN-INFO(WK-IDX-K)
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 203
* MUSR2651.cob                                                     cpy)cpy)y)y)
 11717           TO  PTF-CD         OF  PARM-SCZY4002-ARG1(WK-COUNT-1)
 11718*-------------------<DEBUG>---------------------------------------
 11719D    DISPLAY  CNS-PGM-ID":PTF-KBN OF  PARM-SCZY4002-ARG1("
 11720D             WK-COUNT-1")=["
 11721D             PTF-KBN        OF  PARM-SCZY4002-ARG1(WK-COUNT-1)"]"
 11722D    DISPLAY  CNS-PGM-ID":GRP-FUND-CD  OF  PARM-SCZY4002-ARG1("
 11723D             WK-COUNT-1")=["
 11724D             GRP-FUND-CD    OF  PARM-SCZY4002-ARG1(WK-COUNT-1)"]"
 11725D    DISPLAY  CNS-PGM-ID":PTF-CD   OF  PARM-SCZY4002-ARG1("
 11726D             WK-COUNT-1")=["
 11727D             PTF-CD         OF  PARM-SCZY4002-ARG1(WK-COUNT-1)"]"
 11728*-----------------------------------------------------------------
 11729       END-PERFORM
 11730     MOVE FUNCTION CURRENT-DATE(1:14) TO WK-RUN-EDATETIME
 11731*--------------------<DEBUG>--------------------------------------
 11732     DISPLAY "プログラムID:        ["CNS-PGM-ID"]"                GUT2013
 11733     DISPLAY "セクション:          [SCZY4002-RTN_1]"              GUT2013
 11734     DISPLAY "セクションの終了時間:["WK-RUN-EDATETIME"]"          GUT2013
 11735*-----------------------------------------------------------------
 11736     ELSE
 11737       INITIALIZE  PTF-FUND-LIST  OF  PARM-SCZY4002-ARG1
 11738     END-IF
 11739*------------------ <連結障害211の対応 END>-----------------------
 11740*-------------------<DEBUG>---------------------------------------
 11741D    DISPLAY  CNS-PGM-ID":上り電文.評価系列区分=["
 11742D             I-HYK-KRTU-KBN      OF  WK-DENBUN-INFO"]"
 11743*-----------------------------------------------------------------
 11744*----------  オール指定2
 11745     EVALUATE  I-HYK-KRTU-KBN     OF  WK-DENBUN-INFO
 11746       WHEN  CNS-X-1
 11747         MOVE  CNS-X-3
 11748           TO  ALL-SITEI-2        OF  PARM-SCZY4002-ARG1
 11749       WHEN  CNS-X-2
 11750         MOVE  CNS-X-2
 11751           TO  ALL-SITEI-2        OF  PARM-SCZY4002-ARG1
 11752       WHEN  CNS-X-3
 11753         MOVE  CNS-X-1
 11754           TO  ALL-SITEI-2        OF  PARM-SCZY4002-ARG1
 11755       WHEN  OTHER
 11756         CONTINUE
 11757     END-EVALUATE
 11758*----------  評価系列
 11759     IF  I-HYK-KRTU-KBN           OF  WK-DENBUN-INFO = CNS-X-1
 11760     THEN
 11761     MOVE FUNCTION CURRENT-DATE(1:14) TO WK-RUN-SDATETIME
 11762*-------------------<DEBUG>---------------------------------------
 11763     DISPLAY "プログラムID:        ["CNS-PGM-ID"]"                GUT2013
 11764     DISPLAY "セクション:          [SCZY4002-RTN_2]"              GUT2013
 11765     DISPLAY "セクションの開始時間:["WK-RUN-SDATETIME"]"          GUT2013
 11766*-----------------------------------------------------------------
 11767       PERFORM                  VARYING  WK-IDX-K
 11768         FROM  CNS-1  BY  CNS-1
 11769         UNTIL  WK-IDX-K > CNS-10
 11770*-------------------<DEBUG>---------------------------------------
 11771D    DISPLAY  CNS-PGM-ID":WK-IDX-K=["WK-IDX-K"]"
 11772*-----------------------------------------------------------------
 11773           MOVE  I-HYK-KRTU-CD    OF  WK-DENBUN-INFO(WK-IDX-K)
 11774             TO  HYK-KRTU-CD      OF  PARM-SCZY4002-ARG1(WK-IDX-K)
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 204
* MUSR2651.cob                                                     cpy)cpy)y)y)
 11775*-------------------<DEBUG>---------------------------------------
 11776D    DISPLAY  CNS-PGM-ID":HYK-KRTU-CD("WK-IDX-K")=["
 11777D             HYK-KRTU-CD      OF  PARM-SCZY4002-ARG1(WK-IDX-K)"]"
 11778*-----------------------------------------------------------------
 11779       END-PERFORM
 11780     MOVE FUNCTION CURRENT-DATE(1:14) TO WK-RUN-EDATETIME
 11781*--------------------<DEBUG>--------------------------------------
 11782     DISPLAY "プログラムID:        ["CNS-PGM-ID"]"                GUT2013
 11783     DISPLAY "セクション:          [SCZY4002-RTN_2]"              GUT2013
 11784     DISPLAY "セクションの終了時間:["WK-RUN-EDATETIME"]"          GUT2013
 11785*-----------------------------------------------------------------
 11786     ELSE
 11787       INITIALIZE  HYK-KRTU       OF  PARM-SCZY4002-ARG1
 11788     END-IF
 11789*----------  基準日FROM
 11790     MOVE  WK-KIKAN-FR-9
 11791       TO  KZYN-YMD-FROM          OF  PARM-SCZY4002-ARG1
 11792*----------  基準日TO
 11793     MOVE  WK-KIKAN-TO-9
 11794       TO  KZYN-YMD-TO            OF  PARM-SCZY4002-ARG1
 11795*---------- 権限チェック有無
 11796     MOVE  CNS-X-1
 11797       TO  KGN-CHK-UMU            OF  PARM-SCZY4002-ARG1
 11798*---------- メニューID
 11799     MOVE  MENU-ID                OF  WK-DENBUN-INFO
 11800       TO  MENU-ID                OF  PARM-SCZY4002-ARG1
 11801*---------- 画面アクション区分
 11802     MOVE  CNS-KIDOU-KIRO-A
 11803       TO  GAMEN-ACT-KBN          OF  PARM-SCZY4002-ARG1
 11804*---------- 業務タスクID
 11805     MOVE  WK-GYOMU-TASK-ID       OF  WK-ARGUMENT
 11806       TO  GYOMU-TASK-ID          OF  PARM-SCZY4002-ARG1
 11807*---------- 日中夜間区分
 11808     MOVE  CNS-X-0
 11809       TO  NCHU-YAKN-KBN          OF  PARM-SCZY4002-ARG1
 11810*---------- APL指定出力件数
 11811     MOVE  ZERO
 11812       TO  APL-OUT-CNT            OF  PARM-SCZY4002-ARG1
 11813*--------------------<DEBUG>--------------------------------------
 11814D    DISPLAY  CNS-PGM-ID":SCZY4002-ARG:"
 11815D    DISPLAY  CNS-PGM-ID":AIFA情報=["
 11816D             WK-IN-AIFA          OF  PARM-SCZY4002-AIFA-HEADER"]"
 11817D    DISPLAY  CNS-PGM-ID":共通ヘッダ=["
 11818D             WK-IN-HEADER        OF  PARM-SCZY4002-AIFA-HEADER"]"
 11819D    DISPLAY  CNS-PGM-ID":利用会社コード=["
 11820D             RIYO-COMPANY-CODE   OF  PARM-SCZY4002-ARG1"]"
 11821D    DISPLAY  CNS-PGM-ID":オール指定1=["
 11822D             ALL-SITEI-1         OF  PARM-SCZY4002-ARG1"]"
 11823*------------------ <連結障害211の対応 START>---------------------
 11824D    DISPLAY  CNS-PGM-ID":ポートフォリオ選択リスト=["
 11825D             PTF-FUND-LIST       OF  PARM-SCZY4002-ARG1"]"
 11826*------------------ <連結障害211の対応 END>-----------------------
 11827D    DISPLAY  CNS-PGM-ID":オール指定2=["
 11828D             ALL-SITEI-2         OF  PARM-SCZY4002-ARG1"]"
 11829D    DISPLAY  CNS-PGM-ID":評価系列=["
 11830D             HYK-KRTU            OF  PARM-SCZY4002-ARG1"]"
 11831D    DISPLAY  CNS-PGM-ID":基準日FROM=["
 11832D             KZYN-YMD-FROM       OF  PARM-SCZY4002-ARG1"]"
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 205
* MUSR2651.cob                                                     cpy)cpy)y)y)
 11833D    DISPLAY  CNS-PGM-ID":基準日TO=["
 11834D             KZYN-YMD-TO         OF  PARM-SCZY4002-ARG1"]"
 11835D    DISPLAY  CNS-PGM-ID":権限チェック有無=["
 11836D             KGN-CHK-UMU         OF  PARM-SCZY4002-ARG1"]"
 11837D    DISPLAY  CNS-PGM-ID":メニューID=["
 11838D             MENU-ID             OF  PARM-SCZY4002-ARG1"]"
 11839D    DISPLAY  CNS-PGM-ID":画面アクション区分=["
 11840D             GAMEN-ACT-KBN       OF  PARM-SCZY4002-ARG1"]"
 11841D    DISPLAY  CNS-PGM-ID":業務タスクID=["
 11842D             GYOMU-TASK-ID       OF  PARM-SCZY4002-ARG1"]"
 11843D    DISPLAY  CNS-PGM-ID":日中夜間区分=["
 11844D             NCHU-YAKN-KBN       OF  PARM-SCZY4002-ARG1"]"
 11845D    DISPLAY  CNS-PGM-ID":APL指定出力件数=["
 11846D             APL-OUT-CNT         OF  PARM-SCZY4002-ARG1"]"
 11847D    DISPLAY  CNS-PGM-ID":***  CALL SCZY4002 START  ***"
 11848*-----------------------------------------------------------------
 11849     CALL  "SCZY4002"             USING  PARM-SCZY4002-AIFA-HEADER
 11850                                         PARM-SCZY4002-INOUT
 11851                                         PARM-RTNPKG
 11852*--------------------<DEBUG>--------------------------------------
 11853D    DISPLAY  CNS-PGM-ID":***  CALL SCZY4002 END  ***"
 11854D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY4002)       =["
 11855D             RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)"]"
 11856D    DISPLAY  CNS-PGM-ID":COUNTER OF PARM-RTNPKG =["
 11857D             COUNTER             OF PARM-RTNPKG "]"
 11858*-----------------------------------------------------------------
 11859     EVALUATE  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
 11860       WHEN  CNS-RTN-000
 11861*--------------------<DEBSUG>-------------------------------------
 11862D    DISPLAY  CNS-PGM-ID":ポートフォリオと有効期間取得  正常"
 11863D    DISPLAY  CNS-PGM-ID":HIT-KENSU  OF  PARM-SCZY4002-ARG2=["
 11864D             HIT-KENSU  OF  PARM-SCZY4002-ARG2"]"
 11865*-----------------------------------------------------------------
 11866         IF  HIT-KENSU  OF  PARM-SCZY4002-ARG2 = ZERO
 11867         THEN
 11868           MOVE  CNS-RTN-BT8        TO  WK-RTN-CODE
 11869*----------  ワーク業務エラーパッケージを編集
 11870           INITIALIZE  WK-GYOMU-ERR-INFO
 11871*---------- 基準日From
 11872           MOVE  WK-KIKAN-FR
 11873             TO  WK-GYOMU-KJN-YMD-FROM
 11874               OF  WK-GYOMU-ERR-INFO(CNS-1)
 11875*---------- 基準日To
 11876           MOVE  WK-KIKAN-TO
 11877             TO  WK-GYOMU-KJN-YMD-TO
 11878               OF  WK-GYOMU-ERR-INFO(CNS-1)
 11879*---------- メッセージID
 11880           MOVE  CNS-MSG-E000217
 11881             TO  WK-GYOMU-MSG-ID    OF  WK-GYOMU-ERR-INFO(CNS-1)
 11882*---------- 置換文字
 11883           MOVE  CNS-FUND-PTF
 11884             TO  WK-GYOMU-TK-MOJI
 11885             OF  WK-GYOMU-ERR-INFO(CNS-1,CNS-1)
 11886           MOVE  CNS-ON             TO  FLG-GYOMU-ERR
 11887           PERFORM  END-RTN
 11888         ELSE
 11889           MOVE  PARM-SCZY4002-ARG2 TO  WK-FUND-PTF-DETAIL
 11890         END-IF
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 206
* MUSR2651.cob                                                     cpy)cpy)y)y)
 11891       WHEN  CNS-RTN-002
 11892         MOVE  PARM-SCZY4002-ARG2   TO  WK-FUND-PTF-DETAIL
 11893         MOVE  CNS-RTN-BT2          TO  WK-RTN-CODE
 11894*----------  ワーク業務エラーパッケージを編集
 11895         INITIALIZE  WK-GYOMU-ERR-INFO
 11896*---------- 基準日From
 11897         MOVE  WK-KIKAN-FR
 11898           TO  WK-GYOMU-KJN-YMD-FROM  OF  WK-GYOMU-ERR-INFO(CNS-1)
 11899*---------- 基準日To
 11900         MOVE  WK-KIKAN-TO
 11901           TO  WK-GYOMU-KJN-YMD-TO    OF  WK-GYOMU-ERR-INFO(CNS-1)
 11902*---------- メッセージID
 11903         MOVE  CNS-MSG-W000309
 11904           TO  WK-GYOMU-MSG-ID      OF  WK-GYOMU-ERR-INFO(CNS-1)
 11905*---------- 置換文字
 11906         MOVE  SPACE
 11907           TO  WK-GYOMU-TK-MOJI
 11908           OF  WK-GYOMU-ERR-INFO(CNS-1,CNS-1)
 11909         PERFORM GYOMU-ERR-2-RTN
 11910*------------------ <残タスク159の対応 START>---------------------
 11911       WHEN  CNS-RTN-130
 11912*------------------ <連結障害20090106の対応 START>----------------
 11913*--------------------<DEBSUG>-------------------------------------
 11914D    DISPLAY  CNS-PGM-ID":HIT-KENSU  OF  PARM-SCZY4002-ARG2=["
 11915D             HIT-KENSU  OF  PARM-SCZY4002-ARG2"]"
 11916*-----------------------------------------------------------------
 11917         IF  HIT-KENSU  OF  PARM-SCZY4002-ARG2 = ZERO
 11918         THEN
 11919           MOVE  CNS-RTN-BT8        TO  WK-RTN-CODE
 11920*----------  ワーク業務エラーパッケージを編集
 11921           INITIALIZE  WK-GYOMU-ERR-INFO
 11922*---------- 基準日From
 11923           MOVE  WK-KIKAN-FR
 11924             TO  WK-GYOMU-KJN-YMD-FROM
 11925               OF  WK-GYOMU-ERR-INFO(CNS-1)
 11926*---------- 基準日To
 11927           MOVE  WK-KIKAN-TO
 11928             TO  WK-GYOMU-KJN-YMD-TO
 11929               OF  WK-GYOMU-ERR-INFO(CNS-1)
 11930*---------- メッセージID
 11931           MOVE  CNS-MSG-E000217
 11932             TO  WK-GYOMU-MSG-ID    OF  WK-GYOMU-ERR-INFO(CNS-1)
 11933*---------- 置換文字
 11934           MOVE  CNS-FUND-PTF
 11935             TO  WK-GYOMU-TK-MOJI
 11936             OF  WK-GYOMU-ERR-INFO(CNS-1,CNS-1)
 11937*---------- 基準日From
 11938           MOVE  WK-KIKAN-FR
 11939             TO  WK-GYOMU-KJN-YMD-FROM
 11940               OF  WK-GYOMU-ERR-INFO(CNS-2)
 11941*---------- 基準日To
 11942           MOVE  WK-KIKAN-TO
 11943             TO  WK-GYOMU-KJN-YMD-TO
 11944               OF  WK-GYOMU-ERR-INFO(CNS-2)
 11945*---------- メッセージID
 11946           MOVE  CNS-MSG-E000534
 11947             TO  WK-GYOMU-MSG-ID    OF  WK-GYOMU-ERR-INFO(CNS-2)
 11948*---------- 置換文字
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 207
* MUSR2651.cob                                                     cpy)cpy)y)y)
 11949           MOVE  SPACE
 11950             TO  WK-GYOMU-TK-MOJI
 11951             OF  WK-GYOMU-ERR-INFO(CNS-2,CNS-1)
 11952           MOVE  CNS-ON             TO  FLG-GYOMU-ERR
 11953           PERFORM  END-RTN
 11954         ELSE
 11955*----------  ワークリターンコード
 11956           MOVE  CNS-RTN-BT4        TO  WK-RTN-CODE
 11957*----------  ワーク業務エラーパッケージを編集
 11958           INITIALIZE  WK-GYOMU-ERR-INFO
 11959*---------- 基準日From
 11960           MOVE  WK-KIKAN-FR
 11961             TO  WK-GYOMU-KJN-YMD-FROM OF WK-GYOMU-ERR-INFO(CNS-1)
 11962*---------- 基準日To
 11963           MOVE  WK-KIKAN-TO
 11964             TO  WK-GYOMU-KJN-YMD-TO   OF WK-GYOMU-ERR-INFO(CNS-1)
 11965*---------- メッセージID
 11966           MOVE  CNS-MSG-E000534
 11967             TO  WK-GYOMU-MSG-ID    OF  WK-GYOMU-ERR-INFO(CNS-1)
 11968*---------- 置換文字
 11969           MOVE  SPACE
 11970             TO  WK-GYOMU-TK-MOJI
 11971             OF  WK-GYOMU-ERR-INFO(CNS-1,CNS-1)
 11972*--------------------<DEBUG>--------------------------------------
 11973D    DISPLAY  CNS-PGM-ID":W.メッセージID=["
 11974D             WK-GYOMU-MSG-ID     OF  WK-GYOMU-ERR-INFO(CNS-1)"]"
 11975D    DISPLAY  CNS-PGM-ID":W.置換文字=["WK-GYOMU-TK-MOJI
 11976D             OF  WK-GYOMU-ERR-INFO(CNS-1,CNS-1)"]"
 11977*-----------------------------------------------------------------
 11978           PERFORM  GYOMU-ERR-2-RTN
 11979           MOVE  PARM-SCZY4002-ARG2 TO  WK-FUND-PTF-DETAIL
 11980         END-IF
 11981*------------------ <連結障害20090106の対応 END>------------------
 11982*------------------ <残タスク159の対応 END>-----------------------
 11983       WHEN  CNS-RTN-800
 11984         MOVE  CNS-RTN-BT8          TO  WK-RTN-CODE
 11985*----------  ワーク業務エラーパッケージを編集
 11986         INITIALIZE  WK-GYOMU-ERR-INFO
 11987*---------- 基準日From
 11988         MOVE  WK-KIKAN-FR
 11989           TO  WK-GYOMU-KJN-YMD-FROM  OF  WK-GYOMU-ERR-INFO(CNS-1)
 11990*---------- 基準日To
 11991         MOVE  WK-KIKAN-TO
 11992           TO  WK-GYOMU-KJN-YMD-TO    OF  WK-GYOMU-ERR-INFO(CNS-1)
 11993*---------- メッセージID
 11994         MOVE  CNS-MSG-E000189
 11995           TO  WK-GYOMU-MSG-ID      OF  WK-GYOMU-ERR-INFO(CNS-1)
 11996*---------- 置換文字
 11997         MOVE  SPACE
 11998           TO  WK-GYOMU-TK-MOJI
 11999           OF  WK-GYOMU-ERR-INFO(CNS-1,CNS-1)
 12000           MOVE  CNS-ON             TO  FLG-GYOMU-ERR
 12001           PERFORM  END-RTN
 12002       WHEN  OTHER
 12003*--------------------<DEBUG>--------------------------------------
 12004D    DISPLAY  CNS-PGM-ID":ポートフォリオと有効期間取得  エラー"
 12005*-----------------------------------------------------------------
 12006*----------  ワークリターンコード
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 208
* MUSR2651.cob                                                     cpy)cpy)y)y)
 12007         MOVE  CNS-RTN-BT16         TO  WK-RTN-CODE
 12008*----------  ワークエラーパッケージを編集
 12009         MOVE  PARM-RTNPKG          TO  PARM-SCZY1170-RTNPKG
 12010         INITIALIZE  WK-SYS-ERR-INFO
 12011*----------  エラー検知プログラムID
 12012         MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
 12013*----------  ポジション
 12014         MOVE  CNS-POS-012          TO  WK-ERR-POS
 12015*----------  リターンコード
 12016         MOVE  CNS-RTN-901          TO  WK-RTN-CD
 12017*----------  詳細リターンコード
 12018         MOVE  RTN-CD               OF  PARM-RTNPKG
 12019                                      (COUNTER OF PARM-RTNPKG)
 12020                                    TO  WK-DETAIL-RTN-CD
 12021*----------  詳細リターンコードデコードフラグ
 12022         MOVE  CNS-DETAIL-0         TO  WK-DETAIL-RTN-CD-FLG
 12023*---------- フリーメッセージ
 12024         MOVE  SPACE                TO  WK-FREE-MSG
 12025*----------  エラー処理
 12026         PERFORM  ERR-RTN
 12027     END-EVALUATE
 12028*--------------------<DEBUG>--------------------------------------
 12029D    DISPLAY  CNS-PGM-ID
 12030D             ":***  ポートフォリオと有効期間取得処理  END  ***"
 12031*-----------------------------------------------------------------
 12032     CONTINUE.
 12033 SCZY4002-EXT.
 12034     EXIT.
 12035******************************************************************
 12036*    実行状況管理明細インサート処理
 12037******************************************************************
 12038 SCZY7050-RTN           SECTION.
 12039*--------------------<DEBUG>--------------------------------------
 12040D    DISPLAY  CNS-PGM-ID":*** 実行状況管理明細インサート処理"
 12041D             " START ***"
 12042*-----------------------------------------------------------------
 12043     INITIALIZE  PARM-SCZY7050-IN
 12044                   PARM-RTNPKG
 12045*----------  利用会社コード
 12046     MOVE  WK-RIYO-CMP-CD
 12047       TO  RIYO-CMP-CD              OF PARM-SCZY7050-ARG1
 12048*----------  処理実行日
 12049     MOVE  WK-SHORI-YMD-9
 12050       TO  SYORI-YMD                OF PARM-SCZY7050-ARG1
 12051*----------  起動ID
 12052     MOVE  WK-KIDOU-ID
 12053       TO  KIDOU-ID                 OF PARM-SCZY7050-ARG1
 12054*---------  業務タスクID
 12055     MOVE  WK-GYOMU-TASK-ID         OF  WK-ARGUMENT
 12056       TO  GYOMU-TASK-ID            OF  PARM-SCZY7050-ARG1
 12057*---------  基準日From
 12058     MOVE  WK-KIKAN-FR
 12059       TO  KJN-YMD-FROM             OF  PARM-SCZY7050-ARG1
 12060*---------  基準日To
 12061     MOVE  WK-KIKAN-TO
 12062       TO  KJN-YMD-TO               OF  PARM-SCZY7050-ARG1
 12063*--------------------<DEBUG>--------------------------------------
 12064D    DISPLAY  CNS-PGM-ID":SCZY7050-ARG:"
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 209
* MUSR2651.cob                                                     cpy)cpy)y)y)
 12065D    DISPLAY  CNS-PGM-ID":利用会社コード=["
 12066D             RIYO-CMP-CD           OF  PARM-SCZY7050-ARG1"]"
 12067D    DISPLAY  CNS-PGM-ID":処理実行日=["
 12068D             SYORI-YMD             OF  PARM-SCZY7050-ARG1"]"
 12069D    DISPLAY  CNS-PGM-ID":起動ID=["
 12070D             KIDOU-ID              OF  PARM-SCZY7050-ARG1"]"
 12071D    DISPLAY  CNS-PGM-ID":業務タスクID=["
 12072D             GYOMU-TASK-ID         OF  PARM-SCZY7050-ARG1"]"
 12073D    DISPLAY  CNS-PGM-ID":ファンドコード=["
 12074D             FUND-CD               OF  PARM-SCZY7050-ARG1"]"
 12075D    DISPLAY  CNS-PGM-ID":ポートフォリオコード=["
 12076D             PTF-CD                OF  PARM-SCZY7050-ARG1"]"
 12077D    DISPLAY  CNS-PGM-ID":評価系列コード=["
 12078D             HYK-KRTU-CD           OF  PARM-SCZY7050-ARG1"]"
 12079D    DISPLAY  CNS-PGM-ID":帳票ID=["
 12080D             REP-ID                OF  PARM-SCZY7050-ARG1"]"
 12081D    DISPLAY  CNS-PGM-ID":帳票任意コード=["
 12082D             REP-ANY-CD            OF  PARM-SCZY7050-ARG1"]"
 12083D    DISPLAY  CNS-PGM-ID":基準日From=["
 12084D             KJN-YMD-FROM          OF  PARM-SCZY7050-ARG1"]"
 12085D    DISPLAY  CNS-PGM-ID":基準日To=["
 12086D             KJN-YMD-TO            OF  PARM-SCZY7050-ARG1"]"
 12087D    DISPLAY  CNS-PGM-ID":***  CALL SCZY7050 START  ***"
 12088*-----------------------------------------------------------------
 12089     CALL  "SCZY7050"             USING  PARM-SCZY7050-IN
 12090                                         PARM-RTNPKG
 12091*--------------------<DEBUG>--------------------------------------
 12092D    DISPLAY  CNS-PGM-ID":***  CALL SCZY7050 END  ***"
 12093D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY7050)       =["
 12094D             RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)"]"
 12095D    DISPLAY  CNS-PGM-ID":COUNTER OF PARM-RTNPKG =["
 12096D             COUNTER               OF PARM-RTNPKG "]"
 12097*-----------------------------------------------------------------
 12098     IF  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
 12099      =  CNS-RTN-000
 12100     THEN
 12101       CONTINUE
 12102*--------------------<DEBSUG>-------------------------------------
 12103D    DISPLAY  CNS-PGM-ID":実行状況管理明細インサート処理  正常"
 12104*-----------------------------------------------------------------
 12105     ELSE
 12106*--------------------<DEBUG>--------------------------------------
 12107D    DISPLAY  CNS-PGM-ID":実行状況管理明細インサート処理  エラー"
 12108*-----------------------------------------------------------------
 12109*----------  ワークリターンコード
 12110       MOVE  CNS-RTN-BT16           TO  WK-RTN-CODE
 12111*----------  ワークエラーパッケージを編集
 12112       MOVE  PARM-RTNPKG            TO  PARM-SCZY1170-RTNPKG
 12113       INITIALIZE  WK-SYS-ERR-INFO
 12114*----------  エラー検知プログラムID
 12115       MOVE  CNS-PGM-ID             TO  WK-ERR-PGM-ID
 12116*----------  ポジション
 12117       MOVE  CNS-POS-013            TO  WK-ERR-POS
 12118*----------  リターンコード
 12119       MOVE  CNS-RTN-901            TO  WK-RTN-CD
 12120*----------  詳細リターンコード
 12121       MOVE  RTN-CD                 OF  PARM-RTNPKG
 12122                                      (COUNTER OF PARM-RTNPKG)
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 210
* MUSR2651.cob                                                     cpy)cpy)y)y)
 12123                                    TO  WK-DETAIL-RTN-CD
 12124*----------  詳細リターンコードデコードフラグ
 12125       MOVE  CNS-DETAIL-0           TO  WK-DETAIL-RTN-CD-FLG
 12126*---------- フリーメッセージ
 12127       MOVE  SPACE                  TO  WK-FREE-MSG
 12128*----------  エラー処理
 12129       PERFORM  ERR-RTN
 12130     END-IF
 12131*--------------------<DEBUG>--------------------------------------
 12132D    DISPLAY  CNS-PGM-ID":*** 実行状況管理明細インサート処理"
 12133D             " END ***"
 12134*-----------------------------------------------------------------
 12135     CONTINUE.
 12136 SCZY7050-EXT.
 12137     EXIT.
 12138******************************************************************
 12139*     実行状況更新処理1
 12140******************************************************************
 12141 STATUS-KOUSIN-1-RTN    SECTION.
 12142*--------------------<DEBUG>--------------------------------------
 12143D    DISPLAY  CNS-PGM-ID":***  実行状況更新処理1 START  ***"
 12144*----------------------------------------------------------------
 12145     INITIALIZE  PARM-SCZY7210-INOUT
 12146                 PARM-RTNPKG
 12147*----------  セッション区分
 12148     MOVE  CNS-X-0
 12149       TO  SESSION-KBN            OF  PARM-SCZY7210-ARG1
 12150*----------  利用会社コード
 12151     MOVE  WK-RIYO-CMP-CD
 12152       TO  RIYO-CMP-CD            OF  PARM-SCZY7210-ARG2
 12153*----------  処理実行日
 12154     MOVE  WK-SHORI-YMD-9
 12155       TO  SYORI-YMD              OF  PARM-SCZY7210-ARG2
 12156*----------  起動ID
 12157     MOVE  WK-KIDOU-ID
 12158       TO  KIDOU-ID               OF  PARM-SCZY7210-ARG2
 12159*----------  実行ステータス
 12160     MOVE  SPACE
 12161       TO  JIKOU-STS              OF  PARM-SCZY7210-ARG2
 12162*----------  基準日FROM
 12163     MOVE  WK-KIKAN-FR-9
 12164       TO  KJN-YMD-FROM           OF  PARM-SCZY7210-ARG2
 12165*--------------------<DEBUG>-------------------------------------
 12166D    DISPLAY  CNS-PGM-ID":SCZY7210-ARG:"
 12167D    DISPLAY  CNS-PGM-ID":SESSION-KBN   =["
 12168D             SESSION-KBN         OF  PARM-SCZY7210-ARG1"]"
 12169D    DISPLAY  CNS-PGM-ID":RIYO-CMP-CD   =["
 12170D             RIYO-CMP-CD         OF  PARM-SCZY7210-ARG2"]"
 12171D    DISPLAY  CNS-PGM-ID":SYORI-YMD     =["
 12172D             SYORI-YMD           OF  PARM-SCZY7210-ARG2"]"
 12173D    DISPLAY  CNS-PGM-ID":KIDOU-ID      =["
 12174D             KIDOU-ID            OF  PARM-SCZY7210-ARG2"]"
 12175D    DISPLAY  CNS-PGM-ID":JIKOU-STS     =["
 12176D             JIKOU-STS           OF  PARM-SCZY7210-ARG2"]"
 12177D    DISPLAY  CNS-PGM-ID":KJN-YMD-FROM =["
 12178D             KJN-YMD-FROM        OF  PARM-SCZY7210-ARG2"]"
 12179D    DISPLAY  CNS-PGM-ID":***  CALL SCZY7210 START  ***"
 12180*----------------------------------------------------------------
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 211
* MUSR2651.cob                                                     cpy)cpy)y)y)
 12181     CALL  "SCZY7210"             USING  PARM-SCZY7210-INOUT
 12182                                         PARM-RTNPKG
 12183*--------------------<DEBUG>-------------------------------------
 12184D    DISPLAY  CNS-PGM-ID":***  CALL SCZY7210 END  ***"
 12185D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY7210)       =["
 12186D             RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)"]"
 12187D    DISPLAY  CNS-PGM-ID":COUNTER OF PARM-RTNPKG =["
 12188D             COUNTER             OF PARM-RTNPKG "]"
 12189*----------------------------------------------------------------
 12190     IF  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
 12191      =  CNS-RTN-000
 12192     THEN
 12193*--------------------<DEBSUG>------------------------------------
 12194D    DISPLAY  CNS-PGM-ID":実行状況更新処理1  正常"
 12195*----------------------------------------------------------------
 12196*----------  ＤＢコミット処理
 12197       PERFORM  DB-COMMIT-RTN
 12198*--------------------<DEBSUG>------------------------------------
 12199D    DISPLAY  CNS-PGM-ID":CONTINUE-KBN   =["
 12200D             CONTINUE-KBN        OF  PARM-SCZY7210-ARG3"]"
 12201*----------------------------------------------------------------
 12202*----------  実行可能区分
 12203       EVALUATE  CONTINUE-KBN OF PARM-SCZY7210-ARG3
 12204         WHEN  CNS-X-0
 12205           CONTINUE
 12206         WHEN  CNS-X-1
 12207*--------------------<DEBSUG>-------------------------------------
 12208D    DISPLAY  CNS-PGM-ID":実行状況管理停止判断正常且つ一時停止"
 12209*-----------------------------------------------------------------
 12210*----------  ワークリターンコード
 12211           IF  WK-RTN-CODE < CNS-10
 12212           THEN
 12213             MOVE  CNS-10        TO  WK-RTN-CODE
 12214           ELSE
 12215             CONTINUE
 12216           END-IF
 12217*---------- ファンドコード
 12218           MOVE  SPACE
 12219             TO  WK-GYOMU-FUND-CD     OF  WK-GYOMU-ERR-INFO(CNS-1)
 12220*---------- ポートフォリオコード
 12221           MOVE  SPACE
 12222             TO  WK-GYOMU-PTF-CD      OF  WK-GYOMU-ERR-INFO(CNS-1)
 12223*---------- 評価系列コード
 12224           MOVE  SPACE
 12225             TO  WK-GYOMU-HYK-KRTU-CD OF  WK-GYOMU-ERR-INFO(CNS-1)
 12226*---------- メッセージID
 12227           MOVE  CNS-MSG-E000451
 12228             TO  WK-GYOMU-MSG-ID      OF  WK-GYOMU-ERR-INFO(CNS-1)
 12229*---------- 基準日From
 12230         MOVE  WK-KIKAN-FR
 12231           TO  WK-GYOMU-KJN-YMD-FROM  OF  WK-GYOMU-ERR-INFO(CNS-1)
 12232*---------- 基準日To
 12233         MOVE  WK-KIKAN-TO
 12234           TO  WK-GYOMU-KJN-YMD-TO    OF  WK-GYOMU-ERR-INFO(CNS-1)
 12235*---------- 置換文字
 12236           MOVE  SPACE
 12237             TO  WK-GYOMU-TK-MOJI(CNS-1,CNS-1)
 12238*---------- フリーメッセージ
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 212
* MUSR2651.cob                                                     cpy)cpy)y)y)
 12239           MOVE  SPACE
 12240             TO  WK-GYOMU-FREE-MSG    OF  WK-GYOMU-ERR-INFO(CNS-1)
 12241           MOVE  CNS-ON               TO  FLG-GYOMU-ERR
 12242*----------  後処理
 12243           PERFORM  END-RTN
 12244         WHEN  CNS-X-2
 12245*--------------------<DEBSUG>-------------------------------------
 12246D    DISPLAY  CNS-PGM-ID":実行状況管理停止判断正常且つ強制停止"
 12247*-----------------------------------------------------------------
 12248*----------  ワークリターンコード
 12249           IF  WK-RTN-CODE < CNS-8
 12250           THEN
 12251             MOVE  CNS-8           TO  WK-RTN-CODE
 12252           ELSE
 12253             CONTINUE
 12254           END-IF
 12255*---------- ファンドコード
 12256           MOVE  SPACE
 12257             TO  WK-GYOMU-FUND-CD     OF  WK-GYOMU-ERR-INFO(CNS-1)
 12258*---------- ポートフォリオコード
 12259           MOVE  SPACE
 12260             TO  WK-GYOMU-PTF-CD      OF  WK-GYOMU-ERR-INFO(CNS-1)
 12261*---------- 評価系列コード
 12262         MOVE  SPACE
 12263           TO  WK-GYOMU-HYK-KRTU-CD   OF  WK-GYOMU-ERR-INFO(CNS-1)
 12264*---------- メッセージID
 12265           MOVE  CNS-MSG-E000431
 12266             TO  WK-GYOMU-MSG-ID      OF  WK-GYOMU-ERR-INFO(CNS-1)
 12267*---------- 基準日From
 12268         MOVE  WK-KIKAN-FR
 12269           TO  WK-GYOMU-KJN-YMD-FROM  OF  WK-GYOMU-ERR-INFO(CNS-1)
 12270*---------- 基準日To
 12271         MOVE  WK-KIKAN-TO
 12272           TO  WK-GYOMU-KJN-YMD-TO    OF  WK-GYOMU-ERR-INFO(CNS-1)
 12273*---------- 置換文字
 12274           MOVE  SPACE
 12275             TO  WK-GYOMU-TK-MOJI(CNS-1,CNS-1)
 12276*---------- フリーメッセージ
 12277           MOVE  SPACE
 12278             TO  WK-GYOMU-FREE-MSG    OF  WK-GYOMU-ERR-INFO(CNS-1)
 12279           MOVE  CNS-ON               TO  FLG-GYOMU-ERR
 12280*----------  後処理
 12281           PERFORM  END-RTN
 12282         WHEN  CNS-X-3
 12283           PERFORM  END-RTN
 12284         WHEN OTHER
 12285           CONTINUE
 12286       END-EVALUATE
 12287     ELSE
 12288*--------------------<DEBUG>--------------------------------------
 12289D    DISPLAY  CNS-PGM-ID":実行状況更新処理1 システムエラー"
 12290*-----------------------------------------------------------------
 12291*----------  ワークリターンコード
 12292       MOVE  CNS-16               TO  WK-RTN-CODE
 12293*----------  ワークエラーパッケージを編集
 12294       MOVE  PARM-RTNPKG          TO  PARM-SCZY1170-RTNPKG
 12295       INITIALIZE  WK-SYS-ERR-INFO
 12296*----------  エラー検知プログラムID
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 213
* MUSR2651.cob                                                     cpy)cpy)y)y)
 12297       MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
 12298*----------  ポジション
 12299       MOVE  CNS-POS-014          TO  WK-ERR-POS
 12300*----------  リターンコード
 12301       MOVE  CNS-RTN-901          TO  WK-RTN-CD
 12302*----------  詳細リターンコード
 12303       MOVE  RTN-CD               OF  PARM-RTNPKG
 12304                                      (COUNTER OF PARM-RTNPKG)
 12305                                  TO  WK-DETAIL-RTN-CD
 12306*----------  詳細リターンコードデコードフラグ
 12307       MOVE  CNS-DETAIL-0         TO  WK-DETAIL-RTN-CD-FLG
 12308*---------- フリーメッセージ
 12309       MOVE  SPACE                TO  WK-FREE-MSG
 12310*----------  エラー処理
 12311       PERFORM  ERR-RTN
 12312     END-IF
 12313*--------------------<DEBUG>-------------------------------------
 12314D    DISPLAY  CNS-PGM-ID":***  実行状況更新処理1 END  ***"
 12315*-----------------------------------------------------------------
 12316     CONTINUE.
 12317 STATUS-KOUSIN-1-EXT.
 12318     EXIT.
 12319******************************************************************
 12320*    3.2.3.１行目にヘッダーの出力処理
 12321******************************************************************
 12322 HEADER-OUT-RTN         SECTION.
 12323*--------------------<DEBUG>--------------------------------------
 12324D    DISPLAY  CNS-PGM-ID":*** ヘッダーの出力処理START ***"
 12325*-----------------------------------------------------------------
 12326*------------------ <連結障害1077の対応 START>--------------------
 12327*----------  約定ファイルデータ出力処理
 12328     IF  I-FLG-KEISAN OF WK-DENBUN-INFO  = CNS-0
 12329     THEN
 12330*------------------ <連結障害493の対応 START>---------------------
 12331       INITIALIZE  DAT-REC
 12332*------------------ <連結障害493の対応 END>-----------------------
 12333                   WK-HEADER-TITLE
 12334       MOVE  WK-KIKAN-TO-9
 12335         TO  WK-KJN-YMD                 OF  WK-HEADER-TITLE
 12336       MOVE  CNS-X-0
 12337         TO  WK-Y-U-FLG                 OF  WK-HEADER-TITLE
 12338*------------------ <連結障害493の対応 START>---------------------
 12339       MOVE  WK-HEADER-TITLE            TO  DAT-REC
 12340*------------------ <連結障害493の対応 END>-----------------------
 12341*-------------------<DEBUG>---------------------------------------
 12342D    DISPLAY  CNS-PGM-ID":DAT-REC = ["DAT-REC"]"
 12343*-----------------------------------------------------------------
 12344       PERFORM  DATA-WRITE1-RTN
 12345*------------------ <連結障害493の対応 START>---------------------
 12346       INITIALIZE  DAT-REC2
 12347*------------------ <連結障害493の対応 END>-----------------------
 12348                   WK-HEADER-TITLE
 12349       MOVE  WK-KIKAN-TO-9
 12350         TO  WK-KJN-YMD                 OF  WK-HEADER-TITLE
 12351       MOVE  CNS-X-1
 12352         TO  WK-Y-U-FLG                 OF  WK-HEADER-TITLE
 12353*------------------ <連結障害493の対応 START>---------------------
 12354       MOVE  WK-HEADER-TITLE            TO  DAT-REC2
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 214
* MUSR2651.cob                                                     cpy)cpy)y)y)
 12355*------------------ <連結障害493の対応 END>-----------------------
 12356*-------------------<DEBUG>---------------------------------------
 12357D    DISPLAY  CNS-PGM-ID":DAT-REC2 = ["DAT-REC2"]"
 12358*-----------------------------------------------------------------
 12359       PERFORM  DATA-WRITE2-RTN
 12360       INITIALIZE  DAT-REC5
 12361                   WK-HEADER-TITLE
 12362       MOVE  WK-KIKAN-TO-9
 12363         TO  WK-KJN-YMD                 OF  WK-HEADER-TITLE
 12364       MOVE  CNS-X-0
 12365         TO  WK-Y-U-FLG                 OF  WK-HEADER-TITLE
 12366       MOVE  WK-HEADER-TITLE            TO  DAT-REC5
 12367*-------------------<DEBUG>---------------------------------------
 12368D    DISPLAY  CNS-PGM-ID":DAT-REC5 = ["DAT-REC5"]"
 12369*-----------------------------------------------------------------
 12370       PERFORM  DATA-WRITE5-RTN
 12371       INITIALIZE  DAT-REC6
 12372                   WK-HEADER-TITLE
 12373       MOVE  WK-KIKAN-TO-9
 12374         TO  WK-KJN-YMD                 OF  WK-HEADER-TITLE
 12375       MOVE  CNS-X-1
 12376         TO  WK-Y-U-FLG                 OF  WK-HEADER-TITLE
 12377       MOVE  WK-HEADER-TITLE            TO  DAT-REC6
 12378*-------------------<DEBUG>---------------------------------------
 12379D    DISPLAY  CNS-PGM-ID":DAT-REC6 = ["DAT-REC6"]"
 12380*-----------------------------------------------------------------
 12381       PERFORM  DATA-WRITE6-RTN
 12382     ELSE
 12383       CONTINUE
 12384     END-IF
 12385*----------  約定ファイルデータ03出力処理
 12386     IF  I-FLG-KEISAN OF WK-DENBUN-INFO  = CNS-1
 12387     THEN
 12388       INITIALIZE  DAT-REC3
 12389                   WK-HEADER-TITLE
 12390       MOVE  WK-KIKAN-TO-9
 12391         TO  WK-KJN-YMD                 OF  WK-HEADER-TITLE
 12392       MOVE  CNS-X-0
 12393         TO  WK-Y-U-FLG                 OF  WK-HEADER-TITLE
 12394       MOVE  WK-HEADER-TITLE            TO  DAT-REC3
 12395*-------------------<DEBUG>---------------------------------------
 12396D    DISPLAY  CNS-PGM-ID":DAT-REC3 = ["DAT-REC3"]"
 12397*-----------------------------------------------------------------
 12398       PERFORM  DATA-WRITE3-RTN
 12399       INITIALIZE  DAT-REC4
 12400                   WK-HEADER-TITLE
 12401       MOVE  WK-KIKAN-TO-9
 12402         TO  WK-KJN-YMD                 OF  WK-HEADER-TITLE
 12403       MOVE  CNS-X-1
 12404         TO  WK-Y-U-FLG                 OF  WK-HEADER-TITLE
 12405       MOVE  WK-HEADER-TITLE            TO  DAT-REC4
 12406*-------------------<DEBUG>---------------------------------------
 12407D    DISPLAY  CNS-PGM-ID":DAT-REC4 = ["DAT-REC4"]"
 12408*-----------------------------------------------------------------
 12409       PERFORM  DATA-WRITE4-RTN
 12410       INITIALIZE  DAT-REC7
 12411                   WK-HEADER-TITLE
 12412       MOVE  WK-KIKAN-TO-9
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 215
* MUSR2651.cob                                                     cpy)cpy)y)y)
 12413         TO  WK-KJN-YMD                 OF  WK-HEADER-TITLE
 12414       MOVE  CNS-X-0
 12415         TO  WK-Y-U-FLG                 OF  WK-HEADER-TITLE
 12416       MOVE  WK-HEADER-TITLE            TO  DAT-REC7
 12417*-------------------<DEBUG>---------------------------------------
 12418D    DISPLAY  CNS-PGM-ID":DAT-REC7 = ["DAT-REC7"]"
 12419*-----------------------------------------------------------------
 12420       PERFORM  DATA-WRITE7-RTN
 12421       INITIALIZE  DAT-REC8
 12422                   WK-HEADER-TITLE
 12423       MOVE  WK-KIKAN-TO-9
 12424         TO  WK-KJN-YMD                 OF  WK-HEADER-TITLE
 12425       MOVE  CNS-X-1
 12426         TO  WK-Y-U-FLG                 OF  WK-HEADER-TITLE
 12427       MOVE  WK-HEADER-TITLE            TO  DAT-REC8
 12428*-------------------<DEBUG>---------------------------------------
 12429D    DISPLAY  CNS-PGM-ID":DAT-REC8 = ["DAT-REC8"]"
 12430*-----------------------------------------------------------------
 12431       PERFORM  DATA-WRITE8-RTN
 12432     ELSE
 12433       CONTINUE
 12434     END-IF
 12435*------------------ <連結障害1077の対応 END>----------------------
 12436*--------------------<DEBUG>--------------------------------------
 12437D    DISPLAY  CNS-PGM-ID":*** ヘッダーの出力処理END ***"
 12438*-----------------------------------------------------------------
 12439     CONTINUE.
 12440 HEADER-OUT-EXT.
 12441     EXIT.
 12442******************************************************************
 12443*    フッターをダウンロードファイルに書き
 12444******************************************************************
 12445 FOOT-OUT-RTN           SECTION.
 12446*--------------------<DEBUG>--------------------------------------
 12447D    DISPLAY  CNS-PGM-ID":*** フッターをダウンロードファイルに"
 12448D             "書きSTART ***"
 12449D    DISPLAY  CNS-PGM-ID":WK-WRITE-KENSUU:["WK-WRITE-KENSUU"]"
 12450D    DISPLAY  CNS-PGM-ID":WK-WRITE-KENSUU2:["WK-WRITE-KENSUU2"]"
 12451D    DISPLAY  CNS-PGM-ID":WK-WRITE-KENSUU3:["WK-WRITE-KENSUU3"]"
 12452D    DISPLAY  CNS-PGM-ID":WK-WRITE-KENSUU4:["WK-WRITE-KENSUU4"]"
 12453D    DISPLAY  CNS-PGM-ID":WK-WRITE-KENSUU5:["WK-WRITE-KENSUU5"]"
 12454D    DISPLAY  CNS-PGM-ID":WK-WRITE-KENSUU6:["WK-WRITE-KENSUU6"]"
 12455D    DISPLAY  CNS-PGM-ID":WK-WRITE-KENSUU7:["WK-WRITE-KENSUU7"]"
 12456D    DISPLAY  CNS-PGM-ID":WK-WRITE-KENSUU8:["WK-WRITE-KENSUU8"]"
 12457D    DISPLAY  CNS-PGM-ID":WK-CASH-FLOW-KBN=["WK-CASH-FLOW-KBN"]"
 12458D    DISPLAY  CNS-PGM-ID":I-FLG-KEISAN:["
 12459D             I-FLG-KEISAN OF WK-DENBUN-INFO"]"
 12460*-----------------------------------------------------------------
 12461*------------------ <連結障害1077の対応 START>--------------------
 12462*----------  約定ファイルデータ出力処理
 12463*------------------ <連結障害493の対応 START>---------------------
 12464     IF  WK-WRITE-KENSUU > ZERO OR WK-WRITE-KENSUU3 > ZERO
 12465       OR  WK-WRITE-KENSUU5 > ZERO OR  WK-WRITE-KENSUU7 > ZERO
 12466     THEN
 12467       INITIALIZE  DAT-REC
 12468                   DAT-REC3
 12469                   DAT-REC5
 12470                   DAT-REC7
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 216
* MUSR2651.cob                                                     cpy)cpy)y)y)
 12471*------------------ <連結障害493の対応 END>-----------------------
 12472                   WK-FOOT
 12473                   WK-WRITE-TEMP
 12474                   WK-WRITE-TEMP3
 12475       IF  I-FLG-KEISAN OF WK-DENBUN-INFO  = CNS-0
 12476       THEN
 12477         COMPUTE  WK-WRITE-TEMP = WK-WRITE-KENSUU - CNS-1
 12478         COMPUTE  WK-WRITE-TEMP3 = WK-WRITE-KENSUU5 - CNS-1
 12479       ELSE
 12480         COMPUTE  WK-WRITE-TEMP = WK-WRITE-KENSUU3 - CNS-1
 12481         COMPUTE  WK-WRITE-TEMP3 = WK-WRITE-KENSUU7 - CNS-1
 12482       END-IF
 12483       MOVE  WK-WRITE-TEMP
 12484         TO  WK-18-18-X
 12485       PERFORM  ZERO-COMPUTE-RTN
 12486       COMPUTE  WK-NUM-LENGTH = 18 - WK-NUM-1
 12487       MOVE  WK-18-18-X(WK-NUM-FROM:WK-NUM-LENGTH)
 12488         TO  WK-FILE-KENSUU          OF  WK-FOOT
 12489       IF  I-FLG-KEISAN OF WK-DENBUN-INFO  = CNS-0
 12490       THEN
 12491*------------------ <連結障害493の対応 START>---------------------
 12492         MOVE  WK-FOOT                 TO  DAT-REC
 12493*------------------ <連結障害493の対応 END>-----------------------
 12494         PERFORM  DATA-WRITE-RTN
 12495       ELSE
 12496         MOVE  WK-FOOT                 TO  DAT-REC3
 12497         PERFORM  DATA-WRITE-3-RTN
 12498       END-IF
 12499       MOVE  WK-WRITE-TEMP3
 12500         TO  WK-18-18-X
 12501       PERFORM  ZERO-COMPUTE-RTN
 12502       COMPUTE  WK-NUM-LENGTH = 18 - WK-NUM-1
 12503       MOVE  WK-18-18-X(WK-NUM-FROM:WK-NUM-LENGTH)
 12504         TO  WK-FILE-KENSUU          OF  WK-FOOT
 12505       IF  I-FLG-KEISAN OF WK-DENBUN-INFO  = CNS-0
 12506       THEN
 12507         MOVE  WK-FOOT                 TO  DAT-REC5
 12508         PERFORM  DATA-WRITE-5-RTN
 12509       ELSE
 12510         MOVE  WK-FOOT                 TO  DAT-REC7
 12511         PERFORM  DATA-WRITE-7-RTN
 12512       END-IF
 12513*-------------------<DEBUG>---------------------------------------
 12514D    DISPLAY  CNS-PGM-ID":DAT-REC = ["DAT-REC"]"
 12515D    DISPLAY  CNS-PGM-ID":DAT-REC3 = ["DAT-REC3"]"
 12516D    DISPLAY  CNS-PGM-ID":DAT-REC5 = ["DAT-REC5"]"
 12517D    DISPLAY  CNS-PGM-ID":DAT-REC7 = ["DAT-REC7"]"
 12518*-----------------------------------------------------------------
 12519     ELSE
 12520       CONTINUE
 12521     END-IF
 12522*----------  受渡ファイルデータ出力処理
 12523*------------------ <連結障害493の対応 START>---------------------
 12524     IF  WK-WRITE-KENSUU2 > ZERO OR  WK-WRITE-KENSUU4 > ZERO
 12525       OR  WK-WRITE-KENSUU6 > ZERO OR  WK-WRITE-KENSUU8 > ZERO
 12526     THEN
 12527       INITIALIZE  DAT-REC2
 12528                   DAT-REC4
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 217
* MUSR2651.cob                                                     cpy)cpy)y)y)
 12529                   DAT-REC6
 12530                   DAT-REC8
 12531*------------------ <連結障害493の対応 END>-----------------------
 12532                   WK-FOOT
 12533                   WK-WRITE-TEMP2
 12534                   WK-WRITE-TEMP4
 12535       IF  I-FLG-KEISAN OF WK-DENBUN-INFO  = CNS-0
 12536       THEN
 12537         COMPUTE  WK-WRITE-TEMP2 = WK-WRITE-KENSUU2 - CNS-1
 12538         COMPUTE  WK-WRITE-TEMP4 = WK-WRITE-KENSUU6 - CNS-1
 12539       ELSE
 12540         COMPUTE  WK-WRITE-TEMP2 = WK-WRITE-KENSUU4 - CNS-1
 12541         COMPUTE  WK-WRITE-TEMP4 = WK-WRITE-KENSUU8 - CNS-1
 12542       END-IF
 12543       MOVE  WK-WRITE-TEMP2
 12544         TO  WK-18-18-X
 12545       PERFORM  ZERO-COMPUTE-RTN
 12546       COMPUTE  WK-NUM-LENGTH = 18 - WK-NUM-1
 12547       MOVE  WK-18-18-X(WK-NUM-FROM:WK-NUM-LENGTH)
 12548         TO  WK-FILE-KENSUU          OF  WK-FOOT
 12549       IF  I-FLG-KEISAN OF WK-DENBUN-INFO  = CNS-0
 12550       THEN
 12551*------------------ <連結障害493の対応 START>---------------------
 12552           MOVE  WK-FOOT                 TO  DAT-REC2
 12553*------------------ <連結障害493の対応 END>-----------------------
 12554         PERFORM  DATA-WRITE-2-RTN
 12555       ELSE
 12556         MOVE  WK-FOOT                 TO  DAT-REC4
 12557         PERFORM  DATA-WRITE-4-RTN
 12558       END-IF
 12559       MOVE  WK-WRITE-TEMP4
 12560         TO  WK-18-18-X
 12561       PERFORM  ZERO-COMPUTE-RTN
 12562       COMPUTE  WK-NUM-LENGTH = 18 - WK-NUM-1
 12563       MOVE  WK-18-18-X(WK-NUM-FROM:WK-NUM-LENGTH)
 12564         TO  WK-FILE-KENSUU          OF  WK-FOOT
 12565       IF  I-FLG-KEISAN OF WK-DENBUN-INFO  = CNS-0
 12566       THEN
 12567         MOVE  WK-FOOT                 TO  DAT-REC6
 12568         PERFORM  DATA-WRITE-6-RTN
 12569       ELSE
 12570         MOVE  WK-FOOT                 TO  DAT-REC8
 12571         PERFORM  DATA-WRITE-8-RTN
 12572       END-IF
 12573*-------------------<DEBUG>---------------------------------------
 12574D    DISPLAY  CNS-PGM-ID":DAT-REC2 = ["DAT-REC2"]"
 12575D    DISPLAY  CNS-PGM-ID":DAT-REC4 = ["DAT-REC4"]"
 12576D    DISPLAY  CNS-PGM-ID":DAT-REC6 = ["DAT-REC6"]"
 12577D    DISPLAY  CNS-PGM-ID":DAT-REC8 = ["DAT-REC8"]"
 12578*-----------------------------------------------------------------
 12579     ELSE
 12580       CONTINUE
 12581     END-IF
 12582*------------------ <連結障害1077の対応 END>----------------------
 12583*--------------------<DEBUG>--------------------------------------
 12584D    DISPLAY  CNS-PGM-ID":*** フッターをダウンロードファイルに"
 12585D             "書き END ***"
 12586*-----------------------------------------------------------------
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 218
* MUSR2651.cob                                                     cpy)cpy)y)y)
 12587     CONTINUE.
 12588 FOOT-OUT-EXT.
 12589     EXIT.
 12590******************************************************************
 12591*     転送制御ファイル作成
 12592******************************************************************
 12593 SCZY7180-RTN           SECTION.
 12594*--------------------<DEBUG>--------------------------------------
 12595D    DISPLAY  CNS-PGM-ID":***  転送制御ファイル作成 START  ***"
 12596*-----------------------------------------------------------------
 12597     INITIALIZE  PARM-SCZY7180-INOUT
 12598                 PARM-RTNPKG
 12599*----------  利用会社コード
 12600     MOVE  WK-RIYO-CMP-CD         OF  WK-ARGUMENT
 12601       TO  RIYO-CMP-CD            OF  PARM-SCZY7180-ARG1
 12602*----------  処理実行日
 12603     MOVE  WK-SHORI-YMD           OF  WK-ARGUMENT
 12604       TO  SYORI-YMD              OF  PARM-SCZY7180-ARG1
 12605*----------  起動ID
 12606     MOVE  WK-KIDOU-ID            OF  WK-ARGUMENT
 12607       TO  KIDOU-ID               OF  PARM-SCZY7180-ARG1
 12608*----------  実行処理ID
 12609     MOVE  WK-GYOMU-TASK-ID       OF  WK-ARGUMENT
 12610       TO  JIKOU-SYORI-ID         OF  PARM-SCZY7180-ARG1
 12611*----------  拠点サーバ区分
 12612     MOVE  CNS-KYOTEN-KBN-02
 12613       TO  KYOTEN-KBN             OF  PARM-SCZY7180-ARG1
 12614*----------  最大連番
 12615     MOVE  CNS-SAIDAI-RBN-08
 12616       TO  SAIDAI-RBN             OF  PARM-SCZY7180-ARG1
 12617*--------------------<DEBUG>--------------------------------------
 12618D    DISPLAY  CNS-PGM-ID":PARM-SCZY7180-ARG1:"
 12619D    DISPLAY  CNS-PGM-ID":利用会社コード =["
 12620D             RIYO-CMP-CD         OF  PARM-SCZY7180-ARG1"]"
 12621D    DISPLAY  CNS-PGM-ID":処理実行日 =["
 12622D             SYORI-YMD           OF  PARM-SCZY7180-ARG1"]"
 12623D    DISPLAY  CNS-PGM-ID":起動ID =["
 12624D             KIDOU-ID            OF  PARM-SCZY7180-ARG1"]"
 12625D    DISPLAY  CNS-PGM-ID":実行処理ID=["
 12626D             JIKOU-SYORI-ID      OF  PARM-SCZY7180-ARG1"]"
 12627D    DISPLAY  CNS-PGM-ID":拠点サーバ区分=["
 12628D             KYOTEN-KBN          OF  PARM-SCZY7180-ARG1"]"
 12629D    DISPLAY  CNS-PGM-ID":最大連番=["
 12630D             SAIDAI-RBN          OF  PARM-SCZY7180-ARG1"]"
 12631D    DISPLAY  CNS-PGM-ID":***  CALL SCZY7180 START  ***"
 12632*-----------------------------------------------------------------
 12633     CALL  "SCZY7180"             USING  PARM-SCZY7180-INOUT
 12634                                         PARM-RTNPKG
 12635*--------------------<DEBUG>--------------------------------------
 12636D    DISPLAY  CNS-PGM-ID":***  CALL SCZY7180 END  ***"
 12637D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY7180)       =["
 12638D             RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)"]"
 12639D    DISPLAY  CNS-PGM-ID":COUNTER OF PARM-RTNPKG =["
 12640D             COUNTER             OF PARM-RTNPKG "]"
 12641*-----------------------------------------------------------------
 12642     IF  RTN-CD  OF  PARM-RTNPKG(COUNTER  OF  PARM-RTNPKG)
 12643       = CNS-RTN-000
 12644     THEN
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 219
* MUSR2651.cob                                                     cpy)cpy)y)y)
 12645*--------------------<DEBSUG>-------------------------------------
 12646D    DISPLAY  CNS-PGM-ID":転送制御ファイル作成  正常"
 12647*-----------------------------------------------------------------
 12648       CONTINUE
 12649     ELSE
 12650*--------------------<DEBSUG>-------------------------------------
 12651D    DISPLAY  CNS-PGM-ID":転送制御ファイル作成  異常"
 12652*-----------------------------------------------------------------
 12653*----------  ワークリターンコード
 12654       MOVE  CNS-RTN-BT16         TO  WK-RTN-CODE
 12655*--------------------<DEBSUG>-------------------------------------
 12656D    DISPLAY  CNS-PGM-ID":WK-RTN-CODE=["WK-RTN-CODE"]"
 12657*-----------------------------------------------------------------
 12658*----------  ワークエラーパッケージを編集
 12659       MOVE  PARM-RTNPKG          TO  PARM-SCZY1170-RTNPKG
 12660*----------  ワークエラーパッケージを編集
 12661       INITIALIZE  WK-SYS-ERR-INFO
 12662*----------  エラー検知プログラムID
 12663       MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
 12664*----------  ポジション
 12665       MOVE  CNS-POS-015          TO  WK-ERR-POS
 12666*----------  リターンコード
 12667       MOVE  CNS-RTN-901          TO  WK-RTN-CD
 12668*----------  詳細リターンコード
 12669       MOVE  RTN-CD               OF  PARM-RTNPKG
 12670                                      (COUNTER OF PARM-RTNPKG)
 12671                                  TO  WK-DETAIL-RTN-CD
 12672*----------  詳細リターンコードデコードフラグ
 12673       MOVE  CNS-DETAIL-0         TO  WK-DETAIL-RTN-CD-FLG
 12674*---------- フリーメッセージ
 12675       MOVE  SPACE                TO  WK-FREE-MSG
 12676*----------  エラー処理
 12677       PERFORM  ERR-RTN
 12678     END-IF
 12679*--------------------<DEBUG>--------------------------------------
 12680D    DISPLAY  CNS-PGM-ID":***  転送制御ファイル作成 END  ***"
 12681*-----------------------------------------------------------------
 12682     CONTINUE.
 12683 SCZY7180-EXT.
 12684     EXIT.
 12685******************************************************************
 12686*    3.2.2.データ出力処理
 12687******************************************************************
 12688 DATA-OUT-RTN           SECTION.
 12689*--------------------<DEBUG>--------------------------------------
 12690D    DISPLAY  CNS-PGM-ID":*** データ出力処理START ***"
 12691D    DISPLAY  CNS-PGM-ID":WK-HIT-KENSU=["WK-HIT-KENSU"]"
 12692*-----------------------------------------------------------------
 12693*----------  SQL作成(PREPARE)
 12694     PERFORM  CR-PREPARE-2-RTN
 12695*-------------------<DEBUG>---------------------------------------
 12696D    DISPLAY  CNS-PGM-ID":WK-STATUS=["WK-STATUS"]"
 12697*-----------------------------------------------------------------
 12698*----------  カーソル作成(DECLARE，OPEN)
 12699     IF  WK-STATUS < CNS-8
 12700     THEN
 12701       PERFORM  CR-OPEN-2-RTN
 12702     ELSE
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 220
* MUSR2651.cob                                                     cpy)cpy)y)y)
 12703*-------------------<DEBUG>---------------------------------------
 12704D    DISPLAY  CNS-PGM-ID":**** カーソル作成しない ****"
 12705*-----------------------------------------------------------------
 12706       CONTINUE
 12707     END-IF
 12708*-------------------<DEBUG>---------------------------------------
 12709D    DISPLAY  CNS-PGM-ID":WK-STATUS=["WK-STATUS"]"
 12710*-----------------------------------------------------------------
 12711     IF  WK-STATUS < CNS-8
 12712     THEN
 12713     MOVE FUNCTION CURRENT-DATE(1:14) TO WK-RUN-SDATETIME
 12714*-------------------<DEBUG>---------------------------------------
 12715     DISPLAY "プログラムID:        ["CNS-PGM-ID"]"                GUT2013
 12716     DISPLAY "セクション:          [DATA-OUT-RTN]"                GUT2013
 12717     DISPLAY "セクションの開始時間:["WK-RUN-SDATETIME"]"          GUT2013
 12718*-----------------------------------------------------------------
 12719       PERFORM  UNTIL
 12720         FLG-STOP-2 = CNS-ON  OR  WK-RTN-CODE = CNS-16
 12721*----------  カーソルFETCH
 12722         PERFORM  CR-FETCH-2-RTN
 12723*
 12724         INITIALIZE  HST-TBL-SELECT-2
 12725                     WK-STATUS
 12726                     WK-J
 12727                     FLG-MEISAI-GYOMU-ERR
 12728                     WK-GYOMU-ERR-INFO
 12729                     FLG-FETCH-END2
 12730       END-PERFORM
 12731     MOVE FUNCTION CURRENT-DATE(1:14) TO WK-RUN-EDATETIME
 12732*--------------------<DEBUG>--------------------------------------
 12733     DISPLAY "プログラムID:        ["CNS-PGM-ID"]"                GUT2013
 12734     DISPLAY "セクション:          [DATA-OUT-RTN]"                GUT2013
 12735     DISPLAY "セクションの終了時間:["WK-RUN-EDATETIME"]"          GUT2013
 12736*-----------------------------------------------------------------
 12737     ELSE
 12738       CONTINUE
 12739     END-IF
 12740*-------------------<DEBUG>---------------------------------------
 12741D    DISPLAY  CNS-PGM-ID":FLG-CR-OPEN2=["FLG-CR-OPEN2"]"
 12742*-----------------------------------------------------------------
 12743*----------  カーソルクローズ処理
 12744     IF  FLG-CR-OPEN2 = CNS-ON
 12745     THEN
 12746       PERFORM  CR-CLOSE-3-RTN
 12747     ELSE
 12748*-------------------<DEBUG>---------------------------------------
 12749D    DISPLAY  CNS-PGM-ID":**** カーソルクローズ処理しない ****"
 12750*-----------------------------------------------------------------
 12751       CONTINUE
 12752     END-IF
 12753*--------------------<DEBUG>--------------------------------------
 12754D    DISPLAY  CNS-PGM-ID":WK-IDX-J=["WK-IDX-J"]"
 12755D    DISPLAY  CNS-PGM-ID":*** データ出力処理END ***"
 12756*-----------------------------------------------------------------
 12757     CONTINUE.
 12758 DATA-OUT-EXT.
 12759     EXIT.
 12760******************************************************************
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 221
* MUSR2651.cob                                                     cpy)cpy)y)y)
 12761*    実行状況管理停止判断
 12762******************************************************************
 12763 SCZY7220-RTN           SECTION.
 12764*--------------------<DEBUG>--------------------------------------
 12765D    DISPLAY  CNS-PGM-ID":*** 実行状況管理停止判断 START ***"
 12766*-----------------------------------------------------------------
 12767     INITIALIZE  PARM-SCZY7220-INOUT
 12768                 PARM-RTNPKG
 12769*----------  利用会社コード
 12770     MOVE  WK-RIYO-CMP-CD
 12771       TO  RIYO-CMP-CD            OF  PARM-SCZY7220-ARG1
 12772*----------  処理実行日
 12773     MOVE  WK-SHORI-YMD-9
 12774       TO  SYORI-YMD              OF  PARM-SCZY7220-ARG1
 12775*----------  起動ID
 12776     MOVE  WK-KIDOU-ID
 12777       TO  KIDOU-ID               OF  PARM-SCZY7220-ARG1
 12778*-------------------<DEBUG>---------------------------------------
 12779D    DISPLAY  CNS-PGM-ID":利用会社コード=["
 12780D             RIYO-CMP-CD         OF  PARM-SCZY7220-ARG1"]"
 12781D    DISPLAY  CNS-PGM-ID":処理実行日=["
 12782D             SYORI-YMD           OF  PARM-SCZY7220-ARG1"]"
 12783D    DISPLAY  CNS-PGM-ID":起動ID=["
 12784D             KIDOU-ID            OF  PARM-SCZY7220-ARG1"]"
 12785D    DISPLAY  CNS-PGM-ID": ***  CALL SCZY7220  START  ***"
 12786*-----------------------------------------------------------------
 12787     CALL  "SCZY7220"             USING  PARM-SCZY7220-INOUT
 12788                                         PARM-RTNPKG
 12789*-------------------<DEBUG>---------------------------------------
 12790D    DISPLAY  CNS-PGM-ID": ***  CALL SCZY7220  END  ***"
 12791D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY7220)        =["
 12792D             RTN-CD OF PARM-RTNPKG(COUNTER   OF PARM-RTNPKG) "]"
 12793D    DISPLAY  CNS-PGM-ID":COUNTER  OF  PARM-RTNPKG=["
 12794D             COUNTER              OF PARM-RTNPKG"]"
 12795*-----------------------------------------------------------------
 12796     IF  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
 12797      =  CNS-RTN-000
 12798     THEN
 12799*-------------------<DEBUG>---------------------------------------
 12800D    DISPLAY  CNS-PGM-ID":SOKO-KANO-KBN =["
 12801D                         SOKO-KANO-KBN OF PARM-SCZY7220-ARG2 "]"
 12802*-----------------------------------------------------------------
 12803*----------  実行可能区分
 12804       EVALUATE  SOKO-KANO-KBN OF PARM-SCZY7220-ARG2
 12805         WHEN  CNS-X-0
 12806           MOVE  ZERO             TO  WK-STOP-KENSUU
 12807         WHEN  CNS-X-1
 12808*--------------------<DEBSUG>-------------------------------------
 12809D    DISPLAY  CNS-PGM-ID":実行状況管理停止判断正常且つ一時停止"
 12810*-----------------------------------------------------------------
 12811           MOVE  CNS-10              TO  WK-RTN-CODE
 12812           MOVE  CNS-10              TO  WK-1190-STATUS
 12813           MOVE  ZERO                TO  WK-J
 12814*--------------------<DEBSUG>-------------------------------------
 12815D    DISPLAY  CNS-PGM-ID":WK-1190-STATUS=["WK-1190-STATUS"]"
 12816D    DISPLAY  CNS-PGM-ID":WK-RTN-CODE=["WK-RTN-CODE"]"
 12817D    DISPLAY  CNS-PGM-ID":WK-J =[" WK-J"]"
 12818*-----------------------------------------------------------------
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 222
* MUSR2651.cob                                                     cpy)cpy)y)y)
 12819             COMPUTE  WK-J = WK-J + 1
 12820*-------------------<DEBUG>---------------------------------------
 12821D    DISPLAY  CNS-PGM-ID":WK-J =[" WK-J"]"
 12822*-----------------------------------------------------------------
 12823*---------- ファンドコード
 12824           MOVE  WK-FUND-CD-DETAIL   OF  WK-PTF-ATT-DATA(WK-IDX-J)
 12825             TO  WK-GYOMU-FUND-CD    OF  WK-GYOMU-ERR-INFO(WK-J)
 12826*---------- ポートフォリオコード
 12827           MOVE  WK-PTF-CD-DETAIL    OF  WK-PTF-ATT-DATA(WK-IDX-J)
 12828             TO  WK-GYOMU-PTF-CD     OF  WK-GYOMU-ERR-INFO(WK-J)
 12829*---------- 評価系列コード
 12830           MOVE  WK-DEFAUL-THYK-CD   OF  WK-PTF-ATT-DATA(WK-IDX-J)
 12831             TO  WK-GYOMU-HYK-KRTU-CD OF  WK-GYOMU-ERR-INFO(WK-J)
 12832*---------- メッセージID
 12833           MOVE  CNS-MSG-E000451
 12834             TO  WK-GYOMU-MSG-ID      OF  WK-GYOMU-ERR-INFO(WK-J)
 12835*---------- 基準日From
 12836           MOVE  WK-KIKAN-FR
 12837             TO  WK-GYOMU-KJN-YMD-FROM
 12838                                      OF  WK-GYOMU-ERR-INFO(WK-J)
 12839*---------- 基準日To
 12840           MOVE  WK-KIKAN-TO
 12841             TO  WK-GYOMU-KJN-YMD-TO  OF  WK-GYOMU-ERR-INFO(WK-J)
 12842*---------- 置換文字
 12843           MOVE  SPACE
 12844             TO  WK-GYOMU-TK-MOJI(WK-J,CNS-1)
 12845*---------- フリーメッセージ
 12846           MOVE  SPACE
 12847             TO  WK-GYOMU-FREE-MSG    OF  WK-GYOMU-ERR-INFO(WK-J)
 12848           MOVE  CNS-ON               TO  FLG-GYOMU-ERR
 12849*----------  進捗管理ＩＮＳＵＰＤルーチン OLD.基準日
 12850*--------------------<DEBUG>--------------------------------------
 12851D    DISPLAY  CNS-PGM-ID":業務タスクID=["
 12852D             WK-GYOMU-TASK-ID       OF  WK-ARGUMENT"]"
 12853*-----------------------------------------------------------------
 12854           IF  WK-GYOMU-TASK-ID       OF  WK-ARGUMENT
 12855               =  CNS-TASK-T7080US
 12856           THEN
 12857             PERFORM  SUSC0405-OLD-RTN
 12858*----------  ＤＢ コミット処理
 12859             PERFORM  DB-COMMIT1-RTN
 12860           ELSE
 12861             CONTINUE
 12862           END-IF
 12863*----------  後処理
 12864           IF  WK-RTN-CODE NOT = CNS-RTN-BT16
 12865           THEN
 12866*----------  後処理
 12867             PERFORM  END-RTN
 12868           ELSE
 12869*----------  エラー処理
 12870             PERFORM  ERR-RTN
 12871           END-IF
 12872         WHEN  CNS-X-2
 12873*--------------------<DEBSUG>-------------------------------------
 12874D    DISPLAY  CNS-PGM-ID":実行状況管理停止判断正常且つ強制停止"
 12875*-----------------------------------------------------------------
 12876           MOVE  CNS-8               TO  WK-RTN-CODE
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 223
* MUSR2651.cob                                                     cpy)cpy)y)y)
 12877           MOVE  CNS-8               TO  WK-1190-STATUS
 12878           MOVE  ZERO                TO  WK-J
 12879*--------------------<DEBSUG>-------------------------------------
 12880D    DISPLAY  CNS-PGM-ID":WK-1190-STATUS=["WK-1190-STATUS"]"
 12881D    DISPLAY  CNS-PGM-ID":WK-RTN-CODE=["WK-RTN-CODE"]"
 12882D    DISPLAY  CNS-PGM-ID":WK-J =[" WK-J"]"
 12883*-----------------------------------------------------------------
 12884             COMPUTE  WK-J = WK-J + 1
 12885*-------------------<DEBUG>---------------------------------------
 12886D    DISPLAY  CNS-PGM-ID":WK-J =[" WK-J"]"
 12887*-----------------------------------------------------------------
 12888*---------- ファンドコード
 12889           MOVE  WK-FUND-CD-DETAIL   OF  WK-PTF-ATT-DATA(WK-IDX-J)
 12890             TO  WK-GYOMU-FUND-CD    OF  WK-GYOMU-ERR-INFO(WK-J)
 12891*---------- ポートフォリオコード
 12892           MOVE  WK-PTF-CD-DETAIL    OF  WK-PTF-ATT-DATA(WK-IDX-J)
 12893             TO  WK-GYOMU-PTF-CD     OF  WK-GYOMU-ERR-INFO(WK-J)
 12894*---------- 評価系列コード
 12895           MOVE  WK-DEFAUL-THYK-CD   OF  WK-PTF-ATT-DATA(WK-IDX-J)
 12896             TO  WK-GYOMU-HYK-KRTU-CD OF  WK-GYOMU-ERR-INFO(WK-J)
 12897*---------- メッセージID
 12898           MOVE  CNS-MSG-E000431
 12899             TO  WK-GYOMU-MSG-ID      OF  WK-GYOMU-ERR-INFO(WK-J)
 12900*---------- 基準日From
 12901           MOVE  WK-KIKAN-FR
 12902             TO  WK-GYOMU-KJN-YMD-FROM
 12903                                      OF  WK-GYOMU-ERR-INFO(WK-J)
 12904*---------- 基準日To
 12905           MOVE  WK-KIKAN-TO
 12906             TO  WK-GYOMU-KJN-YMD-TO  OF  WK-GYOMU-ERR-INFO(WK-J)
 12907*---------- 置換文字
 12908           MOVE  SPACE
 12909             TO  WK-GYOMU-TK-MOJI(WK-J,CNS-1)
 12910*---------- フリーメッセージ
 12911           MOVE  SPACE
 12912             TO  WK-GYOMU-FREE-MSG    OF  WK-GYOMU-ERR-INFO(WK-J)
 12913           MOVE  CNS-ON               TO  FLG-GYOMU-ERR
 12914*----------  進捗管理ＩＮＳＵＰＤルーチン OLD.基準日
 12915*--------------------<DEBUG>--------------------------------------
 12916D    DISPLAY  CNS-PGM-ID":業務タスクID=["
 12917D             WK-GYOMU-TASK-ID       OF  WK-ARGUMENT"]"
 12918*-----------------------------------------------------------------
 12919           IF  WK-GYOMU-TASK-ID       OF  WK-ARGUMENT
 12920               =  CNS-TASK-T7080US
 12921           THEN
 12922             PERFORM  SUSC0405-OLD-RTN
 12923*----------  ＤＢ コミット処理
 12924             PERFORM  DB-COMMIT1-RTN
 12925           ELSE
 12926             CONTINUE
 12927           END-IF
 12928*----------  後処理
 12929           IF  WK-RTN-CODE NOT = CNS-RTN-BT16
 12930           THEN
 12931*----------  後処理
 12932             PERFORM  END-RTN
 12933           ELSE
 12934*----------  エラー処理
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 224
* MUSR2651.cob                                                     cpy)cpy)y)y)
 12935             PERFORM  ERR-RTN
 12936           END-IF
 12937         WHEN OTHER
 12938           CONTINUE
 12939       END-EVALUATE
 12940     ELSE
 12941*--------------------<DEBUG>--------------------------------------
 12942D    DISPLAY  CNS-PGM-ID":*** 実行状況管理停止判断 エラー ***"
 12943*-----------------------------------------------------------------
 12944       MOVE  CNS-16               TO  WK-STATUS
 12945*----------  ワークリターンコード
 12946       MOVE  CNS-16               TO  WK-RTN-CODE
 12947*----------  サブエラーメッセージ出力処理
 12948       PERFORM  SUB-ERR-MSG-RTN
 12949*----------  ワークエラーパッケージを編集
 12950       INITIALIZE  WK-SYS-ERR-INFO
 12951*----------  エラー検知プログラムID
 12952       MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
 12953*----------  ポジション
 12954       MOVE  CNS-POS-016          TO  WK-ERR-POS
 12955*----------  リターンコード
 12956       MOVE  CNS-RTN-901          TO  WK-RTN-CD
 12957*----------  詳細リターンコード
 12958       MOVE  RTN-CD
 12959         OF  PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
 12960                                  TO  WK-DETAIL-RTN-CD
 12961*----------  詳細リターンコードデコードフラグ
 12962       MOVE  CNS-DETAIL-0         TO  WK-DETAIL-RTN-CD-FLG
 12963*---------- フリーメッセージ
 12964       MOVE  SPACE                TO  WK-FREE-MSG
 12965*----------  エラー情報追加処理
 12966       PERFORM  ERR-INFO-ADD-RTN
 12967     END-IF
 12968*--------------------<DEBUG>--------------------------------------
 12969D    DISPLAY  CNS-PGM-ID":WK-STOP-KENSUU=["WK-STOP-KENSUU"]"
 12970D    DISPLAY  CNS-PGM-ID":*** 実行状況管理停止判断  END  ***"
 12971*-----------------------------------------------------------------
 12972     CONTINUE.
 12973 SCZY7220-EXT.
 12974     EXIT.
 12975******************************************************************
 12976*    エラー1情報追加処理
 12977******************************************************************
 12978 ERR-INFO-ADD-RTN       SECTION.
 12979*--------------------<DEBUG>--------------------------------------
 12980D    DISPLAY  CNS-PGM-ID":***  エラー1情報追加処理  START  ***"
 12981*-----------------------------------------------------------------
 12982     MOVE  CNS-ON                 TO  FLG-SYSTEM-ERR
 12983*---------- エラーリターンパッケージ
 12984     INITIALIZE  PARM-SCZY1170-IN
 12985     MOVE  WK-SYS-ERR-INFO        TO  PARM-SCZY1170-ARG1
 12986*--------------------<DEBUG>--------------------------------------
 12987D    DISPLAY  CNS-PGM-ID":エラー検知プログラム名          =["
 12988D             ERR-PGM-ID          OF  PARM-SCZY1170-ARG1"]"
 12989D    DISPLAY  CNS-PGM-ID":ポジション                      =["
 12990D             ERR-POS             OF  PARM-SCZY1170-ARG1"]"
 12991D    DISPLAY  CNS-PGM-ID":リターンコード                  =["
 12992D             RTN-CD              OF  PARM-SCZY1170-ARG1"]"
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 225
* MUSR2651.cob                                                     cpy)cpy)y)y)
 12993D    DISPLAY  CNS-PGM-ID":詳細リターンコード              =["
 12994D             DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1"]"
 12995D    DISPLAY  CNS-PGM-ID":詳細リターンコードデコードフラグ=["
 12996D             DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1"]"
 12997D    DISPLAY  CNS-PGM-ID":フリーメッセージ                =["
 12998D             FREE-MSG            OF  PARM-SCZY1170-ARG1"]"
 12999D    DISPLAY  CNS-PGM-ID":PARM-SCZY1170-ARG1              =["
 13000D             PARM-SCZY1170-ARG1                        "]"
 13001D    DISPLAY  CNS-PGM-ID":***  CALL SCZY1170 START  ***"
 13002*-----------------------------------------------------------------
 13003     CALL  "SCZY1170"             USING  PARM-SCZY1170-IN
 13004                                         PARM-SCZY1170-RTNPKG
 13005*--------------------<DEBUG>--------------------------------------
 13006D    DISPLAY  CNS-PGM-ID":***  CALL SCZY1170 END  ***"
 13007D    DISPLAY  CNS-PGM-ID":***  エラー1情報追加処理  END  ***"
 13008*-----------------------------------------------------------------
 13009     CONTINUE.
 13010 ERR-INFO-ADD-EXT.
 13011     EXIT.
 13012******************************************************************
 13013*    SQL作成（PREPARE）
 13014******************************************************************
 13015 CR-PREPARE-RTN         SECTION.
 13016*-------------------<DEBUG>---------------------------------------
 13017D    DISPLAY  CNS-PGM-ID":***  SQL作成(PREPARE)  START  ***"
 13018*-----------------------------------------------------------------
 13019     INITIALIZE  SQLSTMT-S
 13020                 HST-SELECT-WHERE
 13021                 WK-SELECT-FREE-MSG
 13022*----------  テーブルTKUSZT01
 13023     MOVE  WK-TBL-TKUSZT01
 13024       TO  SQL-TBL-TKUSZT01       OF  SQL-SELECT
 13025*----------  利用会社コード
 13026     MOVE  WK-RIYO-CMP-CD
 13027       TO  H-RIYO-CMP-CD          OF  HST-SELECT-WHERE
 13028*----------  ファンドコード
 13029     MOVE  WK-FUND-CD-DETAIL      OF  WK-FUND-PTF-DETAIL(WK-IDX-J)
 13030       TO  H-FUND-CD              OF  HST-SELECT-WHERE
 13031*----------  ポートフォリオコード
 13032     MOVE  WK-PTF-CD-DETAIL       OF  WK-FUND-PTF-DETAIL(WK-IDX-J)
 13033       TO  H-PTF-CD               OF  HST-SELECT-WHERE
 13034*----------  テーマ2693対応
 13035*----------  期間FROM
 13036     MOVE  WK-KZYN-YMD-FROM       OF  WK-FUND-PTF-DETAIL(WK-IDX-J)
 13037       TO  H-KIKAN-FR             OF  HST-SELECT-WHERE
 13038*----------  期間TO
 13039     MOVE  WK-KZYN-YMD-TO         OF  WK-FUND-PTF-DETAIL(WK-IDX-J)
 13040       TO  H-KIKAN-TO             OF  HST-SELECT-WHERE
 13041*----------  テーマ2693対応
 13042*----------  評価系列コード
 13043     MOVE  WK-DEFAUL-THYK-CD      OF  WK-FUND-PTF-DETAIL(WK-IDX-J)
 13044       TO  H-HYK-KRTU-CD          OF  HST-SELECT-WHERE
 13045*----------  残高日付
 13046     MOVE  H-ZANTK-YMD            OF  HST-TBL-SELECT-2
 13047       TO  H-ZANTK-YMD            OF  HST-SELECT-WHERE
 13048     STRING  SQL-SELECT
 13049             DELIMITED BY SIZE
 13050             INTO SQLSTMT-S
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 226
* MUSR2651.cob                                                     cpy)cpy)y)y)
 13051     END-STRING
 13052     STRING SQLSTMT-S(1:FUNCTION  LENGTH(SQL-SELECT))
 13053          "[:V1="
 13054           H-RIYO-CMP-CD        OF  HST-SELECT-WHERE
 13055          "][:V2="
 13056           H-FUND-CD            OF  HST-SELECT-WHERE
 13057          "][:V3="
 13058           H-PTF-CD             OF  HST-SELECT-WHERE
 13059          "][:V4="
 13060           H-KIKAN-FR           OF  HST-SELECT-WHERE
 13061          "][:V5="
 13062           H-KIKAN-TO           OF  HST-SELECT-WHERE
 13063          "][:V6="
 13064           H-HYK-KRTU-CD        OF  HST-SELECT-WHERE
 13065          "][:V7="
 13066           H-ZANTK-YMD          OF  HST-SELECT-WHERE
 13067          "]"
 13068          DELIMITED BY SIZE
 13069          INTO  WK-SELECT-FREE-MSG
 13070     END-STRING
 13071*-------------------<DEBUG>---------------------------------------
 13072D    DISPLAY  CNS-PGM-ID "テーブルTKUSZT01 =["
 13073D             SQL-TBL-TKUSZT01       OF  SQL-SELECT"]"
 13074D    DISPLAY  CNS-PGM-ID ":利用会社コードH-RIYO-CMP-CD =["
 13075D                 H-RIYO-CMP-CD      OF  HST-SELECT-WHERE "]"
 13076D    DISPLAY  CNS-PGM-ID ":ファンドコードH-FUND-CD     =["
 13077D                 H-FUND-CD          OF  HST-SELECT-WHERE "]"
 13078D    DISPLAY  CNS-PGM-ID ":ポートフォリオコードH-PTF-CD      =["
 13079D                 H-PTF-CD           OF  HST-SELECT-WHERE "]"
 13080D    DISPLAY  CNS-PGM-ID ":残高日付FR H-KIKAN-FR      =["
 13081D                 H-KIKAN-FR         OF  HST-SELECT-WHERE "]"
 13082D    DISPLAY  CNS-PGM-ID ":残高日付TO H-KIKAN-TO      =["
 13083D                 H-KIKAN-TO         OF  HST-SELECT-WHERE "]"
 13084D    DISPLAY  CNS-PGM-ID ":評価系列コードH-HYK-KRTU-CD      =["
 13085D                 H-HYK-KRTU-CD      OF  HST-SELECT-WHERE "]"
 13086D    DISPLAY  CNS-PGM-ID ":残高日付H-ZANTK-YMD      =["
 13087D                 H-ZANTK-YMD        OF  HST-SELECT-WHERE "]"
 13088D    DISPLAY  CNS-PGM-ID":SQLSTMT-S      =["SQLSTMT-S"]"
 13089D    DISPLAY  CNS-PGM-ID":WK-SELECT-FREE-MSG =["
 13090D             WK-SELECT-FREE-MSG"]"
 13091*-----------------------------------------------------------------
 13092*    EXEC  SQL
 13093*      PREPARE  SS  FROM  :SQLSTMT-S
 13094*    END-EXEC
 13095     MOVE 1 TO SQL-ITERS
 13096     MOVE 36 TO SQL-OFFSET
 13097     MOVE 0 TO SQL-OCCURS
 13098     CALL "SQLADR" USING
 13099         SQLCUD
 13100         SQL-CUD
 13101     CALL "SQLADR" USING
 13102         SQLCA
 13103         SQL-SQLEST
 13104     MOVE 256 TO SQL-SQLETY
 13105     CALL "SQLADR" USING
 13106         SQLSTMT-S IN
 13107         HST-AREA
 13108         SQL-SQHSTV(1)
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 227
* MUSR2651.cob                                                     cpy)cpy)y)y)
 13109     MOVE 3000 TO SQL-SQHSTL(1)
 13110     MOVE 0 TO SQL-SQHSTS(1)
 13111     MOVE 0 TO SQL-SQINDV(1)
 13112     MOVE 0 TO SQL-SQINDS(1)
 13113     MOVE 0 TO SQL-SQHARM(1)
 13114     CALL "SQLADR" USING
 13115         SQL-SQHSTV(1)
 13116         SQL-SQPHSV
 13117     CALL "SQLADR" USING
 13118         SQL-SQHSTL(1)
 13119         SQL-SQPHSL
 13120     CALL "SQLADR" USING
 13121         SQL-SQHSTS(1)
 13122         SQL-SQPHSS
 13123     CALL "SQLADR" USING
 13124         SQL-SQINDV(1)
 13125         SQL-SQPIND
 13126     CALL "SQLADR" USING
 13127         SQL-SQINDS(1)
 13128         SQL-SQPINS
 13129     CALL "SQLADR" USING
 13130         SQL-SQHARM(1)
 13131         SQL-SQPARM
 13132     CALL "SQLADR" USING
 13133         SQL-SQHARC(1)
 13134         SQL-SQPARC
 13135
 13136     CALL "SQLBEX" USING
 13137         SQLCTX
 13138         SQLEXD
 13139         SQLFPN
 13140*-------------------<DEBUG>---------------------------------------
 13141D    DISPLAY  CNS-PGM-ID":SQLCODE(PREPARE)       =["SQLCODE"]"
 13142*-----------------------------------------------------------------
 13143     EVALUATE  SQLCODE
 13144       WHEN  CNS-SQL-NORMAL
 13145         CONTINUE
 13146       WHEN   OTHER
 13147*----------  ワーク実行ステータス
 13148         MOVE  CNS-16             TO  WK-STATUS
 13149         MOVE  CNS-16             TO  WK-1190-STATUS
 13150*----------  ワークリターンコード
 13151         MOVE  WK-STATUS          TO  WK-RTN-CODE
 13152*----------  ワークエラーパッケージを編集
 13153         INITIALIZE  WK-SYS-ERR-INFO
 13154*----------  エラー検知プログラムID
 13155         MOVE  CNS-PGM-ID         TO  WK-ERR-PGM-ID
 13156*----------  ポジション
 13157         MOVE  CNS-POS-017        TO  WK-ERR-POS
 13158*----------  リターンコード
 13159         MOVE  CNS-RTN-900        TO  WK-RTN-CD
 13160*----------  詳細リターンコード
 13161         MOVE  SQLCODE            TO  WK-DETAIL-RTN-CD
 13162*----------  詳細リターンコードデコードフラグ
 13163         MOVE  CNS-DETAIL-1       TO  WK-DETAIL-RTN-CD-FLG
 13164*---------- フリーメッセージ
 13165         MOVE  WK-SELECT-FREE-MSG TO  WK-FREE-MSG
 13166*----------  エラー情報追加処理
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 228
* MUSR2651.cob                                                     cpy)cpy)y)y)
 13167         PERFORM  ERR-INFO-ADD-RTN
 13168     END-EVALUATE
 13169*-------------------<DEBUG>---------------------------------------
 13170D    DISPLAY  CNS-PGM-ID":***  SQL作成(PREPARE)  END  ***"
 13171*-----------------------------------------------------------------
 13172     CONTINUE.
 13173 CR-PREPARE-EXT.
 13174     EXIT.
 13175******************************************************************
 13176*    カーソル作成（DECLARE，OPEN）
 13177******************************************************************
 13178 CR-OPEN-RTN            SECTION.
 13179*-------------------<DEBUG>---------------------------------------
 13180D    DISPLAY  CNS-PGM-ID
 13181D             ":***  カーソル作成(DECLARE，OPEN)  START  ***"
 13182*-----------------------------------------------------------------
 13183*----------DECLARE CURSOR
 13184*    EXEC  SQL
 13185*      DECLARE  CR  CURSOR  FOR  SS
 13186*    END-EXEC
 13187*-------------------<DEBUG>---------------------------------------
 13188D    DISPLAY  CNS-PGM-ID":SQLCODE(CURSOR DECLARE)=["SQLCODE"]"
 13189*-----------------------------------------------------------------
 13190*----------OPEN    CURSOR
 13191*    EXEC  SQL
 13192*      OPEN  CR
 13193*    USING  :HST-SELECT-WHERE.H-RIYO-CMP-CD,
 13194*           :HST-SELECT-WHERE.H-FUND-CD,
 13195*           :HST-SELECT-WHERE.H-PTF-CD,
 13196*           :HST-SELECT-WHERE.H-KIKAN-FR,
 13197*           :HST-SELECT-WHERE.H-KIKAN-TO,
 13198*           :HST-SELECT-WHERE.H-HYK-KRTU-CD,
 13199*           :HST-SELECT-WHERE.H-ZANTK-YMD
 13200*    END-EXEC
 13201     MOVE 1 TO SQL-ITERS
 13202     MOVE 55 TO SQL-OFFSET
 13203     MOVE 0 TO SQL-OCCURS
 13204     MOVE 1 TO SQL-SELERR
 13205     CALL "SQLADR" USING
 13206         SQLCUD
 13207         SQL-CUD
 13208     CALL "SQLADR" USING
 13209         SQLCA
 13210         SQL-SQLEST
 13211     MOVE 256 TO SQL-SQLETY
 13212     CALL "SQLADR" USING
 13213         H-RIYO-CMP-CD IN
 13214         HST-SELECT-WHERE IN
 13215         HST-AREA
 13216         SQL-SQHSTV(1)
 13217     MOVE 4 TO SQL-SQHSTL(1)
 13218     MOVE 0 TO SQL-SQHSTS(1)
 13219     MOVE 0 TO SQL-SQINDV(1)
 13220     MOVE 0 TO SQL-SQINDS(1)
 13221     MOVE 0 TO SQL-SQHARM(1)
 13222     CALL "SQLADR" USING
 13223         H-FUND-CD IN
 13224         HST-SELECT-WHERE IN
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 229
* MUSR2651.cob                                                     cpy)cpy)y)y)
 13225         HST-AREA
 13226         SQL-SQHSTV(2)
 13227     MOVE 12 TO SQL-SQHSTL(2)
 13228     MOVE 0 TO SQL-SQHSTS(2)
 13229     MOVE 0 TO SQL-SQINDV(2)
 13230     MOVE 0 TO SQL-SQINDS(2)
 13231     MOVE 0 TO SQL-SQHARM(2)
 13232     CALL "SQLADR" USING
 13233         H-PTF-CD IN
 13234         HST-SELECT-WHERE IN
 13235         HST-AREA
 13236         SQL-SQHSTV(3)
 13237     MOVE 4 TO SQL-SQHSTL(3)
 13238     MOVE 0 TO SQL-SQHSTS(3)
 13239     MOVE 0 TO SQL-SQINDV(3)
 13240     MOVE 0 TO SQL-SQINDS(3)
 13241     MOVE 0 TO SQL-SQHARM(3)
 13242     CALL "SQLADR" USING
 13243         H-KIKAN-FR IN
 13244         HST-SELECT-WHERE IN
 13245         HST-AREA
 13246         SQL-SQHSTV(4)
 13247     MOVE 8 TO SQL-SQHSTL(4)
 13248     MOVE 0 TO SQL-SQHSTS(4)
 13249     MOVE 0 TO SQL-SQINDV(4)
 13250     MOVE 0 TO SQL-SQINDS(4)
 13251     MOVE 0 TO SQL-SQHARM(4)
 13252     CALL "SQLADR" USING
 13253         H-KIKAN-TO IN
 13254         HST-SELECT-WHERE IN
 13255         HST-AREA
 13256         SQL-SQHSTV(5)
 13257     MOVE 8 TO SQL-SQHSTL(5)
 13258     MOVE 0 TO SQL-SQHSTS(5)
 13259     MOVE 0 TO SQL-SQINDV(5)
 13260     MOVE 0 TO SQL-SQINDS(5)
 13261     MOVE 0 TO SQL-SQHARM(5)
 13262     CALL "SQLADR" USING
 13263         H-HYK-KRTU-CD IN
 13264         HST-SELECT-WHERE IN
 13265         HST-AREA
 13266         SQL-SQHSTV(6)
 13267     MOVE 4 TO SQL-SQHSTL(6)
 13268     MOVE 0 TO SQL-SQHSTS(6)
 13269     MOVE 0 TO SQL-SQINDV(6)
 13270     MOVE 0 TO SQL-SQINDS(6)
 13271     MOVE 0 TO SQL-SQHARM(6)
 13272     CALL "SQLADR" USING
 13273         H-ZANTK-YMD IN
 13274         HST-SELECT-WHERE IN
 13275         HST-AREA
 13276         SQL-SQHSTV(7)
 13277     MOVE 8 TO SQL-SQHSTL(7)
 13278     MOVE 0 TO SQL-SQHSTS(7)
 13279     MOVE 0 TO SQL-SQINDV(7)
 13280     MOVE 0 TO SQL-SQINDS(7)
 13281     MOVE 0 TO SQL-SQHARM(7)
 13282     CALL "SQLADR" USING
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 230
* MUSR2651.cob                                                     cpy)cpy)y)y)
 13283         SQL-SQHSTV(1)
 13284         SQL-SQPHSV
 13285     CALL "SQLADR" USING
 13286         SQL-SQHSTL(1)
 13287         SQL-SQPHSL
 13288     CALL "SQLADR" USING
 13289         SQL-SQHSTS(1)
 13290         SQL-SQPHSS
 13291     CALL "SQLADR" USING
 13292         SQL-SQINDV(1)
 13293         SQL-SQPIND
 13294     CALL "SQLADR" USING
 13295         SQL-SQINDS(1)
 13296         SQL-SQPINS
 13297     CALL "SQLADR" USING
 13298         SQL-SQHARM(1)
 13299         SQL-SQPARM
 13300     CALL "SQLADR" USING
 13301         SQL-SQHARC(1)
 13302         SQL-SQPARC
 13303
 13304     CALL "SQLBEX" USING
 13305         SQLCTX
 13306         SQLEXD
 13307         SQLFPN
 13308*-------------------<DEBUG>---------------------------------------
 13309D    DISPLAY  CNS-PGM-ID":SQLCODE(CURSOR OPEN)   =["SQLCODE"]"
 13310*-----------------------------------------------------------------
 13311     EVALUATE  SQLCODE
 13312       WHEN  CNS-SQL-NORMAL
 13313         MOVE  CNS-ON               TO  FLG-CR-OPEN
 13314*-------------------<DEBUG>---------------------------------------
 13315D    DISPLAY  CNS-PGM-ID":FLG-CR-OPEN =["FLG-CR-OPEN"]"
 13316D    DISPLAY  CNS-PGM-ID":FLG-STOP =["FLG-STOP"]"
 13317*-----------------------------------------------------------------
 13318       WHEN   OTHER
 13319*----------  ワーク実行ステータス
 13320         MOVE  CNS-16               TO  WK-STATUS
 13321         MOVE  CNS-16               TO  WK-1190-STATUS
 13322*----------  ワークリターンコード
 13323         MOVE  WK-STATUS            TO  WK-RTN-CODE
 13324*----------  ワークエラーパッケージを編集
 13325         INITIALIZE  WK-SYS-ERR-INFO
 13326*----------  エラー検知プログラムID
 13327         MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
 13328*----------  ポジション
 13329         MOVE  CNS-POS-018          TO  WK-ERR-POS
 13330*----------  リターンコード
 13331         MOVE  CNS-RTN-900          TO  WK-RTN-CD
 13332*----------  詳細リターンコード
 13333         MOVE  SQLCODE              TO  WK-DETAIL-RTN-CD
 13334*----------  詳細リターンコードデコードフラグ
 13335         MOVE  CNS-DETAIL-1         TO  WK-DETAIL-RTN-CD-FLG
 13336*---------- フリーメッセージ
 13337         MOVE  WK-SELECT-FREE-MSG   TO  WK-FREE-MSG
 13338*----------  エラー情報追加処理
 13339         PERFORM  ERR-INFO-ADD-RTN
 13340     END-EVALUATE
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 231
* MUSR2651.cob                                                     cpy)cpy)y)y)
 13341*-------------------<DEBUG>---------------------------------------
 13342D    DISPLAY  CNS-PGM-ID
 13343D             ":***  カーソル作成(DECLARE，OPEN)  END  ***"
 13344*-----------------------------------------------------------------
 13345     CONTINUE.
 13346 CR-OPEN-EXT.
 13347     EXIT.
 13348******************************************************************
 13349*    カーソル（FETCH）
 13350******************************************************************
 13351 CR-FETCH-RTN           SECTION.
 13352*-------------------<DEBUG>---------------------------------------
 13353D    DISPLAY  CNS-PGM-ID":***  カーソル(FETCH)  START  ***"
 13354*-----------------------------------------------------------------
 13355     INITIALIZE  HST-TBL-SELECT
 13356                 WK-REC
 13357                 FLG-DATA-OUT
 13358     MOVE  WK-YJ-UW-KBN-NEW     TO  WK-YJ-UW-KBN-OLD
 13359*----------  CURSOR FETCH
 13360*    EXEC SQL
 13361*      FETCH CR
 13362*      INTO  :HST-TBL-SELECT.H-RIYO-CMP-CD,
 13363*            :HST-TBL-SELECT.H-FUND-CD,
 13364*            :HST-TBL-SELECT.H-PTF-CD,
 13365*            :HST-TBL-SELECT.H-YJ-UW-KBN,
 13366*            :HST-TBL-SELECT.H-ZANTK-YMD,
 13367*            :HST-TBL-SELECT.H-KSN-YMD-DMN-KBN,
 13368*            :HST-TBL-SELECT.H-HYK-KRTU-CD,
 13369*            :HST-TBL-SELECT.H-SEC-SBT-CD,
 13370*            :HST-TBL-SELECT.H-DEL-KBN,
 13371*            :HST-TBL-SELECT.H-KT-KBN,
 13372*            :HST-TBL-SELECT.H-TRHK-TUKA,
 13373*            :HST-TBL-SELECT.H-KWS-TH-TUKA-CD,
 13374*            :HST-TBL-SELECT.H-HAKO-CD,
 13375*            :HST-TBL-SELECT.H-MEG-CD,
 13376*            :HST-TBL-SELECT.H-TATE-FLG,
 13377*            :HST-TBL-SELECT.H-TG-YKJ-YMD,
 13378*            :HST-TBL-SELECT.H-KB-KANRI-ID,
 13379*            :HST-TBL-SELECT.H-CAST-CD,
 13380*            :HST-TBL-SELECT.H-HOU-SURYO,
 13381*            :HST-TBL-SELECT.H-SURYO-TANI,
 13382*            :HST-TBL-SELECT.H-THTK-ST-KNG,
 13383*            :HST-TBL-SELECT.H-THTK-ST-TNK,
 13384*            :HST-TBL-SELECT.H-CP-KRTU-CD,
 13385*            :HST-TBL-SELECT.H-CP-SAIYO-YMD,
 13386*            :HST-TBL-SELECT.H-CP-SAIYO-SIJO,
 13387*            :HST-TBL-SELECT.H-THTK-HYK-KN,
 13388*            :HST-TBL-SELECT.H-THTK-HYK-SNEKI,
 13389*            :HST-TBL-SELECT.H-THTK-PPAYZN,
 13390*            :HST-TBL-SELECT.H-THTK-KKRS,
 13391*            :HST-TBL-SELECT.H-THTK-MS-EKI,
 13392*            :HST-TBL-SELECT.H-HYK-KWS,
 13393*            :HST-TBL-SELECT.H-KWS-SAIYO-YMD,
 13394*            :HST-TBL-SELECT.H-KWS-SAIYO-SOURCE,
 13395*            :HST-TBL-SELECT.H-UYTK-KWS-BOKAZN,
 13396*            :HST-TBL-SELECT.H-SHTK-KN-LC,
 13397*            :HST-TBL-SELECT.H-UYTK-ST-TNK,
 13398*            :HST-TBL-SELECT.H-HYK-KN-LC,
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 232
* MUSR2651.cob                                                     cpy)cpy)y)y)
 13399*            :HST-TBL-SELECT.H-HYK-SNEKI-LC,
 13400*            :HST-TBL-SELECT.H-UYTK-PPAY-ZN,
 13401*            :HST-TBL-SELECT.H-KEKA-RSK-LC,
 13402*            :HST-TBL-SELECT.H-UYTK-MS-EKI,
 13403*            :HST-TBL-SELECT.H-BIKOU-1,
 13404*            :HST-TBL-SELECT.H-BIKOU-2,
 13405*            :HST-TBL-SELECT.H-BIKOU-3,
 13406*            :HST-TBL-SELECT.H-BIKOU-4,
 13407*            :HST-TBL-SELECT.H-BIKOU-5,
 13408*            :HST-TBL-SELECT.H-BIKOU-6,
 13409*            :HST-TBL-SELECT.H-BIKOU-7,
 13410*            :HST-TBL-SELECT.H-BIKOU-8,
 13411*            :HST-TBL-SELECT.H-BIKOU-9,
 13412*            :HST-TBL-SELECT.H-TS-TARGET-KUNI,
 13413*            :HST-TBL-SELECT.H-SJTK-MBHY-ZN,
 13414*            :HST-TBL-SELECT.H-UYTK-MBHY-ZN,
 13415*            :HST-TBL-SELECT.H-TGYOKU-KWS-RATE,
 13416*            :HST-TBL-SELECT.H-THTK-TG-YJKN-ZN,
 13417*            :HST-TBL-SELECT.H-UYTK-TG-YJKN-ZN,
 13418*            :HST-TBL-SELECT.H-THTK-TG-TSR-ZN,
 13419*            :HST-TBL-SELECT.H-UYTK-TG-TSR-ZN,
 13420*            :HST-TBL-SELECT.H-THTK-TG-S-TAX-ZN,
 13421*            :HST-TBL-SELECT.H-UYTK-TG-S-TAX-ZN,
 13422*            :HST-TBL-SELECT.H-THTK-TG-ELS-HIYO-ZN,
 13423*            :HST-TBL-SELECT.H-UYTK-TG-ELS-HIYO-ZN,
 13424*            :HST-TBL-SELECT.H-THTK-TG-SSKG-ZN,
 13425*            :HST-TBL-SELECT.H-UYTK-TG-SSKG-ZN,
 13426*            :HST-TBL-SELECT.H-THTK-AREC-ZN,
 13427*            :HST-TBL-SELECT.H-UYTK-AREC-ZN,
 13428*            :HST-TBL-SELECT.H-THTK-SPAY-ZN,
 13429*            :HST-TBL-SELECT.H-UYTK-SPAY-ZN,
 13430*            :HST-TBL-SELECT.H-THTK-GSZ,
 13431*            :HST-TBL-SELECT.H-GENSEN-TAX-LC,
 13432*            :HST-TBL-SELECT.H-THTK-GSZKP-YT-ZN,
 13433*            :HST-TBL-SELECT.H-UYTK-GSZKP-YT-ZN,
 13434*            :HST-TBL-SELECT.H-BOKA-KWS,
 13435*            :HST-TBL-SELECT.H-THTK-IKAN-HYK-SEZN,
 13436*            :HST-TBL-SELECT.H-UYTK-IKAN-HYK-SEZN,
 13437*            :HST-TBL-SELECT.H-SJTK-IKAN-MSSHEKI,
 13438*            :HST-TBL-SELECT.H-UYTK-IKAN-MSSHEKI,
 13439*            :HST-TBL-SELECT.H-UYTK-IKAN-PPHKZN,
 13440*            :HST-TBL-SELECT.H-OP-TATE-FLG,
 13441*            :HST-TBL-SELECT.H-JIKA-KRTU-CD,
 13442*            :HST-TBL-SELECT.H-SKYU-UMU-FLG,
 13443*            :HST-TBL-SELECT.H-JIKA-SHRU,
 13444*            :HST-TBL-SELECT.H-SOURCE-KBN,
 13445*            :HST-TBL-SELECT.H-UYTK-KPPAY-HYK-GK,
 13446*            :HST-TBL-SELECT.H-UYTK-PPAY-SNEKI,
 13447*            :HST-TBL-SELECT.H-MS-SHEKI-HYK-KWS,
 13448*            :HST-TBL-SELECT.H-GENS-TAX-HYK-KWS,
 13449*            :HST-TBL-SELECT.H-DATA-KBN,
 13450*            :HST-TBL-SELECT.H-SYOHIN-KBN,
 13451*            :HST-TBL-SELECT.H-REP-KBN,
 13452*            :HST-TBL-SELECT.H-KODE-1,
 13453*            :HST-TBL-SELECT.H-SUJI-11,
 13454*            :HST-TBL-SELECT.H-SUJI-12,
 13455*            :HST-TBL-SELECT.H-SUJI-13,
 13456*            :HST-TBL-SELECT.H-KODE-2,
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 233
* MUSR2651.cob                                                     cpy)cpy)y)y)
 13457*            :HST-TBL-SELECT.H-SUJI-21,
 13458*            :HST-TBL-SELECT.H-SUJI-22,
 13459*            :HST-TBL-SELECT.H-SUJI-23,
 13460*            :HST-TBL-SELECT.H-KODE-3,
 13461*            :HST-TBL-SELECT.H-SUJI-31,
 13462*            :HST-TBL-SELECT.H-SUJI-32,
 13463*            :HST-TBL-SELECT.H-SUJI-33,
 13464*            :HST-TBL-SELECT.H-YOBI1,
 13465*            :HST-TBL-SELECT.H-YOBI2,
 13466*            :HST-TBL-SELECT.H-SK-FLG,
 13467*            :HST-TBL-SELECT.H-SK-GAMEN,
 13468*            :HST-TBL-SELECT.H-SK-FILE,
 13469*            :HST-TBL-SELECT.H-SK-DATE,
 13470*            :HST-TBL-SELECT.H-SK-LOGIN-CMP-CD,
 13471*            :HST-TBL-SELECT.H-SK-SID,
 13472*            :HST-TBL-SELECT.H-SK-PGMID,
 13473*            :HST-TBL-SELECT.H-UPD-FLG,
 13474*            :HST-TBL-SELECT.H-UPD-GAMEN,
 13475*            :HST-TBL-SELECT.H-UPD-FILE,
 13476*            :HST-TBL-SELECT.H-UPD-DATE,
 13477*            :HST-TBL-SELECT.H-UPD-LOGIN-CMP-CD,
 13478*            :HST-TBL-SELECT.H-UPD-SID,
 13479*            :HST-TBL-SELECT.H-UPD-PGMID
 13480*    END-EXEC
 13481     MOVE 1 TO SQL-ITERS
 13482     MOVE 98 TO SQL-OFFSET
 13483     MOVE 0 TO SQL-OCCURS
 13484     MOVE 1 TO SQL-SELERR
 13485     CALL "SQLADR" USING
 13486         SQLCUD
 13487         SQL-CUD
 13488     CALL "SQLADR" USING
 13489         SQLCA
 13490         SQL-SQLEST
 13491     MOVE 256 TO SQL-SQLETY
 13492     CALL "SQLADR" USING
 13493         H-RIYO-CMP-CD IN
 13494         HST-TBL-SELECT IN
 13495         HST-AREA
 13496         SQL-SQHSTV(1)
 13497     MOVE 4 TO SQL-SQHSTL(1)
 13498     MOVE 0 TO SQL-SQHSTS(1)
 13499     MOVE 0 TO SQL-SQINDV(1)
 13500     MOVE 0 TO SQL-SQINDS(1)
 13501     MOVE 0 TO SQL-SQHARM(1)
 13502     CALL "SQLADR" USING
 13503         H-FUND-CD IN
 13504         HST-TBL-SELECT IN
 13505         HST-AREA
 13506         SQL-SQHSTV(2)
 13507     MOVE 12 TO SQL-SQHSTL(2)
 13508     MOVE 0 TO SQL-SQHSTS(2)
 13509     MOVE 0 TO SQL-SQINDV(2)
 13510     MOVE 0 TO SQL-SQINDS(2)
 13511     MOVE 0 TO SQL-SQHARM(2)
 13512     CALL "SQLADR" USING
 13513         H-PTF-CD IN
 13514         HST-TBL-SELECT IN
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 234
* MUSR2651.cob                                                     cpy)cpy)y)y)
 13515         HST-AREA
 13516         SQL-SQHSTV(3)
 13517     MOVE 4 TO SQL-SQHSTL(3)
 13518     MOVE 0 TO SQL-SQHSTS(3)
 13519     MOVE 0 TO SQL-SQINDV(3)
 13520     MOVE 0 TO SQL-SQINDS(3)
 13521     MOVE 0 TO SQL-SQHARM(3)
 13522     CALL "SQLADR" USING
 13523         H-YJ-UW-KBN IN
 13524         HST-TBL-SELECT IN
 13525         HST-AREA
 13526         SQL-SQHSTV(4)
 13527     MOVE 1 TO SQL-SQHSTL(4)
 13528     MOVE 0 TO SQL-SQHSTS(4)
 13529     MOVE 0 TO SQL-SQINDV(4)
 13530     MOVE 0 TO SQL-SQINDS(4)
 13531     MOVE 0 TO SQL-SQHARM(4)
 13532     CALL "SQLADR" USING
 13533         H-ZANTK-YMD IN
 13534         HST-TBL-SELECT IN
 13535         HST-AREA
 13536         SQL-SQHSTV(5)
 13537     MOVE 8 TO SQL-SQHSTL(5)
 13538     MOVE 0 TO SQL-SQHSTS(5)
 13539     MOVE 0 TO SQL-SQINDV(5)
 13540     MOVE 0 TO SQL-SQINDS(5)
 13541     MOVE 0 TO SQL-SQHARM(5)
 13542     CALL "SQLADR" USING
 13543         H-KSN-YMD-DMN-KBN IN
 13544         HST-TBL-SELECT IN
 13545         HST-AREA
 13546         SQL-SQHSTV(6)
 13547     MOVE 1 TO SQL-SQHSTL(6)
 13548     MOVE 0 TO SQL-SQHSTS(6)
 13549     MOVE 0 TO SQL-SQINDV(6)
 13550     MOVE 0 TO SQL-SQINDS(6)
 13551     MOVE 0 TO SQL-SQHARM(6)
 13552     CALL "SQLADR" USING
 13553         H-HYK-KRTU-CD IN
 13554         HST-TBL-SELECT IN
 13555         HST-AREA
 13556         SQL-SQHSTV(7)
 13557     MOVE 4 TO SQL-SQHSTL(7)
 13558     MOVE 0 TO SQL-SQHSTS(7)
 13559     MOVE 0 TO SQL-SQINDV(7)
 13560     MOVE 0 TO SQL-SQINDS(7)
 13561     MOVE 0 TO SQL-SQHARM(7)
 13562     CALL "SQLADR" USING
 13563         H-SEC-SBT-CD IN
 13564         HST-TBL-SELECT IN
 13565         HST-AREA
 13566         SQL-SQHSTV(8)
 13567     MOVE 4 TO SQL-SQHSTL(8)
 13568     MOVE 0 TO SQL-SQHSTS(8)
 13569     MOVE 0 TO SQL-SQINDV(8)
 13570     MOVE 0 TO SQL-SQINDS(8)
 13571     MOVE 0 TO SQL-SQHARM(8)
 13572     CALL "SQLADR" USING
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 235
* MUSR2651.cob                                                     cpy)cpy)y)y)
 13573         H-DEL-KBN IN
 13574         HST-TBL-SELECT IN
 13575         HST-AREA
 13576         SQL-SQHSTV(9)
 13577     MOVE 1 TO SQL-SQHSTL(9)
 13578     MOVE 0 TO SQL-SQHSTS(9)
 13579     MOVE 0 TO SQL-SQINDV(9)
 13580     MOVE 0 TO SQL-SQINDS(9)
 13581     MOVE 0 TO SQL-SQHARM(9)
 13582     CALL "SQLADR" USING
 13583         H-KT-KBN IN
 13584         HST-TBL-SELECT IN
 13585         HST-AREA
 13586         SQL-SQHSTV(10)
 13587     MOVE 1 TO SQL-SQHSTL(10)
 13588     MOVE 0 TO SQL-SQHSTS(10)
 13589     MOVE 0 TO SQL-SQINDV(10)
 13590     MOVE 0 TO SQL-SQINDS(10)
 13591     MOVE 0 TO SQL-SQHARM(10)
 13592     CALL "SQLADR" USING
 13593         H-TRHK-TUKA IN
 13594         HST-TBL-SELECT IN
 13595         HST-AREA
 13596         SQL-SQHSTV(11)
 13597     MOVE 4 TO SQL-SQHSTL(11)
 13598     MOVE 0 TO SQL-SQHSTS(11)
 13599     MOVE 0 TO SQL-SQINDV(11)
 13600     MOVE 0 TO SQL-SQINDS(11)
 13601     MOVE 0 TO SQL-SQHARM(11)
 13602     CALL "SQLADR" USING
 13603         H-KWS-TH-TUKA-CD IN
 13604         HST-TBL-SELECT IN
 13605         HST-AREA
 13606         SQL-SQHSTV(12)
 13607     MOVE 4 TO SQL-SQHSTL(12)
 13608     MOVE 0 TO SQL-SQHSTS(12)
 13609     MOVE 0 TO SQL-SQINDV(12)
 13610     MOVE 0 TO SQL-SQINDS(12)
 13611     MOVE 0 TO SQL-SQHARM(12)
 13612     CALL "SQLADR" USING
 13613         H-HAKO-CD IN
 13614         HST-TBL-SELECT IN
 13615         HST-AREA
 13616         SQL-SQHSTV(13)
 13617     MOVE 4 TO SQL-SQHSTL(13)
 13618     MOVE 0 TO SQL-SQHSTS(13)
 13619     MOVE 0 TO SQL-SQINDV(13)
 13620     MOVE 0 TO SQL-SQINDS(13)
 13621     MOVE 0 TO SQL-SQHARM(13)
 13622     CALL "SQLADR" USING
 13623         H-MEG-CD IN
 13624         HST-TBL-SELECT IN
 13625         HST-AREA
 13626         SQL-SQHSTV(14)
 13627     MOVE 15 TO SQL-SQHSTL(14)
 13628     MOVE 0 TO SQL-SQHSTS(14)
 13629     MOVE 0 TO SQL-SQINDV(14)
 13630     MOVE 0 TO SQL-SQINDS(14)
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 236
* MUSR2651.cob                                                     cpy)cpy)y)y)
 13631     MOVE 0 TO SQL-SQHARM(14)
 13632     CALL "SQLADR" USING
 13633         H-TATE-FLG IN
 13634         HST-TBL-SELECT IN
 13635         HST-AREA
 13636         SQL-SQHSTV(15)
 13637     MOVE 1 TO SQL-SQHSTL(15)
 13638     MOVE 0 TO SQL-SQHSTS(15)
 13639     MOVE 0 TO SQL-SQINDV(15)
 13640     MOVE 0 TO SQL-SQINDS(15)
 13641     MOVE 0 TO SQL-SQHARM(15)
 13642     CALL "SQLADR" USING
 13643         H-TG-YKJ-YMD IN
 13644         HST-TBL-SELECT IN
 13645         HST-AREA
 13646         SQL-SQHSTV(16)
 13647     MOVE 8 TO SQL-SQHSTL(16)
 13648     MOVE 0 TO SQL-SQHSTS(16)
 13649     MOVE 0 TO SQL-SQINDV(16)
 13650     MOVE 0 TO SQL-SQINDS(16)
 13651     MOVE 0 TO SQL-SQHARM(16)
 13652     CALL "SQLADR" USING
 13653         H-KB-KANRI-ID IN
 13654         HST-TBL-SELECT IN
 13655         HST-AREA
 13656         SQL-SQHSTV(17)
 13657     MOVE 10 TO SQL-SQHSTL(17)
 13658     MOVE 0 TO SQL-SQHSTS(17)
 13659     MOVE 0 TO SQL-SQINDV(17)
 13660     MOVE 0 TO SQL-SQINDS(17)
 13661     MOVE 0 TO SQL-SQHARM(17)
 13662     CALL "SQLADR" USING
 13663         H-CAST-CD IN
 13664         HST-TBL-SELECT IN
 13665         HST-AREA
 13666         SQL-SQHSTV(18)
 13667     MOVE 4 TO SQL-SQHSTL(18)
 13668     MOVE 0 TO SQL-SQHSTS(18)
 13669     MOVE 0 TO SQL-SQINDV(18)
 13670     MOVE 0 TO SQL-SQINDS(18)
 13671     MOVE 0 TO SQL-SQHARM(18)
 13672     CALL "SQLADR" USING
 13673         H-HOU-SURYO IN
 13674         HST-TBL-SELECT IN
 13675         HST-AREA
 13676         SQL-SQHSTV(19)
 13677     MOVE 18 TO SQL-SQHSTL(19)
 13678     MOVE 0 TO SQL-SQHSTS(19)
 13679     MOVE 0 TO SQL-SQINDV(19)
 13680     MOVE 0 TO SQL-SQINDS(19)
 13681     MOVE 0 TO SQL-SQHARM(19)
 13682     CALL "SQLADR" USING
 13683         H-SURYO-TANI IN
 13684         HST-TBL-SELECT IN
 13685         HST-AREA
 13686         SQL-SQHSTV(20)
 13687     MOVE 18 TO SQL-SQHSTL(20)
 13688     MOVE 0 TO SQL-SQHSTS(20)
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 237
* MUSR2651.cob                                                     cpy)cpy)y)y)
 13689     MOVE 0 TO SQL-SQINDV(20)
 13690     MOVE 0 TO SQL-SQINDS(20)
 13691     MOVE 0 TO SQL-SQHARM(20)
 13692     CALL "SQLADR" USING
 13693         H-THTK-ST-KNG IN
 13694         HST-TBL-SELECT IN
 13695         HST-AREA
 13696         SQL-SQHSTV(21)
 13697     MOVE 18 TO SQL-SQHSTL(21)
 13698     MOVE 0 TO SQL-SQHSTS(21)
 13699     MOVE 0 TO SQL-SQINDV(21)
 13700     MOVE 0 TO SQL-SQINDS(21)
 13701     MOVE 0 TO SQL-SQHARM(21)
 13702     CALL "SQLADR" USING
 13703         H-THTK-ST-TNK IN
 13704         HST-TBL-SELECT IN
 13705         HST-AREA
 13706         SQL-SQHSTV(22)
 13707     MOVE 18 TO SQL-SQHSTL(22)
 13708     MOVE 0 TO SQL-SQHSTS(22)
 13709     MOVE 0 TO SQL-SQINDV(22)
 13710     MOVE 0 TO SQL-SQINDS(22)
 13711     MOVE 0 TO SQL-SQHARM(22)
 13712     CALL "SQLADR" USING
 13713         H-CP-KRTU-CD IN
 13714         HST-TBL-SELECT IN
 13715         HST-AREA
 13716         SQL-SQHSTV(23)
 13717     MOVE 18 TO SQL-SQHSTL(23)
 13718     MOVE 0 TO SQL-SQHSTS(23)
 13719     MOVE 0 TO SQL-SQINDV(23)
 13720     MOVE 0 TO SQL-SQINDS(23)
 13721     MOVE 0 TO SQL-SQHARM(23)
 13722     CALL "SQLADR" USING
 13723         H-CP-SAIYO-YMD IN
 13724         HST-TBL-SELECT IN
 13725         HST-AREA
 13726         SQL-SQHSTV(24)
 13727     MOVE 8 TO SQL-SQHSTL(24)
 13728     MOVE 0 TO SQL-SQHSTS(24)
 13729     MOVE 0 TO SQL-SQINDV(24)
 13730     MOVE 0 TO SQL-SQINDS(24)
 13731     MOVE 0 TO SQL-SQHARM(24)
 13732     CALL "SQLADR" USING
 13733         H-CP-SAIYO-SIJO IN
 13734         HST-TBL-SELECT IN
 13735         HST-AREA
 13736         SQL-SQHSTV(25)
 13737     MOVE 4 TO SQL-SQHSTL(25)
 13738     MOVE 0 TO SQL-SQHSTS(25)
 13739     MOVE 0 TO SQL-SQINDV(25)
 13740     MOVE 0 TO SQL-SQINDS(25)
 13741     MOVE 0 TO SQL-SQHARM(25)
 13742     CALL "SQLADR" USING
 13743         H-THTK-HYK-KN IN
 13744         HST-TBL-SELECT IN
 13745         HST-AREA
 13746         SQL-SQHSTV(26)
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 238
* MUSR2651.cob                                                     cpy)cpy)y)y)
 13747     MOVE 18 TO SQL-SQHSTL(26)
 13748     MOVE 0 TO SQL-SQHSTS(26)
 13749     MOVE 0 TO SQL-SQINDV(26)
 13750     MOVE 0 TO SQL-SQINDS(26)
 13751     MOVE 0 TO SQL-SQHARM(26)
 13752     CALL "SQLADR" USING
 13753         H-THTK-HYK-SNEKI IN
 13754         HST-TBL-SELECT IN
 13755         HST-AREA
 13756         SQL-SQHSTV(27)
 13757     MOVE 18 TO SQL-SQHSTL(27)
 13758     MOVE 0 TO SQL-SQHSTS(27)
 13759     MOVE 0 TO SQL-SQINDV(27)
 13760     MOVE 0 TO SQL-SQINDS(27)
 13761     MOVE 0 TO SQL-SQHARM(27)
 13762     CALL "SQLADR" USING
 13763         H-THTK-PPAYZN IN
 13764         HST-TBL-SELECT IN
 13765         HST-AREA
 13766         SQL-SQHSTV(28)
 13767     MOVE 18 TO SQL-SQHSTL(28)
 13768     MOVE 0 TO SQL-SQHSTS(28)
 13769     MOVE 0 TO SQL-SQINDV(28)
 13770     MOVE 0 TO SQL-SQINDS(28)
 13771     MOVE 0 TO SQL-SQHARM(28)
 13772     CALL "SQLADR" USING
 13773         H-THTK-KKRS IN
 13774         HST-TBL-SELECT IN
 13775         HST-AREA
 13776         SQL-SQHSTV(29)
 13777     MOVE 18 TO SQL-SQHSTL(29)
 13778     MOVE 0 TO SQL-SQHSTS(29)
 13779     MOVE 0 TO SQL-SQINDV(29)
 13780     MOVE 0 TO SQL-SQINDS(29)
 13781     MOVE 0 TO SQL-SQHARM(29)
 13782     CALL "SQLADR" USING
 13783         H-THTK-MS-EKI IN
 13784         HST-TBL-SELECT IN
 13785         HST-AREA
 13786         SQL-SQHSTV(30)
 13787     MOVE 18 TO SQL-SQHSTL(30)
 13788     MOVE 0 TO SQL-SQHSTS(30)
 13789     MOVE 0 TO SQL-SQINDV(30)
 13790     MOVE 0 TO SQL-SQINDS(30)
 13791     MOVE 0 TO SQL-SQHARM(30)
 13792     CALL "SQLADR" USING
 13793         H-HYK-KWS IN
 13794         HST-TBL-SELECT IN
 13795         HST-AREA
 13796         SQL-SQHSTV(31)
 13797     MOVE 18 TO SQL-SQHSTL(31)
 13798     MOVE 0 TO SQL-SQHSTS(31)
 13799     MOVE 0 TO SQL-SQINDV(31)
 13800     MOVE 0 TO SQL-SQINDS(31)
 13801     MOVE 0 TO SQL-SQHARM(31)
 13802     CALL "SQLADR" USING
 13803         H-KWS-SAIYO-YMD IN
 13804         HST-TBL-SELECT IN
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 239
* MUSR2651.cob                                                     cpy)cpy)y)y)
 13805         HST-AREA
 13806         SQL-SQHSTV(32)
 13807     MOVE 8 TO SQL-SQHSTL(32)
 13808     MOVE 0 TO SQL-SQHSTS(32)
 13809     MOVE 0 TO SQL-SQINDV(32)
 13810     MOVE 0 TO SQL-SQINDS(32)
 13811     MOVE 0 TO SQL-SQHARM(32)
 13812     CALL "SQLADR" USING
 13813         H-KWS-SAIYO-SOURCE IN
 13814         HST-TBL-SELECT IN
 13815         HST-AREA
 13816         SQL-SQHSTV(33)
 13817     MOVE 4 TO SQL-SQHSTL(33)
 13818     MOVE 0 TO SQL-SQHSTS(33)
 13819     MOVE 0 TO SQL-SQINDV(33)
 13820     MOVE 0 TO SQL-SQINDS(33)
 13821     MOVE 0 TO SQL-SQHARM(33)
 13822     CALL "SQLADR" USING
 13823         H-UYTK-KWS-BOKAZN IN
 13824         HST-TBL-SELECT IN
 13825         HST-AREA
 13826         SQL-SQHSTV(34)
 13827     MOVE 18 TO SQL-SQHSTL(34)
 13828     MOVE 0 TO SQL-SQHSTS(34)
 13829     MOVE 0 TO SQL-SQINDV(34)
 13830     MOVE 0 TO SQL-SQINDS(34)
 13831     MOVE 0 TO SQL-SQHARM(34)
 13832     CALL "SQLADR" USING
 13833         H-SHTK-KN-LC IN
 13834         HST-TBL-SELECT IN
 13835         HST-AREA
 13836         SQL-SQHSTV(35)
 13837     MOVE 18 TO SQL-SQHSTL(35)
 13838     MOVE 0 TO SQL-SQHSTS(35)
 13839     MOVE 0 TO SQL-SQINDV(35)
 13840     MOVE 0 TO SQL-SQINDS(35)
 13841     MOVE 0 TO SQL-SQHARM(35)
 13842     CALL "SQLADR" USING
 13843         H-UYTK-ST-TNK IN
 13844         HST-TBL-SELECT IN
 13845         HST-AREA
 13846         SQL-SQHSTV(36)
 13847     MOVE 18 TO SQL-SQHSTL(36)
 13848     MOVE 0 TO SQL-SQHSTS(36)
 13849     MOVE 0 TO SQL-SQINDV(36)
 13850     MOVE 0 TO SQL-SQINDS(36)
 13851     MOVE 0 TO SQL-SQHARM(36)
 13852     CALL "SQLADR" USING
 13853         H-HYK-KN-LC IN
 13854         HST-TBL-SELECT IN
 13855         HST-AREA
 13856         SQL-SQHSTV(37)
 13857     MOVE 18 TO SQL-SQHSTL(37)
 13858     MOVE 0 TO SQL-SQHSTS(37)
 13859     MOVE 0 TO SQL-SQINDV(37)
 13860     MOVE 0 TO SQL-SQINDS(37)
 13861     MOVE 0 TO SQL-SQHARM(37)
 13862     CALL "SQLADR" USING
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 240
* MUSR2651.cob                                                     cpy)cpy)y)y)
 13863         H-HYK-SNEKI-LC IN
 13864         HST-TBL-SELECT IN
 13865         HST-AREA
 13866         SQL-SQHSTV(38)
 13867     MOVE 18 TO SQL-SQHSTL(38)
 13868     MOVE 0 TO SQL-SQHSTS(38)
 13869     MOVE 0 TO SQL-SQINDV(38)
 13870     MOVE 0 TO SQL-SQINDS(38)
 13871     MOVE 0 TO SQL-SQHARM(38)
 13872     CALL "SQLADR" USING
 13873         H-UYTK-PPAY-ZN IN
 13874         HST-TBL-SELECT IN
 13875         HST-AREA
 13876         SQL-SQHSTV(39)
 13877     MOVE 18 TO SQL-SQHSTL(39)
 13878     MOVE 0 TO SQL-SQHSTS(39)
 13879     MOVE 0 TO SQL-SQINDV(39)
 13880     MOVE 0 TO SQL-SQINDS(39)
 13881     MOVE 0 TO SQL-SQHARM(39)
 13882     CALL "SQLADR" USING
 13883         H-KEKA-RSK-LC IN
 13884         HST-TBL-SELECT IN
 13885         HST-AREA
 13886         SQL-SQHSTV(40)
 13887     MOVE 18 TO SQL-SQHSTL(40)
 13888     MOVE 0 TO SQL-SQHSTS(40)
 13889     MOVE 0 TO SQL-SQINDV(40)
 13890     MOVE 0 TO SQL-SQINDS(40)
 13891     MOVE 0 TO SQL-SQHARM(40)
 13892     CALL "SQLADR" USING
 13893         H-UYTK-MS-EKI IN
 13894         HST-TBL-SELECT IN
 13895         HST-AREA
 13896         SQL-SQHSTV(41)
 13897     MOVE 18 TO SQL-SQHSTL(41)
 13898     MOVE 0 TO SQL-SQHSTS(41)
 13899     MOVE 0 TO SQL-SQINDV(41)
 13900     MOVE 0 TO SQL-SQINDS(41)
 13901     MOVE 0 TO SQL-SQHARM(41)
 13902     CALL "SQLADR" USING
 13903         H-BIKOU-1 IN
 13904         HST-TBL-SELECT IN
 13905         HST-AREA
 13906         SQL-SQHSTV(42)
 13907     MOVE 20 TO SQL-SQHSTL(42)
 13908     MOVE 0 TO SQL-SQHSTS(42)
 13909     MOVE 0 TO SQL-SQINDV(42)
 13910     MOVE 0 TO SQL-SQINDS(42)
 13911     MOVE 0 TO SQL-SQHARM(42)
 13912     CALL "SQLADR" USING
 13913         H-BIKOU-2 IN
 13914         HST-TBL-SELECT IN
 13915         HST-AREA
 13916         SQL-SQHSTV(43)
 13917     MOVE 20 TO SQL-SQHSTL(43)
 13918     MOVE 0 TO SQL-SQHSTS(43)
 13919     MOVE 0 TO SQL-SQINDV(43)
 13920     MOVE 0 TO SQL-SQINDS(43)
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 241
* MUSR2651.cob                                                     cpy)cpy)y)y)
 13921     MOVE 0 TO SQL-SQHARM(43)
 13922     CALL "SQLADR" USING
 13923         H-BIKOU-3 IN
 13924         HST-TBL-SELECT IN
 13925         HST-AREA
 13926         SQL-SQHSTV(44)
 13927     MOVE 12 TO SQL-SQHSTL(44)
 13928     MOVE 0 TO SQL-SQHSTS(44)
 13929     MOVE 0 TO SQL-SQINDV(44)
 13930     MOVE 0 TO SQL-SQINDS(44)
 13931     MOVE 0 TO SQL-SQHARM(44)
 13932     CALL "SQLADR" USING
 13933         H-BIKOU-4 IN
 13934         HST-TBL-SELECT IN
 13935         HST-AREA
 13936         SQL-SQHSTV(45)
 13937     MOVE 12 TO SQL-SQHSTL(45)
 13938     MOVE 0 TO SQL-SQHSTS(45)
 13939     MOVE 0 TO SQL-SQINDV(45)
 13940     MOVE 0 TO SQL-SQINDS(45)
 13941     MOVE 0 TO SQL-SQHARM(45)
 13942     CALL "SQLADR" USING
 13943         H-BIKOU-5 IN
 13944         HST-TBL-SELECT IN
 13945         HST-AREA
 13946         SQL-SQHSTV(46)
 13947     MOVE 18 TO SQL-SQHSTL(46)
 13948     MOVE 0 TO SQL-SQHSTS(46)
 13949     MOVE 0 TO SQL-SQINDV(46)
 13950     MOVE 0 TO SQL-SQINDS(46)
 13951     MOVE 0 TO SQL-SQHARM(46)
 13952     CALL "SQLADR" USING
 13953         H-BIKOU-6 IN
 13954         HST-TBL-SELECT IN
 13955         HST-AREA
 13956         SQL-SQHSTV(47)
 13957     MOVE 18 TO SQL-SQHSTL(47)
 13958     MOVE 0 TO SQL-SQHSTS(47)
 13959     MOVE 0 TO SQL-SQINDV(47)
 13960     MOVE 0 TO SQL-SQINDS(47)
 13961     MOVE 0 TO SQL-SQHARM(47)
 13962     CALL "SQLADR" USING
 13963         H-BIKOU-7 IN
 13964         HST-TBL-SELECT IN
 13965         HST-AREA
 13966         SQL-SQHSTV(48)
 13967     MOVE 18 TO SQL-SQHSTL(48)
 13968     MOVE 0 TO SQL-SQHSTS(48)
 13969     MOVE 0 TO SQL-SQINDV(48)
 13970     MOVE 0 TO SQL-SQINDS(48)
 13971     MOVE 0 TO SQL-SQHARM(48)
 13972     CALL "SQLADR" USING
 13973         H-BIKOU-8 IN
 13974         HST-TBL-SELECT IN
 13975         HST-AREA
 13976         SQL-SQHSTV(49)
 13977     MOVE 18 TO SQL-SQHSTL(49)
 13978     MOVE 0 TO SQL-SQHSTS(49)
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 242
* MUSR2651.cob                                                     cpy)cpy)y)y)
 13979     MOVE 0 TO SQL-SQINDV(49)
 13980     MOVE 0 TO SQL-SQINDS(49)
 13981     MOVE 0 TO SQL-SQHARM(49)
 13982     CALL "SQLADR" USING
 13983         H-BIKOU-9 IN
 13984         HST-TBL-SELECT IN
 13985         HST-AREA
 13986         SQL-SQHSTV(50)
 13987     MOVE 18 TO SQL-SQHSTL(50)
 13988     MOVE 0 TO SQL-SQHSTS(50)
 13989     MOVE 0 TO SQL-SQINDV(50)
 13990     MOVE 0 TO SQL-SQINDS(50)
 13991     MOVE 0 TO SQL-SQHARM(50)
 13992     CALL "SQLADR" USING
 13993         H-TS-TARGET-KUNI IN
 13994         HST-TBL-SELECT IN
 13995         HST-AREA
 13996         SQL-SQHSTV(51)
 13997     MOVE 4 TO SQL-SQHSTL(51)
 13998     MOVE 0 TO SQL-SQHSTS(51)
 13999     MOVE 0 TO SQL-SQINDV(51)
 14000     MOVE 0 TO SQL-SQINDS(51)
 14001     MOVE 0 TO SQL-SQHARM(51)
 14002     CALL "SQLADR" USING
 14003         H-SJTK-MBHY-ZN IN
 14004         HST-TBL-SELECT IN
 14005         HST-AREA
 14006         SQL-SQHSTV(52)
 14007     MOVE 18 TO SQL-SQHSTL(52)
 14008     MOVE 0 TO SQL-SQHSTS(52)
 14009     MOVE 0 TO SQL-SQINDV(52)
 14010     MOVE 0 TO SQL-SQINDS(52)
 14011     MOVE 0 TO SQL-SQHARM(52)
 14012     CALL "SQLADR" USING
 14013         H-UYTK-MBHY-ZN IN
 14014         HST-TBL-SELECT IN
 14015         HST-AREA
 14016         SQL-SQHSTV(53)
 14017     MOVE 18 TO SQL-SQHSTL(53)
 14018     MOVE 0 TO SQL-SQHSTS(53)
 14019     MOVE 0 TO SQL-SQINDV(53)
 14020     MOVE 0 TO SQL-SQINDS(53)
 14021     MOVE 0 TO SQL-SQHARM(53)
 14022     CALL "SQLADR" USING
 14023         H-TGYOKU-KWS-RATE IN
 14024         HST-TBL-SELECT IN
 14025         HST-AREA
 14026         SQL-SQHSTV(54)
 14027     MOVE 18 TO SQL-SQHSTL(54)
 14028     MOVE 0 TO SQL-SQHSTS(54)
 14029     MOVE 0 TO SQL-SQINDV(54)
 14030     MOVE 0 TO SQL-SQINDS(54)
 14031     MOVE 0 TO SQL-SQHARM(54)
 14032     CALL "SQLADR" USING
 14033         H-THTK-TG-YJKN-ZN IN
 14034         HST-TBL-SELECT IN
 14035         HST-AREA
 14036         SQL-SQHSTV(55)
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 243
* MUSR2651.cob                                                     cpy)cpy)y)y)
 14037     MOVE 18 TO SQL-SQHSTL(55)
 14038     MOVE 0 TO SQL-SQHSTS(55)
 14039     MOVE 0 TO SQL-SQINDV(55)
 14040     MOVE 0 TO SQL-SQINDS(55)
 14041     MOVE 0 TO SQL-SQHARM(55)
 14042     CALL "SQLADR" USING
 14043         H-UYTK-TG-YJKN-ZN IN
 14044         HST-TBL-SELECT IN
 14045         HST-AREA
 14046         SQL-SQHSTV(56)
 14047     MOVE 18 TO SQL-SQHSTL(56)
 14048     MOVE 0 TO SQL-SQHSTS(56)
 14049     MOVE 0 TO SQL-SQINDV(56)
 14050     MOVE 0 TO SQL-SQINDS(56)
 14051     MOVE 0 TO SQL-SQHARM(56)
 14052     CALL "SQLADR" USING
 14053         H-THTK-TG-TSR-ZN IN
 14054         HST-TBL-SELECT IN
 14055         HST-AREA
 14056         SQL-SQHSTV(57)
 14057     MOVE 18 TO SQL-SQHSTL(57)
 14058     MOVE 0 TO SQL-SQHSTS(57)
 14059     MOVE 0 TO SQL-SQINDV(57)
 14060     MOVE 0 TO SQL-SQINDS(57)
 14061     MOVE 0 TO SQL-SQHARM(57)
 14062     CALL "SQLADR" USING
 14063         H-UYTK-TG-TSR-ZN IN
 14064         HST-TBL-SELECT IN
 14065         HST-AREA
 14066         SQL-SQHSTV(58)
 14067     MOVE 18 TO SQL-SQHSTL(58)
 14068     MOVE 0 TO SQL-SQHSTS(58)
 14069     MOVE 0 TO SQL-SQINDV(58)
 14070     MOVE 0 TO SQL-SQINDS(58)
 14071     MOVE 0 TO SQL-SQHARM(58)
 14072     CALL "SQLADR" USING
 14073         H-THTK-TG-S-TAX-ZN IN
 14074         HST-TBL-SELECT IN
 14075         HST-AREA
 14076         SQL-SQHSTV(59)
 14077     MOVE 18 TO SQL-SQHSTL(59)
 14078     MOVE 0 TO SQL-SQHSTS(59)
 14079     MOVE 0 TO SQL-SQINDV(59)
 14080     MOVE 0 TO SQL-SQINDS(59)
 14081     MOVE 0 TO SQL-SQHARM(59)
 14082     CALL "SQLADR" USING
 14083         H-UYTK-TG-S-TAX-ZN IN
 14084         HST-TBL-SELECT IN
 14085         HST-AREA
 14086         SQL-SQHSTV(60)
 14087     MOVE 18 TO SQL-SQHSTL(60)
 14088     MOVE 0 TO SQL-SQHSTS(60)
 14089     MOVE 0 TO SQL-SQINDV(60)
 14090     MOVE 0 TO SQL-SQINDS(60)
 14091     MOVE 0 TO SQL-SQHARM(60)
 14092     CALL "SQLADR" USING
 14093         H-THTK-TG-ELS-HIYO-ZN IN
 14094         HST-TBL-SELECT IN
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 244
* MUSR2651.cob                                                     cpy)cpy)y)y)
 14095         HST-AREA
 14096         SQL-SQHSTV(61)
 14097     MOVE 18 TO SQL-SQHSTL(61)
 14098     MOVE 0 TO SQL-SQHSTS(61)
 14099     MOVE 0 TO SQL-SQINDV(61)
 14100     MOVE 0 TO SQL-SQINDS(61)
 14101     MOVE 0 TO SQL-SQHARM(61)
 14102     CALL "SQLADR" USING
 14103         H-UYTK-TG-ELS-HIYO-ZN IN
 14104         HST-TBL-SELECT IN
 14105         HST-AREA
 14106         SQL-SQHSTV(62)
 14107     MOVE 18 TO SQL-SQHSTL(62)
 14108     MOVE 0 TO SQL-SQHSTS(62)
 14109     MOVE 0 TO SQL-SQINDV(62)
 14110     MOVE 0 TO SQL-SQINDS(62)
 14111     MOVE 0 TO SQL-SQHARM(62)
 14112     CALL "SQLADR" USING
 14113         H-THTK-TG-SSKG-ZN IN
 14114         HST-TBL-SELECT IN
 14115         HST-AREA
 14116         SQL-SQHSTV(63)
 14117     MOVE 18 TO SQL-SQHSTL(63)
 14118     MOVE 0 TO SQL-SQHSTS(63)
 14119     MOVE 0 TO SQL-SQINDV(63)
 14120     MOVE 0 TO SQL-SQINDS(63)
 14121     MOVE 0 TO SQL-SQHARM(63)
 14122     CALL "SQLADR" USING
 14123         H-UYTK-TG-SSKG-ZN IN
 14124         HST-TBL-SELECT IN
 14125         HST-AREA
 14126         SQL-SQHSTV(64)
 14127     MOVE 18 TO SQL-SQHSTL(64)
 14128     MOVE 0 TO SQL-SQHSTS(64)
 14129     MOVE 0 TO SQL-SQINDV(64)
 14130     MOVE 0 TO SQL-SQINDS(64)
 14131     MOVE 0 TO SQL-SQHARM(64)
 14132     CALL "SQLADR" USING
 14133         H-THTK-AREC-ZN IN
 14134         HST-TBL-SELECT IN
 14135         HST-AREA
 14136         SQL-SQHSTV(65)
 14137     MOVE 18 TO SQL-SQHSTL(65)
 14138     MOVE 0 TO SQL-SQHSTS(65)
 14139     MOVE 0 TO SQL-SQINDV(65)
 14140     MOVE 0 TO SQL-SQINDS(65)
 14141     MOVE 0 TO SQL-SQHARM(65)
 14142     CALL "SQLADR" USING
 14143         H-UYTK-AREC-ZN IN
 14144         HST-TBL-SELECT IN
 14145         HST-AREA
 14146         SQL-SQHSTV(66)
 14147     MOVE 18 TO SQL-SQHSTL(66)
 14148     MOVE 0 TO SQL-SQHSTS(66)
 14149     MOVE 0 TO SQL-SQINDV(66)
 14150     MOVE 0 TO SQL-SQINDS(66)
 14151     MOVE 0 TO SQL-SQHARM(66)
 14152     CALL "SQLADR" USING
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 245
* MUSR2651.cob                                                     cpy)cpy)y)y)
 14153         H-THTK-SPAY-ZN IN
 14154         HST-TBL-SELECT IN
 14155         HST-AREA
 14156         SQL-SQHSTV(67)
 14157     MOVE 18 TO SQL-SQHSTL(67)
 14158     MOVE 0 TO SQL-SQHSTS(67)
 14159     MOVE 0 TO SQL-SQINDV(67)
 14160     MOVE 0 TO SQL-SQINDS(67)
 14161     MOVE 0 TO SQL-SQHARM(67)
 14162     CALL "SQLADR" USING
 14163         H-UYTK-SPAY-ZN IN
 14164         HST-TBL-SELECT IN
 14165         HST-AREA
 14166         SQL-SQHSTV(68)
 14167     MOVE 18 TO SQL-SQHSTL(68)
 14168     MOVE 0 TO SQL-SQHSTS(68)
 14169     MOVE 0 TO SQL-SQINDV(68)
 14170     MOVE 0 TO SQL-SQINDS(68)
 14171     MOVE 0 TO SQL-SQHARM(68)
 14172     CALL "SQLADR" USING
 14173         H-THTK-GSZ IN
 14174         HST-TBL-SELECT IN
 14175         HST-AREA
 14176         SQL-SQHSTV(69)
 14177     MOVE 18 TO SQL-SQHSTL(69)
 14178     MOVE 0 TO SQL-SQHSTS(69)
 14179     MOVE 0 TO SQL-SQINDV(69)
 14180     MOVE 0 TO SQL-SQINDS(69)
 14181     MOVE 0 TO SQL-SQHARM(69)
 14182     CALL "SQLADR" USING
 14183         H-GENSEN-TAX-LC IN
 14184         HST-TBL-SELECT IN
 14185         HST-AREA
 14186         SQL-SQHSTV(70)
 14187     MOVE 18 TO SQL-SQHSTL(70)
 14188     MOVE 0 TO SQL-SQHSTS(70)
 14189     MOVE 0 TO SQL-SQINDV(70)
 14190     MOVE 0 TO SQL-SQINDS(70)
 14191     MOVE 0 TO SQL-SQHARM(70)
 14192     CALL "SQLADR" USING
 14193         H-THTK-GSZKP-YT-ZN IN
 14194         HST-TBL-SELECT IN
 14195         HST-AREA
 14196         SQL-SQHSTV(71)
 14197     MOVE 18 TO SQL-SQHSTL(71)
 14198     MOVE 0 TO SQL-SQHSTS(71)
 14199     MOVE 0 TO SQL-SQINDV(71)
 14200     MOVE 0 TO SQL-SQINDS(71)
 14201     MOVE 0 TO SQL-SQHARM(71)
 14202     CALL "SQLADR" USING
 14203         H-UYTK-GSZKP-YT-ZN IN
 14204         HST-TBL-SELECT IN
 14205         HST-AREA
 14206         SQL-SQHSTV(72)
 14207     MOVE 18 TO SQL-SQHSTL(72)
 14208     MOVE 0 TO SQL-SQHSTS(72)
 14209     MOVE 0 TO SQL-SQINDV(72)
 14210     MOVE 0 TO SQL-SQINDS(72)
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 246
* MUSR2651.cob                                                     cpy)cpy)y)y)
 14211     MOVE 0 TO SQL-SQHARM(72)
 14212     CALL "SQLADR" USING
 14213         H-BOKA-KWS IN
 14214         HST-TBL-SELECT IN
 14215         HST-AREA
 14216         SQL-SQHSTV(73)
 14217     MOVE 18 TO SQL-SQHSTL(73)
 14218     MOVE 0 TO SQL-SQHSTS(73)
 14219     MOVE 0 TO SQL-SQINDV(73)
 14220     MOVE 0 TO SQL-SQINDS(73)
 14221     MOVE 0 TO SQL-SQHARM(73)
 14222     CALL "SQLADR" USING
 14223         H-THTK-IKAN-HYK-SEZN IN
 14224         HST-TBL-SELECT IN
 14225         HST-AREA
 14226         SQL-SQHSTV(74)
 14227     MOVE 18 TO SQL-SQHSTL(74)
 14228     MOVE 0 TO SQL-SQHSTS(74)
 14229     MOVE 0 TO SQL-SQINDV(74)
 14230     MOVE 0 TO SQL-SQINDS(74)
 14231     MOVE 0 TO SQL-SQHARM(74)
 14232     CALL "SQLADR" USING
 14233         H-UYTK-IKAN-HYK-SEZN IN
 14234         HST-TBL-SELECT IN
 14235         HST-AREA
 14236         SQL-SQHSTV(75)
 14237     MOVE 18 TO SQL-SQHSTL(75)
 14238     MOVE 0 TO SQL-SQHSTS(75)
 14239     MOVE 0 TO SQL-SQINDV(75)
 14240     MOVE 0 TO SQL-SQINDS(75)
 14241     MOVE 0 TO SQL-SQHARM(75)
 14242     CALL "SQLADR" USING
 14243         H-SJTK-IKAN-MSSHEKI IN
 14244         HST-TBL-SELECT IN
 14245         HST-AREA
 14246         SQL-SQHSTV(76)
 14247     MOVE 18 TO SQL-SQHSTL(76)
 14248     MOVE 0 TO SQL-SQHSTS(76)
 14249     MOVE 0 TO SQL-SQINDV(76)
 14250     MOVE 0 TO SQL-SQINDS(76)
 14251     MOVE 0 TO SQL-SQHARM(76)
 14252     CALL "SQLADR" USING
 14253         H-UYTK-IKAN-MSSHEKI IN
 14254         HST-TBL-SELECT IN
 14255         HST-AREA
 14256         SQL-SQHSTV(77)
 14257     MOVE 18 TO SQL-SQHSTL(77)
 14258     MOVE 0 TO SQL-SQHSTS(77)
 14259     MOVE 0 TO SQL-SQINDV(77)
 14260     MOVE 0 TO SQL-SQINDS(77)
 14261     MOVE 0 TO SQL-SQHARM(77)
 14262     CALL "SQLADR" USING
 14263         H-UYTK-IKAN-PPHKZN IN
 14264         HST-TBL-SELECT IN
 14265         HST-AREA
 14266         SQL-SQHSTV(78)
 14267     MOVE 18 TO SQL-SQHSTL(78)
 14268     MOVE 0 TO SQL-SQHSTS(78)
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 247
* MUSR2651.cob                                                     cpy)cpy)y)y)
 14269     MOVE 0 TO SQL-SQINDV(78)
 14270     MOVE 0 TO SQL-SQINDS(78)
 14271     MOVE 0 TO SQL-SQHARM(78)
 14272     CALL "SQLADR" USING
 14273         H-OP-TATE-FLG IN
 14274         HST-TBL-SELECT IN
 14275         HST-AREA
 14276         SQL-SQHSTV(79)
 14277     MOVE 1 TO SQL-SQHSTL(79)
 14278     MOVE 0 TO SQL-SQHSTS(79)
 14279     MOVE 0 TO SQL-SQINDV(79)
 14280     MOVE 0 TO SQL-SQINDS(79)
 14281     MOVE 0 TO SQL-SQHARM(79)
 14282     CALL "SQLADR" USING
 14283         H-JIKA-KRTU-CD IN
 14284         HST-TBL-SELECT IN
 14285         HST-AREA
 14286         SQL-SQHSTV(80)
 14287     MOVE 4 TO SQL-SQHSTL(80)
 14288     MOVE 0 TO SQL-SQHSTS(80)
 14289     MOVE 0 TO SQL-SQINDV(80)
 14290     MOVE 0 TO SQL-SQINDS(80)
 14291     MOVE 0 TO SQL-SQHARM(80)
 14292     CALL "SQLADR" USING
 14293         H-SKYU-UMU-FLG IN
 14294         HST-TBL-SELECT IN
 14295         HST-AREA
 14296         SQL-SQHSTV(81)
 14297     MOVE 1 TO SQL-SQHSTL(81)
 14298     MOVE 0 TO SQL-SQHSTS(81)
 14299     MOVE 0 TO SQL-SQINDV(81)
 14300     MOVE 0 TO SQL-SQINDS(81)
 14301     MOVE 0 TO SQL-SQHARM(81)
 14302     CALL "SQLADR" USING
 14303         H-JIKA-SHRU IN
 14304         HST-TBL-SELECT IN
 14305         HST-AREA
 14306         SQL-SQHSTV(82)
 14307     MOVE 4 TO SQL-SQHSTL(82)
 14308     MOVE 0 TO SQL-SQHSTS(82)
 14309     MOVE 0 TO SQL-SQINDV(82)
 14310     MOVE 0 TO SQL-SQINDS(82)
 14311     MOVE 0 TO SQL-SQHARM(82)
 14312     CALL "SQLADR" USING
 14313         H-SOURCE-KBN IN
 14314         HST-TBL-SELECT IN
 14315         HST-AREA
 14316         SQL-SQHSTV(83)
 14317     MOVE 2 TO SQL-SQHSTL(83)
 14318     MOVE 0 TO SQL-SQHSTS(83)
 14319     MOVE 0 TO SQL-SQINDV(83)
 14320     MOVE 0 TO SQL-SQINDS(83)
 14321     MOVE 0 TO SQL-SQHARM(83)
 14322     CALL "SQLADR" USING
 14323         H-UYTK-KPPAY-HYK-GK IN
 14324         HST-TBL-SELECT IN
 14325         HST-AREA
 14326         SQL-SQHSTV(84)
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 248
* MUSR2651.cob                                                     cpy)cpy)y)y)
 14327     MOVE 18 TO SQL-SQHSTL(84)
 14328     MOVE 0 TO SQL-SQHSTS(84)
 14329     MOVE 0 TO SQL-SQINDV(84)
 14330     MOVE 0 TO SQL-SQINDS(84)
 14331     MOVE 0 TO SQL-SQHARM(84)
 14332     CALL "SQLADR" USING
 14333         H-UYTK-PPAY-SNEKI IN
 14334         HST-TBL-SELECT IN
 14335         HST-AREA
 14336         SQL-SQHSTV(85)
 14337     MOVE 18 TO SQL-SQHSTL(85)
 14338     MOVE 0 TO SQL-SQHSTS(85)
 14339     MOVE 0 TO SQL-SQINDV(85)
 14340     MOVE 0 TO SQL-SQINDS(85)
 14341     MOVE 0 TO SQL-SQHARM(85)
 14342     CALL "SQLADR" USING
 14343         H-MS-SHEKI-HYK-KWS IN
 14344         HST-TBL-SELECT IN
 14345         HST-AREA
 14346         SQL-SQHSTV(86)
 14347     MOVE 18 TO SQL-SQHSTL(86)
 14348     MOVE 0 TO SQL-SQHSTS(86)
 14349     MOVE 0 TO SQL-SQINDV(86)
 14350     MOVE 0 TO SQL-SQINDS(86)
 14351     MOVE 0 TO SQL-SQHARM(86)
 14352     CALL "SQLADR" USING
 14353         H-GENS-TAX-HYK-KWS IN
 14354         HST-TBL-SELECT IN
 14355         HST-AREA
 14356         SQL-SQHSTV(87)
 14357     MOVE 18 TO SQL-SQHSTL(87)
 14358     MOVE 0 TO SQL-SQHSTS(87)
 14359     MOVE 0 TO SQL-SQINDV(87)
 14360     MOVE 0 TO SQL-SQINDS(87)
 14361     MOVE 0 TO SQL-SQHARM(87)
 14362     CALL "SQLADR" USING
 14363         H-DATA-KBN IN
 14364         HST-TBL-SELECT IN
 14365         HST-AREA
 14366         SQL-SQHSTV(88)
 14367     MOVE 1 TO SQL-SQHSTL(88)
 14368     MOVE 0 TO SQL-SQHSTS(88)
 14369     MOVE 0 TO SQL-SQINDV(88)
 14370     MOVE 0 TO SQL-SQINDS(88)
 14371     MOVE 0 TO SQL-SQHARM(88)
 14372     CALL "SQLADR" USING
 14373         H-SYOHIN-KBN IN
 14374         HST-TBL-SELECT IN
 14375         HST-AREA
 14376         SQL-SQHSTV(89)
 14377     MOVE 2 TO SQL-SQHSTL(89)
 14378     MOVE 0 TO SQL-SQHSTS(89)
 14379     MOVE 0 TO SQL-SQINDV(89)
 14380     MOVE 0 TO SQL-SQINDS(89)
 14381     MOVE 0 TO SQL-SQHARM(89)
 14382     CALL "SQLADR" USING
 14383         H-REP-KBN IN
 14384         HST-TBL-SELECT IN
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 249
* MUSR2651.cob                                                     cpy)cpy)y)y)
 14385         HST-AREA
 14386         SQL-SQHSTV(90)
 14387     MOVE 1 TO SQL-SQHSTL(90)
 14388     MOVE 0 TO SQL-SQHSTS(90)
 14389     MOVE 0 TO SQL-SQINDV(90)
 14390     MOVE 0 TO SQL-SQINDS(90)
 14391     MOVE 0 TO SQL-SQHARM(90)
 14392     CALL "SQLADR" USING
 14393         H-KODE-1 IN
 14394         HST-TBL-SELECT IN
 14395         HST-AREA
 14396         SQL-SQHSTV(91)
 14397     MOVE 20 TO SQL-SQHSTL(91)
 14398     MOVE 0 TO SQL-SQHSTS(91)
 14399     MOVE 0 TO SQL-SQINDV(91)
 14400     MOVE 0 TO SQL-SQINDS(91)
 14401     MOVE 0 TO SQL-SQHARM(91)
 14402     CALL "SQLADR" USING
 14403         H-SUJI-11 IN
 14404         HST-TBL-SELECT IN
 14405         HST-AREA
 14406         SQL-SQHSTV(92)
 14407     MOVE 18 TO SQL-SQHSTL(92)
 14408     MOVE 0 TO SQL-SQHSTS(92)
 14409     MOVE 0 TO SQL-SQINDV(92)
 14410     MOVE 0 TO SQL-SQINDS(92)
 14411     MOVE 0 TO SQL-SQHARM(92)
 14412     CALL "SQLADR" USING
 14413         H-SUJI-12 IN
 14414         HST-TBL-SELECT IN
 14415         HST-AREA
 14416         SQL-SQHSTV(93)
 14417     MOVE 18 TO SQL-SQHSTL(93)
 14418     MOVE 0 TO SQL-SQHSTS(93)
 14419     MOVE 0 TO SQL-SQINDV(93)
 14420     MOVE 0 TO SQL-SQINDS(93)
 14421     MOVE 0 TO SQL-SQHARM(93)
 14422     CALL "SQLADR" USING
 14423         H-SUJI-13 IN
 14424         HST-TBL-SELECT IN
 14425         HST-AREA
 14426         SQL-SQHSTV(94)
 14427     MOVE 18 TO SQL-SQHSTL(94)
 14428     MOVE 0 TO SQL-SQHSTS(94)
 14429     MOVE 0 TO SQL-SQINDV(94)
 14430     MOVE 0 TO SQL-SQINDS(94)
 14431     MOVE 0 TO SQL-SQHARM(94)
 14432     CALL "SQLADR" USING
 14433         H-KODE-2 IN
 14434         HST-TBL-SELECT IN
 14435         HST-AREA
 14436         SQL-SQHSTV(95)
 14437     MOVE 20 TO SQL-SQHSTL(95)
 14438     MOVE 0 TO SQL-SQHSTS(95)
 14439     MOVE 0 TO SQL-SQINDV(95)
 14440     MOVE 0 TO SQL-SQINDS(95)
 14441     MOVE 0 TO SQL-SQHARM(95)
 14442     CALL "SQLADR" USING
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 250
* MUSR2651.cob                                                     cpy)cpy)y)y)
 14443         H-SUJI-21 IN
 14444         HST-TBL-SELECT IN
 14445         HST-AREA
 14446         SQL-SQHSTV(96)
 14447     MOVE 18 TO SQL-SQHSTL(96)
 14448     MOVE 0 TO SQL-SQHSTS(96)
 14449     MOVE 0 TO SQL-SQINDV(96)
 14450     MOVE 0 TO SQL-SQINDS(96)
 14451     MOVE 0 TO SQL-SQHARM(96)
 14452     CALL "SQLADR" USING
 14453         H-SUJI-22 IN
 14454         HST-TBL-SELECT IN
 14455         HST-AREA
 14456         SQL-SQHSTV(97)
 14457     MOVE 18 TO SQL-SQHSTL(97)
 14458     MOVE 0 TO SQL-SQHSTS(97)
 14459     MOVE 0 TO SQL-SQINDV(97)
 14460     MOVE 0 TO SQL-SQINDS(97)
 14461     MOVE 0 TO SQL-SQHARM(97)
 14462     CALL "SQLADR" USING
 14463         H-SUJI-23 IN
 14464         HST-TBL-SELECT IN
 14465         HST-AREA
 14466         SQL-SQHSTV(98)
 14467     MOVE 18 TO SQL-SQHSTL(98)
 14468     MOVE 0 TO SQL-SQHSTS(98)
 14469     MOVE 0 TO SQL-SQINDV(98)
 14470     MOVE 0 TO SQL-SQINDS(98)
 14471     MOVE 0 TO SQL-SQHARM(98)
 14472     CALL "SQLADR" USING
 14473         H-KODE-3 IN
 14474         HST-TBL-SELECT IN
 14475         HST-AREA
 14476         SQL-SQHSTV(99)
 14477     MOVE 20 TO SQL-SQHSTL(99)
 14478     MOVE 0 TO SQL-SQHSTS(99)
 14479     MOVE 0 TO SQL-SQINDV(99)
 14480     MOVE 0 TO SQL-SQINDS(99)
 14481     MOVE 0 TO SQL-SQHARM(99)
 14482     CALL "SQLADR" USING
 14483         H-SUJI-31 IN
 14484         HST-TBL-SELECT IN
 14485         HST-AREA
 14486         SQL-SQHSTV(100)
 14487     MOVE 18 TO SQL-SQHSTL(100)
 14488     MOVE 0 TO SQL-SQHSTS(100)
 14489     MOVE 0 TO SQL-SQINDV(100)
 14490     MOVE 0 TO SQL-SQINDS(100)
 14491     MOVE 0 TO SQL-SQHARM(100)
 14492     CALL "SQLADR" USING
 14493         H-SUJI-32 IN
 14494         HST-TBL-SELECT IN
 14495         HST-AREA
 14496         SQL-SQHSTV(101)
 14497     MOVE 18 TO SQL-SQHSTL(101)
 14498     MOVE 0 TO SQL-SQHSTS(101)
 14499     MOVE 0 TO SQL-SQINDV(101)
 14500     MOVE 0 TO SQL-SQINDS(101)
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 251
* MUSR2651.cob                                                     cpy)cpy)y)y)
 14501     MOVE 0 TO SQL-SQHARM(101)
 14502     CALL "SQLADR" USING
 14503         H-SUJI-33 IN
 14504         HST-TBL-SELECT IN
 14505         HST-AREA
 14506         SQL-SQHSTV(102)
 14507     MOVE 18 TO SQL-SQHSTL(102)
 14508     MOVE 0 TO SQL-SQHSTS(102)
 14509     MOVE 0 TO SQL-SQINDV(102)
 14510     MOVE 0 TO SQL-SQINDS(102)
 14511     MOVE 0 TO SQL-SQHARM(102)
 14512     CALL "SQLADR" USING
 14513         H-YOBI1 IN
 14514         HST-TBL-SELECT IN
 14515         HST-AREA
 14516         SQL-SQHSTV(103)
 14517     MOVE 20 TO SQL-SQHSTL(103)
 14518     MOVE 0 TO SQL-SQHSTS(103)
 14519     MOVE 0 TO SQL-SQINDV(103)
 14520     MOVE 0 TO SQL-SQINDS(103)
 14521     MOVE 0 TO SQL-SQHARM(103)
 14522     CALL "SQLADR" USING
 14523         H-YOBI2 IN
 14524         HST-TBL-SELECT IN
 14525         HST-AREA
 14526         SQL-SQHSTV(104)
 14527     MOVE 20 TO SQL-SQHSTL(104)
 14528     MOVE 0 TO SQL-SQHSTS(104)
 14529     MOVE 0 TO SQL-SQINDV(104)
 14530     MOVE 0 TO SQL-SQINDS(104)
 14531     MOVE 0 TO SQL-SQHARM(104)
 14532     CALL "SQLADR" USING
 14533         H-SK-FLG IN
 14534         HST-TBL-SELECT IN
 14535         HST-AREA
 14536         SQL-SQHSTV(105)
 14537     MOVE 1 TO SQL-SQHSTL(105)
 14538     MOVE 0 TO SQL-SQHSTS(105)
 14539     MOVE 0 TO SQL-SQINDV(105)
 14540     MOVE 0 TO SQL-SQINDS(105)
 14541     MOVE 0 TO SQL-SQHARM(105)
 14542     CALL "SQLADR" USING
 14543         H-SK-GAMEN IN
 14544         HST-TBL-SELECT IN
 14545         HST-AREA
 14546         SQL-SQHSTV(106)
 14547     MOVE 8 TO SQL-SQHSTL(106)
 14548     MOVE 0 TO SQL-SQHSTS(106)
 14549     MOVE 0 TO SQL-SQINDV(106)
 14550     MOVE 0 TO SQL-SQINDS(106)
 14551     MOVE 0 TO SQL-SQHARM(106)
 14552     CALL "SQLADR" USING
 14553         H-SK-FILE IN
 14554         HST-TBL-SELECT IN
 14555         HST-AREA
 14556         SQL-SQHSTV(107)
 14557     MOVE 20 TO SQL-SQHSTL(107)
 14558     MOVE 0 TO SQL-SQHSTS(107)
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 252
* MUSR2651.cob                                                     cpy)cpy)y)y)
 14559     MOVE 0 TO SQL-SQINDV(107)
 14560     MOVE 0 TO SQL-SQINDS(107)
 14561     MOVE 0 TO SQL-SQHARM(107)
 14562     CALL "SQLADR" USING
 14563         H-SK-DATE IN
 14564         HST-TBL-SELECT IN
 14565         HST-AREA
 14566         SQL-SQHSTV(108)
 14567     MOVE 14 TO SQL-SQHSTL(108)
 14568     MOVE 0 TO SQL-SQHSTS(108)
 14569     MOVE 0 TO SQL-SQINDV(108)
 14570     MOVE 0 TO SQL-SQINDS(108)
 14571     MOVE 0 TO SQL-SQHARM(108)
 14572     CALL "SQLADR" USING
 14573         H-SK-LOGIN-CMP-CD IN
 14574         HST-TBL-SELECT IN
 14575         HST-AREA
 14576         SQL-SQHSTV(109)
 14577     MOVE 4 TO SQL-SQHSTL(109)
 14578     MOVE 0 TO SQL-SQHSTS(109)
 14579     MOVE 0 TO SQL-SQINDV(109)
 14580     MOVE 0 TO SQL-SQINDS(109)
 14581     MOVE 0 TO SQL-SQHARM(109)
 14582     CALL "SQLADR" USING
 14583         H-SK-SID IN
 14584         HST-TBL-SELECT IN
 14585         HST-AREA
 14586         SQL-SQHSTV(110)
 14587     MOVE 20 TO SQL-SQHSTL(110)
 14588     MOVE 0 TO SQL-SQHSTS(110)
 14589     MOVE 0 TO SQL-SQINDV(110)
 14590     MOVE 0 TO SQL-SQINDS(110)
 14591     MOVE 0 TO SQL-SQHARM(110)
 14592     CALL "SQLADR" USING
 14593         H-SK-PGMID IN
 14594         HST-TBL-SELECT IN
 14595         HST-AREA
 14596         SQL-SQHSTV(111)
 14597     MOVE 16 TO SQL-SQHSTL(111)
 14598     MOVE 0 TO SQL-SQHSTS(111)
 14599     MOVE 0 TO SQL-SQINDV(111)
 14600     MOVE 0 TO SQL-SQINDS(111)
 14601     MOVE 0 TO SQL-SQHARM(111)
 14602     CALL "SQLADR" USING
 14603         H-UPD-FLG IN
 14604         HST-TBL-SELECT IN
 14605         HST-AREA
 14606         SQL-SQHSTV(112)
 14607     MOVE 1 TO SQL-SQHSTL(112)
 14608     MOVE 0 TO SQL-SQHSTS(112)
 14609     MOVE 0 TO SQL-SQINDV(112)
 14610     MOVE 0 TO SQL-SQINDS(112)
 14611     MOVE 0 TO SQL-SQHARM(112)
 14612     CALL "SQLADR" USING
 14613         H-UPD-GAMEN IN
 14614         HST-TBL-SELECT IN
 14615         HST-AREA
 14616         SQL-SQHSTV(113)
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 253
* MUSR2651.cob                                                     cpy)cpy)y)y)
 14617     MOVE 8 TO SQL-SQHSTL(113)
 14618     MOVE 0 TO SQL-SQHSTS(113)
 14619     MOVE 0 TO SQL-SQINDV(113)
 14620     MOVE 0 TO SQL-SQINDS(113)
 14621     MOVE 0 TO SQL-SQHARM(113)
 14622     CALL "SQLADR" USING
 14623         H-UPD-FILE IN
 14624         HST-TBL-SELECT IN
 14625         HST-AREA
 14626         SQL-SQHSTV(114)
 14627     MOVE 20 TO SQL-SQHSTL(114)
 14628     MOVE 0 TO SQL-SQHSTS(114)
 14629     MOVE 0 TO SQL-SQINDV(114)
 14630     MOVE 0 TO SQL-SQINDS(114)
 14631     MOVE 0 TO SQL-SQHARM(114)
 14632     CALL "SQLADR" USING
 14633         H-UPD-DATE IN
 14634         HST-TBL-SELECT IN
 14635         HST-AREA
 14636         SQL-SQHSTV(115)
 14637     MOVE 14 TO SQL-SQHSTL(115)
 14638     MOVE 0 TO SQL-SQHSTS(115)
 14639     MOVE 0 TO SQL-SQINDV(115)
 14640     MOVE 0 TO SQL-SQINDS(115)
 14641     MOVE 0 TO SQL-SQHARM(115)
 14642     CALL "SQLADR" USING
 14643         H-UPD-LOGIN-CMP-CD IN
 14644         HST-TBL-SELECT IN
 14645         HST-AREA
 14646         SQL-SQHSTV(116)
 14647     MOVE 4 TO SQL-SQHSTL(116)
 14648     MOVE 0 TO SQL-SQHSTS(116)
 14649     MOVE 0 TO SQL-SQINDV(116)
 14650     MOVE 0 TO SQL-SQINDS(116)
 14651     MOVE 0 TO SQL-SQHARM(116)
 14652     CALL "SQLADR" USING
 14653         H-UPD-SID IN
 14654         HST-TBL-SELECT IN
 14655         HST-AREA
 14656         SQL-SQHSTV(117)
 14657     MOVE 20 TO SQL-SQHSTL(117)
 14658     MOVE 0 TO SQL-SQHSTS(117)
 14659     MOVE 0 TO SQL-SQINDV(117)
 14660     MOVE 0 TO SQL-SQINDS(117)
 14661     MOVE 0 TO SQL-SQHARM(117)
 14662     CALL "SQLADR" USING
 14663         H-UPD-PGMID IN
 14664         HST-TBL-SELECT IN
 14665         HST-AREA
 14666         SQL-SQHSTV(118)
 14667     MOVE 16 TO SQL-SQHSTL(118)
 14668     MOVE 0 TO SQL-SQHSTS(118)
 14669     MOVE 0 TO SQL-SQINDV(118)
 14670     MOVE 0 TO SQL-SQINDS(118)
 14671     MOVE 0 TO SQL-SQHARM(118)
 14672     CALL "SQLADR" USING
 14673         SQL-SQHSTV(1)
 14674         SQL-SQPHSV
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 254
* MUSR2651.cob                                                     cpy)cpy)y)y)
 14675     CALL "SQLADR" USING
 14676         SQL-SQHSTL(1)
 14677         SQL-SQPHSL
 14678     CALL "SQLADR" USING
 14679         SQL-SQHSTS(1)
 14680         SQL-SQPHSS
 14681     CALL "SQLADR" USING
 14682         SQL-SQINDV(1)
 14683         SQL-SQPIND
 14684     CALL "SQLADR" USING
 14685         SQL-SQINDS(1)
 14686         SQL-SQPINS
 14687     CALL "SQLADR" USING
 14688         SQL-SQHARM(1)
 14689         SQL-SQPARM
 14690     CALL "SQLADR" USING
 14691         SQL-SQHARC(1)
 14692         SQL-SQPARC
 14693
 14694     CALL "SQLBEX" USING
 14695         SQLCTX
 14696         SQLEXD
 14697         SQLFPN
 14698*-------------------<DEBUG>---------------------------------------
 14699D    DISPLAY  CNS-PGM-ID":SQLCODE(CURSOR FETCH)  =["SQLCODE"]"
 14700*-----------------------------------------------------------------
 14701     EVALUATE  SQLCODE
 14702       WHEN  CNS-SQL-NORMAL
 14703         PERFORM  FETCH-GET-RTN
 14704*-------------------<DEBUG>---------------------------------------
 14705D    DISPLAY  CNS-PGM-ID":WK-FETCH-KENSUU =["WK-FETCH-KENSUU"]"
 14706*-----------------------------------------------------------------
 14707       WHEN  CNS-SQL-NOTFOUND
 14708         MOVE  CNS-ON                   TO  FLG-STOP
 14709         IF  WK-SELECT-KENSUU NOT = ZERO
 14710         THEN
 14711           PERFORM  BREAK3-RTN
 14712           PERFORM  BREAK2-RTN
 14713           PERFORM  BREAK2-2-RTN
 14714         ELSE
 14715           CONTINUE
 14716         END-IF
 14717       WHEN  OTHER
 14718*----------  ワーク実行ステータス
 14719         MOVE  CNS-16                   TO  WK-STATUS
 14720         MOVE  CNS-16                   TO  WK-1190-STATUS
 14721*----------  ワークリターンコード
 14722         MOVE  WK-STATUS                TO  WK-RTN-CODE
 14723*----------  ワークエラーパッケージを編集
 14724         INITIALIZE  WK-SYS-ERR-INFO
 14725*----------  エラー検知プログラムID
 14726         MOVE  CNS-PGM-ID               TO  WK-ERR-PGM-ID
 14727*----------  ポジション
 14728         MOVE  CNS-POS-019              TO  WK-ERR-POS
 14729*----------  リターンコード
 14730         MOVE  CNS-RTN-900              TO  WK-RTN-CD
 14731*----------  詳細リターンコード
 14732         MOVE  SQLCODE                  TO  WK-DETAIL-RTN-CD
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 255
* MUSR2651.cob                                                     cpy)cpy)y)y)
 14733*----------  詳細リターンコードデコードフラグ
 14734         MOVE  CNS-DETAIL-1             TO  WK-DETAIL-RTN-CD-FLG
 14735*---------- フリーメッセージ
 14736         MOVE  WK-SELECT-FREE-MSG       TO  WK-FREE-MSG
 14737*----------  エラー情報追加処理
 14738         PERFORM  ERR-INFO-ADD-RTN
 14739     END-EVALUATE
 14740*-------------------<DEBUG>---------------------------------------
 14741D    DISPLAY  CNS-PGM-ID":***  カーソル(FETCH)  END  ***"
 14742*-----------------------------------------------------------------
 14743     CONTINUE.
 14744 CR-FETCH-EXT.
 14745     EXIT.
 14746******************************************************************
 14747*    FETCH-GET NORMAL
 14748******************************************************************
 14749 FETCH-GET-RTN          SECTION.
 14750*-------------------<DEBUG>---------------------------------------
 14751D    DISPLAY  CNS-PGM-ID":***  FETCH-GET NORMAL  START  ***"
 14752*-----------------------------------------------------------------
 14753     PERFORM  WORK-OPERATION-RTN
 14754     IF  WK-STATUS < CNS-16
 14755     THEN
 14756*------------------ <残タスク129の対応 END>-----------------------
 14757*---------- ワークブレイクキーNEW.基準日
 14758       MOVE  H-SEC-SBT-CD
 14759         TO  WK-SEC-SBT-CD-NEW
 14760       MOVE  H-TRHK-TUKA            OF  HST-TBL-SELECT
 14761         TO  WK-TRHK-TUKA-NEW
 14762       MOVE  H-YJ-UW-KBN
 14763         TO  WK-YJ-UW-KBN-NEW
 14764*-------------------<DEBUG>---------------------------------------
 14765D    DISPLAY  CNS-PGM-ID":WK-SWK-KJN-PTN-CD= ["
 14766D             WK-SWK-KJN-PTN-CD"]"
 14767D    DISPLAY  CNS-PGM-ID":WK-YKJ-SYUGI-KAIKEI= ["
 14768D             WK-YKJ-SYUGI-KAIKEI"]"
 14769*-----------------------------------------------------------------
 14770       IF  WK-SWK-KJN-PTN-CD(CNS-1:CNS-1)  =  CNS-TEXT-T
 14771        AND  WK-YKJ-SYUGI-KAIKEI  NOT =  CNS-X-1
 14772       THEN
 14773         MOVE  H-MEG-CD             OF  HST-TBL-SELECT
 14774           TO  WK-MEG-CD-NEW
 14775         MOVE  H-TATE-FLG           OF  HST-TBL-SELECT
 14776           TO  WK-TATE-FLG-NEW
 14777       ELSE
 14778         MOVE  SPACE
 14779           TO  WK-MEG-CD-NEW
 14780         MOVE  SPACE
 14781           TO  WK-TATE-FLG-NEW
 14782       END-IF
 14783*-------------------<DEBUG>---------------------------------------
 14784D    DISPLAY  CNS-PGM-ID":WK-SEC-SBT-CD-NEW =["
 14785D             WK-SEC-SBT-CD-NEW "]"
 14786D    DISPLAY  CNS-PGM-ID":WK-TRHK-TUKA-NEW=[" WK-TRHK-TUKA-NEW "]"
 14787D    DISPLAY  CNS-PGM-ID":WK-MEG-CD-NEW=[" WK-MEG-CD-NEW "]"
 14788D    DISPLAY  CNS-PGM-ID":WK-TATE-FLG-NEW=[" WK-TATE-FLG-NEW "]"
 14789*-----------------------------------------------------------------
 14790*----------  ワーク取得件数
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 256
* MUSR2651.cob                                                     cpy)cpy)y)y)
 14791*-------------------<DEBUG>---------------------------------------
 14792D    DISPLAY  CNS-PGM-ID":WK-SELECT-KENSUU = ["WK-SELECT-KENSUU"]"
 14793*-----------------------------------------------------------------
 14794       IF  WK-SELECT-KENSUU = CNS-1
 14795       THEN
 14796         MOVE  WK-SEC-SBT-CD-NEW    TO  WK-SEC-SBT-CD-OLD
 14797         MOVE  WK-TRHK-TUKA-NEW     TO  WK-TRHK-TUKA-OLD
 14798         MOVE  WK-MEG-CD-NEW        TO  WK-MEG-CD-OLD
 14799         MOVE  WK-TATE-FLG-NEW      TO  WK-TATE-FLG-OLD
 14800       ELSE
 14801         CONTINUE
 14802       END-IF
 14803*-------------------<DEBUG>---------------------------------------
 14804D    DISPLAY  CNS-PGM-ID":WK-BREAK-KEY-NEW = ["WK-BREAK-KEY-NEW"]"
 14805D    DISPLAY  CNS-PGM-ID":WK-BREAK-KEY-OLD = ["WK-BREAK-KEY-OLD"]"
 14806D    DISPLAY  CNS-PGM-ID":WK-SEC-SBT-CD-OLD=["WK-SEC-SBT-CD-OLD"]"
 14807*-----------------------------------------------------------------
 14808       IF  (WK-MEG-CD-OLD  NOT = WK-MEG-CD-NEW
 14809        OR  WK-SEC-SBT-CD-OLD  NOT = WK-SEC-SBT-CD-NEW
 14810        OR  WK-TRHK-TUKA-OLD  NOT = WK-TRHK-TUKA-NEW
 14811        OR  WK-TATE-FLG-OLD  NOT =  WK-TATE-FLG-NEW)
 14812       THEN
 14813         PERFORM  BREAK3-RTN
 14814       ELSE
 14815         CONTINUE
 14816       END-IF
 14817       IF  (WK-TRHK-TUKA-OLD  NOT = WK-TRHK-TUKA-NEW
 14818        OR  WK-SEC-SBT-CD-OLD  NOT = WK-SEC-SBT-CD-NEW)
 14819       THEN
 14820         PERFORM  BREAK2-RTN
 14821       ELSE
 14822         CONTINUE
 14823       END-IF
 14824       IF  (WK-TRHK-TUKA-OLD  NOT = WK-TRHK-TUKA-NEW)
 14825       THEN
 14826         PERFORM  BREAK2-2-RTN
 14827       ELSE
 14828         CONTINUE
 14829       END-IF
 14830       MOVE  WK-BREAK-KEY-NEW  TO  WK-BREAK-KEY-OLD
 14831*-------------------<DEBUG>---------------------------------------
 14832D    DISPLAY  CNS-PGM-ID":WK-STATUS = ["  WK-STATUS "]"
 14833D    DISPLAY  CNS-PGM-ID":WK-GYOMU-TASK-ID = ["
 14834D             WK-GYOMU-TASK-ID       OF  WK-ARGUMENT"]"
 14835*-----------------------------------------------------------------
 14836       IF  WK-STATUS < CNS-8
 14837       THEN
 14838*----------   ディテール行を編集する
 14839         PERFORM  DATA-EDIT-RTN
 14840         IF  WK-STATUS < CNS-4
 14841         THEN
 14842*----------   未収金、未払金の処理
 14843           PERFORM  UYTK-SJTK-RTN
 14844*----------   未払費用の処理
 14845           PERFORM  SJTK-MBHY-RTN
 14846*-------------------<DEBUG>---------------------------------------
 14847D    DISPLAY  CNS-PGM-ID":H-YJ-UW-KBN = ["  H-YJ-UW-KBN "]"
 14848*-----------------------------------------------------------------
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 257
* MUSR2651.cob                                                     cpy)cpy)y)y)
 14849*------------------ <連結障害841の対応 START>---------------------
 14850           IF  H-YJ-UW-KBN = SPACE  AND  FLG-DATA-OUT  =  CNS-OFF
 14851           THEN
 14852*----------  ワーク実行ステータス
 14853             IF  WK-STATUS  < CNS-4
 14854             THEN
 14855               MOVE  CNS-4            TO  WK-STATUS
 14856             ELSE
 14857               CONTINUE
 14858             END-IF
 14859*----------  1190実行ステータス
 14860             IF   WK-STATUS > WK-1190-STATUS
 14861             THEN
 14862               MOVE  WK-STATUS        TO  WK-1190-STATUS
 14863             ELSE
 14864               CONTINUE
 14865             END-IF
 14866*--------------------<DEBSUG>-------------------------------------
 14867D    DISPLAY  CNS-PGM-ID":WK-STATUS=["WK-STATUS"]"
 14868D    DISPLAY  CNS-PGM-ID":WK-RTN-CODE=["WK-RTN-CODE"]"
 14869*-----------------------------------------------------------------
 14870*----------  ワークリターンコード
 14871             IF  WK-RTN-CODE < WK-STATUS
 14872             THEN
 14873               MOVE  WK-STATUS        TO  WK-RTN-CODE
 14874             ELSE
 14875               CONTINUE
 14876             END-IF
 14877*--------------------<DEBSUG>-------------------------------------
 14878D    DISPLAY  CNS-PGM-ID":WK-STATUS=["WK-STATUS"]"
 14879D    DISPLAY  CNS-PGM-ID":WK-RTN-CODE=["WK-RTN-CODE"]"
 14880D    DISPLAY  CNS-PGM-ID":WK-J =[" WK-J"]"
 14881*-----------------------------------------------------------------
 14882             COMPUTE  WK-J = WK-J + 1
 14883*-------------------<DEBUG>---------------------------------------
 14884D    DISPLAY  CNS-PGM-ID":WK-J =[" WK-J"]"
 14885*-----------------------------------------------------------------
 14886*---------- ファンドコード
 14887             MOVE  WK-FUND-CD-DETAIL OF  WK-PTF-ATT-DATA(WK-IDX-J)
 14888               TO  WK-GYOMU-FUND-CD  OF  WK-GYOMU-ERR-INFO(WK-J)
 14889*---------- ポートフォリオコード
 14890             MOVE  WK-PTF-CD-DETAIL  OF  WK-PTF-ATT-DATA(WK-IDX-J)
 14891               TO  WK-GYOMU-PTF-CD   OF  WK-GYOMU-ERR-INFO(WK-J)
 14892*---------- 評価系列コード
 14893             MOVE  WK-DEFAUL-THYK-CD OF  WK-PTF-ATT-DATA(WK-IDX-J)
 14894               TO  WK-GYOMU-HYK-KRTU-CD OF WK-GYOMU-ERR-INFO(WK-J)
 14895*---------- メッセージID
 14896             MOVE  CNS-MSG-E000090
 14897               TO  WK-GYOMU-MSG-ID   OF  WK-GYOMU-ERR-INFO(WK-J)
 14898*---------- 基準日From
 14899             MOVE  WK-KIKAN-FR
 14900               TO  WK-GYOMU-KJN-YMD-FROM
 14901                     OF  WK-GYOMU-ERR-INFO(WK-J)
 14902*---------- 基準日To
 14903             MOVE  WK-KIKAN-TO
 14904               TO  WK-GYOMU-KJN-YMD-TO
 14905                     OF  WK-GYOMU-ERR-INFO(WK-J)
 14906*---------- 置換文字
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 258
* MUSR2651.cob                                                     cpy)cpy)y)y)
 14907             MOVE  CNS-YAKU-UKE-KBN
 14908               TO  WK-GYOMU-TK-MOJI(WK-J,CNS-1)
 14909*---------- フリーメッセージ
 14910             MOVE  SPACE
 14911               TO  WK-GYOMU-FREE-MSG OF  WK-GYOMU-ERR-INFO(WK-J)
 14912             MOVE  CNS-ON            TO  FLG-MEISAI-GYOMU-ERR
 14913             MOVE  CNS-ON            TO  FLG-DATA-OUT
 14914           ELSE
 14915             CONTINUE
 14916           END-IF
 14917*------------------ <連結障害841の対応 END>-----------------------
 14918           IF  FLG-DATA-OUT  =  CNS-OFF
 14919           THEN
 14920*-------------------<DEBUG>---------------------------------------
 14921D    DISPLAY  CNS-PGM-ID":H-YJ-UW-KBN=["H-YJ-UW-KBN"]"
 14922D    DISPLAY  CNS-PGM-ID":WK-CASH-FLOW-KBN=["WK-CASH-FLOW-KBN"]"
 14923D    DISPLAY  CNS-PGM-ID":I-FLG-KEISAN=["
 14924D             I-FLG-KEISAN          OF WK-DENBUN-INFO"]"
 14925D    DISPLAY  CNS-PGM-ID":WK-HOU-SURYO=["WK-HOU-SURYO"]"
 14926D    DISPLAY  CNS-PGM-ID":WK-THTK-ST-KNG=["WK-THTK-ST-KNG"]"
 14927D    DISPLAY  CNS-PGM-ID":WK-THTK-HYK-KN=["WK-THTK-HYK-KN"]"
 14928D    DISPLAY  CNS-PGM-ID":H-THTK-HYK-SNEKI=["H-THTK-HYK-SNEKI"]"
 14929D    DISPLAY  CNS-PGM-ID":H-THTK-PPAYZN=["H-THTK-PPAYZN"]"
 14930D    DISPLAY  CNS-PGM-ID":H-THTK-KKRS=["H-THTK-KKRS"]"
 14931D    DISPLAY  CNS-PGM-ID":H-THTK-MS-EKI=["H-THTK-MS-EKI"]"
 14932D    DISPLAY  CNS-PGM-ID":H-SHTK-KN-LC=["H-SHTK-KN-LC"]"
 14933D    DISPLAY  CNS-PGM-ID":WK-HYK-KN-LC=["WK-HYK-KN-LC"]"
 14934D    DISPLAY  CNS-PGM-ID":H-HYK-SNEKI-LC=["H-HYK-SNEKI-LC"]"
 14935D    DISPLAY  CNS-PGM-ID":H-UYTK-PPAY-ZN=["H-UYTK-PPAY-ZN"]"
 14936D    DISPLAY  CNS-PGM-ID":H-KEKA-RSK-LC=["H-KEKA-RSK-LC"]"
 14937D    DISPLAY  CNS-PGM-ID":H-UYTK-MS-EKI=["H-UYTK-MS-EKI"]"
 14938D    DISPLAY  CNS-PGM-ID":WK-BIKOU-1=["WK-BIKOU-1"]"
 14939D    DISPLAY  CNS-PGM-ID":H-BIKOU-2=["H-BIKOU-2"]"
 14940D    DISPLAY  CNS-PGM-ID":H-BIKOU-3=["H-BIKOU-3"]"
 14941D    DISPLAY  CNS-PGM-ID":H-BIKOU-4=["H-BIKOU-4"]"
 14942D    DISPLAY  CNS-PGM-ID":H-BIKOU-5=["H-BIKOU-5"]"
 14943D    DISPLAY  CNS-PGM-ID":H-BIKOU-6=["H-BIKOU-6"]"
 14944D    DISPLAY  CNS-PGM-ID":H-BIKOU-7=["H-BIKOU-7"]"
 14945D    DISPLAY  CNS-PGM-ID":H-BIKOU-8=["H-BIKOU-8"]"
 14946D    DISPLAY  CNS-PGM-ID":H-BIKOU-9=["H-BIKOU-9"]"
 14947*-----------------------------------------------------------------
 14948             IF  WK-HOU-SURYO NOT = ZERO
 14949              OR WK-THTK-ST-KNG NOT = ZERO
 14950              OR WK-THTK-HYK-KN NOT = ZERO
 14951              OR H-THTK-HYK-SNEKI NOT = ZERO
 14952              OR H-THTK-PPAYZN NOT = ZERO
 14953              OR H-THTK-KKRS NOT = ZERO
 14954              OR H-THTK-MS-EKI NOT = ZERO
 14955              OR H-SHTK-KN-LC NOT = ZERO
 14956              OR WK-HYK-KN-LC NOT = ZERO
 14957              OR H-HYK-SNEKI-LC NOT = ZERO
 14958              OR H-UYTK-PPAY-ZN NOT = ZERO
 14959              OR H-KEKA-RSK-LC NOT = ZERO
 14960              OR H-UYTK-MS-EKI NOT = ZERO
 14961              OR (WK-BIKOU-1 NOT = ZERO
 14962               AND WK-BIKOU-1 NOT = SPACE)
 14963              OR (H-BIKOU-2 NOT = ZERO
 14964               AND H-BIKOU-2 NOT = SPACE)
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 259
* MUSR2651.cob                                                     cpy)cpy)y)y)
 14965              OR (H-BIKOU-3 NOT = ZERO
 14966               AND H-BIKOU-3 NOT = SPACE)
 14967              OR (H-BIKOU-4 NOT = ZERO
 14968               AND H-BIKOU-4 NOT = SPACE)
 14969              OR H-BIKOU-5 NOT = ZERO
 14970              OR H-BIKOU-6 NOT = ZERO
 14971              OR H-BIKOU-7 NOT = ZERO
 14972              OR H-BIKOU-8 NOT = ZERO
 14973              OR H-BIKOU-9 NOT = ZERO
 14974            THEN
 14975               EVALUATE  H-YJ-UW-KBN
 14976                 WHEN  CNS-X-1
 14977                   IF  WK-CASH-FLOW-KBN  =  CNS-X-2
 14978                   THEN
 14979                     IF  I-FLG-KEISAN OF WK-DENBUN-INFO  = CNS-0
 14980                     THEN
 14981*------------------ <連結障害1077の対応 START>--------------------
 14982                       INITIALIZE  DAT-REC
 14983                       MOVE  WK-REC             TO  DAT-REC
 14984*------------------ <連結障害1077の対応 END>----------------------
 14985                       PERFORM  DATA-WRITE-RTN
 14986                     ELSE
 14987                       INITIALIZE  DAT-REC3
 14988                       MOVE  WK-REC             TO  DAT-REC3
 14989                       PERFORM  DATA-WRITE-3-RTN
 14990                     END-IF
 14991                   ELSE
 14992                     IF  I-FLG-KEISAN OF WK-DENBUN-INFO  = CNS-0
 14993                     THEN
 14994                       INITIALIZE  DAT-REC5
 14995                       MOVE  WK-REC             TO  DAT-REC5
 14996                       PERFORM  DATA-WRITE-5-RTN
 14997                     ELSE
 14998                       INITIALIZE  DAT-REC7
 14999                       MOVE  WK-REC             TO  DAT-REC7
 15000                       PERFORM  DATA-WRITE-7-RTN
 15001                     END-IF
 15002                   END-IF
 15003                 WHEN  CNS-X-2
 15004                   IF  WK-CASH-FLOW-KBN  =  CNS-X-2
 15005                   THEN
 15006                     IF  I-FLG-KEISAN OF WK-DENBUN-INFO = CNS-0
 15007                     THEN
 15008*------------------ <連結障害1077の対応 START>--------------------
 15009                       INITIALIZE  DAT-REC2
 15010                       MOVE  WK-REC             TO  DAT-REC2
 15011*------------------ <連結障害1077の対応 END>----------------------
 15012                       PERFORM  DATA-WRITE-2-RTN
 15013                     ELSE
 15014                       INITIALIZE  DAT-REC4
 15015                       MOVE  WK-REC             TO  DAT-REC4
 15016                       PERFORM  DATA-WRITE-4-RTN
 15017                     END-IF
 15018                   ELSE
 15019                     IF  I-FLG-KEISAN OF WK-DENBUN-INFO = CNS-0
 15020                     THEN
 15021                       INITIALIZE  DAT-REC6
 15022                       MOVE  WK-REC             TO  DAT-REC6
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 260
* MUSR2651.cob                                                     cpy)cpy)y)y)
 15023                       PERFORM  DATA-WRITE-6-RTN
 15024                     ELSE
 15025                       INITIALIZE  DAT-REC8
 15026                       MOVE  WK-REC             TO  DAT-REC8
 15027                       PERFORM  DATA-WRITE-8-RTN
 15028                     END-IF
 15029                   END-IF
 15030                 WHEN  OTHER
 15031                   CONTINUE
 15032               END-EVALUATE
 15033             ELSE
 15034               CONTINUE
 15035             END-IF
 15036           ELSE
 15037             CONTINUE
 15038           END-IF
 15039         ELSE
 15040           CONTINUE
 15041         END-IF
 15042       ELSE
 15043*-------------------<DEBUG>---------------------------------------
 15044D    DISPLAY  CNS-PGM-ID":**** DBデータ編集しない ****"
 15045*-----------------------------------------------------------------
 15046         CONTINUE
 15047       END-IF
 15048     ELSE
 15049       CONTINUE
 15050     END-IF
 15051*-------------------<DEBUG>---------------------------------------
 15052D    DISPLAY  CNS-PGM-ID":FLG-MEISAI-GYOMU-ERR = ["
 15053D                         FLG-MEISAI-GYOMU-ERR "]"
 15054*-----------------------------------------------------------------
 15055*----------  業務エラー1処理
 15056     IF  FLG-MEISAI-GYOMU-ERR = CNS-ON
 15057     THEN
 15058       PERFORM  GYOMU-ERR-1-RTN
 15059     ELSE
 15060*-------------------<DEBUG>---------------------------------------
 15061D    DISPLAY  CNS-PGM-ID":**** 業務エラー1処理しない ****"
 15062*-----------------------------------------------------------------
 15063       CONTINUE
 15064     END-IF
 15065*-------------------<DEBUG>---------------------------------------
 15066D    DISPLAY  CNS-PGM-ID":***  FETCH-GET NORMAL  END  ***"
 15067*-----------------------------------------------------------------
 15068     CONTINUE.
 15069 FETCH-GET-EXT.
 15070     EXIT.
 15071******************************************************************
 15072*    ワーク セット
 15073******************************************************************
 15074 WORK-OPERATION-RTN     SECTION.
 15075*--------------------<DEBUG>--------------------------------------
 15076D    DISPLAY  CNS-PGM-ID":***  ワーク セット  START  ***"
 15077*-----------------------------------------------------------------
 15078*---------- ワーク取得件数
 15079     COMPUTE  WK-FETCH-KENSUU  = WK-FETCH-KENSUU  + CNS-1
 15080     COMPUTE  WK-SELECT-KENSUU = WK-SELECT-KENSUU + CNS-1
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 261
* MUSR2651.cob                                                     cpy)cpy)y)y)
 15081     COMPUTE  WK-STOP-KENSUU = WK-STOP-KENSUU + CNS-1
 15082*--------------------<DEBUG>--------------------------------------
 15083D    DISPLAY  CNS-PGM-ID":WK-STOP-KENSUU=["WK-STOP-KENSUU"]"
 15084*-----------------------------------------------------------------
 15085     IF  WK-STOP-KENSUU >= CNS-100
 15086     THEN
 15087*---------- 実行状況管理停止判断
 15088       PERFORM  SCZY7220-RTN
 15089     ELSE
 15090*--------------------<DEBUG>--------------------------------------
 15091D    DISPLAY  CNS-PGM-ID":***  実行状況管理停止  しない  ***"
 15092*-----------------------------------------------------------------
 15093       CONTINUE
 15094     END-IF
 15095*------------------ <残タスク129の対応 START>---------------------
 15096*--------------------<DEBUG>--------------------------------------
 15097D    DISPLAY  "CALL SUSC0057  START"
 15098D    DISPLAY  CNS-PGM-ID":処理前の利用会社コード"
 15099D             "=["H-RIYO-CMP-CD OF HST-TBL-SELECT"]"
 15100D    DISPLAY  CNS-PGM-ID":処理前のファンドコード"
 15101D             "=["H-FUND-CD OF HST-TBL-SELECT"]"
 15102D    DISPLAY  CNS-PGM-ID":処理前のポートフォリオコード"
 15103D             "=["H-PTF-CD OF HST-TBL-SELECT"]"
 15104D    DISPLAY  CNS-PGM-ID":処理前の約定受渡区分"
 15105D             "=["H-YJ-UW-KBN OF HST-TBL-SELECT"]"
 15106D    DISPLAY  CNS-PGM-ID":処理前の残高日付"
 15107D             "=["H-ZANTK-YMD OF HST-TBL-SELECT"]"
 15108D    DISPLAY  CNS-PGM-ID":処理前の決算日断面区分"
 15109D             "=["H-KSN-YMD-DMN-KBN OF HST-TBL-SELECT"]"
 15110D    DISPLAY  CNS-PGM-ID":処理前の評価系列コード"
 15111D             "=["H-HYK-KRTU-CD OF HST-TBL-SELECT"]"
 15112D    DISPLAY  CNS-PGM-ID":処理前の証券種別コード"
 15113D             "=["H-SEC-SBT-CD OF HST-TBL-SELECT"]"
 15114D    DISPLAY  CNS-PGM-ID":処理前の取消フラグ"
 15115D             "=["H-DEL-KBN OF HST-TBL-SELECT"]"
 15116D    DISPLAY  CNS-PGM-ID":処理前の確定フラグ"
 15117D             "=["H-KT-KBN OF HST-TBL-SELECT"]"
 15118D    DISPLAY  CNS-PGM-ID":処理前の取引通貨"
 15119D             "=["H-TRHK-TUKA OF HST-TBL-SELECT"]"
 15120D    DISPLAY  CNS-PGM-ID":処理前の為替取引決済通貨"
 15121D             "=["H-KWS-TH-TUKA-CD OF HST-TBL-SELECT"]"
 15122D    DISPLAY  CNS-PGM-ID":処理前の発行国コード"
 15123D             "=["H-HAKO-CD OF HST-TBL-SELECT"]"
 15124D    DISPLAY  CNS-PGM-ID":処理前の銘柄コード"
 15125D             "=["H-MEG-CD OF HST-TBL-SELECT"]"
 15126D    DISPLAY  CNS-PGM-ID":処理前の資産負債・買建売建フラグ"
 15127D             "=["H-TATE-FLG OF HST-TBL-SELECT"]"
 15128D    DISPLAY  CNS-PGM-ID":処理前の個別建玉約定日"
 15129D             "=["H-TG-YKJ-YMD OF HST-TBL-SELECT"]"
 15130D    DISPLAY  CNS-PGM-ID":処理前の個別玉管理番号"
 15131D             "=["H-KB-KANRI-ID OF HST-TBL-SELECT"]"
 15132D    DISPLAY  CNS-PGM-ID":処理前のカストディコード"
 15133D             "=["H-CAST-CD OF HST-TBL-SELECT"]"
 15134D    DISPLAY  CNS-PGM-ID":処理前の保有数量"
 15135D             "=["H-HOU-SURYO OF HST-TBL-SELECT"]"
 15136D    DISPLAY  CNS-PGM-ID":処理前の数量単位"
 15137D             "=["H-SURYO-TANI OF HST-TBL-SELECT"]"
 15138D    DISPLAY  CNS-PGM-ID":処理前の取得金額取引通貨"
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 262
* MUSR2651.cob                                                     cpy)cpy)y)y)
 15139D             "=["H-THTK-ST-KNG OF HST-TBL-SELECT"]"
 15140D    DISPLAY  CNS-PGM-ID":処理前の取得単価取引通貨"
 15141D             "=["H-THTK-ST-TNK OF HST-TBL-SELECT"]"
 15142D    DISPLAY  CNS-PGM-ID":処理前の時価取引通貨"
 15143D             "=["H-CP-KRTU-CD OF HST-TBL-SELECT"]"
 15144D    DISPLAY  CNS-PGM-ID":処理前の時価採用日付"
 15145D             "=["H-CP-SAIYO-YMD OF HST-TBL-SELECT"]"
 15146D    DISPLAY  CNS-PGM-ID":処理前の時価採用市場"
 15147D             "=["H-CP-SAIYO-SIJO OF HST-TBL-SELECT"]"
 15148D    DISPLAY  CNS-PGM-ID":処理前の評価金額取引通貨"
 15149D             "=["H-THTK-HYK-KN OF HST-TBL-SELECT"]"
 15150D    DISPLAY  CNS-PGM-ID":処理前の評価損益取引通貨"
 15151D             "=["H-THTK-HYK-SNEKI OF HST-TBL-SELECT"]"
 15152D    DISPLAY  CNS-PGM-ID":処理前の前払金残取引通貨"
 15153D             "=["H-THTK-PPAYZN OF HST-TBL-SELECT"]"
 15154D    DISPLAY  CNS-PGM-ID":処理前の経過利息金額取引通貨"
 15155D             "=["H-THTK-KKRS   OF HST-TBL-SELECT"]"
 15156D    DISPLAY  CNS-PGM-ID":処理前の未収収益取引通貨"
 15157D             "=["H-THTK-MS-EKI OF HST-TBL-SELECT"]"
 15158D    DISPLAY  CNS-PGM-ID":処理前の評価為替レート"
 15159D             "=["H-HYK-KWS OF HST-TBL-SELECT"]"
 15160D    DISPLAY  CNS-PGM-ID":処理前の為替採用日付"
 15161D             "=["H-KWS-SAIYO-YMD OF HST-TBL-SELECT"]"
 15162D    DISPLAY  CNS-PGM-ID":処理前の為替採用ソース"
 15163D             "=["H-KWS-SAIYO-SOURCE OF HST-TBL-SELECT"]"
 15164D    DISPLAY  CNS-PGM-ID":処理前の取得金額運用通貨為替換算額"
 15165D             "=["H-UYTK-KWS-BOKAZN OF HST-TBL-SELECT"]"
 15166D    DISPLAY  CNS-PGM-ID":処理前の取得金額運用通貨"
 15167D             "=["H-SHTK-KN-LC OF HST-TBL-SELECT"]"
 15168D    DISPLAY  CNS-PGM-ID":処理前の取得単価運用通貨"
 15169D             "=["H-UYTK-ST-TNK OF HST-TBL-SELECT"]"
 15170D    DISPLAY  CNS-PGM-ID":処理前の評価金額運用通貨"
 15171D             "=["H-HYK-KN-LC OF HST-TBL-SELECT"]"
 15172D    DISPLAY  CNS-PGM-ID":処理前の評価損益運用通貨"
 15173D             "=["H-HYK-SNEKI-LC OF HST-TBL-SELECT"]"
 15174D    DISPLAY  CNS-PGM-ID":処理前の前払金残運用通貨"
 15175D             "=["H-UYTK-PPAY-ZN OF HST-TBL-SELECT"]"
 15176D    DISPLAY  CNS-PGM-ID":処理前の経過利息金額運用通貨"
 15177D             "=["H-KEKA-RSK-LC  OF HST-TBL-SELECT"]"
 15178D    DISPLAY  CNS-PGM-ID":処理前の未収収益運用通貨"
 15179D             "=["H-UYTK-MS-EKI OF HST-TBL-SELECT"]"
 15180D    DISPLAY  CNS-PGM-ID":処理前の備考_１"
 15181D             "=["H-BIKOU-1 OF HST-TBL-SELECT"]"
 15182D    DISPLAY  CNS-PGM-ID":処理前の備考_２"
 15183D             "=["H-BIKOU-2 OF HST-TBL-SELECT"]"
 15184D    DISPLAY  CNS-PGM-ID":処理前の備考_３"
 15185D             "=["H-BIKOU-3 OF HST-TBL-SELECT"]"
 15186D    DISPLAY  CNS-PGM-ID":処理前の備考_４"
 15187D             "=["H-BIKOU-4 OF HST-TBL-SELECT"]"
 15188D    DISPLAY  CNS-PGM-ID":処理前の備考_５"
 15189D             "=["H-BIKOU-5 OF HST-TBL-SELECT"]"
 15190D    DISPLAY  CNS-PGM-ID":処理前の備考_６"
 15191D             "=["H-BIKOU-6 OF HST-TBL-SELECT"]"
 15192D    DISPLAY  CNS-PGM-ID":処理前の備考_７"
 15193D             "=["H-BIKOU-7 OF HST-TBL-SELECT"]"
 15194D    DISPLAY  CNS-PGM-ID":処理前の備考_８"
 15195D             "=["H-BIKOU-8 OF HST-TBL-SELECT"]"
 15196D    DISPLAY  CNS-PGM-ID":処理前の備考_９"
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 263
* MUSR2651.cob                                                     cpy)cpy)y)y)
 15197D             "=["H-BIKOU-9 OF HST-TBL-SELECT"]"
 15198D    DISPLAY  CNS-PGM-ID":処理前の投資対象国"
 15199D             "=["H-TS-TARGET-KUNI OF HST-TBL-SELECT"]"
 15200D    DISPLAY  CNS-PGM-ID":処理前の未払費用残取引通貨"
 15201D             "=["H-SJTK-MBHY-ZN OF HST-TBL-SELECT"]"
 15202D    DISPLAY  CNS-PGM-ID":処理前の未払費用残運用通貨"
 15203D             "=["H-UYTK-MBHY-ZN OF HST-TBL-SELECT"]"
 15204D    DISPLAY  CNS-PGM-ID":処理前の建玉為替レート"
 15205D             "=["H-TGYOKU-KWS-RATE OF HST-TBL-SELECT"]"
 15206D    DISPLAY  CNS-PGM-ID":処理前の建玉約定金額残取引通貨"
 15207D             "=["H-THTK-TG-YJKN-ZN OF HST-TBL-SELECT"]"
 15208D    DISPLAY  CNS-PGM-ID":処理前の建玉約定金額残運用通貨"
 15209D             "=["H-UYTK-TG-YJKN-ZN OF HST-TBL-SELECT"]"
 15210D    DISPLAY  CNS-PGM-ID":処理前の建玉手数料残取引通貨"
 15211D             "=["H-THTK-TG-TSR-ZN OF HST-TBL-SELECT"]"
 15212D    DISPLAY  CNS-PGM-ID":処理前の建玉手数料残運用通貨"
 15213D             "=["H-UYTK-TG-TSR-ZN OF HST-TBL-SELECT"]"
 15214D    DISPLAY  CNS-PGM-ID":処理前の建玉消費税残取引通貨"
 15215D             "=["H-THTK-TG-S-TAX-ZN OF HST-TBL-SELECT"]"
 15216D    DISPLAY  CNS-PGM-ID":処理前の建玉消費税残運用通貨"
 15217D             "=["H-UYTK-TG-S-TAX-ZN OF HST-TBL-SELECT"]"
 15218D    DISPLAY  CNS-PGM-ID":処理前の建玉その他費用残取引通貨"
 15219D             "=["H-THTK-TG-ELS-HIYO-ZN OF HST-TBL-SELECT"]"
 15220D    DISPLAY  CNS-PGM-ID":処理前の建玉その他費用残運用通貨"
 15221D             "=["H-UYTK-TG-ELS-HIYO-ZN OF HST-TBL-SELECT"]"
 15222D    DISPLAY  CNS-PGM-ID":処理前の建玉精算金額残取引通貨"
 15223D             "=["H-THTK-TG-SSKG-ZN OF HST-TBL-SELECT"]"
 15224D    DISPLAY  CNS-PGM-ID":処理前の建玉精算金額残運用通貨"
 15225D             "=["H-UYTK-TG-SSKG-ZN OF HST-TBL-SELECT"]"
 15226D    DISPLAY  CNS-PGM-ID":処理前の前受金残取引通貨"
 15227D             "=["H-THTK-AREC-ZN OF HST-TBL-SELECT"]"
 15228D    DISPLAY  CNS-PGM-ID":処理前の前受金残運用通貨"
 15229D             "=["H-UYTK-AREC-ZN OF HST-TBL-SELECT"]"
 15230D    DISPLAY  CNS-PGM-ID":処理前の仮払金残取引通貨"
 15231D             "=["H-THTK-SPAY-ZN OF HST-TBL-SELECT"]"
 15232D    DISPLAY  CNS-PGM-ID":処理前の仮払金残運用通貨"
 15233D             "=["H-UYTK-SPAY-ZN OF HST-TBL-SELECT"]"
 15234D    DISPLAY  CNS-PGM-ID":処理前の源泉税取引通貨"
 15235D             "=["H-THTK-GSZ OF HST-TBL-SELECT"]"
 15236D    DISPLAY  CNS-PGM-ID":処理前の源泉税運用通貨"
 15237D             "=["H-GENSEN-TAX-LC OF HST-TBL-SELECT"]"
 15238D    DISPLAY  CNS-PGM-ID":処理前の源泉税還付予定額残高取引通貨"
 15239D             "=["H-THTK-GSZKP-YT-ZN OF HST-TBL-SELECT"]"
 15240D    DISPLAY  CNS-PGM-ID":処理前の源泉税還付予定額残高運用通貨"
 15241D             "=["H-UYTK-GSZKP-YT-ZN OF HST-TBL-SELECT"]"
 15242D    DISPLAY  CNS-PGM-ID":処理前の簿価為替レート"
 15243D             "=["H-BOKA-KWS OF HST-TBL-SELECT"]"
 15244D    DISPLAY  CNS-PGM-ID":処理前の移管評価損益残取引通貨"
 15245D             "=["H-THTK-IKAN-HYK-SEZN OF HST-TBL-SELECT"]"
 15246D    DISPLAY  CNS-PGM-ID":処理前の移管評価損益残運用通貨"
 15247D             "=["H-UYTK-IKAN-HYK-SEZN OF HST-TBL-SELECT"]"
 15248D    DISPLAY  CNS-PGM-ID":処理前の移管未収収益取引通貨"
 15249D             "=["H-SJTK-IKAN-MSSHEKI OF HST-TBL-SELECT"]"
 15250D    DISPLAY  CNS-PGM-ID":処理前の移管未収収益運用通貨"
 15251D             "=["H-UYTK-IKAN-MSSHEKI OF HST-TBL-SELECT"]"
 15252D    DISPLAY  CNS-PGM-ID":処理前の移管前払金評価損益残運用通貨"
 15253D             "=["H-UYTK-IKAN-PPHKZN OF HST-TBL-SELECT"]"
 15254D    DISPLAY  CNS-PGM-ID":処理前のＯＰ資産負債・買建売建フラグ"
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 264
* MUSR2651.cob                                                     cpy)cpy)y)y)
 15255D             "=["H-OP-TATE-FLG OF HST-TBL-SELECT"]"
 15256D    DISPLAY  CNS-PGM-ID":処理前の時価系列コード"
 15257D             "=["H-JIKA-KRTU-CD OF HST-TBL-SELECT"]"
 15258D    DISPLAY  CNS-PGM-ID":処理前の取得時遡及有無"
 15259D             "=["H-SKYU-UMU-FLG OF HST-TBL-SELECT"]"
 15260D    DISPLAY  CNS-PGM-ID":処理前の時価種類"
 15261D             "=["H-JIKA-SHRU OF HST-TBL-SELECT"]"
 15262D    DISPLAY  CNS-PGM-ID":処理前のソース区分"
 15263D             "=["H-SOURCE-KBN OF HST-TBL-SELECT"]"
 15264D    DISPLAY  CNS-PGM-ID":処理前の前払金評価額運用通貨"
 15265D             "=["H-UYTK-KPPAY-HYK-GK OF HST-TBL-SELECT"]"
 15266D    DISPLAY  CNS-PGM-ID":処理前の前払金評価損益運用通貨"
 15267D             "=["H-UYTK-PPAY-SNEKI OF HST-TBL-SELECT"]"
 15268D    DISPLAY  CNS-PGM-ID":処理前の未収収益評価為替レート"
 15269D             "=["H-MS-SHEKI-HYK-KWS OF HST-TBL-SELECT"]"
 15270D    DISPLAY  CNS-PGM-ID":処理前の源泉税評価為替レート"
 15271D             "=["H-GENS-TAX-HYK-KWS OF HST-TBL-SELECT"]"
 15272D    DISPLAY  CNS-PGM-ID":処理前のデータ区分"
 15273D             "=["H-DATA-KBN OF HST-TBL-SELECT"]"
 15274D    DISPLAY  CNS-PGM-ID":処理前の商品区分"
 15275D             "=["H-SYOHIN-KBN OF HST-TBL-SELECT"]"
 15276D    DISPLAY  CNS-PGM-ID":処理前の帳票出力区分"
 15277D             "=["H-REP-KBN OF HST-TBL-SELECT"]"
 15278D    DISPLAY  CNS-PGM-ID":処理前の項目コード１"
 15279D             "=["H-KODE-1 OF HST-TBL-SELECT"]"
 15280D    DISPLAY  CNS-PGM-ID":処理前の数値_１１"
 15281D             "=["H-SUJI-11 OF HST-TBL-SELECT"]"
 15282D    DISPLAY  CNS-PGM-ID":処理前の数値１２"
 15283D             "=["H-SUJI-12 OF HST-TBL-SELECT"]"
 15284D    DISPLAY  CNS-PGM-ID":処理前の数値１３"
 15285D             "=["H-SUJI-13 OF HST-TBL-SELECT"]"
 15286D    DISPLAY  CNS-PGM-ID":処理前の項目コード２"
 15287D             "=["H-KODE-2 OF HST-TBL-SELECT"]"
 15288D    DISPLAY  CNS-PGM-ID":処理前の数値２１"
 15289D             "=["H-SUJI-21 OF HST-TBL-SELECT"]"
 15290D    DISPLAY  CNS-PGM-ID":処理前の数値２２"
 15291D             "=["H-SUJI-22 OF HST-TBL-SELECT"]"
 15292D    DISPLAY  CNS-PGM-ID":処理前の数値２３"
 15293D             "=["H-SUJI-23 OF HST-TBL-SELECT"]"
 15294D    DISPLAY  CNS-PGM-ID":処理前の項目コード３"
 15295D             "=["H-KODE-3 OF HST-TBL-SELECT"]"
 15296D    DISPLAY  CNS-PGM-ID":処理前の数値３１"
 15297D             "=["H-SUJI-31 OF HST-TBL-SELECT"]"
 15298D    DISPLAY  CNS-PGM-ID":処理前の数値３２"
 15299D             "=["H-SUJI-32 OF HST-TBL-SELECT"]"
 15300D    DISPLAY  CNS-PGM-ID":処理前の数値３３"
 15301D             "=["H-SUJI-33 OF HST-TBL-SELECT"]"
 15302D    DISPLAY  CNS-PGM-ID":処理前の予備１"
 15303D             "=["H-YOBI1 OF HST-TBL-SELECT"]"
 15304D    DISPLAY  CNS-PGM-ID":処理前の予備２"
 15305D             "=["H-YOBI2 OF HST-TBL-SELECT"]"
 15306D    DISPLAY  CNS-PGM-ID":処理前の作成フラグ"
 15307D             "=["H-SK-FLG OF HST-TBL-SELECT"]"
 15308D    DISPLAY  CNS-PGM-ID":処理前の作成画面ＩＤ"
 15309D             "=["H-SK-GAMEN OF HST-TBL-SELECT"]"
 15310D    DISPLAY  CNS-PGM-ID":処理前の作成ファイル名"
 15311D             "=["H-SK-FILE OF HST-TBL-SELECT"]"
 15312D    DISPLAY  CNS-PGM-ID":処理前の作成日時"
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 265
* MUSR2651.cob                                                     cpy)cpy)y)y)
 15313D             "=["H-SK-DATE OF HST-TBL-SELECT"]"
 15314D    DISPLAY  CNS-PGM-ID":処理前の作成ログインユーザ会社コード"
 15315D             "=["H-SK-LOGIN-CMP-CD OF HST-TBL-SELECT"]"
 15316D    DISPLAY  CNS-PGM-ID":処理前の作成ユーザＩＤ"
 15317D             "=["H-SK-SID OF HST-TBL-SELECT"]"
 15318D    DISPLAY  CNS-PGM-ID":処理前の作成プログラムＩＤ"
 15319D             "=["H-SK-PGMID OF HST-TBL-SELECT"]"
 15320D    DISPLAY  CNS-PGM-ID":処理前の更新フラグ"
 15321D             "=["H-UPD-FLG OF HST-TBL-SELECT"]"
 15322D    DISPLAY  CNS-PGM-ID":処理前の更新画面ＩＤ"
 15323D             "=["H-UPD-GAMEN OF HST-TBL-SELECT"]"
 15324D    DISPLAY  CNS-PGM-ID":処理前の更新ファイル名"
 15325D             "=["H-UPD-FILE OF HST-TBL-SELECT"]"
 15326D    DISPLAY  CNS-PGM-ID":処理前の更新日時"
 15327D    DISPLAY  CNS-PGM-ID":処理前の更新ログインユーザ会社コード"
 15328D             "=["H-UPD-LOGIN-CMP-CD OF HST-TBL-SELECT"]"
 15329D    DISPLAY  CNS-PGM-ID":処理前の更新ユーザＩＤ"
 15330D             "=["H-UPD-SID OF HST-TBL-SELECT"]"
 15331D    DISPLAY  CNS-PGM-ID":処理前の更新プログラムＩＤ"
 15332D             "=["H-UPD-PGMID OF HST-TBL-SELECT"]"
 15333D    DISPLAY  CNS-PGM-ID":H-CP-KRTU-CD"
 15334D             "=["H-CP-KRTU-CD"]"
 15335D    DISPLAY  CNS-PGM-ID":H-HOU-SURYO"
 15336D             "=["H-HOU-SURYO"]"
 15337D    DISPLAY  CNS-PGM-ID":H-THTK-ST-TNK"
 15338D             "=["H-THTK-ST-TNK"]"
 15339*-----------------------------------------------------------------
 15340     IF  H-CP-KRTU-CD = CNS-18-10
 15341       OR  H-CP-KRTU-CD = CNS-18-10-2
 15342     THEN
 15343       IF  H-HOU-SURYO NOT = ZERO
 15344       THEN
 15345         MOVE  H-THTK-ST-TNK
 15346           TO  H-CP-KRTU-CD
 15347       ELSE
 15348         MOVE  ZERO
 15349           TO  H-CP-KRTU-CD
 15350       END-IF
 15351     ELSE
 15352       CONTINUE
 15353     END-IF
 15354*--------------------<DEBUG>--------------------------------------
 15355D    DISPLAY  CNS-PGM-ID":H-CP-KRTU-CD"
 15356D             "=["H-CP-KRTU-CD"]"
 15357*-----------------------------------------------------------------
 15358     MOVE  HST-TBL-SELECT         TO  PARM-SUSC0057-ARG1
 15359         CALL  "SUSC0057"  USING  PARM-SUSC0057-INOUT
 15360     MOVE  PARM-SUSC0057-ARG2     TO  HST-TBL-SELECT
 15361*--------------------<DEBUG>--------------------------------------
 15362D    DISPLAY  CNS-PGM-ID":******************************"
 15363D    DISPLAY  CNS-PGM-ID":処理後の利用会社コード"
 15364D             "=["H-RIYO-CMP-CD OF HST-TBL-SELECT"]"
 15365D    DISPLAY  CNS-PGM-ID":処理後のファンドコード"
 15366D             "=["H-FUND-CD OF HST-TBL-SELECT"]"
 15367D    DISPLAY  CNS-PGM-ID":処理後のポートフォリオコード"
 15368D             "=["H-PTF-CD OF HST-TBL-SELECT"]"
 15369D    DISPLAY  CNS-PGM-ID":処理後の約定受渡区分"
 15370D             "=["H-YJ-UW-KBN OF HST-TBL-SELECT"]"
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 266
* MUSR2651.cob                                                     cpy)cpy)y)y)
 15371D    DISPLAY  CNS-PGM-ID":処理後の残高日付"
 15372D             "=["H-ZANTK-YMD OF HST-TBL-SELECT"]"
 15373D    DISPLAY  CNS-PGM-ID":処理後の決算日断面区分"
 15374D             "=["H-KSN-YMD-DMN-KBN OF HST-TBL-SELECT"]"
 15375D    DISPLAY  CNS-PGM-ID":処理後の評価系列コード"
 15376D             "=["H-HYK-KRTU-CD OF HST-TBL-SELECT"]"
 15377D    DISPLAY  CNS-PGM-ID":処理後の証券種別コード"
 15378D             "=["H-SEC-SBT-CD OF HST-TBL-SELECT"]"
 15379D    DISPLAY  CNS-PGM-ID":処理後の取消フラグ"
 15380D             "=["H-DEL-KBN OF HST-TBL-SELECT"]"
 15381D    DISPLAY  CNS-PGM-ID":処理後の確定フラグ"
 15382D             "=["H-KT-KBN OF HST-TBL-SELECT"]"
 15383D    DISPLAY  CNS-PGM-ID":処理後の取引通貨"
 15384D             "=["H-TRHK-TUKA OF HST-TBL-SELECT"]"
 15385D    DISPLAY  CNS-PGM-ID":処理後の為替取引決済通貨"
 15386D             "=["H-KWS-TH-TUKA-CD OF HST-TBL-SELECT"]"
 15387D    DISPLAY  CNS-PGM-ID":処理後の発行国コード"
 15388D             "=["H-HAKO-CD OF HST-TBL-SELECT"]"
 15389D    DISPLAY  CNS-PGM-ID":処理後の銘柄コード"
 15390D             "=["H-MEG-CD OF HST-TBL-SELECT"]"
 15391D    DISPLAY  CNS-PGM-ID":処理後の資産負債・買建売建フラグ"
 15392D             "=["H-TATE-FLG OF HST-TBL-SELECT"]"
 15393D    DISPLAY  CNS-PGM-ID":処理後の個別建玉約定日"
 15394D             "=["H-TG-YKJ-YMD OF HST-TBL-SELECT"]"
 15395D    DISPLAY  CNS-PGM-ID":処理後の個別玉管理番号"
 15396D             "=["H-KB-KANRI-ID OF HST-TBL-SELECT"]"
 15397D    DISPLAY  CNS-PGM-ID":処理後のカストディコード"
 15398D             "=["H-CAST-CD OF HST-TBL-SELECT"]"
 15399D    DISPLAY  CNS-PGM-ID":処理後の保有数量"
 15400D             "=["H-HOU-SURYO OF HST-TBL-SELECT"]"
 15401D    DISPLAY  CNS-PGM-ID":処理後の数量単位"
 15402D             "=["H-SURYO-TANI OF HST-TBL-SELECT"]"
 15403D    DISPLAY  CNS-PGM-ID":処理後の取得金額取引通貨"
 15404D             "=["H-THTK-ST-KNG OF HST-TBL-SELECT"]"
 15405D    DISPLAY  CNS-PGM-ID":処理後の取得単価取引通貨"
 15406D             "=["H-THTK-ST-TNK OF HST-TBL-SELECT"]"
 15407D    DISPLAY  CNS-PGM-ID":処理後の時価取引通貨"
 15408D             "=["H-CP-KRTU-CD OF HST-TBL-SELECT"]"
 15409D    DISPLAY  CNS-PGM-ID":処理後の時価採用日付"
 15410D             "=["H-CP-SAIYO-YMD OF HST-TBL-SELECT"]"
 15411D    DISPLAY  CNS-PGM-ID":処理後の時価採用市場"
 15412D             "=["H-CP-SAIYO-SIJO OF HST-TBL-SELECT"]"
 15413D    DISPLAY  CNS-PGM-ID":処理後の評価金額取引通貨"
 15414D             "=["H-THTK-HYK-KN OF HST-TBL-SELECT"]"
 15415D    DISPLAY  CNS-PGM-ID":処理後の評価損益取引通貨"
 15416D             "=["H-THTK-HYK-SNEKI OF HST-TBL-SELECT"]"
 15417D    DISPLAY  CNS-PGM-ID":処理後の前払金残取引通貨"
 15418D             "=["H-THTK-PPAYZN OF HST-TBL-SELECT"]"
 15419D    DISPLAY  CNS-PGM-ID":処理後の経過利息金額取引通貨"
 15420D             "=["H-THTK-KKRS   OF HST-TBL-SELECT"]"
 15421D    DISPLAY  CNS-PGM-ID":処理後の未収収益取引通貨"
 15422D             "=["H-THTK-MS-EKI OF HST-TBL-SELECT"]"
 15423D    DISPLAY  CNS-PGM-ID":処理後の評価為替レート"
 15424D             "=["H-HYK-KWS OF HST-TBL-SELECT"]"
 15425D    DISPLAY  CNS-PGM-ID":処理後の為替採用日付"
 15426D             "=["H-KWS-SAIYO-YMD OF HST-TBL-SELECT"]"
 15427D    DISPLAY  CNS-PGM-ID":処理後の為替採用ソース"
 15428D             "=["H-KWS-SAIYO-SOURCE OF HST-TBL-SELECT"]"
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 267
* MUSR2651.cob                                                     cpy)cpy)y)y)
 15429D    DISPLAY  CNS-PGM-ID":処理後の取得金額運用通貨為替換算額"
 15430D             "=["H-UYTK-KWS-BOKAZN OF HST-TBL-SELECT"]"
 15431D    DISPLAY  CNS-PGM-ID":処理後の取得金額運用通貨"
 15432D             "=["H-SHTK-KN-LC OF HST-TBL-SELECT"]"
 15433D    DISPLAY  CNS-PGM-ID":処理後の取得単価運用通貨"
 15434D             "=["H-UYTK-ST-TNK OF HST-TBL-SELECT"]"
 15435D    DISPLAY  CNS-PGM-ID":処理後の評価金額運用通貨"
 15436D             "=["H-HYK-KN-LC OF HST-TBL-SELECT"]"
 15437D    DISPLAY  CNS-PGM-ID":処理後の評価損益運用通貨"
 15438D             "=["H-HYK-SNEKI-LC OF HST-TBL-SELECT"]"
 15439D    DISPLAY  CNS-PGM-ID":処理後の前払金残運用通貨"
 15440D             "=["H-UYTK-PPAY-ZN OF HST-TBL-SELECT"]"
 15441D    DISPLAY  CNS-PGM-ID":処理後の経過利息金額運用通貨"
 15442D             "=["H-KEKA-RSK-LC  OF HST-TBL-SELECT"]"
 15443D    DISPLAY  CNS-PGM-ID":処理後の未収収益運用通貨"
 15444D             "=["H-UYTK-MS-EKI OF HST-TBL-SELECT"]"
 15445D    DISPLAY  CNS-PGM-ID":処理後の備考_１"
 15446D             "=["H-BIKOU-1 OF HST-TBL-SELECT"]"
 15447D    DISPLAY  CNS-PGM-ID":処理後の備考_２"
 15448D             "=["H-BIKOU-2 OF HST-TBL-SELECT"]"
 15449D    DISPLAY  CNS-PGM-ID":処理後の備考_３"
 15450D             "=["H-BIKOU-3 OF HST-TBL-SELECT"]"
 15451D    DISPLAY  CNS-PGM-ID":処理後の備考_４"
 15452D             "=["H-BIKOU-4 OF HST-TBL-SELECT"]"
 15453D    DISPLAY  CNS-PGM-ID":処理後の備考_５"
 15454D             "=["H-BIKOU-5 OF HST-TBL-SELECT"]"
 15455D    DISPLAY  CNS-PGM-ID":処理後の備考_６"
 15456D             "=["H-BIKOU-6 OF HST-TBL-SELECT"]"
 15457D    DISPLAY  CNS-PGM-ID":処理後の備考_７"
 15458D             "=["H-BIKOU-7 OF HST-TBL-SELECT"]"
 15459D    DISPLAY  CNS-PGM-ID":処理後の備考_８"
 15460D             "=["H-BIKOU-8 OF HST-TBL-SELECT"]"
 15461D    DISPLAY  CNS-PGM-ID":処理後の備考_９"
 15462D             "=["H-BIKOU-9 OF HST-TBL-SELECT"]"
 15463D    DISPLAY  CNS-PGM-ID":処理後の投資対象国"
 15464D             "=["H-TS-TARGET-KUNI OF HST-TBL-SELECT"]"
 15465D    DISPLAY  CNS-PGM-ID":処理後の未払費用残取引通貨"
 15466D             "=["H-SJTK-MBHY-ZN OF HST-TBL-SELECT"]"
 15467D    DISPLAY  CNS-PGM-ID":処理後の未払費用残運用通貨"
 15468D             "=["H-UYTK-MBHY-ZN OF HST-TBL-SELECT"]"
 15469D    DISPLAY  CNS-PGM-ID":処理後の建玉為替レート"
 15470D             "=["H-TGYOKU-KWS-RATE OF HST-TBL-SELECT"]"
 15471D    DISPLAY  CNS-PGM-ID":処理後の建玉約定金額残取引通貨"
 15472D             "=["H-THTK-TG-YJKN-ZN OF HST-TBL-SELECT"]"
 15473D    DISPLAY  CNS-PGM-ID":処理後の建玉約定金額残運用通貨"
 15474D             "=["H-UYTK-TG-YJKN-ZN OF HST-TBL-SELECT"]"
 15475D    DISPLAY  CNS-PGM-ID":処理後の建玉手数料残取引通貨"
 15476D             "=["H-THTK-TG-TSR-ZN OF HST-TBL-SELECT"]"
 15477D    DISPLAY  CNS-PGM-ID":処理後の建玉手数料残運用通貨"
 15478D             "=["H-UYTK-TG-TSR-ZN OF HST-TBL-SELECT"]"
 15479D    DISPLAY  CNS-PGM-ID":処理後の建玉消費税残取引通貨"
 15480D             "=["H-THTK-TG-S-TAX-ZN OF HST-TBL-SELECT"]"
 15481D    DISPLAY  CNS-PGM-ID":処理後の建玉消費税残運用通貨"
 15482D             "=["H-UYTK-TG-S-TAX-ZN OF HST-TBL-SELECT"]"
 15483D    DISPLAY  CNS-PGM-ID":処理後の建玉その他費用残取引通貨"
 15484D             "=["H-THTK-TG-ELS-HIYO-ZN OF HST-TBL-SELECT"]"
 15485D    DISPLAY  CNS-PGM-ID":処理後の建玉その他費用残運用通貨"
 15486D             "=["H-UYTK-TG-ELS-HIYO-ZN OF HST-TBL-SELECT"]"
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 268
* MUSR2651.cob                                                     cpy)cpy)y)y)
 15487D    DISPLAY  CNS-PGM-ID":処理後の建玉精算金額残取引通貨"
 15488D             "=["H-THTK-TG-SSKG-ZN OF HST-TBL-SELECT"]"
 15489D    DISPLAY  CNS-PGM-ID":処理後の建玉精算金額残運用通貨"
 15490D             "=["H-UYTK-TG-SSKG-ZN OF HST-TBL-SELECT"]"
 15491D    DISPLAY  CNS-PGM-ID":処理後の前受金残取引通貨"
 15492D             "=["H-THTK-AREC-ZN OF HST-TBL-SELECT"]"
 15493D    DISPLAY  CNS-PGM-ID":処理後の前受金残運用通貨"
 15494D             "=["H-UYTK-AREC-ZN OF HST-TBL-SELECT"]"
 15495D    DISPLAY  CNS-PGM-ID":処理後の仮払金残取引通貨"
 15496D             "=["H-THTK-SPAY-ZN OF HST-TBL-SELECT"]"
 15497D    DISPLAY  CNS-PGM-ID":処理後の仮払金残運用通貨"
 15498D             "=["H-UYTK-SPAY-ZN OF HST-TBL-SELECT"]"
 15499D    DISPLAY  CNS-PGM-ID":処理後の源泉税取引通貨"
 15500D             "=["H-THTK-GSZ OF HST-TBL-SELECT"]"
 15501D    DISPLAY  CNS-PGM-ID":処理後の源泉税運用通貨"
 15502D             "=["H-GENSEN-TAX-LC OF HST-TBL-SELECT"]"
 15503D    DISPLAY  CNS-PGM-ID":処理後の源泉税還付予定額残高取引通貨"
 15504D             "=["H-THTK-GSZKP-YT-ZN OF HST-TBL-SELECT"]"
 15505D    DISPLAY  CNS-PGM-ID":処理後の源泉税還付予定額残高運用通貨"
 15506D             "=["H-UYTK-GSZKP-YT-ZN OF HST-TBL-SELECT"]"
 15507D    DISPLAY  CNS-PGM-ID":処理後の簿価為替レート"
 15508D             "=["H-BOKA-KWS OF HST-TBL-SELECT"]"
 15509D    DISPLAY  CNS-PGM-ID":処理後の移管評価損益残取引通貨"
 15510D             "=["H-THTK-IKAN-HYK-SEZN OF HST-TBL-SELECT"]"
 15511D    DISPLAY  CNS-PGM-ID":処理後の移管評価損益残運用通貨"
 15512D             "=["H-UYTK-IKAN-HYK-SEZN OF HST-TBL-SELECT"]"
 15513D    DISPLAY  CNS-PGM-ID":処理後の移管未収収益取引通貨"
 15514D             "=["H-SJTK-IKAN-MSSHEKI OF HST-TBL-SELECT"]"
 15515D    DISPLAY  CNS-PGM-ID":処理後の移管未収収益運用通貨"
 15516D             "=["H-UYTK-IKAN-MSSHEKI OF HST-TBL-SELECT"]"
 15517D    DISPLAY  CNS-PGM-ID":処理後の移管前払金評価損益残運用通貨"
 15518D             "=["H-UYTK-IKAN-PPHKZN OF HST-TBL-SELECT"]"
 15519D    DISPLAY  CNS-PGM-ID":処理後のＯＰ資産負債・買建売建フラグ"
 15520D             "=["H-OP-TATE-FLG OF HST-TBL-SELECT"]"
 15521D    DISPLAY  CNS-PGM-ID":処理後の時価系列コード"
 15522D             "=["H-JIKA-KRTU-CD OF HST-TBL-SELECT"]"
 15523D    DISPLAY  CNS-PGM-ID":処理後の取得時遡及有無"
 15524D             "=["H-SKYU-UMU-FLG OF HST-TBL-SELECT"]"
 15525D    DISPLAY  CNS-PGM-ID":処理後の時価種類"
 15526D             "=["H-JIKA-SHRU OF HST-TBL-SELECT"]"
 15527D    DISPLAY  CNS-PGM-ID":処理後のソース区分"
 15528D             "=["H-SOURCE-KBN OF HST-TBL-SELECT"]"
 15529D    DISPLAY  CNS-PGM-ID":処理後の前払金評価額運用通貨"
 15530D             "=["H-UYTK-KPPAY-HYK-GK OF HST-TBL-SELECT"]"
 15531D    DISPLAY  CNS-PGM-ID":処理後の前払金評価損益運用通貨"
 15532D             "=["H-UYTK-PPAY-SNEKI OF HST-TBL-SELECT"]"
 15533D    DISPLAY  CNS-PGM-ID":処理後の未収収益評価為替レート"
 15534D             "=["H-MS-SHEKI-HYK-KWS OF HST-TBL-SELECT"]"
 15535D    DISPLAY  CNS-PGM-ID":処理後の源泉税評価為替レート"
 15536D             "=["H-GENS-TAX-HYK-KWS OF HST-TBL-SELECT"]"
 15537D    DISPLAY  CNS-PGM-ID":処理後のデータ区分"
 15538D             "=["H-DATA-KBN OF HST-TBL-SELECT"]"
 15539D    DISPLAY  CNS-PGM-ID":処理後の商品区分"
 15540D             "=["H-SYOHIN-KBN OF HST-TBL-SELECT"]"
 15541D    DISPLAY  CNS-PGM-ID":処理後の帳票出力区分"
 15542D             "=["H-REP-KBN OF HST-TBL-SELECT"]"
 15543D    DISPLAY  CNS-PGM-ID":処理後の項目コード１"
 15544D             "=["H-KODE-1 OF HST-TBL-SELECT"]"
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 269
* MUSR2651.cob                                                     cpy)cpy)y)y)
 15545D    DISPLAY  CNS-PGM-ID":処理後の数値_１１"
 15546D             "=["H-SUJI-11 OF HST-TBL-SELECT"]"
 15547D    DISPLAY  CNS-PGM-ID":処理後の数値１２"
 15548D             "=["H-SUJI-12 OF HST-TBL-SELECT"]"
 15549D    DISPLAY  CNS-PGM-ID":処理後の数値１３"
 15550D             "=["H-SUJI-13 OF HST-TBL-SELECT"]"
 15551D    DISPLAY  CNS-PGM-ID":処理後の項目コード２"
 15552D             "=["H-KODE-2 OF HST-TBL-SELECT"]"
 15553D    DISPLAY  CNS-PGM-ID":処理後の数値２１"
 15554D             "=["H-SUJI-21 OF HST-TBL-SELECT"]"
 15555D    DISPLAY  CNS-PGM-ID":処理後の数値２２"
 15556D             "=["H-SUJI-22 OF HST-TBL-SELECT"]"
 15557D    DISPLAY  CNS-PGM-ID":処理後の数値２３"
 15558D             "=["H-SUJI-23 OF HST-TBL-SELECT"]"
 15559D    DISPLAY  CNS-PGM-ID":処理後の項目コード３"
 15560D             "=["H-KODE-3 OF HST-TBL-SELECT"]"
 15561D    DISPLAY  CNS-PGM-ID":処理後の数値３１"
 15562D             "=["H-SUJI-31 OF HST-TBL-SELECT"]"
 15563D    DISPLAY  CNS-PGM-ID":処理後の数値３２"
 15564D             "=["H-SUJI-32 OF HST-TBL-SELECT"]"
 15565D    DISPLAY  CNS-PGM-ID":処理後の数値３３"
 15566D             "=["H-SUJI-33 OF HST-TBL-SELECT"]"
 15567D    DISPLAY  CNS-PGM-ID":処理後の予備１"
 15568D             "=["H-YOBI1 OF HST-TBL-SELECT"]"
 15569D    DISPLAY  CNS-PGM-ID":処理後の予備２"
 15570D             "=["H-YOBI2 OF HST-TBL-SELECT"]"
 15571D    DISPLAY  CNS-PGM-ID":処理後の作成フラグ"
 15572D             "=["H-SK-FLG OF HST-TBL-SELECT"]"
 15573D    DISPLAY  CNS-PGM-ID":処理後の作成画面ＩＤ"
 15574D             "=["H-SK-GAMEN OF HST-TBL-SELECT"]"
 15575D    DISPLAY  CNS-PGM-ID":処理後の作成ファイル名"
 15576D             "=["H-SK-FILE OF HST-TBL-SELECT"]"
 15577D    DISPLAY  CNS-PGM-ID":処理後の作成日時"
 15578D             "=["H-SK-DATE OF HST-TBL-SELECT"]"
 15579D    DISPLAY  CNS-PGM-ID":処理後の作成ログインユーザ会社コード"
 15580D             "=["H-SK-LOGIN-CMP-CD OF HST-TBL-SELECT"]"
 15581D    DISPLAY  CNS-PGM-ID":処理後の作成ユーザＩＤ"
 15582D             "=["H-SK-SID OF HST-TBL-SELECT"]"
 15583D    DISPLAY  CNS-PGM-ID":処理後の作成プログラムＩＤ"
 15584D             "=["H-SK-PGMID OF HST-TBL-SELECT"]"
 15585D    DISPLAY  CNS-PGM-ID":処理後の更新フラグ"
 15586D             "=["H-UPD-FLG OF HST-TBL-SELECT"]"
 15587D    DISPLAY  CNS-PGM-ID":処理後の更新画面ＩＤ"
 15588D             "=["H-UPD-GAMEN OF HST-TBL-SELECT"]"
 15589D    DISPLAY  CNS-PGM-ID":処理後の更新ファイル名"
 15590D             "=["H-UPD-FILE OF HST-TBL-SELECT"]"
 15591D    DISPLAY  CNS-PGM-ID":処理後の更新日時"
 15592D    DISPLAY  CNS-PGM-ID":処理後の更新ログインユーザ会社コード"
 15593D             "=["H-UPD-LOGIN-CMP-CD OF HST-TBL-SELECT"]"
 15594D    DISPLAY  CNS-PGM-ID":処理後の更新ユーザＩＤ"
 15595D             "=["H-UPD-SID OF HST-TBL-SELECT"]"
 15596D    DISPLAY  CNS-PGM-ID":処理後の更新プログラムＩＤ"
 15597D             "=["H-UPD-PGMID OF HST-TBL-SELECT"]"
 15598D    DISPLAY  "CALL SUSC0057  END"
 15599*-----------------------------------------------------------------
 15600*--------------------<DEBUG>--------------------------------------
 15601D    DISPLAY  CNS-PGM-ID":***  ワーク セット  END  ***"
 15602*-----------------------------------------------------------------
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 270
* MUSR2651.cob                                                     cpy)cpy)y)y)
 15603     CONTINUE.
 15604 WORK-OPERATION-EXT.
 15605     EXIT.
 15606******************************************************************
 15607*    進捗管理ＩＮＳＵＰＤ処理1
 15608******************************************************************
 15609 SUSC0405-NEW-RTN       SECTION.
 15610*--------------------<DEBUG>--------------------------------------
 15611D    DISPLAY  CNS-PGM-ID":*** 進捗管理ＩＮＳＵＰＤ処理1 START ***"
 15612*-----------------------------------------------------------------
 15613*----------  ワーク進捗フラグ
 15614     MOVE  CNS-ON                 TO  FLG-UPD
 15615     INITIALIZE  PARM-SUSC0405-INOUT
 15616                 PARM-RTNPKG
 15617                 WK-1190-STATUS
 15618*----------  セッション区分←"0":先頭セッション
 15619     MOVE  CNS-X-0
 15620       TO  SESION-KBN             OF  PARM-SUSC0405-ARG1
 15621*----------  OL/BT区分←"BT":バッチ用
 15622     MOVE  CNS-BT
 15623       TO  OLBT-KBN               OF  PARM-SUSC0405-ARG1
 15624*----------  利用会社コード
 15625     MOVE  WK-RIYO-CMP-CD
 15626       TO  RIYO-CMP-CD            OF  PARM-SUSC0405-ARG2
 15627*----------  処理実行日
 15628     MOVE  WK-SHORI-YMD-9
 15629       TO  SYORI-YMD              OF  PARM-SUSC0405-ARG2
 15630*----------  起動ID
 15631     MOVE  WK-KIDOU-ID
 15632       TO  KIDOU-ID               OF  PARM-SUSC0405-ARG2
 15633*----------  業務タスクID
 15634     MOVE  WK-GYOMU-TASK-ID       OF  WK-ARGUMENT
 15635       TO  GYOMU-TASK-ID          OF  PARM-SUSC0405-ARG2
 15636*----------  基準年月日/基準年月
 15637     MOVE  H-ZANTK-YMD            OF  HST-TBL-SELECT-2
 15638       TO  KJN-YMD                OF  PARM-SUSC0405-ARG2
 15639*----------  ファンドコード
 15640     MOVE  WK-FUND-CD-DETAIL      OF  WK-PTF-ATT-DATA(WK-IDX-J)
 15641       TO  FUND-CD                OF  PARM-SUSC0405-ARG2
 15642*----------  ポートフォリオコード
 15643     MOVE  WK-PTF-CD-DETAIL       OF  WK-PTF-ATT-DATA(WK-IDX-J)
 15644       TO  PTF-CD                 OF  PARM-SUSC0405-ARG2
 15645*----------  評価系列コード
 15646     MOVE  WK-DEFAUL-THYK-CD      OF  WK-PTF-ATT-DATA(WK-IDX-J)
 15647       TO  HYK-KRTU-CD            OF  PARM-SUSC0405-ARG2
 15648*----------  基準日FROM
 15649*----------  テーマ2693対応START
 15650     MOVE  WK-KZYN-YMD-FROM       OF  WK-PTF-ATT-DATA(WK-IDX-J)
 15651*----------  テーマ2693対応END
 15652       TO  KJN-YMD-FROM           OF  PARM-SUSC0405-ARG2
 15653*----------  実行ステータス
 15654     MOVE  CNS-SHINTK-STS-600
 15655       TO  JIKOU-STS              OF  PARM-SUSC0405-ARG2
 15656*-------------------<DEBUG>---------------------------------------
 15657D    DISPLAY  CNS-PGM-ID":セッション区分=["
 15658D             SESION-KBN          OF  PARM-SUSC0405-ARG1"]"
 15659D    DISPLAY  CNS-PGM-ID":OL/BT区分=["
 15660D             OLBT-KBN            OF  PARM-SUSC0405-ARG1"]"
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 271
* MUSR2651.cob                                                     cpy)cpy)y)y)
 15661D    DISPLAY  CNS-PGM-ID":利用会社コード=["
 15662D             RIYO-CMP-CD         OF  PARM-SUSC0405-ARG2"]"
 15663D    DISPLAY  CNS-PGM-ID":処理実行日=["
 15664D             SYORI-YMD           OF  PARM-SUSC0405-ARG2"]"
 15665D    DISPLAY  CNS-PGM-ID":起動ID=["
 15666D             KIDOU-ID            OF  PARM-SUSC0405-ARG2"]"
 15667D    DISPLAY  CNS-PGM-ID":業務タスクID=["
 15668D             GYOMU-TASK-ID       OF  PARM-SUSC0405-ARG2"]"
 15669D    DISPLAY  CNS-PGM-ID":基準年月日/基準年月=["
 15670D             KJN-YMD             OF  PARM-SUSC0405-ARG2"]"
 15671D    DISPLAY  CNS-PGM-ID":最終処理基準日=["
 15672D             SS-SYORI-YMD        OF  PARM-SUSC0405-ARG2"]"
 15673D    DISPLAY  CNS-PGM-ID":ベビー未処理フラグ=["
 15674D             BABY-MISYORI-FLG    OF  PARM-SUSC0405-ARG2"]"
 15675D    DISPLAY  CNS-PGM-ID":ファンドコード=["
 15676D             FUND-CD             OF  PARM-SUSC0405-ARG2"]"
 15677D    DISPLAY  CNS-PGM-ID":ポートフォリオコード=["
 15678D             PTF-CD              OF  PARM-SUSC0405-ARG2"]"
 15679D    DISPLAY  CNS-PGM-ID":評価系列コード=["
 15680D             HYK-KRTU-CD         OF  PARM-SUSC0405-ARG2"]"
 15681D    DISPLAY  CNS-PGM-ID":帳票ID=["
 15682D             REP-ID              OF  PARM-SUSC0405-ARG2"]"
 15683D    DISPLAY  CNS-PGM-ID":帳票任意コード=["
 15684D             REP-ANY-CD          OF  PARM-SUSC0405-ARG2"]"
 15685D    DISPLAY  CNS-PGM-ID":基準日FROM=["
 15686D             KJN-YMD-FROM        OF  PARM-SUSC0405-ARG2"]"
 15687D    DISPLAY  CNS-PGM-ID":進捗ステータス=["
 15688D             JIKOU-STS           OF  PARM-SUSC0405-ARG2"]"
 15689D    DISPLAY  CNS-PGM-ID": ***  CALL SUSC0405  START  ***"
 15690*-----------------------------------------------------------------
 15691     CALL  "SUSC0405"             USING  PARM-SUSC0405-INOUT
 15692                                         PARM-RTNPKG
 15693*-------------------<DEBUG>---------------------------------------
 15694D    DISPLAY  CNS-PGM-ID": ***  CALL SUSC0405  END  ***"
 15695D    DISPLAY  CNS-PGM-ID":RTN-CD(SUSC0405)        =["
 15696D             RTN-CD OF PARM-RTNPKG(COUNTER   OF PARM-RTNPKG) "]"
 15697D    DISPLAY  CNS-PGM-ID":COUNTER  OF  PARM-RTNPKG=["
 15698D             COUNTER              OF PARM-RTNPKG"]"
 15699*-----------------------------------------------------------------
 15700     EVALUATE  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
 15701       WHEN  CNS-RTN-000
 15702*----------  ポートフォリオ実行可能区分
 15703*--------------------<DEBUG>--------------------------------------
 15704D    DISPLAY  CNS-PGM-ID":ポートフォリオ実行可能区分=["
 15705D             PTF-JIKOU-KBN       OF  PARM-SUSC0405-ARG3"]"
 15706*-----------------------------------------------------------------
 15707*----------  ＤＢ コミット処理
 15708         PERFORM  DB-COMMIT1-RTN
 15709*----------  ポートフォリオ実行可能区分
 15710         EVALUATE  PTF-JIKOU-KBN OF PARM-SUSC0405-ARG3
 15711           WHEN  CNS-X-0
 15712             CONTINUE
 15713*--------------------<DEBUG>--------------------------------------
 15714D    DISPLAY  CNS-PGM-ID":*** 進捗管理ＩＮＳＵＰＤ処理1 正常  ***"
 15715*-----------------------------------------------------------------
 15716           WHEN  CNS-X-1
 15717             MOVE  CNS-OFF           TO  FLG-UPD
 15718           WHEN  OTHER
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 272
* MUSR2651.cob                                                     cpy)cpy)y)y)
 15719             MOVE  CNS-OFF           TO  FLG-UPD
 15720*--------------------<DEBSUG>-------------------------------------
 15721D    DISPLAY  CNS-PGM-ID":ポートフォリオ実行可能区分'2':停止の時"
 15722*-----------------------------------------------------------------
 15723*----------  ワークリターンコード
 15724             IF  WK-RTN-CODE < CNS-10
 15725             THEN
 15726               MOVE  CNS-10          TO  WK-RTN-CODE
 15727             ELSE
 15728               CONTINUE
 15729             END-IF
 15730*----------  後処理
 15731             PERFORM  END-RTN
 15732         END-EVALUATE
 15733*-------------------<DEBUG>---------------------------------------
 15734D    DISPLAY  CNS-PGM-ID":進捗フラグFLG-UPD =[" FLG-UPD"]"
 15735*-----------------------------------------------------------------
 15736       WHEN  CNS-RTN-113
 15737         MOVE  CNS-OFF          TO  FLG-UPD
 15738*----------
 15739         IF  WK-1190-STATUS < CNS-4
 15740         THEN
 15741           MOVE  CNS-4          TO  WK-1190-STATUS
 15742         ELSE
 15743           CONTINUE
 15744         END-IF
 15745*
 15746         IF  WK-STATUS < CNS-4
 15747         THEN
 15748           MOVE  CNS-4          TO  WK-STATUS
 15749         ELSE
 15750           CONTINUE
 15751         END-IF
 15752*----------  ワークリターンコード
 15753         IF  WK-RTN-CODE < CNS-4
 15754         THEN
 15755           MOVE  CNS-4          TO  WK-RTN-CODE
 15756         ELSE
 15757           CONTINUE
 15758         END-IF
 15759*----------  ワーク業務エラーパッケージを編集
 15760*-------------------<DEBUG>---------------------------------------
 15761D    DISPLAY  CNS-PGM-ID":WK-J =[" WK-J"]"
 15762*-----------------------------------------------------------------
 15763         COMPUTE  WK-J = WK-J + 1
 15764*-------------------<DEBUG>---------------------------------------
 15765D    DISPLAY  CNS-PGM-ID":WK-J =[" WK-J"]"
 15766*-----------------------------------------------------------------
 15767*---------- ファンドコード
 15768         MOVE  WK-FUND-CD-DETAIL     OF  WK-PTF-ATT-DATA(WK-IDX-J)
 15769           TO  WK-GYOMU-FUND-CD      OF  WK-GYOMU-ERR-INFO(WK-J)
 15770*---------- ポートフォリオコード
 15771         MOVE  WK-PTF-CD-DETAIL      OF  WK-PTF-ATT-DATA(WK-IDX-J)
 15772           TO  WK-GYOMU-PTF-CD       OF  WK-GYOMU-ERR-INFO(WK-J)
 15773*---------- 評価系列コード
 15774         MOVE  WK-DEFAUL-THYK-CD     OF  WK-PTF-ATT-DATA(WK-IDX-J)
 15775           TO  WK-GYOMU-HYK-KRTU-CD  OF  WK-GYOMU-ERR-INFO(WK-J)
 15776*---------- 帳票ID
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 273
* MUSR2651.cob                                                     cpy)cpy)y)y)
 15777         MOVE  SPACE
 15778           TO  WK-GYOMU-REP-ID        OF  WK-GYOMU-ERR-INFO(WK-J)
 15779*---------- 帳票任意コード
 15780         MOVE  SPACE
 15781           TO  WK-GYOMU-REP-ANY-CD    OF  WK-GYOMU-ERR-INFO(WK-J)
 15782*---------- 基準日From
 15783         MOVE  WK-KIKAN-FR
 15784           TO  WK-GYOMU-KJN-YMD-FROM  OF  WK-GYOMU-ERR-INFO(WK-J)
 15785*---------- 基準日To
 15786         MOVE  WK-KIKAN-TO
 15787           TO  WK-GYOMU-KJN-YMD-TO    OF  WK-GYOMU-ERR-INFO(WK-J)
 15788*---------- メッセージID
 15789         MOVE  CNS-MSG-E000217
 15790           TO  WK-GYOMU-MSG-ID        OF  WK-GYOMU-ERR-INFO(WK-J)
 15791*---------- 置換文字
 15792         MOVE  CNS-DATA-TEXT
 15793           TO  WK-GYOMU-TK-MOJI(WK-J,CNS-1)
 15794*---------- フリーメッセージ
 15795         MOVE  WK-TEMP-MSG
 15796           TO  WK-GYOMU-FREE-MSG      OF  WK-GYOMU-ERR-INFO(WK-J)
 15797*----------  後処理業務エラーフラグ
 15798         MOVE  CNS-ON                 TO  FLG-MEISAI-GYOMU-ERR
 15799      WHEN  OTHER
 15800*--------------------<DEBUG>--------------------------------------
 15801D    DISPLAY  CNS-PGM-ID":*** 進捗管理ＩＮＳＵＰＤ処理1エラー ***"
 15802*-----------------------------------------------------------------
 15803*----------  ワーク実行ステータス
 15804         MOVE  CNS-OFF              TO  FLG-UPD
 15805         MOVE  CNS-16               TO  WK-STATUS
 15806         MOVE  CNS-16               TO  WK-1190-STATUS
 15807*----------  ワークリターンコード
 15808         MOVE  WK-STATUS            TO  WK-RTN-CODE
 15809*----------  ワークエラーパッケージを編集
 15810         PERFORM  SUB-ERR-MSG-RTN
 15811         INITIALIZE  WK-SYS-ERR-INFO
 15812*----------  エラー検知プログラムID
 15813         MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
 15814*----------  ポジション
 15815         MOVE  CNS-POS-020          TO  WK-ERR-POS
 15816*----------  リターンコード
 15817         MOVE  CNS-RTN-901          TO  WK-RTN-CD
 15818*----------  詳細リターンコード
 15819         MOVE  RTN-CD               OF  PARM-RTNPKG
 15820                                      (COUNTER OF PARM-RTNPKG)
 15821                                    TO  WK-DETAIL-RTN-CD
 15822*----------  詳細リターンコードデコードフラグ
 15823         MOVE  CNS-DETAIL-0         TO  WK-DETAIL-RTN-CD-FLG
 15824*---------- フリーメッセージ
 15825         MOVE  SPACE                TO  WK-FREE-MSG
 15826*----------  エラー情報追加処理
 15827         PERFORM  ERR-INFO-ADD-RTN
 15828     END-EVALUATE
 15829*--------------------<DEBUG>--------------------------------------
 15830D    DISPLAY  CNS-PGM-ID":*** 進捗管理ＩＮＳＵＰＤ処理1  END  ***"
 15831*-----------------------------------------------------------------
 15832     CONTINUE.
 15833 SUSC0405-NEW-EXT.
 15834     EXIT.
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 274
* MUSR2651.cob                                                     cpy)cpy)y)y)
 15835******************************************************************
 15836*    進捗管理ＩＮＳＵＰＤ処理
 15837******************************************************************
 15838 SUSC0405-OLD-RTN       SECTION.
 15839*--------------------<DEBUG>--------------------------------------
 15840D    DISPLAY  CNS-PGM-ID":*** 進捗管理ＩＮＳＵＰＤ処理2 START ***"
 15841*-----------------------------------------------------------------
 15842     INITIALIZE  PARM-SUSC0405-INOUT
 15843                 PARM-RTNPKG
 15844     MOVE  CNS-OFF                TO  FLG-UPD
 15845*----------  セッション区分←"1":最終セッション
 15846     MOVE  CNS-X-1
 15847       TO  SESION-KBN             OF  PARM-SUSC0405-ARG1
 15848*----------  OL/BT区分←"BT":バッチ用
 15849     MOVE  CNS-BT
 15850       TO  OLBT-KBN               OF  PARM-SUSC0405-ARG1
 15851*----------  利用会社コード
 15852     MOVE  WK-RIYO-CMP-CD
 15853       TO  RIYO-CMP-CD            OF  PARM-SUSC0405-ARG2
 15854*----------  処理実行日
 15855     MOVE  WK-SHORI-YMD-9
 15856       TO  SYORI-YMD              OF  PARM-SUSC0405-ARG2
 15857*----------  起動ID
 15858     MOVE  WK-KIDOU-ID
 15859       TO  KIDOU-ID               OF  PARM-SUSC0405-ARG2
 15860*----------  業務タスクID
 15861     MOVE  WK-GYOMU-TASK-ID       OF  WK-ARGUMENT
 15862       TO  GYOMU-TASK-ID          OF  PARM-SUSC0405-ARG2
 15863*----------  基準日
 15864     MOVE  H-ZANTK-YMD            OF  HST-TBL-SELECT-2
 15865       TO  KJN-YMD                OF  PARM-SUSC0405-ARG2
 15866*----------  ファンドコード
 15867     MOVE  WK-FUND-CD-DETAIL      OF  WK-PTF-ATT-DATA(WK-IDX-J)
 15868       TO  FUND-CD                OF  PARM-SUSC0405-ARG2
 15869*----------  ポートフォリオコード
 15870     MOVE  WK-PTF-CD-DETAIL       OF  WK-PTF-ATT-DATA(WK-IDX-J)
 15871       TO  PTF-CD                 OF  PARM-SUSC0405-ARG2
 15872*----------  評価系列コード
 15873     MOVE  WK-DEFAUL-THYK-CD      OF  WK-PTF-ATT-DATA(WK-IDX-J)
 15874       TO  HYK-KRTU-CD            OF  PARM-SUSC0405-ARG2
 15875*----------  基準日FROM
 15876*----------  テーマ2693対応START
 15877     MOVE  WK-KZYN-YMD-FROM       OF  WK-PTF-ATT-DATA(WK-IDX-J)
 15878*----------  テーマ2693対応END
 15879       TO  KJN-YMD-FROM           OF  PARM-SUSC0405-ARG2
 15880*----------  実行ステータス
 15881     EVALUATE  WK-1190-STATUS
 15882       WHEN  ZERO
 15883*----------  実行ステータス0(正常終了)
 15884         MOVE  CNS-STS-100
 15885           TO  JIKOU-STS          OF  PARM-SUSC0405-ARG2
 15886       WHEN  CNS-2
 15887*----------  実行ステータス2(警告終了)
 15888         MOVE  CNS-STS-200
 15889           TO  JIKOU-STS          OF  PARM-SUSC0405-ARG2
 15890*----------  実行ステータス4(業務エラー(続行可能))
 15891       WHEN  CNS-4
 15892         MOVE  CNS-STS-270
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 275
* MUSR2651.cob                                                     cpy)cpy)y)y)
 15893           TO  JIKOU-STS          OF  PARM-SUSC0405-ARG2
 15894       WHEN  CNS-6
 15895*----------  実行ステータス6
 15896         MOVE  CNS-STS-275
 15897           TO  JIKOU-STS          OF  PARM-SUSC0405-ARG2
 15898       WHEN  CNS-8
 15899*----------  実行ステータス8 (業務エラー(明細続行不可))
 15900         MOVE  CNS-STS-277
 15901           TO  JIKOU-STS          OF  PARM-SUSC0405-ARG2
 15902       WHEN  CNS-10
 15903*----------  実行ステータス10
 15904         MOVE  CNS-STS-375
 15905           TO  JIKOU-STS          OF  PARM-SUSC0405-ARG2
 15906       WHEN  OTHER
 15907*----------  実行ステータス16(システムエラー)
 15908         MOVE  CNS-STS-400
 15909           TO  JIKOU-STS          OF  PARM-SUSC0405-ARG2
 15910     END-EVALUATE
 15911*-------------------<DEBUG>---------------------------------------
 15912D    DISPLAY  CNS-PGM-ID":WK-1190-STATUS=["     WK-1190-STATUS"]"
 15913D    DISPLAY  CNS-PGM-ID":進捗ステータス=["
 15914D             JIKOU-STS          OF  PARM-SUSC0405-ARG2"]"
 15915D    DISPLAY  CNS-PGM-ID":ARGUEMENT OF SUSC0405"
 15916D    DISPLAY  CNS-PGM-ID":セッション区分=["
 15917D             SESION-KBN          OF  PARM-SUSC0405-ARG1"]"
 15918D    DISPLAY  CNS-PGM-ID":OL/BT区分=["
 15919D             OLBT-KBN            OF  PARM-SUSC0405-ARG1"]"
 15920D    DISPLAY  CNS-PGM-ID":利用会社コード=["
 15921D             RIYO-CMP-CD         OF  PARM-SUSC0405-ARG2"]"
 15922D    DISPLAY  CNS-PGM-ID":処理実行日=["
 15923D             SYORI-YMD           OF  PARM-SUSC0405-ARG2"]"
 15924D    DISPLAY  CNS-PGM-ID":起動ID=["
 15925D             KIDOU-ID            OF  PARM-SUSC0405-ARG2"]"
 15926D    DISPLAY  CNS-PGM-ID":業務タスクID=["
 15927D             GYOMU-TASK-ID       OF  PARM-SUSC0405-ARG2"]"
 15928D    DISPLAY  CNS-PGM-ID":基準年月日/基準年月=["
 15929D             KJN-YMD             OF  PARM-SUSC0405-ARG2"]"
 15930D    DISPLAY  CNS-PGM-ID":最終処理基準日=["
 15931D             SS-SYORI-YMD        OF  PARM-SUSC0405-ARG2"]"
 15932D    DISPLAY  CNS-PGM-ID":ベビー未処理フラグ=["
 15933D             BABY-MISYORI-FLG    OF  PARM-SUSC0405-ARG2"]"
 15934D    DISPLAY  CNS-PGM-ID":ファンドコード=["
 15935D             FUND-CD             OF  PARM-SUSC0405-ARG2"]"
 15936D    DISPLAY  CNS-PGM-ID":ポートフォリオコード=["
 15937D             PTF-CD              OF  PARM-SUSC0405-ARG2"]"
 15938D    DISPLAY  CNS-PGM-ID":評価系列コード=["
 15939D             HYK-KRTU-CD         OF  PARM-SUSC0405-ARG2"]"
 15940D    DISPLAY  CNS-PGM-ID":帳票ID=["
 15941D             REP-ID              OF  PARM-SUSC0405-ARG2"]"
 15942D    DISPLAY  CNS-PGM-ID":帳票任意コード=["
 15943D             REP-ANY-CD          OF  PARM-SUSC0405-ARG2"]"
 15944D    DISPLAY  CNS-PGM-ID":基準日FROM=["
 15945D             KJN-YMD-FROM        OF  PARM-SUSC0405-ARG2"]"
 15946D    DISPLAY  CNS-PGM-ID":進捗ステータス=["
 15947D             JIKOU-STS           OF  PARM-SUSC0405-ARG2"]"
 15948D    DISPLAY  CNS-PGM-ID": ***  CALL SUSC0405  START  ***"
 15949*-----------------------------------------------------------------
 15950     CALL  "SUSC0405"             USING  PARM-SUSC0405-INOUT
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 276
* MUSR2651.cob                                                     cpy)cpy)y)y)
 15951                                         PARM-RTNPKG
 15952*-------------------<DEBUG>---------------------------------------
 15953D    DISPLAY  CNS-PGM-ID": ***  CALL SUSC0405  END  ***"
 15954D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG       =["PARM-RTNPKG"]"
 15955D    DISPLAY  CNS-PGM-ID":RTN-CD(SUSC0405)        =["
 15956D             RTN-CD OF PARM-RTNPKG(COUNTER   OF PARM-RTNPKG) "]"
 15957D    DISPLAY  CNS-PGM-ID":COUNTER  OF  PARM-RTNPKG=["
 15958D             COUNTER              OF PARM-RTNPKG"]"
 15959*-----------------------------------------------------------------
 15960     EVALUATE  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
 15961       WHEN  CNS-RTN-000
 15962         CONTINUE
 15963*--------------------<DEBUG>--------------------------------------
 15964D    DISPLAY  CNS-PGM-ID":*** 進捗管理ＩＮＳＵＰＤ処理2 正常  ***"
 15965*-----------------------------------------------------------------
 15966       WHEN  CNS-RTN-113
 15967*----------
 15968         IF  WK-STATUS < CNS-4
 15969         THEN
 15970           MOVE  CNS-4          TO  WK-STATUS
 15971         ELSE
 15972           CONTINUE
 15973         END-IF
 15974*----------  ワークリターンコード
 15975         IF  WK-RTN-CODE < CNS-4
 15976         THEN
 15977           MOVE  CNS-4          TO  WK-RTN-CODE
 15978         ELSE
 15979           CONTINUE
 15980         END-IF
 15981*----------  ワーク業務エラーパッケージを編集
 15982*-------------------<DEBUG>---------------------------------------
 15983D    DISPLAY  CNS-PGM-ID":WK-J =[" WK-J"]"
 15984*-----------------------------------------------------------------
 15985         COMPUTE  WK-J = WK-J + 1
 15986*-------------------<DEBUG>---------------------------------------
 15987D    DISPLAY  CNS-PGM-ID":WK-J =[" WK-J"]"
 15988*-----------------------------------------------------------------
 15989*---------- ファンドコード
 15990         MOVE  WK-FUND-CD-DETAIL     OF  WK-PTF-ATT-DATA(WK-IDX-J)
 15991           TO  WK-GYOMU-FUND-CD      OF  WK-GYOMU-ERR-INFO(WK-J)
 15992*---------- ポートフォリオコード
 15993         MOVE  WK-PTF-CD-DETAIL      OF  WK-PTF-ATT-DATA(WK-IDX-J)
 15994           TO  WK-GYOMU-PTF-CD       OF  WK-GYOMU-ERR-INFO(WK-J)
 15995*---------- 評価系列コード
 15996         MOVE  WK-DEFAUL-THYK-CD     OF  WK-PTF-ATT-DATA(WK-IDX-J)
 15997           TO  WK-GYOMU-HYK-KRTU-CD  OF  WK-GYOMU-ERR-INFO(WK-J)
 15998*---------- 帳票ID
 15999         MOVE  SPACE
 16000           TO  WK-GYOMU-REP-ID        OF  WK-GYOMU-ERR-INFO(WK-J)
 16001*---------- 帳票任意コード
 16002         MOVE  SPACE
 16003           TO  WK-GYOMU-REP-ANY-CD    OF  WK-GYOMU-ERR-INFO(WK-J)
 16004*---------- 基準日From
 16005         MOVE  WK-KIKAN-FR
 16006           TO  WK-GYOMU-KJN-YMD-FROM  OF  WK-GYOMU-ERR-INFO(WK-J)
 16007*---------- 基準日To
 16008         MOVE  WK-KIKAN-TO
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 277
* MUSR2651.cob                                                     cpy)cpy)y)y)
 16009           TO  WK-GYOMU-KJN-YMD-TO    OF  WK-GYOMU-ERR-INFO(WK-J)
 16010*---------- メッセージID
 16011         MOVE  CNS-MSG-E000217
 16012           TO  WK-GYOMU-MSG-ID        OF  WK-GYOMU-ERR-INFO(WK-J)
 16013*---------- 置換文字
 16014         MOVE  CNS-DATA-TEXT
 16015           TO  WK-GYOMU-TK-MOJI(WK-J,CNS-1)
 16016*---------- フリーメッセージ
 16017         MOVE  WK-TEMP-MSG
 16018           TO  WK-GYOMU-FREE-MSG      OF  WK-GYOMU-ERR-INFO(WK-J)
 16019*----------  後処理業務エラーフラグ
 16020         MOVE  CNS-ON                 TO  FLG-MEISAI-GYOMU-ERR
 16021*-------------------<DEBUG>---------------------------------------
 16022D    DISPLAY  CNS-PGM-ID":FLG-MEISAI-GYOMU-ERR =["
 16023D             FLG-MEISAI-GYOMU-ERR"]"
 16024*-----------------------------------------------------------------
 16025       WHEN  OTHER
 16026*--------------------<DEBUG>--------------------------------------
 16027D    DISPLAY  CNS-PGM-ID":***進捗管理ＩＮＳＵＰＤ処理2 エラー ***"
 16028*-----------------------------------------------------------------
 16029*----------  ワーク実行ステータス
 16030         MOVE  CNS-16               TO  WK-STATUS
 16031*----------  ワークリターンコード
 16032         MOVE  WK-STATUS            TO  WK-RTN-CODE
 16033*----------  ワークエラーパッケージを編集
 16034         PERFORM  SUB-ERR-MSG-RTN
 16035         INITIALIZE  WK-SYS-ERR-INFO
 16036*----------  エラー検知プログラムID
 16037         MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
 16038*----------  ポジション
 16039         MOVE  CNS-POS-021          TO  WK-ERR-POS
 16040*----------  リターンコード
 16041         MOVE  CNS-RTN-901          TO  WK-RTN-CD
 16042*----------  詳細リターンコード
 16043         MOVE  RTN-CD               OF  PARM-RTNPKG
 16044                                        (COUNTER OF PARM-RTNPKG)
 16045                                    TO  WK-DETAIL-RTN-CD
 16046*----------  詳細リターンコードデコードフラグ
 16047         MOVE  CNS-DETAIL-0         TO  WK-DETAIL-RTN-CD-FLG
 16048*---------- フリーメッセージ
 16049         MOVE  SPACE                TO  WK-FREE-MSG
 16050*----------  エラー情報追加処理
 16051         PERFORM  ERR-INFO-ADD-RTN
 16052     END-EVALUATE
 16053*--------------------<DEBUG>--------------------------------------
 16054D    DISPLAY  CNS-PGM-ID":***  進捗管理ＩＮＳＵＰＤ処理2 END  ***"
 16055*-----------------------------------------------------------------
 16056     CONTINUE.
 16057 SUSC0405-OLD-EXT.
 16058     EXIT.
 16059******************************************************************
 16060*    カーソル(CLOSE)
 16061******************************************************************
 16062 CR-CLOSE-RTN           SECTION.
 16063*-------------------<DEBUG>---------------------------------------
 16064D    DISPLAY  CNS-PGM-ID":***  カーソル(CLOSE)  START  ***"
 16065*-----------------------------------------------------------------
 16066*    EXEC  SQL
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 278
* MUSR2651.cob                                                     cpy)cpy)y)y)
 16067*        CLOSE CR
 16068*    END-EXEC
 16069     MOVE 1 TO SQL-ITERS
 16070     MOVE 585 TO SQL-OFFSET
 16071     MOVE 0 TO SQL-OCCURS
 16072     CALL "SQLADR" USING
 16073         SQLCUD
 16074         SQL-CUD
 16075     CALL "SQLADR" USING
 16076         SQLCA
 16077         SQL-SQLEST
 16078     MOVE 256 TO SQL-SQLETY
 16079
 16080     CALL "SQLBEX" USING
 16081         SQLCTX
 16082         SQLEXD
 16083         SQLFPN
 16084*-------------------<DEBUG>---------------------------------------
 16085D    DISPLAY  CNS-PGM-ID":SQLCODE(CURSOR CLOSE)  =["SQLCODE"]"
 16086*-----------------------------------------------------------------
 16087     IF  SQLCODE = CNS-SQL-NORMAL
 16088     THEN
 16089       MOVE  CNS-OFF              TO  FLG-CR-OPEN
 16090*-------------------<DEBUG>---------------------------------------
 16091D    DISPLAY  CNS-PGM-ID":FLG-CR-OPEN           =["FLG-CR-OPEN"]"
 16092*-----------------------------------------------------------------
 16093     ELSE
 16094*----------  ワーク実行ステータス
 16095       MOVE  CNS-16               TO  WK-STATUS
 16096       MOVE  CNS-16               TO  WK-1190-STATUS
 16097*----------  ワークリターンコード
 16098       MOVE  WK-STATUS            TO  WK-RTN-CODE
 16099*----------  ワークエラーパッケージを編集
 16100       INITIALIZE  WK-SYS-ERR-INFO
 16101*----------  エラー検知プログラムID
 16102       MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
 16103*----------  ポジション
 16104       MOVE  CNS-POS-022          TO  WK-ERR-POS
 16105*----------  リターンコード
 16106       MOVE  CNS-RTN-900          TO  WK-RTN-CD
 16107*----------  詳細リターンコード
 16108       MOVE  SQLCODE              TO  WK-DETAIL-RTN-CD
 16109*----------  詳細リターンコードデコードフラグ
 16110       MOVE  CNS-DETAIL-1         TO  WK-DETAIL-RTN-CD-FLG
 16111*---------- フリーメッセージ
 16112       MOVE  WK-SELECT-FREE-MSG   TO  WK-FREE-MSG
 16113*----------  エラー情報追加処理
 16114       PERFORM  ERR-INFO-ADD-RTN
 16115     END-IF
 16116*-------------------<DEBUG>---------------------------------------
 16117D    DISPLAY  CNS-PGM-ID":***  カーソル(CLOSE)  END  ***"
 16118*-----------------------------------------------------------------
 16119     CONTINUE.
 16120 CR-CLOSE-EXT.
 16121     EXIT.
 16122******************************************************************
 16123*    カーソル(CLOSE)
 16124******************************************************************
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 279
* MUSR2651.cob                                                     cpy)cpy)y)y)
 16125 CR-CLOSE-2-RTN         SECTION.
 16126*-------------------<DEBUG>---------------------------------------
 16127D    DISPLAY  CNS-PGM-ID":***  カーソル(CLOSE)  START  ***"
 16128*-----------------------------------------------------------------
 16129*    EXEC  SQL
 16130*        CLOSE CR
 16131*    END-EXEC
 16132     MOVE 1 TO SQL-ITERS
 16133     MOVE 600 TO SQL-OFFSET
 16134     MOVE 0 TO SQL-OCCURS
 16135     CALL "SQLADR" USING
 16136         SQLCUD
 16137         SQL-CUD
 16138     CALL "SQLADR" USING
 16139         SQLCA
 16140         SQL-SQLEST
 16141     MOVE 256 TO SQL-SQLETY
 16142
 16143     CALL "SQLBEX" USING
 16144         SQLCTX
 16145         SQLEXD
 16146         SQLFPN
 16147*-------------------<DEBUG>---------------------------------------
 16148D    DISPLAY  CNS-PGM-ID":SQLCODE(CURSOR CLOSE)  =["SQLCODE"]"
 16149*-----------------------------------------------------------------
 16150     IF  SQLCODE = CNS-SQL-NORMAL
 16151     THEN
 16152       MOVE  CNS-OFF              TO  FLG-CR-OPEN
 16153*-------------------<DEBUG>---------------------------------------
 16154D    DISPLAY  CNS-PGM-ID":FLG-CR-OPEN           =["FLG-CR-OPEN"]"
 16155*-----------------------------------------------------------------
 16156     ELSE
 16157*----------  ワークリターンコード
 16158       MOVE  CNS-16               TO  WK-RTN-CODE
 16159*----------  ワークエラーパッケージを編集
 16160       INITIALIZE  WK-SYS-ERR-INFO
 16161*----------  エラー検知プログラムID
 16162       MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
 16163*----------  ポジション
 16164       MOVE  CNS-POS-088          TO  WK-ERR-POS
 16165*----------  リターンコード
 16166       MOVE  CNS-RTN-900          TO  WK-RTN-CD
 16167*----------  詳細リターンコード
 16168       MOVE  SQLCODE              TO  WK-DETAIL-RTN-CD
 16169*----------  詳細リターンコードデコードフラグ
 16170       MOVE  CNS-DETAIL-1         TO  WK-DETAIL-RTN-CD-FLG
 16171*---------- フリーメッセージ
 16172       MOVE  WK-SELECT-FREE-MSG   TO  WK-FREE-MSG
 16173*----------  エラー処理
 16174       PERFORM  ERR-RTN
 16175     END-IF
 16176*-------------------<DEBUG>---------------------------------------
 16177D    DISPLAY  CNS-PGM-ID":***  カーソル(CLOSE)  END  ***"
 16178*-----------------------------------------------------------------
 16179     CONTINUE.
 16180 CR-CLOSE-2-EXT.
 16181     EXIT.
 16182******************************************************************
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 280
* MUSR2651.cob                                                     cpy)cpy)y)y)
 16183*    SQL作成（PREPARE）
 16184******************************************************************
 16185 CR-PREPARE-2-RTN       SECTION.
 16186*-------------------<DEBUG>---------------------------------------
 16187D    DISPLAY  CNS-PGM-ID":***  SQL作成(PREPARE2)  START  ***"
 16188*-----------------------------------------------------------------
 16189     INITIALIZE  SQLSTMT-S2
 16190                 HST-SELECT-WHERE
 16191                 WK-SELECT-FREE-MSG2
 16192*----------  テーブルTKUSZT01
 16193     MOVE  WK-TBL-TKUSZT01
 16194       TO  SQL-TBL-TKUSZT01       OF  SQL-SELECT-2
 16195*----------  利用会社コード
 16196     MOVE  WK-RIYO-CMP-CD
 16197       TO  H-RIYO-CMP-CD          OF  HST-SELECT-WHERE
 16198*----------  ファンドコード
 16199     MOVE  WK-FUND-CD-DETAIL      OF  WK-FUND-PTF-DETAIL(WK-IDX-J)
 16200       TO  H-FUND-CD              OF  HST-SELECT-WHERE
 16201*----------  ポートフォリオコード
 16202     MOVE  WK-PTF-CD-DETAIL       OF  WK-FUND-PTF-DETAIL(WK-IDX-J)
 16203       TO  H-PTF-CD               OF  HST-SELECT-WHERE
 16204*----------  テーマ2693対応
 16205*----------  期間FROM
 16206     MOVE  WK-KZYN-YMD-FROM       OF  WK-FUND-PTF-DETAIL(WK-IDX-J)
 16207       TO  H-KIKAN-FR             OF  HST-SELECT-WHERE
 16208*----------  期間TO
 16209     MOVE  WK-KZYN-YMD-TO         OF  WK-FUND-PTF-DETAIL(WK-IDX-J)
 16210       TO  H-KIKAN-TO             OF  HST-SELECT-WHERE
 16211*----------  テーマ2693対応
 16212*----------  評価系列コード
 16213     MOVE  WK-DEFAUL-THYK-CD      OF  WK-FUND-PTF-DETAIL(WK-IDX-J)
 16214       TO  H-HYK-KRTU-CD          OF  HST-SELECT-WHERE
 16215     STRING  SQL-SELECT-2
 16216             DELIMITED BY SIZE
 16217             INTO SQLSTMT-S2
 16218     END-STRING
 16219     STRING SQLSTMT-S2(1:FUNCTION  LENGTH(SQL-SELECT-2))
 16220          "[:V1="
 16221           H-RIYO-CMP-CD        OF  HST-SELECT-WHERE
 16222          "][:V2="
 16223           H-FUND-CD            OF  HST-SELECT-WHERE
 16224          "][:V3="
 16225           H-PTF-CD             OF  HST-SELECT-WHERE
 16226          "][:V4="
 16227           H-KIKAN-FR           OF  HST-SELECT-WHERE
 16228          "][:V5="
 16229           H-KIKAN-TO           OF  HST-SELECT-WHERE
 16230          "][:V6="
 16231           H-HYK-KRTU-CD        OF  HST-SELECT-WHERE
 16232          "]"
 16233          DELIMITED BY SIZE
 16234          INTO  WK-SELECT-FREE-MSG2
 16235     END-STRING
 16236*-------------------<DEBUG>---------------------------------------
 16237D    DISPLAY  CNS-PGM-ID "テーブルTKUSZT01 =["
 16238D             SQL-TBL-TKUSZT01       OF  SQL-SELECT-2"]"
 16239D    DISPLAY  CNS-PGM-ID ":利用会社コードH-RIYO-CMP-CD =["
 16240D                 H-RIYO-CMP-CD      OF  HST-SELECT-WHERE "]"
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 281
* MUSR2651.cob                                                     cpy)cpy)y)y)
 16241D    DISPLAY  CNS-PGM-ID ":ファンドコードH-FUND-CD     =["
 16242D                 H-FUND-CD          OF  HST-SELECT-WHERE "]"
 16243D    DISPLAY  CNS-PGM-ID ":ポートフォリオコードH-PTF-CD      =["
 16244D                 H-PTF-CD           OF  HST-SELECT-WHERE "]"
 16245D    DISPLAY  CNS-PGM-ID ":残高日付FR H-KIKAN-FR      =["
 16246D                 H-KIKAN-FR         OF  HST-SELECT-WHERE "]"
 16247D    DISPLAY  CNS-PGM-ID ":残高日付TO H-KIKAN-TO      =["
 16248D                 H-KIKAN-TO         OF  HST-SELECT-WHERE "]"
 16249D    DISPLAY  CNS-PGM-ID ":評価系列コードH-HYK-KRTU-CD      =["
 16250D                 H-HYK-KRTU-CD      OF  HST-SELECT-WHERE "]"
 16251D    DISPLAY  CNS-PGM-ID":SQLSTMT-S2      =["SQLSTMT-S2"]"
 16252D    DISPLAY  CNS-PGM-ID":WK-SELECT-FREE-MSG2 =["
 16253D             WK-SELECT-FREE-MSG2"]"
 16254*-----------------------------------------------------------------
 16255*    EXEC  SQL
 16256*      PREPARE  SS2  FROM  :SQLSTMT-S2
 16257*    END-EXEC
 16258     MOVE 1 TO SQL-ITERS
 16259     MOVE 615 TO SQL-OFFSET
 16260     MOVE 0 TO SQL-OCCURS
 16261     CALL "SQLADR" USING
 16262         SQLCUD
 16263         SQL-CUD
 16264     CALL "SQLADR" USING
 16265         SQLCA
 16266         SQL-SQLEST
 16267     MOVE 256 TO SQL-SQLETY
 16268     CALL "SQLADR" USING
 16269         SQLSTMT-S2 IN
 16270         HST-AREA
 16271         SQL-SQHSTV(1)
 16272     MOVE 3000 TO SQL-SQHSTL(1)
 16273     MOVE 0 TO SQL-SQHSTS(1)
 16274     MOVE 0 TO SQL-SQINDV(1)
 16275     MOVE 0 TO SQL-SQINDS(1)
 16276     MOVE 0 TO SQL-SQHARM(1)
 16277     CALL "SQLADR" USING
 16278         SQL-SQHSTV(1)
 16279         SQL-SQPHSV
 16280     CALL "SQLADR" USING
 16281         SQL-SQHSTL(1)
 16282         SQL-SQPHSL
 16283     CALL "SQLADR" USING
 16284         SQL-SQHSTS(1)
 16285         SQL-SQPHSS
 16286     CALL "SQLADR" USING
 16287         SQL-SQINDV(1)
 16288         SQL-SQPIND
 16289     CALL "SQLADR" USING
 16290         SQL-SQINDS(1)
 16291         SQL-SQPINS
 16292     CALL "SQLADR" USING
 16293         SQL-SQHARM(1)
 16294         SQL-SQPARM
 16295     CALL "SQLADR" USING
 16296         SQL-SQHARC(1)
 16297         SQL-SQPARC
 16298
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 282
* MUSR2651.cob                                                     cpy)cpy)y)y)
 16299     CALL "SQLBEX" USING
 16300         SQLCTX
 16301         SQLEXD
 16302         SQLFPN
 16303*-------------------<DEBUG>---------------------------------------
 16304D    DISPLAY  CNS-PGM-ID":SQLCODE(PREPARE2)       =["SQLCODE"]"
 16305*-----------------------------------------------------------------
 16306     EVALUATE  SQLCODE
 16307       WHEN  CNS-SQL-NORMAL
 16308         CONTINUE
 16309       WHEN   OTHER
 16310*----------  ワーク実行ステータス
 16311         MOVE  CNS-16             TO  WK-STATUS
 16312*----------  ワークリターンコード
 16313         MOVE  WK-STATUS          TO  WK-RTN-CODE
 16314*----------  ワークエラーパッケージを編集
 16315         INITIALIZE  WK-SYS-ERR-INFO
 16316*----------  エラー検知プログラムID
 16317         MOVE  CNS-PGM-ID         TO  WK-ERR-PGM-ID
 16318*----------  ポジション
 16319         MOVE  CNS-POS-068        TO  WK-ERR-POS
 16320*----------  リターンコード
 16321         MOVE  CNS-RTN-900        TO  WK-RTN-CD
 16322*----------  詳細リターンコード
 16323         MOVE  SQLCODE            TO  WK-DETAIL-RTN-CD
 16324*----------  詳細リターンコードデコードフラグ
 16325         MOVE  CNS-DETAIL-1       TO  WK-DETAIL-RTN-CD-FLG
 16326*---------- フリーメッセージ
 16327         MOVE  WK-SELECT-FREE-MSG2
 16328           TO  WK-FREE-MSG
 16329*----------  エラー情報追加処理
 16330         PERFORM  ERR-INFO-ADD-RTN
 16331     END-EVALUATE
 16332*-------------------<DEBUG>---------------------------------------
 16333D    DISPLAY  CNS-PGM-ID":***  SQL作成(PREPARE2)  END  ***"
 16334*-----------------------------------------------------------------
 16335     CONTINUE.
 16336 CR-PREPARE-2-EXT.
 16337     EXIT.
 16338******************************************************************
 16339*    カーソル作成（DECLARE，OPEN）
 16340******************************************************************
 16341 CR-OPEN-2-RTN          SECTION.
 16342*-------------------<DEBUG>---------------------------------------
 16343D    DISPLAY  CNS-PGM-ID
 16344D             ":***  カーソル作成(DECLARE，OPEN2)  START  ***"
 16345*-----------------------------------------------------------------
 16346*----------DECLARE CURSOR
 16347*    EXEC  SQL
 16348*      DECLARE  CR2  CURSOR  FOR  SS2
 16349*    END-EXEC
 16350*-------------------<DEBUG>---------------------------------------
 16351D    DISPLAY  CNS-PGM-ID":SQLCODE(CURSOR2 DECLARE)=["SQLCODE"]"
 16352*-----------------------------------------------------------------
 16353*----------OPEN    CURSOR
 16354*    EXEC  SQL
 16355*      OPEN  CR2
 16356*    USING  :HST-SELECT-WHERE.H-RIYO-CMP-CD,
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 283
* MUSR2651.cob                                                     cpy)cpy)y)y)
 16357*           :HST-SELECT-WHERE.H-FUND-CD,
 16358*           :HST-SELECT-WHERE.H-PTF-CD,
 16359*           :HST-SELECT-WHERE.H-KIKAN-FR,
 16360*           :HST-SELECT-WHERE.H-KIKAN-TO,
 16361*           :HST-SELECT-WHERE.H-HYK-KRTU-CD
 16362*    END-EXEC
 16363     MOVE 1 TO SQL-ITERS
 16364     MOVE 634 TO SQL-OFFSET
 16365     MOVE 0 TO SQL-OCCURS
 16366     MOVE 1 TO SQL-SELERR
 16367     CALL "SQLADR" USING
 16368         SQLCUD
 16369         SQL-CUD
 16370     CALL "SQLADR" USING
 16371         SQLCA
 16372         SQL-SQLEST
 16373     MOVE 256 TO SQL-SQLETY
 16374     CALL "SQLADR" USING
 16375         H-RIYO-CMP-CD IN
 16376         HST-SELECT-WHERE IN
 16377         HST-AREA
 16378         SQL-SQHSTV(1)
 16379     MOVE 4 TO SQL-SQHSTL(1)
 16380     MOVE 0 TO SQL-SQHSTS(1)
 16381     MOVE 0 TO SQL-SQINDV(1)
 16382     MOVE 0 TO SQL-SQINDS(1)
 16383     MOVE 0 TO SQL-SQHARM(1)
 16384     CALL "SQLADR" USING
 16385         H-FUND-CD IN
 16386         HST-SELECT-WHERE IN
 16387         HST-AREA
 16388         SQL-SQHSTV(2)
 16389     MOVE 12 TO SQL-SQHSTL(2)
 16390     MOVE 0 TO SQL-SQHSTS(2)
 16391     MOVE 0 TO SQL-SQINDV(2)
 16392     MOVE 0 TO SQL-SQINDS(2)
 16393     MOVE 0 TO SQL-SQHARM(2)
 16394     CALL "SQLADR" USING
 16395         H-PTF-CD IN
 16396         HST-SELECT-WHERE IN
 16397         HST-AREA
 16398         SQL-SQHSTV(3)
 16399     MOVE 4 TO SQL-SQHSTL(3)
 16400     MOVE 0 TO SQL-SQHSTS(3)
 16401     MOVE 0 TO SQL-SQINDV(3)
 16402     MOVE 0 TO SQL-SQINDS(3)
 16403     MOVE 0 TO SQL-SQHARM(3)
 16404     CALL "SQLADR" USING
 16405         H-KIKAN-FR IN
 16406         HST-SELECT-WHERE IN
 16407         HST-AREA
 16408         SQL-SQHSTV(4)
 16409     MOVE 8 TO SQL-SQHSTL(4)
 16410     MOVE 0 TO SQL-SQHSTS(4)
 16411     MOVE 0 TO SQL-SQINDV(4)
 16412     MOVE 0 TO SQL-SQINDS(4)
 16413     MOVE 0 TO SQL-SQHARM(4)
 16414     CALL "SQLADR" USING
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 284
* MUSR2651.cob                                                     cpy)cpy)y)y)
 16415         H-KIKAN-TO IN
 16416         HST-SELECT-WHERE IN
 16417         HST-AREA
 16418         SQL-SQHSTV(5)
 16419     MOVE 8 TO SQL-SQHSTL(5)
 16420     MOVE 0 TO SQL-SQHSTS(5)
 16421     MOVE 0 TO SQL-SQINDV(5)
 16422     MOVE 0 TO SQL-SQINDS(5)
 16423     MOVE 0 TO SQL-SQHARM(5)
 16424     CALL "SQLADR" USING
 16425         H-HYK-KRTU-CD IN
 16426         HST-SELECT-WHERE IN
 16427         HST-AREA
 16428         SQL-SQHSTV(6)
 16429     MOVE 4 TO SQL-SQHSTL(6)
 16430     MOVE 0 TO SQL-SQHSTS(6)
 16431     MOVE 0 TO SQL-SQINDV(6)
 16432     MOVE 0 TO SQL-SQINDS(6)
 16433     MOVE 0 TO SQL-SQHARM(6)
 16434     CALL "SQLADR" USING
 16435         SQL-SQHSTV(1)
 16436         SQL-SQPHSV
 16437     CALL "SQLADR" USING
 16438         SQL-SQHSTL(1)
 16439         SQL-SQPHSL
 16440     CALL "SQLADR" USING
 16441         SQL-SQHSTS(1)
 16442         SQL-SQPHSS
 16443     CALL "SQLADR" USING
 16444         SQL-SQINDV(1)
 16445         SQL-SQPIND
 16446     CALL "SQLADR" USING
 16447         SQL-SQINDS(1)
 16448         SQL-SQPINS
 16449     CALL "SQLADR" USING
 16450         SQL-SQHARM(1)
 16451         SQL-SQPARM
 16452     CALL "SQLADR" USING
 16453         SQL-SQHARC(1)
 16454         SQL-SQPARC
 16455
 16456     CALL "SQLBEX" USING
 16457         SQLCTX
 16458         SQLEXD
 16459         SQLFPN
 16460*-------------------<DEBUG>---------------------------------------
 16461D    DISPLAY  CNS-PGM-ID":SQLCODE(CURSOR2 OPEN)   =["SQLCODE"]"
 16462*-----------------------------------------------------------------
 16463     EVALUATE  SQLCODE
 16464       WHEN  CNS-SQL-NORMAL
 16465         MOVE  CNS-ON               TO  FLG-CR-OPEN2
 16466*-------------------<DEBUG>---------------------------------------
 16467D    DISPLAY  CNS-PGM-ID":FLG-CR-OPEN2 =["FLG-CR-OPEN2"]"
 16468D    DISPLAY  CNS-PGM-ID":FLG-STOP-2 =["FLG-STOP-2"]"
 16469*-----------------------------------------------------------------
 16470       WHEN   OTHER
 16471*----------  ワーク実行ステータス
 16472         MOVE  CNS-16               TO  WK-STATUS
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 285
* MUSR2651.cob                                                     cpy)cpy)y)y)
 16473*----------  ワークリターンコード
 16474         MOVE  WK-STATUS            TO  WK-RTN-CODE
 16475*----------  ワークエラーパッケージを編集
 16476         INITIALIZE  WK-SYS-ERR-INFO
 16477*----------  エラー検知プログラムID
 16478         MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
 16479*----------  ポジション
 16480         MOVE  CNS-POS-069          TO  WK-ERR-POS
 16481*----------  リターンコード
 16482         MOVE  CNS-RTN-900          TO  WK-RTN-CD
 16483*----------  詳細リターンコード
 16484         MOVE  SQLCODE              TO  WK-DETAIL-RTN-CD
 16485*----------  詳細リターンコードデコードフラグ
 16486         MOVE  CNS-DETAIL-1         TO  WK-DETAIL-RTN-CD-FLG
 16487*---------- フリーメッセージ
 16488         MOVE  WK-SELECT-FREE-MSG2  TO  WK-FREE-MSG
 16489*----------  エラー情報追加処理
 16490         PERFORM  ERR-INFO-ADD-RTN
 16491     END-EVALUATE
 16492*-------------------<DEBUG>---------------------------------------
 16493D    DISPLAY  CNS-PGM-ID
 16494D             ":***  カーソル作成(DECLARE，OPEN2)  END  ***"
 16495*-----------------------------------------------------------------
 16496     CONTINUE.
 16497 CR-OPEN-2-EXT.
 16498     EXIT.
 16499******************************************************************
 16500*    ディテール行を編集する
 16501******************************************************************
 16502 DATA-EDIT-RTN          SECTION.
 16503*------------------ <残タスク135の対応 START>---------------------
 16504*--------------------<DEBUG>--------------------------------------
 16505D    DISPLAY  CNS-PGM-ID":証券種別コード=["
 16506D             H-SEC-SBT-CD"]"
 16507D    DISPLAY  CNS-PGM-ID":WK-SEC-SBT-4156=["WK-SEC-SBT-4156"]"
 16508*-----------------------------------------------------------------
 16509*----------  商品属性全項目取得
 16510     IF  H-SEC-SBT-CD NOT = SPACE
 16511     THEN
 16512       IF  WK-SEC-SBT-4156
 16513         NOT =  H-SEC-SBT-CD
 16514       THEN
 16515         PERFORM  SCZY4156-RTN
 16516       ELSE
 16517         IF  WK-RTN-4156 = CNS-RTN-110
 16518         THEN
 16519*----------  ワーク実行ステータス
 16520           IF  WK-STATUS  < CNS-4
 16521           THEN
 16522             MOVE  CNS-4            TO  WK-STATUS
 16523           ELSE
 16524             CONTINUE
 16525           END-IF
 16526*----------  1190実行ステータス
 16527           IF   WK-STATUS > WK-1190-STATUS
 16528           THEN
 16529             MOVE  WK-STATUS        TO  WK-1190-STATUS
 16530           ELSE
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 286
* MUSR2651.cob                                                     cpy)cpy)y)y)
 16531             CONTINUE
 16532           END-IF
 16533*----------  ワークリターンコード
 16534           IF  WK-RTN-CODE < WK-STATUS
 16535           THEN
 16536             MOVE  WK-STATUS        TO  WK-RTN-CODE
 16537           ELSE
 16538             CONTINUE
 16539           END-IF
 16540         ELSE
 16541           CONTINUE
 16542         END-IF
 16543       END-IF
 16544     ELSE
 16545       INITIALIZE  WK-SYOHIN-KBN
 16546                   WK-KANRI-SURYO-TANI
 16547                   WK-SEC-SBT-4156
 16548*------------------ <連結障害841の対応 START>---------------------
 16549*----------  ワーク実行ステータス
 16550       IF  WK-STATUS  < CNS-4
 16551       THEN
 16552         MOVE  CNS-4            TO  WK-STATUS
 16553       ELSE
 16554         CONTINUE
 16555       END-IF
 16556*----------  1190実行ステータス
 16557       IF   WK-STATUS > WK-1190-STATUS
 16558       THEN
 16559         MOVE  WK-STATUS        TO  WK-1190-STATUS
 16560       ELSE
 16561         CONTINUE
 16562       END-IF
 16563*--------------------<DEBSUG>-------------------------------------
 16564D    DISPLAY  CNS-PGM-ID":WK-STATUS=["WK-STATUS"]"
 16565D    DISPLAY  CNS-PGM-ID":WK-RTN-CODE=["WK-RTN-CODE"]"
 16566*-----------------------------------------------------------------
 16567*----------  ワークリターンコード
 16568       IF  WK-RTN-CODE < WK-STATUS
 16569       THEN
 16570         MOVE  WK-STATUS        TO  WK-RTN-CODE
 16571       ELSE
 16572         CONTINUE
 16573       END-IF
 16574*--------------------<DEBSUG>-------------------------------------
 16575D    DISPLAY  CNS-PGM-ID":WK-STATUS=["WK-STATUS"]"
 16576D    DISPLAY  CNS-PGM-ID":WK-RTN-CODE=["WK-RTN-CODE"]"
 16577D    DISPLAY  CNS-PGM-ID":WK-J =[" WK-J"]"
 16578*-----------------------------------------------------------------
 16579       COMPUTE  WK-J = WK-J + 1
 16580*-------------------<DEBUG>---------------------------------------
 16581D    DISPLAY  CNS-PGM-ID":WK-J =[" WK-J"]"
 16582*-----------------------------------------------------------------
 16583*---------- ファンドコード
 16584       MOVE  WK-FUND-CD-DETAIL      OF  WK-PTF-ATT-DATA(WK-IDX-J)
 16585         TO  WK-GYOMU-FUND-CD       OF  WK-GYOMU-ERR-INFO(WK-J)
 16586*---------- ポートフォリオコード
 16587       MOVE  WK-PTF-CD-DETAIL       OF  WK-PTF-ATT-DATA(WK-IDX-J)
 16588         TO  WK-GYOMU-PTF-CD        OF  WK-GYOMU-ERR-INFO(WK-J)
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 287
* MUSR2651.cob                                                     cpy)cpy)y)y)
 16589*---------- 評価系列コード
 16590       MOVE  WK-DEFAUL-THYK-CD      OF  WK-PTF-ATT-DATA(WK-IDX-J)
 16591         TO  WK-GYOMU-HYK-KRTU-CD   OF  WK-GYOMU-ERR-INFO(WK-J)
 16592*---------- メッセージID
 16593       MOVE  CNS-MSG-E000090
 16594         TO  WK-GYOMU-MSG-ID        OF  WK-GYOMU-ERR-INFO(WK-J)
 16595*---------- 基準日From
 16596       MOVE  WK-KIKAN-FR
 16597         TO  WK-GYOMU-KJN-YMD-FROM
 16598                 OF  WK-GYOMU-ERR-INFO(WK-J)
 16599*---------- 基準日To
 16600       MOVE  WK-KIKAN-TO
 16601         TO  WK-GYOMU-KJN-YMD-TO
 16602                 OF  WK-GYOMU-ERR-INFO(WK-J)
 16603*---------- 置換文字
 16604       MOVE  CNS-SEC-SBT-CD
 16605         TO  WK-GYOMU-TK-MOJI(WK-J,CNS-1)
 16606*---------- フリーメッセージ
 16607       MOVE  WK-TEMP-MSG
 16608         TO  WK-GYOMU-FREE-MSG      OF  WK-GYOMU-ERR-INFO(WK-J)
 16609       MOVE  CNS-ON                 TO  FLG-MEISAI-GYOMU-ERR
 16610*------------------ <連結障害841の対応 END>-----------------------
 16611     END-IF
 16612*--------------------<DEBUG>--------------------------------------
 16613D    DISPLAY  CNS-PGM-ID":WK-SYOHIN-KBN=["WK-SYOHIN-KBN"]"
 16614D    DISPLAY  CNS-PGM-ID":取引通貨=["
 16615D             H-TRHK-TUKA                OF  HST-TBL-SELECT"]"
 16616D    DISPLAY  CNS-PGM-ID":為替決済通貨=["
 16617D             H-KWS-TH-TUKA-CD           OF  HST-TBL-SELECT"]"
 16618*-----------------------------------------------------------------
 16619*----------  1)取引通貨と為替決済通貨の編集取得
 16620     IF  WK-SYOHIN-KBN = CNS-SYOHIN-KBN-22
 16621     THEN
 16622       MOVE  H-KWS-TH-TUKA-CD     OF  HST-TBL-SELECT
 16623         TO  WK-TRHK-TUKA
 16624       MOVE  H-TRHK-TUKA          OF  HST-TBL-SELECT
 16625         TO  WK-KWS-TH-TUKA-CD
 16626     ELSE
 16627       MOVE  H-TRHK-TUKA          OF  HST-TBL-SELECT
 16628         TO  WK-TRHK-TUKA
 16629       MOVE  H-KWS-TH-TUKA-CD     OF  HST-TBL-SELECT
 16630         TO  WK-KWS-TH-TUKA-CD
 16631     END-IF
 16632*--------------------<DEBUG>--------------------------------------
 16633D    DISPLAY  CNS-PGM-ID":取引通貨=["WK-TRHK-TUKA"]"
 16634D    DISPLAY  CNS-PGM-ID":為替決済通貨=["WK-KWS-TH-TUKA-CD"]"
 16635*-----------------------------------------------------------------
 16636*------------------ <連結障害841の対応 START>---------------------
 16637     IF  WK-TRHK-TUKA  = SPACE
 16638     THEN
 16639*----------  ワーク実行ステータス
 16640       IF  WK-STATUS  < CNS-4
 16641       THEN
 16642         MOVE  CNS-4            TO  WK-STATUS
 16643       ELSE
 16644         CONTINUE
 16645       END-IF
 16646*----------  1190実行ステータス
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 288
* MUSR2651.cob                                                     cpy)cpy)y)y)
 16647       IF   WK-STATUS > WK-1190-STATUS
 16648       THEN
 16649         MOVE  WK-STATUS        TO  WK-1190-STATUS
 16650       ELSE
 16651         CONTINUE
 16652       END-IF
 16653*--------------------<DEBSUG>-------------------------------------
 16654D    DISPLAY  CNS-PGM-ID":WK-STATUS=["WK-STATUS"]"
 16655D    DISPLAY  CNS-PGM-ID":WK-RTN-CODE=["WK-RTN-CODE"]"
 16656*-----------------------------------------------------------------
 16657*----------  ワークリターンコード
 16658       IF  WK-RTN-CODE < WK-STATUS
 16659       THEN
 16660         MOVE  WK-STATUS        TO  WK-RTN-CODE
 16661       ELSE
 16662         CONTINUE
 16663       END-IF
 16664*--------------------<DEBSUG>-------------------------------------
 16665D    DISPLAY  CNS-PGM-ID":WK-STATUS=["WK-STATUS"]"
 16666D    DISPLAY  CNS-PGM-ID":WK-RTN-CODE=["WK-RTN-CODE"]"
 16667D    DISPLAY  CNS-PGM-ID":WK-J =[" WK-J"]"
 16668*-----------------------------------------------------------------
 16669       COMPUTE  WK-J = WK-J + 1
 16670*-------------------<DEBUG>---------------------------------------
 16671D    DISPLAY  CNS-PGM-ID":WK-J =[" WK-J"]"
 16672*-----------------------------------------------------------------
 16673*---------- ファンドコード
 16674       MOVE  WK-FUND-CD-DETAIL      OF  WK-PTF-ATT-DATA(WK-IDX-J)
 16675         TO  WK-GYOMU-FUND-CD       OF  WK-GYOMU-ERR-INFO(WK-J)
 16676*---------- ポートフォリオコード
 16677       MOVE  WK-PTF-CD-DETAIL       OF  WK-PTF-ATT-DATA(WK-IDX-J)
 16678         TO  WK-GYOMU-PTF-CD        OF  WK-GYOMU-ERR-INFO(WK-J)
 16679*---------- 評価系列コード
 16680       MOVE  WK-DEFAUL-THYK-CD      OF  WK-PTF-ATT-DATA(WK-IDX-J)
 16681         TO  WK-GYOMU-HYK-KRTU-CD   OF  WK-GYOMU-ERR-INFO(WK-J)
 16682*---------- メッセージID
 16683       MOVE  CNS-MSG-E000090
 16684         TO  WK-GYOMU-MSG-ID        OF  WK-GYOMU-ERR-INFO(WK-J)
 16685*---------- 基準日From
 16686       MOVE  WK-KIKAN-FR
 16687         TO  WK-GYOMU-KJN-YMD-FROM
 16688                 OF  WK-GYOMU-ERR-INFO(WK-J)
 16689*---------- 基準日To
 16690       MOVE  WK-KIKAN-TO
 16691         TO  WK-GYOMU-KJN-YMD-TO
 16692                 OF  WK-GYOMU-ERR-INFO(WK-J)
 16693*---------- 置換文字
 16694       MOVE  CNS-TRHK-TUKA
 16695         TO  WK-GYOMU-TK-MOJI(WK-J,CNS-1)
 16696*---------- フリーメッセージ
 16697       MOVE  WK-TEMP-MSG
 16698         TO  WK-GYOMU-FREE-MSG      OF  WK-GYOMU-ERR-INFO(WK-J)
 16699       MOVE  CNS-ON                 TO  FLG-MEISAI-GYOMU-ERR
 16700     ELSE
 16701       CONTINUE
 16702     END-IF
 16703*------------------ <連結障害841の対応 END>-----------------------
 16704*------------------ <残タスク135の対応 END>-----------------------
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 289
* MUSR2651.cob                                                     cpy)cpy)y)y)
 16705*--------------------<DEBUG>--------------------------------------
 16706D    DISPLAY  CNS-PGM-ID":WK-STATUS=["
 16707D             WK-STATUS"]"
 16708*-----------------------------------------------------------------
 16709*----------  2)外部銘柄コード変換ルーチンをコール
 16710     IF  WK-STATUS < CNS-16
 16711     THEN
 16712*------------------ <連結障害841の対応 START>---------------------
 16713*--------------------<DEBSUG>-------------------------------------
 16714D    DISPLAY  CNS-PGM-ID":H-MEG-CD=["
 16715D             H-MEG-CD            OF  HST-TBL-SELECT"]"
 16716*-----------------------------------------------------------------
 16717       IF  H-MEG-CD               OF  HST-TBL-SELECT
 16718         NOT = SPACE
 16719       THEN
 16720         IF  WK-MEG-CD-3002 NOT = H-MEG-CD  OF  HST-TBL-SELECT
 16721          OR  WK-SEC-SBT-3002 NOT = H-SEC-SBT-CD
 16722         THEN
 16723           PERFORM  SCZY3002-CHAN-RTN
 16724         ELSE
 16725           EVALUATE  WK-RTN-3002
 16726             WHEN  CNS-RTN-002
 16727             WHEN  CNS-RTN-110
 16728               EVALUATE  WK-RTN-3002-2
 16729                 WHEN  CNS-RTN-000
 16730                 WHEN  CNS-RTN-002
 16731                 WHEN  CNS-RTN-110
 16732                 WHEN  CNS-RTN-800
 16733*----------  ワーク実行ステータス
 16734                   IF  WK-STATUS  < CNS-4
 16735                   THEN
 16736                     MOVE  CNS-4            TO  WK-STATUS
 16737                   ELSE
 16738                     CONTINUE
 16739                   END-IF
 16740*----------  1190実行ステータス
 16741                   IF   WK-STATUS > WK-1190-STATUS
 16742                   THEN
 16743                     MOVE  WK-STATUS        TO  WK-1190-STATUS
 16744                   ELSE
 16745                     CONTINUE
 16746                   END-IF
 16747*----------  ワークリターンコード
 16748                   IF  WK-RTN-CODE < WK-STATUS
 16749                   THEN
 16750                     MOVE  WK-STATUS        TO  WK-RTN-CODE
 16751                   ELSE
 16752                     CONTINUE
 16753                   END-IF
 16754                 WHEN  OTHER
 16755                   CONTINUE
 16756               END-EVALUATE
 16757             WHEN  CNS-RTN-800
 16758*----------  ワーク実行ステータス
 16759               IF  WK-STATUS  < CNS-4
 16760               THEN
 16761                 MOVE  CNS-4            TO  WK-STATUS
 16762               ELSE
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 290
* MUSR2651.cob                                                     cpy)cpy)y)y)
 16763                 CONTINUE
 16764               END-IF
 16765*----------  1190実行ステータス
 16766               IF   WK-STATUS > WK-1190-STATUS
 16767               THEN
 16768                 MOVE  WK-STATUS        TO  WK-1190-STATUS
 16769               ELSE
 16770                 CONTINUE
 16771               END-IF
 16772*----------  ワークリターンコード
 16773               IF  WK-RTN-CODE < WK-STATUS
 16774               THEN
 16775                 MOVE  WK-STATUS        TO  WK-RTN-CODE
 16776               ELSE
 16777                 CONTINUE
 16778               END-IF
 16779             WHEN  OTHER
 16780               CONTINUE
 16781           END-EVALUATE
 16782         END-IF
 16783       ELSE
 16784         INITIALIZE  WK-GAIBU-MEG-CD
 16785                     WK-CD-REF-KRTU-CD
 16786                     WK-JS-CD-FLG
 16787                     WK-SEC-SBT-CD
 16788                     WK-HAKO-CD
 16789                     WK-TS-TARGET-KUNI
 16790                     WK-MEG-CD-3002
 16791                     WK-SEC-SBT-3002
 16792*----------  ワーク実行ステータス
 16793         IF  WK-STATUS  < CNS-4
 16794         THEN
 16795           MOVE  CNS-4            TO  WK-STATUS
 16796         ELSE
 16797           CONTINUE
 16798         END-IF
 16799*----------  1190実行ステータス
 16800         IF   WK-STATUS > WK-1190-STATUS
 16801         THEN
 16802           MOVE  WK-STATUS        TO  WK-1190-STATUS
 16803         ELSE
 16804           CONTINUE
 16805         END-IF
 16806*--------------------<DEBSUG>-------------------------------------
 16807D    DISPLAY  CNS-PGM-ID":WK-STATUS=["WK-STATUS"]"
 16808D    DISPLAY  CNS-PGM-ID":WK-RTN-CODE=["WK-RTN-CODE"]"
 16809*-----------------------------------------------------------------
 16810*----------  ワークリターンコード
 16811         IF  WK-RTN-CODE < WK-STATUS
 16812         THEN
 16813           MOVE  WK-STATUS        TO  WK-RTN-CODE
 16814         ELSE
 16815           CONTINUE
 16816         END-IF
 16817*--------------------<DEBSUG>-------------------------------------
 16818D    DISPLAY  CNS-PGM-ID":WK-STATUS=["WK-STATUS"]"
 16819D    DISPLAY  CNS-PGM-ID":WK-RTN-CODE=["WK-RTN-CODE"]"
 16820D    DISPLAY  CNS-PGM-ID":WK-J =[" WK-J"]"
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 291
* MUSR2651.cob                                                     cpy)cpy)y)y)
 16821*-----------------------------------------------------------------
 16822         COMPUTE  WK-J = WK-J + 1
 16823*-------------------<DEBUG>---------------------------------------
 16824D    DISPLAY  CNS-PGM-ID":WK-J =[" WK-J"]"
 16825*-----------------------------------------------------------------
 16826*---------- ファンドコード
 16827         MOVE  WK-FUND-CD-DETAIL     OF  WK-PTF-ATT-DATA(WK-IDX-J)
 16828           TO  WK-GYOMU-FUND-CD      OF  WK-GYOMU-ERR-INFO(WK-J)
 16829*---------- ポートフォリオコード
 16830         MOVE  WK-PTF-CD-DETAIL      OF  WK-PTF-ATT-DATA(WK-IDX-J)
 16831           TO  WK-GYOMU-PTF-CD       OF  WK-GYOMU-ERR-INFO(WK-J)
 16832*---------- 評価系列コード
 16833         MOVE  WK-DEFAUL-THYK-CD     OF  WK-PTF-ATT-DATA(WK-IDX-J)
 16834           TO  WK-GYOMU-HYK-KRTU-CD  OF  WK-GYOMU-ERR-INFO(WK-J)
 16835*---------- メッセージID
 16836         MOVE  CNS-MSG-E000090
 16837           TO  WK-GYOMU-MSG-ID       OF  WK-GYOMU-ERR-INFO(WK-J)
 16838*---------- 基準日From
 16839         MOVE  WK-KIKAN-FR
 16840           TO  WK-GYOMU-KJN-YMD-FROM
 16841                   OF  WK-GYOMU-ERR-INFO(WK-J)
 16842*---------- 基準日To
 16843         MOVE  WK-KIKAN-TO
 16844           TO  WK-GYOMU-KJN-YMD-TO
 16845                   OF  WK-GYOMU-ERR-INFO(WK-J)
 16846*---------- 置換文字
 16847         MOVE  CNS-MEG-CD
 16848           TO  WK-GYOMU-TK-MOJI(WK-J,CNS-1)
 16849*---------- フリーメッセージ
 16850         MOVE  WK-TEMP-MSG
 16851           TO  WK-GYOMU-FREE-MSG      OF  WK-GYOMU-ERR-INFO(WK-J)
 16852         MOVE  CNS-ON                 TO  FLG-MEISAI-GYOMU-ERR
 16853       END-IF
 16854*------------------ <連結障害841の対応 END>-----------------------
 16855     ELSE
 16856       CONTINUE
 16857     END-IF
 16858*--------------------<DEBSUG>-------------------------------------
 16859D    DISPLAY  CNS-PGM-ID":外部銘柄コード=["WK-GAIBU-MEG-CD"]"
 16860*-----------------------------------------------------------------
 16861*
 16862     IF  WK-STATUS < CNS-16
 16863     THEN
 16864       IF  I-CD-REF-KRTU-CD OF WK-DENBUN-INFO NOT = CNS-D001
 16865         AND H-MEG-CD NOT = SPACE
 16866         AND WK-GAIBU-MEG-CD  NOT =  SPACE
 16867       THEN
 16868         IF  WK-MEG-CD-3002-3 NOT = H-MEG-CD  OF  HST-TBL-SELECT
 16869          OR  WK-SEC-SBT-3002-3 NOT = H-SEC-SBT-CD
 16870         THEN
 16871           PERFORM  SCZY3002-CHAN-2-RTN
 16872         ELSE
 16873           IF  WK-RTN-3002-3 = CNS-RTN-800
 16874           THEN
 16875*----------  ワーク実行ステータス
 16876             IF  WK-STATUS  < CNS-4
 16877             THEN
 16878               MOVE  CNS-4            TO  WK-STATUS
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 292
* MUSR2651.cob                                                     cpy)cpy)y)y)
 16879             ELSE
 16880               CONTINUE
 16881             END-IF
 16882*----------  1190実行ステータス
 16883             IF   WK-STATUS > WK-1190-STATUS
 16884             THEN
 16885               MOVE  WK-STATUS        TO  WK-1190-STATUS
 16886             ELSE
 16887               CONTINUE
 16888             END-IF
 16889*----------  ワークリターンコード
 16890             IF  WK-RTN-CODE < WK-STATUS
 16891             THEN
 16892               MOVE  WK-STATUS        TO  WK-RTN-CODE
 16893             ELSE
 16894               CONTINUE
 16895             END-IF
 16896           ELSE
 16897             CONTINUE
 16898           END-IF
 16899         END-IF
 16900       ELSE
 16901         INITIALIZE  WK-MEG-CD-3002-3
 16902                     WK-SEC-SBT-3002-3
 16903*--------------------<DEBSUG>-------------------------------------
 16904D    DISPLAY  CNS-PGM-ID":I-CD-REF-KRTU-CD=["
 16905D             I-CD-REF-KRTU-CD  OF  WK-DENBUN-INFO"]"
 16906D    DISPLAY  CNS-PGM-ID":H-MEG-CD=["H-MEG-CD"]"
 16907D    DISPLAY  CNS-PGM-ID":WK-GAIBU-MEG-CD=["WK-GAIBU-MEG-CD"]"
 16908*-----------------------------------------------------------------
 16909         IF  I-CD-REF-KRTU-CD  OF  WK-DENBUN-INFO  =  CNS-D001
 16910         THEN
 16911           MOVE  CNS-1        TO  FLG-DEFAULT-KRTU-CD
 16912*--------------------<DEBSUG>-------------------------------------
 16913D    DISPLAY  CNS-PGM-ID":FLG-DEFAULT-KRTU-CD=["
 16914D             FLG-DEFAULT-KRTU-CD"]"
 16915*-----------------------------------------------------------------
 16916         ELSE
 16917           IF  H-MEG-CD  = SPACE
 16918             OR  WK-GAIBU-MEG-CD  =  SPACE
 16919           THEN
 16920             MOVE  ZERO         TO  FLG-DEFAULT-KRTU-CD
 16921           ELSE
 16922             MOVE  CNS-1        TO  FLG-DEFAULT-KRTU-CD
 16923           END-IF
 16924*--------------------<DEBSUG>-------------------------------------
 16925D    DISPLAY  CNS-PGM-ID":FLG-DEFAULT-KRTU-CD=["
 16926D             FLG-DEFAULT-KRTU-CD"]"
 16927*-----------------------------------------------------------------
 16928         END-IF
 16929       END-IF
 16930     ELSE
 16931       CONTINUE
 16932     END-IF
 16933     IF  WK-STATUS < CNS-16
 16934     THEN
 16935*--------------------<DEBSUG>-------------------------------------
 16936D    DISPLAY  CNS-PGM-ID":外部銘柄コード=["WK-GAIBU-MEG-CD"]"
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 293
* MUSR2651.cob                                                     cpy)cpy)y)y)
 16937*-----------------------------------------------------------------
 16938       IF  WK-GAIBU-MEG-CD  =  SPACE
 16939       THEN
 16940         INITIALIZE  WK-MEG-CD-3002
 16941                     WK-SEC-SBT-3002
 16942*---------- 外部銘柄コード
 16943         MOVE  H-MEG-CD                 OF  HST-TBL-SELECT
 16944           TO  WK-GAIBU-MEG-CD
 16945*---------- 証券種別コード
 16946         MOVE  H-SEC-SBT-CD
 16947           TO  WK-SEC-SBT-CD
 16948*---------- 発行体国コード
 16949         MOVE  H-HAKO-CD                OF  HST-TBL-SELECT
 16950           TO  WK-HAKO-CD
 16951*---------- 投資対象国コード
 16952         MOVE  H-TS-TARGET-KUNI         OF  HST-TBL-SELECT
 16953           TO  WK-TS-TARGET-KUNI
 16954*--------------------<DEBSUG>-------------------------------------
 16955D    DISPLAY  CNS-PGM-ID":外部銘柄コード=["WK-GAIBU-MEG-CD"]"
 16956D    DISPLAY  CNS-PGM-ID":証券種別コード=["WK-SEC-SBT-CD"]"
 16957D    DISPLAY  CNS-PGM-ID":発行体国コード=["WK-HAKO-CD"]"
 16958D    DISPLAY  CNS-PGM-ID":投資対象国コード=["WK-TS-TARGET-KUNI"]"
 16959*-----------------------------------------------------------------
 16960       ELSE
 16961         CONTINUE
 16962       END-IF
 16963     ELSE
 16964       CONTINUE
 16965     END-IF
 16966*--------------------<DEBUG>--------------------------------------
 16967D    DISPLAY  CNS-PGM-ID":WK-STATUS=["
 16968D             WK-STATUS"]"
 16969*-----------------------------------------------------------------
 16970*----------  6)銘柄情報を取得
 16971     IF  WK-STATUS < CNS-16
 16972     THEN
 16973*------------------ <連結障害841の対応 START>---------------------
 16974*--------------------<DEBSUG>-------------------------------------
 16975D    DISPLAY  CNS-PGM-ID":H-MEG-CD=["
 16976D             H-MEG-CD            OF  HST-TBL-SELECT"]"
 16977*-----------------------------------------------------------------
 16978       IF  H-MEG-CD               OF  HST-TBL-SELECT
 16979         NOT = SPACE
 16980       THEN
 16981         IF  WK-MEG-CD-3004 NOT = H-MEG-CD  OF  HST-TBL-SELECT
 16982         THEN
 16983           PERFORM  SCZY3004-CHAN-RTN
 16984         ELSE
 16985           IF  WK-RTN-3004 = CNS-RTN-800
 16986           THEN
 16987*----------  ワーク実行ステータス
 16988             IF  WK-STATUS  < CNS-4
 16989             THEN
 16990               MOVE  CNS-4            TO  WK-STATUS
 16991             ELSE
 16992               CONTINUE
 16993             END-IF
 16994*----------  1190実行ステータス
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 294
* MUSR2651.cob                                                     cpy)cpy)y)y)
 16995             IF   WK-STATUS > WK-1190-STATUS
 16996             THEN
 16997               MOVE  WK-STATUS        TO  WK-1190-STATUS
 16998             ELSE
 16999               CONTINUE
 17000             END-IF
 17001*----------  ワークリターンコード
 17002             IF  WK-RTN-CODE < WK-STATUS
 17003             THEN
 17004               MOVE  WK-STATUS        TO  WK-RTN-CODE
 17005             ELSE
 17006               CONTINUE
 17007             END-IF
 17008           ELSE
 17009             CONTINUE
 17010           END-IF
 17011         END-IF
 17012       ELSE
 17013         INITIALIZE  WK-MEG-CD-3004
 17014                     WK-MEG-MEI-JP
 17015                     WK-MEG-MEI-EN
 17016                     WK-SAKEN-KP-KBN
 17017                     WK-SAKEN-SK-YMD
 17018                     WK-SISAN-BUNRUI-CD
 17019                     WK-CALL-PUT-KBN
 17020                     WK-RF-KABU-SBT
 17021*----------  ワーク実行ステータス
 17022         IF  WK-STATUS  < CNS-4
 17023         THEN
 17024           MOVE  CNS-4            TO  WK-STATUS
 17025         ELSE
 17026           CONTINUE
 17027         END-IF
 17028*----------  1190実行ステータス
 17029         IF   WK-STATUS > WK-1190-STATUS
 17030         THEN
 17031           MOVE  WK-STATUS        TO  WK-1190-STATUS
 17032         ELSE
 17033           CONTINUE
 17034         END-IF
 17035*--------------------<DEBSUG>-------------------------------------
 17036D    DISPLAY  CNS-PGM-ID":WK-STATUS=["WK-STATUS"]"
 17037D    DISPLAY  CNS-PGM-ID":WK-RTN-CODE=["WK-RTN-CODE"]"
 17038*-----------------------------------------------------------------
 17039*----------  ワークリターンコード
 17040         IF  WK-RTN-CODE < WK-STATUS
 17041         THEN
 17042           MOVE  WK-STATUS        TO  WK-RTN-CODE
 17043         ELSE
 17044           CONTINUE
 17045         END-IF
 17046*--------------------<DEBSUG>-------------------------------------
 17047D    DISPLAY  CNS-PGM-ID":WK-STATUS=["WK-STATUS"]"
 17048D    DISPLAY  CNS-PGM-ID":WK-RTN-CODE=["WK-RTN-CODE"]"
 17049D    DISPLAY  CNS-PGM-ID":WK-J =[" WK-J"]"
 17050*-----------------------------------------------------------------
 17051         COMPUTE  WK-J = WK-J + 1
 17052*-------------------<DEBUG>---------------------------------------
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 295
* MUSR2651.cob                                                     cpy)cpy)y)y)
 17053D    DISPLAY  CNS-PGM-ID":WK-J =[" WK-J"]"
 17054*-----------------------------------------------------------------
 17055*---------- ファンドコード
 17056         MOVE  WK-FUND-CD-DETAIL     OF  WK-PTF-ATT-DATA(WK-IDX-J)
 17057           TO  WK-GYOMU-FUND-CD      OF  WK-GYOMU-ERR-INFO(WK-J)
 17058*---------- ポートフォリオコード
 17059         MOVE  WK-PTF-CD-DETAIL      OF  WK-PTF-ATT-DATA(WK-IDX-J)
 17060           TO  WK-GYOMU-PTF-CD       OF  WK-GYOMU-ERR-INFO(WK-J)
 17061*---------- 評価系列コード
 17062         MOVE  WK-DEFAUL-THYK-CD     OF  WK-PTF-ATT-DATA(WK-IDX-J)
 17063           TO  WK-GYOMU-HYK-KRTU-CD  OF  WK-GYOMU-ERR-INFO(WK-J)
 17064*---------- メッセージID
 17065         MOVE  CNS-MSG-E000090
 17066           TO  WK-GYOMU-MSG-ID       OF  WK-GYOMU-ERR-INFO(WK-J)
 17067*---------- 基準日From
 17068         MOVE  WK-KIKAN-FR
 17069           TO  WK-GYOMU-KJN-YMD-FROM
 17070                   OF  WK-GYOMU-ERR-INFO(WK-J)
 17071*---------- 基準日To
 17072         MOVE  WK-KIKAN-TO
 17073           TO  WK-GYOMU-KJN-YMD-TO
 17074                   OF  WK-GYOMU-ERR-INFO(WK-J)
 17075*---------- 置換文字
 17076         MOVE  CNS-MEG-CD
 17077           TO  WK-GYOMU-TK-MOJI(WK-J,CNS-1)
 17078*---------- フリーメッセージ
 17079         MOVE  WK-TEMP-MSG
 17080           TO  WK-GYOMU-FREE-MSG      OF  WK-GYOMU-ERR-INFO(WK-J)
 17081         MOVE  CNS-ON                 TO  FLG-MEISAI-GYOMU-ERR
 17082       END-IF
 17083*------------------ <連結障害841の対応 END>-----------------------
 17084     ELSE
 17085       CONTINUE
 17086     END-IF
 17087*--------------------<DEBUG>--------------------------------------
 17088D    DISPLAY  CNS-PGM-ID": WK-RF-KABU-SBT =["WK-RF-KABU-SBT "]"
 17089D    DISPLAY  CNS-PGM-ID": FLG-DEFAULT-KRTU-CD =["
 17090D             FLG-DEFAULT-KRTU-CD "]"
 17091D    DISPLAY  CNS-PGM-ID": 国 =["WK-HAKO-CD "]"
 17092D    DISPLAY  CNS-PGM-ID": H-SEC-SBT-CD=["H-SEC-SBT-CD "]"
 17093D    DISPLAY  CNS-PGM-ID": H-DATA-KBN =["H-DATA-KBN "]"
 17094*-----------------------------------------------------------------
 17095     IF  H-SEC-SBT-CD  =  CNS-SKSBT-PRI
 17096     THEN
 17097       MOVE  CNS-PRI-J  TO  WK-MEG-MEI-JP
 17098       MOVE  CNS-PRI-E  TO  WK-MEG-MEI-EN
 17099     ELSE
 17100       CONTINUE
 17101     END-IF
 17102*--------------------<DEBUG>--------------------------------------
 17103D    DISPLAY  CNS-PGM-ID":銘柄名称(日本語)=["WK-MEG-MEI-JP"]"
 17104D    DISPLAY  CNS-PGM-ID":銘柄名称(英語)=["WK-MEG-MEI-EN"]"
 17105*-----------------------------------------------------------------
 17106*------------------ <連結障害841の対応 START>---------------------
 17107*----------  内部⇒外部コード(証券種別)
 17108*--------------------<DEBUG>--------------------------------------
 17109D    DISPLAY  CNS-PGM-ID": 証券種別 =["WK-SEC-SBT-CD"]"
 17110D    DISPLAY  CNS-PGM-ID":H-DATA-KBN=["H-DATA-KBN"]"
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 296
* MUSR2651.cob                                                     cpy)cpy)y)y)
 17111*-----------------------------------------------------------------
 17112     IF  WK-STATUS < CNS-16
 17113     THEN
 17114       IF  WK-SEC-SBT-CD NOT = SPACE
 17115       THEN
 17116         IF  H-DATA-KBN NOT = CNS-X-1
 17117           AND H-SEC-SBT-CD NOT = CNS-SKSBT-CASH
 17118         THEN
 17119           IF  WK-SEC-SBT-4182-2 NOT = WK-SEC-SBT-CD
 17120           THEN
 17121             PERFORM  SEC-SBT-CD-RTN
 17122           ELSE
 17123             EVALUATE  WK-RTN-4182-2
 17124               WHEN  CNS-RTN-110
 17125               WHEN  CNS-RTN-800
 17126*----------  ワーク実行ステータス
 17127                 IF  WK-STATUS  < CNS-4
 17128                 THEN
 17129                   MOVE  CNS-4            TO  WK-STATUS
 17130                 ELSE
 17131                   CONTINUE
 17132                 END-IF
 17133*----------  1190実行ステータス
 17134                 IF   WK-STATUS > WK-1190-STATUS
 17135                 THEN
 17136                   MOVE  WK-STATUS        TO  WK-1190-STATUS
 17137                 ELSE
 17138                   CONTINUE
 17139                 END-IF
 17140*----------  ワークリターンコード
 17141                 IF  WK-RTN-CODE < WK-STATUS
 17142                 THEN
 17143                   MOVE  WK-STATUS        TO  WK-RTN-CODE
 17144                 ELSE
 17145                   CONTINUE
 17146                 END-IF
 17147               WHEN  OTHER
 17148                 CONTINUE
 17149             END-EVALUATE
 17150           END-IF
 17151           MOVE  WK-GAIBU-CD
 17152             TO  WK-SEC-SBT-CD-2
 17153         ELSE
 17154           IF  H-SEC-SBT-CD = CNS-SKSBT-CASH
 17155           THEN
 17156             IF  H-TRHK-TUKA = WK-CAPITAL-TUKA-CD
 17157             THEN
 17158               MOVE  CNS-SKSBT-CASH
 17159                 TO  WK-SEC-SBT-CD-2
 17160             ELSE
 17161               MOVE  CNS-SKSBT-EX
 17162                 TO  WK-SEC-SBT-CD-2
 17163             END-IF
 17164*--------------------<DEBUG>--------------------------------------
 17165D    DISPLAY  CNS-PGM-ID": WK-SEC-SBT-CD-2 =["WK-SEC-SBT-CD-2"]"
 17166*-----------------------------------------------------------------
 17167           ELSE
 17168             CONTINUE
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 297
* MUSR2651.cob                                                     cpy)cpy)y)y)
 17169           END-IF
 17170         END-IF
 17171       ELSE
 17172         INITIALIZE  WK-SEC-SBT-4182-2
 17173                     WK-SEC-SBT-CD-2
 17174*----------  ワーク実行ステータス
 17175         IF  WK-STATUS  < CNS-4
 17176         THEN
 17177           MOVE  CNS-4            TO  WK-STATUS
 17178         ELSE
 17179           CONTINUE
 17180         END-IF
 17181*----------  1190実行ステータス
 17182         IF   WK-STATUS > WK-1190-STATUS
 17183         THEN
 17184           MOVE  WK-STATUS        TO  WK-1190-STATUS
 17185         ELSE
 17186           CONTINUE
 17187         END-IF
 17188*--------------------<DEBSUG>-------------------------------------
 17189D    DISPLAY  CNS-PGM-ID":WK-STATUS=["WK-STATUS"]"
 17190D    DISPLAY  CNS-PGM-ID":WK-RTN-CODE=["WK-RTN-CODE"]"
 17191*-----------------------------------------------------------------
 17192*----------  ワークリターンコード
 17193         IF  WK-RTN-CODE < WK-STATUS
 17194         THEN
 17195           MOVE  WK-STATUS        TO  WK-RTN-CODE
 17196         ELSE
 17197           CONTINUE
 17198         END-IF
 17199*--------------------<DEBSUG>-------------------------------------
 17200D    DISPLAY  CNS-PGM-ID":WK-STATUS=["WK-STATUS"]"
 17201D    DISPLAY  CNS-PGM-ID":WK-RTN-CODE=["WK-RTN-CODE"]"
 17202D    DISPLAY  CNS-PGM-ID":WK-J =[" WK-J"]"
 17203*-----------------------------------------------------------------
 17204         COMPUTE  WK-J = WK-J + 1
 17205*-------------------<DEBUG>---------------------------------------
 17206D    DISPLAY  CNS-PGM-ID":WK-J =[" WK-J"]"
 17207*-----------------------------------------------------------------
 17208*---------- ファンドコード
 17209         MOVE  WK-FUND-CD-DETAIL     OF  WK-PTF-ATT-DATA(WK-IDX-J)
 17210           TO  WK-GYOMU-FUND-CD      OF  WK-GYOMU-ERR-INFO(WK-J)
 17211*---------- ポートフォリオコード
 17212         MOVE  WK-PTF-CD-DETAIL      OF  WK-PTF-ATT-DATA(WK-IDX-J)
 17213           TO  WK-GYOMU-PTF-CD       OF  WK-GYOMU-ERR-INFO(WK-J)
 17214*---------- 評価系列コード
 17215         MOVE  WK-DEFAUL-THYK-CD     OF  WK-PTF-ATT-DATA(WK-IDX-J)
 17216           TO  WK-GYOMU-HYK-KRTU-CD  OF  WK-GYOMU-ERR-INFO(WK-J)
 17217*---------- メッセージID
 17218         MOVE  CNS-MSG-E000090
 17219           TO  WK-GYOMU-MSG-ID       OF  WK-GYOMU-ERR-INFO(WK-J)
 17220*---------- 基準日From
 17221         MOVE  WK-KIKAN-FR
 17222           TO  WK-GYOMU-KJN-YMD-FROM
 17223                   OF  WK-GYOMU-ERR-INFO(WK-J)
 17224*---------- 基準日To
 17225         MOVE  WK-KIKAN-TO
 17226           TO  WK-GYOMU-KJN-YMD-TO
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 298
* MUSR2651.cob                                                     cpy)cpy)y)y)
 17227                   OF  WK-GYOMU-ERR-INFO(WK-J)
 17228*---------- 置換文字
 17229         MOVE  CNS-SEC-SBT-CD
 17230           TO  WK-GYOMU-TK-MOJI(WK-J,CNS-1)
 17231*---------- フリーメッセージ
 17232         MOVE  WK-TEMP-MSG
 17233           TO  WK-GYOMU-FREE-MSG      OF  WK-GYOMU-ERR-INFO(WK-J)
 17234         MOVE  CNS-ON                 TO  FLG-MEISAI-GYOMU-ERR
 17235       END-IF
 17236     ELSE
 17237       CONTINUE
 17238     END-IF
 17239*------------------ <連結障害841の対応 END>-----------------------
 17240*--------------------<DEBUG>--------------------------------------
 17241D    DISPLAY  CNS-PGM-ID":WK-STATUS=["WK-STATUS"]"
 17242*-----------------------------------------------------------------
 17243*----------  ＧＸ用証券種別コード変換ルーチン
 17244     IF  WK-STATUS < CNS-16
 17245     THEN
 17246*--------------------<DEBUG>--------------------------------------
 17247D    DISPLAY  CNS-PGM-ID":H-DATA-KBN=["H-DATA-KBN"]"
 17248*-----------------------------------------------------------------
 17249       IF H-SEC-SBT-CD NOT = CNS-SKSBT-CASH
 17250       THEN
 17251         IF  H-DATA-KBN = CNS-X-1
 17252         THEN
 17253           MOVE  H-SEC-SBT-CD
 17254             TO  WK-SEC-SBT-CD-3
 17255*--------------------<DEBUG>--------------------------------------
 17256D    DISPLAY  CNS-PGM-ID":WK-SEC-SBT-CD-3=["WK-SEC-SBT-CD-3"]"
 17257*-----------------------------------------------------------------
 17258         ELSE
 17259           PERFORM  SUSC0603-RTN
 17260         END-IF
 17261       ELSE
 17262         MOVE  WK-SEC-SBT-CD-2
 17263           TO  WK-SEC-SBT-CD-3
 17264       END-IF
 17265     ELSE
 17266       CONTINUE
 17267     END-IF
 17268     IF  WK-STATUS < CNS-16
 17269     THEN
 17270       PERFORM  SCZY3026-RTN
 17271     ELSE
 17272       CONTINUE
 17273     END-IF
 17274     MOVE  H-CAST-CD              OF  HST-TBL-SELECT
 17275       TO  WK-CAST-CD-2
 17276*--------------------<DEBUG>--------------------------------------
 17277D    DISPLAY  CNS-PGM-ID":WK-CAST-CD-2=["WK-CAST-CD-2"]"
 17278D    DISPLAY  CNS-PGM-ID":WK-STATUS=["WK-STATUS"]"
 17279D    DISPLAY  CNS-PGM-ID":WK-SEC-SBT-CD-3=["WK-SEC-SBT-CD-3"]"
 17280D    DISPLAY  CNS-PGM-ID":WK-TRHK-TUKA=["WK-TRHK-TUKA"]"
 17281D    DISPLAY  CNS-PGM-ID":WK-CAPITAL-TUKA-CD=["
 17282D             WK-CAPITAL-TUKA-CD"]"
 17283*-----------------------------------------------------------------
 17284     IF  WK-STATUS < CNS-16
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 299
* MUSR2651.cob                                                     cpy)cpy)y)y)
 17285     THEN
 17286       IF  (WK-SEC-SBT-CD-3  = CNS-SKSBT-FBMS
 17287         OR  WK-SEC-SBT-CD-3  = CNS-SKSBT-FSMS
 17288         OR  WK-SEC-SBT-CD-3  = CNS-SKSBT-CBMS
 17289         OR  WK-SEC-SBT-CD-3  = CNS-SKSBT-OOET)
 17290         AND WK-TRHK-TUKA = WK-CAPITAL-TUKA-CD
 17291       THEN
 17292         INITIALIZE  WK-HAKO-CD-4102
 17293         MOVE  CNS-SPACE-99
 17294           TO  WK-HAKO-CD-2
 17295       ELSE
 17296*----------  4)国全項目取得
 17297         IF  WK-HAKO-CD NOT = SPACE
 17298           AND  WK-HAKO-CD NOT = CNS-OTHR
 17299           AND  H-SEC-SBT-CD NOT = CNS-SKSBT-FDAL
 17300           AND  H-SEC-SBT-CD NOT = CNS-SKSBT-PRI
 17301           AND  H-SEC-SBT-CD NOT = CNS-SKSBT-CASH
 17302           AND  WK-SYOHIN-KBN NOT = CNS-SYOHIN-KBN-17
 17303           AND  WK-SYOHIN-KBN NOT = CNS-SYOHIN-KBN-22
 17304           AND  (H-DATA-KBN NOT = CNS-X-1
 17305             OR  WK-TRHK-TUKA NOT = WK-CAPITAL-TUKA-CD)
 17306         THEN
 17307           IF  WK-HAKO-CD-4102 NOT = WK-HAKO-CD
 17308           THEN
 17309             PERFORM  SCZY4102-RTN
 17310           ELSE
 17311             EVALUATE  WK-RTN-4102
 17312               WHEN  CNS-RTN-110
 17313               WHEN  CNS-RTN-800
 17314*----------  ワーク実行ステータス
 17315                 IF  WK-STATUS  < CNS-4
 17316                 THEN
 17317                   MOVE  CNS-4            TO  WK-STATUS
 17318                 ELSE
 17319                   CONTINUE
 17320                 END-IF
 17321*----------  1190実行ステータス
 17322                 IF   WK-STATUS > WK-1190-STATUS
 17323                 THEN
 17324                   MOVE  WK-STATUS        TO  WK-1190-STATUS
 17325                 ELSE
 17326                   CONTINUE
 17327                 END-IF
 17328*----------  ワークリターンコード
 17329                 IF  WK-RTN-CODE < WK-STATUS
 17330                 THEN
 17331                   MOVE  WK-STATUS        TO  WK-RTN-CODE
 17332                 ELSE
 17333                   CONTINUE
 17334                 END-IF
 17335               WHEN  OTHER
 17336                 CONTINUE
 17337             END-EVALUATE
 17338           END-IF
 17339         ELSE
 17340           INITIALIZE  WK-HAKO-CD-4102
 17341           MOVE  CNS-SPACE-99
 17342             TO  WK-HAKO-CD-2
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 300
* MUSR2651.cob                                                     cpy)cpy)y)y)
 17343           IF  H-SEC-SBT-CD = CNS-SKSBT-FDAL
 17344             OR  H-SEC-SBT-CD = CNS-SKSBT-PRI
 17345             OR  H-SEC-SBT-CD = CNS-SKSBT-CASH
 17346             OR  WK-SYOHIN-KBN = CNS-SYOHIN-KBN-17
 17347             OR  WK-SYOHIN-KBN = CNS-SYOHIN-KBN-22
 17348           THEN
 17349*--------------------<DEBUG>--------------------------------------
 17350D    DISPLAY  CNS-PGM-ID":WK-KUNI-FLG =["WK-KUNI-FLG"]"
 17351D    DISPLAY  CNS-PGM-ID":WK-TRHK-TUKA-0604=["WK-TRHK-TUKA-0604"]"
 17352*-----------------------------------------------------------------
 17353             IF  WK-KUNI-FLG = CNS-OFF
 17354               OR WK-TRHK-TUKA-0604 NOT = WK-TRHK-TUKA
 17355             THEN
 17356               PERFORM  SUSC0604-RTN
 17357             ELSE
 17358               IF  WK-RTN-0604 = CNS-RTN-110
 17359               THEN
 17360                 IF  WK-1190-STATUS < CNS-4
 17361                 THEN
 17362                   MOVE  CNS-4          TO  WK-1190-STATUS
 17363                 ELSE
 17364                   CONTINUE
 17365                 END-IF
 17366                 IF  WK-STATUS < CNS-4
 17367                 THEN
 17368                   MOVE  CNS-4          TO  WK-STATUS
 17369                 ELSE
 17370                   CONTINUE
 17371                 END-IF
 17372                 IF  WK-RTN-CODE < CNS-4
 17373                 THEN
 17374                   MOVE  CNS-4          TO  WK-RTN-CODE
 17375                 ELSE
 17376                   CONTINUE
 17377                 END-IF
 17378               ELSE
 17379                 CONTINUE
 17380               END-IF
 17381             END-IF
 17382             MOVE  WK-KUNI-CD-RYAKU
 17383               TO  WK-HAKO-CD-2
 17384           ELSE
 17385             CONTINUE
 17386           END-IF
 17387*--------------------<DEBSUG>-------------------------------------
 17388D    DISPLAY  CNS-PGM-ID":国コード_略式=["WK-HAKO-CD-2"]"
 17389*-----------------------------------------------------------------
 17390         END-IF
 17391       END-IF
 17392     ELSE
 17393       CONTINUE
 17394     END-IF
 17395*--------------------<DEBSUG>-------------------------------------
 17396D    DISPLAY  CNS-PGM-ID":WK-HYK-EX-FLG=["WK-HYK-EX-FLG"]"
 17397*-----------------------------------------------------------------
 17398*---------- 乗除区分を取得
 17399     IF  WK-STATUS < CNS-16
 17400     THEN
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 301
* MUSR2651.cob                                                     cpy)cpy)y)y)
 17401       IF  WK-HYK-EX-FLG = CNS-OFF
 17402       THEN
 17403         PERFORM  SCZY4009-RTN
 17404       ELSE
 17405         IF  WK-RTN-4009 = CNS-RTN-110
 17406         THEN
 17407*----------  ワーク実行ステータス
 17408           IF  WK-STATUS  < CNS-4
 17409           THEN
 17410             MOVE  CNS-4            TO  WK-STATUS
 17411           ELSE
 17412             CONTINUE
 17413           END-IF
 17414*----------  1190実行ステータス
 17415           IF   WK-STATUS > WK-1190-STATUS
 17416           THEN
 17417             MOVE  WK-STATUS        TO  WK-1190-STATUS
 17418           ELSE
 17419             CONTINUE
 17420           END-IF
 17421*----------  ワークリターンコード
 17422           IF  WK-RTN-CODE < WK-STATUS
 17423           THEN
 17424             MOVE  WK-STATUS        TO  WK-RTN-CODE
 17425           ELSE
 17426             CONTINUE
 17427           END-IF
 17428         ELSE
 17429           CONTINUE
 17430         END-IF
 17431       END-IF
 17432     ELSE
 17433       CONTINUE
 17434     END-IF
 17435     IF  WK-STATUS < CNS-16
 17436     THEN
 17437       IF  WK-PRIO-1-FLG = CNS-OFF
 17438        OR  WK-TRHK-TUKA-4012 NOT = H-TRHK-TUKA OF HST-TBL-SELECT
 17439       THEN
 17440         PERFORM  SCZY4012-RTN
 17441       ELSE
 17442         IF  WK-RTN-4012 = CNS-RTN-110
 17443         THEN
 17444*----------  ワーク実行ステータス
 17445           IF  WK-STATUS  < CNS-4
 17446           THEN
 17447             MOVE  CNS-4            TO  WK-STATUS
 17448           ELSE
 17449             CONTINUE
 17450           END-IF
 17451*----------  1190実行ステータス
 17452           IF   WK-STATUS > WK-1190-STATUS
 17453           THEN
 17454             MOVE  WK-STATUS        TO  WK-1190-STATUS
 17455           ELSE
 17456             CONTINUE
 17457           END-IF
 17458*----------  ワークリターンコード
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 302
* MUSR2651.cob                                                     cpy)cpy)y)y)
 17459           IF  WK-RTN-CODE < WK-STATUS
 17460           THEN
 17461             MOVE  WK-STATUS        TO  WK-RTN-CODE
 17462           ELSE
 17463             CONTINUE
 17464           END-IF
 17465         ELSE
 17466           CONTINUE
 17467         END-IF
 17468       END-IF
 17469     ELSE
 17470       CONTINUE
 17471     END-IF
 17472*-------------------<DEBUG>---------------------------------------
 17473D    DISPLAY  CNS-PGM-ID":ワーク取引運用乗除区分フラグ=["
 17474D             WK-KWS-ZYOUHO-FLG"]"
 17475D    DISPLAY  CNS-PGM-ID":ワーク約定為替換算時採用系列_3017=["
 17476D             WK-PRIO-3017"]"
 17477D    DISPLAY  CNS-PGM-ID":ワークベース通貨コード_3017=["
 17478D             WK-TRHK-TUKA-3017"]"
 17479D    DISPLAY  CNS-PGM-ID":ワーク目的通貨コード_3017=["
 17480D             WK-CAPITAL-TUKA-3017"]"
 17481D    DISPLAY  CNS-PGM-ID":ワーク約定為替換算時採用系列=["
 17482D             WK-PRIO-1-EX-KRTU"]"
 17483D    DISPLAY  CNS-PGM-ID":DBから取得した取引通貨=["H-TRHK-TUKA"]"
 17484D    DISPLAY  CNS-PGM-ID":ワーク運用通貨コード=["
 17485D             WK-CAPITAL-TUKA-CD"]"
 17486*-----------------------------------------------------------------
 17487     IF  WK-STATUS < CNS-16
 17488     THEN
 17489       IF  WK-KWS-ZYOUHO-FLG = CNS-OFF
 17490        OR  WK-PRIO-3017 NOT = WK-PRIO-1-EX-KRTU
 17491        OR  WK-TRHK-TUKA-3017 NOT = H-TRHK-TUKA
 17492        OR  WK-CAPITAL-TUKA-3017 NOT = WK-CAPITAL-TUKA-CD
 17493       THEN
 17494         PERFORM  SCZY3017-RTN
 17495       ELSE
 17496         EVALUATE  WK-RTN-3017
 17497           WHEN  CNS-RTN-110
 17498           WHEN  CNS-RTN-800
 17499*----------  ワーク実行ステータス
 17500             IF  WK-STATUS  < CNS-4
 17501             THEN
 17502               MOVE  CNS-4            TO  WK-STATUS
 17503             ELSE
 17504               CONTINUE
 17505             END-IF
 17506*----------  1190実行ステータス
 17507             IF   WK-STATUS > WK-1190-STATUS
 17508             THEN
 17509               MOVE  WK-STATUS        TO  WK-1190-STATUS
 17510             ELSE
 17511               CONTINUE
 17512             END-IF
 17513*----------  ワークリターンコード
 17514             IF  WK-RTN-CODE < WK-STATUS
 17515             THEN
 17516               MOVE  WK-STATUS        TO  WK-RTN-CODE
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 303
* MUSR2651.cob                                                     cpy)cpy)y)y)
 17517             ELSE
 17518               CONTINUE
 17519             END-IF
 17520           WHEN  OTHER
 17521             CONTINUE
 17522         END-EVALUATE
 17523       END-IF
 17524     ELSE
 17525       CONTINUE
 17526     END-IF
 17527*******              テーマ3422         修正  開始        ********
 17528*----------ワーク商品区分＝"22"(為替予約)の場合
 17529*-------------------<DEBUG>---------------------------------------
 17530D    DISPLAY  CNS-PGM-ID":ワーク商品区分=["WK-SYOHIN-KBN"]"
 17531*-----------------------------------------------------------------
 17532     IF  WK-SYOHIN-KBN = CNS-SYOHIN-KBN-22
 17533       THEN
 17534       IF  WK-STATUS < CNS-16
 17535         THEN
 17536*-------------------<DEBUG>---------------------------------------
 17537D    DISPLAY  CNS-PGM-ID":ワーク取引決済乗除区分フラグ=["
 17538D             WK-TH-ZYOUHO-FLG"]"
 17539D    DISPLAY  CNS-PGM-ID":ワーク約定為替換算時採用系列_時価(取引"
 17540D             "通貨)用=["WK-PRIO-CP"]"
 17541D    DISPLAY  CNS-PGM-ID":ワークベース通貨コード_時価(取引通貨)用"
 17542D             " =["WK-BASE-TUKA-CP"]"
 17543D    DISPLAY  CNS-PGM-ID":ワーク目的通貨コード_時価(取引通貨)用=["
 17544D             WK-MOKU-TUKA-CP"]"
 17545D    DISPLAY  CNS-PGM-ID":ワーク約定為替換算時採用系列=["
 17546D             WK-PRIO-1-EX-KRTU"]"
 17547D    DISPLAY  CNS-PGM-ID":DBから取得した為替決済通貨=["
 17548D             H-KWS-TH-TUKA-CD"]"
 17549D    DISPLAY  CNS-PGM-ID":DBから取得した取引通貨=["
 17550D             H-TRHK-TUKA"]"
 17551*-----------------------------------------------------------------
 17552           IF  WK-TH-ZYOUHO-FLG = CNS-OFF
 17553            OR  WK-PRIO-CP  NOT = WK-PRIO-1-EX-KRTU
 17554            OR  WK-BASE-TUKA-CP    NOT = H-KWS-TH-TUKA-CD
 17555            OR  WK-MOKU-TUKA-CP    NOT = H-TRHK-TUKA
 17556           THEN
 17557             PERFORM  SCZY3017-2-RTN
 17558           ELSE
 17559*-------------------<DEBUG>---------------------------------------
 17560D    DISPLAY  CNS-PGM-ID":ワークリターンコード_時価(取引通貨)=["
 17561D             WK-RTN-3017-2"]"
 17562*-----------------------------------------------------------------
 17563             EVALUATE  WK-RTN-3017-2
 17564               WHEN  CNS-RTN-110
 17565               WHEN  CNS-RTN-800
 17566*--------------  ワーク実行ステータス
 17567*-------------------<DEBUG>---------------------------------------
 17568D    DISPLAY  CNS-PGM-ID":ワーク実行ステータス=["WK-STATUS"]"
 17569D    DISPLAY  CNS-PGM-ID":WK-1190-STATUS=["WK-1190-STATUS"]"
 17570D    DISPLAY  CNS-PGM-ID":WK-RTN-CODE=["WK-RTN-CODE"]"
 17571*-----------------------------------------------------------------
 17572                 IF  WK-STATUS  < CNS-4
 17573                 THEN
 17574                   MOVE  CNS-4            TO  WK-STATUS
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 304
* MUSR2651.cob                                                     cpy)cpy)y)y)
 17575                 ELSE
 17576                   CONTINUE
 17577                 END-IF
 17578*--------------  1190実行ステータス
 17579                 IF   WK-STATUS > WK-1190-STATUS
 17580                 THEN
 17581                   MOVE  WK-STATUS        TO  WK-1190-STATUS
 17582                 ELSE
 17583                   CONTINUE
 17584                 END-IF
 17585*--------------  ワークリターンコード
 17586                 IF  WK-RTN-CODE < WK-STATUS
 17587                 THEN
 17588                   MOVE  WK-STATUS        TO  WK-RTN-CODE
 17589                 ELSE
 17590                   CONTINUE
 17591                 END-IF
 17592*-------------------<DEBUG>---------------------------------------
 17593D    DISPLAY  CNS-PGM-ID":ワーク実行ステータス=["WK-STATUS"]"
 17594D    DISPLAY  CNS-PGM-ID":WK-1190-STATUS=["WK-1190-STATUS"]"
 17595D    DISPLAY  CNS-PGM-ID":WK-RTN-CODE=["WK-RTN-CODE"]"
 17596*-----------------------------------------------------------------
 17597               WHEN  OTHER
 17598                 CONTINUE
 17599             END-EVALUATE
 17600           END-IF
 17601       ELSE
 17602         CONTINUE
 17603       END-IF
 17604     ELSE
 17605       CONTINUE
 17606     END-IF
 17607*******              テーマ3422         修正  終了        ********
 17608*------------------ <連結障害1532の対応 START>--------------------
 17609*---------- 時価（取引通貨）編集
 17610*-------------------<DEBUG>---------------------------------------
 17611D    DISPLAY  CNS-PGM-ID":ワーク商品区分=["WK-SYOHIN-KBN"]"
 17612D    DISPLAY  CNS-PGM-ID":ワーク乗除区分2（時価（取引通貨）用）"
 17613D             "=["WK-KWS-ZYOUHO-JZS-2"]"
 17614D    DISPLAY  CNS-PGM-ID":運用成果残高.時価(取引通貨)=["
 17615D             H-CP-KRTU-CD"]"
 17616*-----------------------------------------------------------------
 17617       IF  WK-SYOHIN-KBN = CNS-SYOHIN-KBN-22
 17618       THEN
 17619         IF  WK-KWS-ZYOUHO-JZS-2 = CNS-X-2
 17620         THEN
 17621           IF   H-CP-KRTU-CD NOT = ZERO
 17622           THEN
 17623              COMPUTE  WK-CP-KRTU-CD
 17624                    =  CNS-1
 17625                    /  H-CP-KRTU-CD
 17626           ELSE
 17627             MOVE  CNS-0
 17628               TO  WK-CP-KRTU-CD
 17629           END-IF
 17630         ELSE
 17631           MOVE  H-CP-KRTU-CD  TO  WK-CP-KRTU-CD
 17632         END-IF
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 305
* MUSR2651.cob                                                     cpy)cpy)y)y)
 17633       ELSE
 17634         MOVE  H-CP-KRTU-CD  TO  WK-CP-KRTU-CD
 17635       END-IF
 17636*-------------------<DEBUG>---------------------------------------
 17637D    DISPLAY  CNS-PGM-ID":時価（取引通貨) =["WK-CP-KRTU-CD"]"
 17638D    DISPLAY  CNS-PGM-ID":WK-SYOHIN-KBN=["WK-SYOHIN-KBN"]"
 17639D    DISPLAY  CNS-PGM-ID":WK-KWS-ZYOUHO-JZS-2=["
 17640D             WK-KWS-ZYOUHO-JZS-2"]"
 17641*-----------------------------------------------------------------
 17642*---------- 評価為替レート編集
 17643*-------------------<DEBUG>---------------------------------------
 17644D    DISPLAY  CNS-PGM-ID":ワーク乗除区分1（評価為替レート用）"
 17645D             "=["WK-KWS-ZYOUHO-JZS"]"
 17646D    DISPLAY  CNS-PGM-ID":運用成果残高.評価為替レート=["
 17647D             H-HYK-KWS"]"
 17648*-----------------------------------------------------------------
 17649       IF  WK-KWS-ZYOUHO-JZS = CNS-X-2
 17650       THEN
 17651         IF  H-HYK-KWS NOT = ZERO
 17652         THEN
 17653           COMPUTE  WK-HYK-KWS
 17654                 =  CNS-1
 17655                 /  H-HYK-KWS
 17656         ELSE
 17657           MOVE  CNS-0
 17658             TO  WK-HYK-KWS
 17659         END-IF
 17660       ELSE
 17661         MOVE  H-HYK-KWS         TO  WK-HYK-KWS
 17662       END-IF
 17663*-------------------<DEBUG>---------------------------------------
 17664D    DISPLAY  CNS-PGM-ID":評価為替レート編集=["WK-HYK-KWS"]"
 17665D    DISPLAY  CNS-PGM-ID":WK-KWS-ZYOUHO-JZS=["WK-KWS-ZYOUHO-JZS"]"
 17666D    DISPLAY  CNS-PGM-ID":WK-KANRI-SURYO-TANI=["
 17667D             WK-KANRI-SURYO-TANI"]"
 17668D    DISPLAY  CNS-PGM-ID":H-SEC-SBT-CD=["H-SEC-SBT-CD"]"
 17669D    DISPLAY  CNS-PGM-ID":H-THTK-ST-KNG=["H-THTK-ST-KNG"]"
 17670D    DISPLAY  CNS-PGM-ID":H-HOU-SURYO=["H-HOU-SURYO"]"
 17671*-----------------------------------------------------------------
 17672*------------------ <連結障害1532の対応 END  >--------------------
 17673*---------- 取得単価(取引通貨)編集
 17674*-------------------<DEBUG>---------------------------------------
 17675D    DISPLAY  CNS-PGM-ID":ワーク商品区分=["WK-SYOHIN-KBN"]"
 17676D    DISPLAY  CNS-PGM-ID":ワーク乗除区分2（時価（取引通貨）用）"
 17677D             "=["WK-KWS-ZYOUHO-JZS-2"]"
 17678D    DISPLAY  CNS-PGM-ID":運用成果残高.取得単価(取引通貨)=["
 17679D             H-THTK-ST-TNK   OF  HST-TBL-SELECT"]"
 17680*-----------------------------------------------------------------
 17681       IF  WK-SYOHIN-KBN = CNS-SYOHIN-KBN-22
 17682       THEN
 17683         IF  WK-KWS-ZYOUHO-JZS-2 = CNS-X-2
 17684         THEN
 17685           IF   H-THTK-ST-TNK   OF  HST-TBL-SELECT  NOT = ZERO
 17686           THEN
 17687              COMPUTE  WK-THTK-ST-TNK
 17688                    =  CNS-1
 17689                    /  H-THTK-ST-TNK   OF  HST-TBL-SELECT
 17690           ELSE
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 306
* MUSR2651.cob                                                     cpy)cpy)y)y)
 17691             MOVE  CNS-0
 17692               TO  WK-THTK-ST-TNK
 17693           END-IF
 17694         ELSE
 17695           MOVE  H-THTK-ST-TNK   OF  HST-TBL-SELECT
 17696             TO  WK-THTK-ST-TNK
 17697         END-IF
 17698       ELSE
 17699         MOVE  H-THTK-ST-TNK   OF  HST-TBL-SELECT
 17700           TO  WK-THTK-ST-TNK
 17701       END-IF
 17702*-------------------<DEBUG>---------------------------------------
 17703D    DISPLAY  CNS-PGM-ID":取得単価(取引通貨)編集後=["
 17704D             WK-THTK-ST-TNK"]"
 17705*-----------------------------------------------------------------
 17706*---------- 保有数量編集
 17707       IF  WK-SYOHIN-KBN = CNS-SYOHIN-KBN-22
 17708         OR  H-SEC-SBT-CD = CNS-SKSBT-PRI
 17709       THEN
 17710         MOVE  H-THTK-ST-KNG     TO  WK-HOU-SURYO
 17711       ELSE
 17712         COMPUTE  WK-HOU-SURYO
 17713               =  H-HOU-SURYO  *  WK-KANRI-SURYO-TANI
 17714       END-IF
 17715*-------------------<DEBUG>---------------------------------------
 17716D    DISPLAY  CNS-PGM-ID":保有数量編集=["WK-HOU-SURYO"]"
 17717*-----------------------------------------------------------------
 17718*----------  取得金額(取引通貨)編集
 17719       IF  WK-SYOHIN-KBN = CNS-SYOHIN-KBN-22
 17720       THEN
 17721         COMPUTE  WK-THTK-ST-KNG
 17722               =  H-HOU-SURYO  *  WK-KANRI-SURYO-TANI
 17723       ELSE
 17724         MOVE  H-THTK-ST-KNG     TO  WK-THTK-ST-KNG
 17725       END-IF
 17726*-------------------<DEBUG>---------------------------------------
 17727D    DISPLAY  CNS-PGM-ID":取得金額(取引通貨)=["WK-THTK-ST-KNG"]"
 17728D    DISPLAY  CNS-PGM-ID":ワーク商品区分=["WK-SYOHIN-KBN"]"
 17729D    DISPLAY  CNS-PGM-ID":H-SEC-SBT-CD=["H-SEC-SBT-CD"]"
 17730D    DISPLAY  CNS-PGM-ID":H-OP-TATE-FLG=["H-OP-TATE-FLG"]"
 17731D    DISPLAY  CNS-PGM-ID":H-THTK-HYK-SNEKI=["H-THTK-HYK-SNEKI"]"
 17732D    DISPLAY  CNS-PGM-ID":H-THTK-ST-KNG=["H-THTK-ST-KNG"]"
 17733*-----------------------------------------------------------------
 17734*----------  評価金額(取引通貨)編集
 17735       IF  WK-SYOHIN-KBN = CNS-SYOHIN-KBN-20
 17736         OR  WK-SYOHIN-KBN = CNS-SYOHIN-KBN-24
 17737         OR  H-SEC-SBT-CD = CNS-SKSBT-XMFF
 17738         OR  H-SEC-SBT-CD = CNS-SKSBT-TBA
 17739       THEN
 17740         EVALUATE  H-OP-TATE-FLG
 17741           WHEN  CNS-TATE-FLG-L
 17742             COMPUTE  WK-THTK-HYK-KN
 17743                   =  H-THTK-HYK-SNEKI + H-THTK-ST-KNG
 17744           WHEN  CNS-TATE-FLG-S
 17745             COMPUTE  WK-THTK-HYK-KN
 17746                   =  H-THTK-HYK-SNEKI - H-THTK-ST-KNG
 17747           WHEN  OTHER
 17748             MOVE  H-THTK-HYK-SNEKI  TO  WK-THTK-HYK-KN
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 307
* MUSR2651.cob                                                     cpy)cpy)y)y)
 17749         END-EVALUATE
 17750       ELSE
 17751         MOVE  H-THTK-HYK-KN     TO  WK-THTK-HYK-KN
 17752       END-IF
 17753*-------------------<DEBUG>---------------------------------------
 17754D    DISPLAY  CNS-PGM-ID":評価金額(取引通貨)=["WK-THTK-HYK-KN"]"
 17755D    DISPLAY  CNS-PGM-ID":ワーク商品区分=["WK-SYOHIN-KBN"]"
 17756D    DISPLAY  CNS-PGM-ID":H-SEC-SBT-CD=["H-SEC-SBT-CD"]"
 17757D    DISPLAY  CNS-PGM-ID":H-OP-TATE-FLG=["H-OP-TATE-FLG"]"
 17758D    DISPLAY  CNS-PGM-ID":H-HYK-SNEKI-LC=["H-HYK-SNEKI-LC"]"
 17759D    DISPLAY  CNS-PGM-ID":H-SHTK-KN-LC=["H-SHTK-KN-LC"]"
 17760*-----------------------------------------------------------------
 17761*----------  評価金額(運用通貨)
 17762       IF  WK-SYOHIN-KBN = CNS-SYOHIN-KBN-20
 17763         OR  WK-SYOHIN-KBN = CNS-SYOHIN-KBN-24
 17764         OR  H-SEC-SBT-CD = CNS-SKSBT-XMFF
 17765         OR  H-SEC-SBT-CD = CNS-SKSBT-TBA
 17766       THEN
 17767         EVALUATE  H-OP-TATE-FLG
 17768           WHEN  CNS-TATE-FLG-L
 17769             COMPUTE  WK-HYK-KN-LC
 17770                   =  H-HYK-SNEKI-LC + H-SHTK-KN-LC
 17771           WHEN  CNS-TATE-FLG-S
 17772             COMPUTE  WK-HYK-KN-LC
 17773                   =  H-HYK-SNEKI-LC - H-SHTK-KN-LC
 17774           WHEN  OTHER
 17775             MOVE  H-HYK-SNEKI-LC    TO  WK-HYK-KN-LC
 17776         END-EVALUATE
 17777       ELSE
 17778         MOVE  H-HYK-KN-LC       TO  WK-HYK-KN-LC
 17779       END-IF
 17780*-------------------<DEBUG>---------------------------------------
 17781D    DISPLAY  CNS-PGM-ID":評価金額(運用通貨)=["WK-HYK-KN-LC"]"
 17782*-----------------------------------------------------------------
 17783*----------  備考_１
 17784     IF  WK-STATUS < CNS-16
 17785     THEN
 17786       IF  H-BIKOU-1 = SPACE
 17787       THEN
 17788         MOVE  H-BIKOU-1         TO  WK-BIKOU-1
 17789         INITIALIZE  WK-BIKOU-FLG
 17790                     WK-BIKOU-4116
 17791       ELSE
 17792         IF  WK-BIKOU-FLG = CNS-OFF
 17793          OR  WK-BIKOU-4116 NOT = H-BIKOU-1
 17794         THEN
 17795           PERFORM  SCZY4116-RTN
 17796         ELSE
 17797           EVALUATE  WK-RTN-4116
 17798             WHEN  CNS-RTN-110
 17799             WHEN  CNS-RTN-800
 17800*----------  ワーク実行ステータス
 17801               IF  WK-STATUS  < CNS-4
 17802               THEN
 17803                 MOVE  CNS-4            TO  WK-STATUS
 17804               ELSE
 17805                 CONTINUE
 17806               END-IF
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 308
* MUSR2651.cob                                                     cpy)cpy)y)y)
 17807*----------  1190実行ステータス
 17808               IF   WK-STATUS > WK-1190-STATUS
 17809               THEN
 17810                 MOVE  WK-STATUS        TO  WK-1190-STATUS
 17811               ELSE
 17812                 CONTINUE
 17813               END-IF
 17814*----------  ワークリターンコード
 17815               IF  WK-RTN-CODE < WK-STATUS
 17816               THEN
 17817                 MOVE  WK-STATUS        TO  WK-RTN-CODE
 17818               ELSE
 17819                 CONTINUE
 17820               END-IF
 17821             WHEN  OTHER
 17822               CONTINUE
 17823           END-EVALUATE
 17824         END-IF
 17825       END-IF
 17826     ELSE
 17827       CONTINUE
 17828     END-IF
 17829*----------  データ明細編輯
 17830*------------------ <残タスク157の対応 START>---------------------
 17831     IF  WK-STATUS < CNS-4
 17832     THEN
 17833       PERFORM  DATA-RTN
 17834     ELSE
 17835       CONTINUE
 17836     END-IF
 17837*------------------ <残タスク157の対応 END>-----------------------
 17838*--------------------<DEBUG>--------------------------------------
 17839D    DISPLAY  CNS-PGM-ID":***  データ編集処理 END  ***"
 17840*-----------------------------------------------------------------
 17841     CONTINUE.
 17842 DATA-EDIT-EXT.
 17843     EXIT.
 17844*------------------ <残タスク135の対応 START>---------------------
 17845******************************************************************
 17846*    商品属性全項目取得
 17847******************************************************************
 17848 SCZY4156-RTN           SECTION.
 17849*--------------------<DEBUG>--------------------------------------
 17850D    DISPLAY  CNS-PGM-ID":***SCZY4156商品属性全項目取得 START ***"
 17851*-----------------------------------------------------------------
 17852     INITIALIZE  PARM-SCZY4156-INOUT
 17853                 PARM-RTNPKG
 17854                 WK-SYOHIN-KBN
 17855                 WK-KANRI-SURYO-TANI
 17856                 WK-SEC-SBT-4156
 17857                 WK-RTN-4156
 17858*----------  利用会社コード
 17859     MOVE  WK-RIYO-CMP-CD
 17860       TO  RIYO-CMP-CD            OF  PARM-SCZY4156-ARG1
 17861*----------  証券種別コード
 17862     MOVE  H-SEC-SBT-CD
 17863       TO  SEC-SBT-CD             OF  PARM-SCZY4156-ARG1
 17864*-------------------<DEBUG>---------------------------------------
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 309
* MUSR2651.cob                                                     cpy)cpy)y)y)
 17865D    DISPLAY  CNS-PGM-ID":利用会社コード=["
 17866D             RIYO-CMP-CD         OF  PARM-SCZY4156-ARG1"]"
 17867D    DISPLAY  CNS-PGM-ID":証券種別コード=["
 17868D             SEC-SBT-CD          OF  PARM-SCZY4156-ARG1"]"
 17869D    DISPLAY  CNS-PGM-ID": ***  CALL SCZY4156  START  ***"
 17870*-----------------------------------------------------------------
 17871     CALL  "SCZY4156"             USING  PARM-SCZY4156-INOUT
 17872                                         PARM-RTNPKG
 17873*-------------------<DEBUG>---------------------------------------
 17874D    DISPLAY  CNS-PGM-ID": ***  CALL SCZY4156  END  ***"
 17875D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY4156) =["
 17876D             RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)"]"
 17877D    DISPLAY  CNS-PGM-ID":COUNTER OF  PARM-RTNPKG    =["
 17878D                         COUNTER OF  PARM-RTNPKG"]"
 17879D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG    =["PARM-RTNPKG"]"
 17880*-----------------------------------------------------------------
 17881     MOVE  H-SEC-SBT-CD
 17882       TO  WK-SEC-SBT-4156
 17883     MOVE  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
 17884       TO  WK-RTN-4156
 17885     EVALUATE  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
 17886*----------  正常
 17887       WHEN  CNS-RTN-000
 17888*----------  ワーク商品区分
 17889         MOVE  SYOHIN-KBN          OF    PARM-SCZY4156-ARG2
 17890           TO  WK-SYOHIN-KBN
 17891*----------  ワーク管理数量単位
 17892         MOVE  KANRI-SURYO-TANI    OF    PARM-SCZY4156-ARG2
 17893           TO  WK-KANRI-SURYO-TANI
 17894*----------  異常
 17895       WHEN  CNS-RTN-110
 17896         IF  WK-STATUS < CNS-4
 17897         THEN
 17898           MOVE  CNS-4             TO  WK-STATUS
 17899         ELSE
 17900           CONTINUE
 17901         END-IF
 17902*----------  1190実行ステータス
 17903         IF  WK-1190-STATUS < WK-STATUS
 17904         THEN
 17905           MOVE  WK-STATUS    TO  WK-1190-STATUS
 17906         ELSE
 17907           CONTINUE
 17908         END-IF
 17909*----------  ワークリターンコード
 17910         IF  WK-RTN-CODE < WK-STATUS
 17911         THEN
 17912           MOVE  WK-STATUS    TO  WK-RTN-CODE
 17913         ELSE
 17914           CONTINUE
 17915         END-IF
 17916*-------------------<DEBUG>---------------------------------------
 17917D    DISPLAY  CNS-PGM-ID":WK-J =[" WK-J"]"
 17918*-----------------------------------------------------------------
 17919       COMPUTE  WK-J = WK-J + 1
 17920*-------------------<DEBUG>---------------------------------------
 17921D    DISPLAY  CNS-PGM-ID":WK-J =[" WK-J"]"
 17922*-----------------------------------------------------------------
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 310
* MUSR2651.cob                                                     cpy)cpy)y)y)
 17923*---------- ファンドコード
 17924         MOVE  WK-FUND-CD-DETAIL     OF  WK-PTF-ATT-DATA(WK-IDX-J)
 17925           TO  WK-GYOMU-FUND-CD      OF  WK-GYOMU-ERR-INFO(WK-J)
 17926*---------- ポートフォリオコード
 17927         MOVE  WK-PTF-CD-DETAIL      OF  WK-PTF-ATT-DATA(WK-IDX-J)
 17928           TO  WK-GYOMU-PTF-CD       OF  WK-GYOMU-ERR-INFO(WK-J)
 17929*---------- 評価系列コード
 17930         MOVE  WK-DEFAUL-THYK-CD     OF  WK-PTF-ATT-DATA(WK-IDX-J)
 17931           TO  WK-GYOMU-HYK-KRTU-CD  OF  WK-GYOMU-ERR-INFO(WK-J)
 17932*---------- メッセージID
 17933         MOVE  CNS-MSG-E000090
 17934           TO  WK-GYOMU-MSG-ID       OF  WK-GYOMU-ERR-INFO(WK-J)
 17935*---------- 基準日From
 17936         MOVE  WK-KIKAN-FR
 17937           TO  WK-GYOMU-KJN-YMD-FROM
 17938                   OF  WK-GYOMU-ERR-INFO(WK-J)
 17939*---------- 基準日To
 17940         MOVE  WK-KIKAN-TO
 17941           TO  WK-GYOMU-KJN-YMD-TO
 17942                   OF  WK-GYOMU-ERR-INFO(WK-J)
 17943*---------- 置換文字
 17944         STRING  CNS-SEC-SBT-CD
 17945                 H-SEC-SBT-CD
 17946                 DELIMITED BY SPACE
 17947                 INTO  WK-GYOMU-TK-MOJI(WK-J,CNS-1)
 17948         END-STRING
 17949*---------- フリーメッセージ
 17950         MOVE  WK-TEMP-MSG
 17951           TO  WK-GYOMU-FREE-MSG      OF  WK-GYOMU-ERR-INFO(WK-J)
 17952         MOVE  CNS-ON                 TO  FLG-MEISAI-GYOMU-ERR
 17953*----------  上記以外
 17954       WHEN  OTHER
 17955*----------  WK-STATUS
 17956         MOVE  CNS-16              TO  WK-STATUS
 17957*----------  1190実行ステータス
 17958         MOVE  CNS-16              TO  WK-1190-STATUS
 17959*----------  ワークリターンコード
 17960         MOVE  CNS-16              TO  WK-RTN-CODE
 17961*----------  サブエラーメッセージ出力処理
 17962         PERFORM  SUB-ERR-MSG-RTN
 17963*----------  ワークエラーパッケージを編集
 17964         INITIALIZE  WK-SYS-ERR-INFO
 17965*----------  エラー検知プログラムID
 17966         MOVE  CNS-PGM-ID          TO  WK-ERR-PGM-ID
 17967*----------  ポジション
 17968         MOVE  CNS-POS-023         TO  WK-ERR-POS
 17969*----------  リターンコード
 17970         MOVE  CNS-RTN-901         TO  WK-RTN-CD
 17971*----------  詳細リターンコード
 17972         MOVE  RTN-CD
 17973           OF  PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
 17974                                   TO  WK-DETAIL-RTN-CD
 17975*----------  詳細リターンコードデコードフラグ
 17976         MOVE  CNS-DETAIL-0        TO  WK-DETAIL-RTN-CD-FLG
 17977*---------- フリーメッセージ
 17978         MOVE  SPACE               TO  WK-FREE-MSG
 17979*----------  エラー情報追加処理
 17980         PERFORM  ERR-INFO-ADD-RTN
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 311
* MUSR2651.cob                                                     cpy)cpy)y)y)
 17981     END-EVALUATE
 17982*--------------------<DEBUG>--------------------------------------
 17983D    DISPLAY  CNS-PGM-ID":商品区分=["WK-SYOHIN-KBN"]"
 17984D    DISPLAY  CNS-PGM-ID":管理数量単位=["WK-KANRI-SURYO-TANI"]"
 17985D    DISPLAY  CNS-PGM-ID":***SCZY4156商品属性全項目取得 END ***"
 17986*-----------------------------------------------------------------
 17987     CONTINUE.
 17988 SCZY4156-EXT.
 17989     EXIT.
 17990*------------------ <残タスク135の対応 END>-----------------------
 17991******************************************************************
 17992*    データ明細編輯する
 17993******************************************************************
 17994 DATA-RTN               SECTION.
 17995*--------------------<DEBUG>--------------------------------------
 17996D    DISPLAY  CNS-PGM-ID":***  データ明細編輯 START  ***"
 17997*-----------------------------------------------------------------
 17998*----------  (メッセージコード)
 17999     MOVE  CNS-BL0001
 18000       TO  MSG-CODE          OF  WK-REC
 18001*----------  自社コード(出力側)
 18002     MOVE  CNS-RS
 18003       TO  ZISYA-CODE        OF  WK-REC
 18004*******         テーマ3406     20130117 修正  開始        ********
 18005*----------  ポートフォリオコード
 18006*------ ワーク業務タスクID＝"T6820US"(ＳＢＡ残高データ接続)の場合
 18007     IF  WK-GYOMU-TASK-ID     OF  WK-ARGUMENT
 18008         =  CNS-SBA-ZANDAKA-SETUZOKU
 18009     THEN
 18010*------------  運用成果残高.ファンドコード
 18011       STRING  H-FUND-CD        OF HST-TBL-SELECT
 18012*------------  運用成果残高.ポートフォリオコード
 18013               H-PTF-CD         OF HST-TBL-SELECT
 18014*------------  運用成果残高.評価系列コード
 18015               H-HYK-KRTU-CD    OF  HST-TBL-SELECT
 18016       DELIMITED                BY  SIZE
 18017       INTO  PTF-CD             OF  WK-REC
 18018       END-STRING
 18019     ELSE
 18020       MOVE  WK-TEMP-PTF-CD     TO  PTF-CD
 18021                                OF  WK-REC
 18022     END-IF
 18023*******         テーマ3406     20130117 修正  終了        ********
 18024*----------  約定/受渡区分
 18025     MOVE  H-YJ-UW-KBN       OF  HST-TBL-SELECT
 18026       TO  YJ-UW-KBN         OF  WK-REC
 18027*----------  残高日付
 18028     MOVE  H-ZANTK-YMD       OF  HST-TBL-SELECT
 18029       TO  ZANTK-YMD         OF  WK-REC
 18030*----------  証券種別
 18031*----------　テーマ3276対応開始
 18032     IF    WK-RIYO-CMP-CD  =  CNS-CMP-1054
 18033       AND WK-GAIBU-MEG-CD =  CNS-MEG-RES1
 18034       AND WK-SEC-SBT-CD   =  CNS-SEC-XMOS
 18035     THEN
 18036       MOVE  CNS-SEC-S
 18037         TO  SEC-SBT-CD      OF  WK-REC
 18038     ELSE
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 312
* MUSR2651.cob                                                     cpy)cpy)y)y)
 18039*------------------ <連結障害841の対応 START>---------------------
 18040       MOVE  WK-SEC-SBT-CD-3
 18041*------------------ <連結障害841の対応 END>-----------------------
 18042         TO  SEC-SBT-CD      OF  WK-REC
 18043     END-IF
 18044*----------　テーマ3276対応終了
 18045*----------  取消フラグ
 18046     IF  H-DEL-KBN NOT = SPACE
 18047     THEN
 18048       MOVE  H-DEL-KBN       OF  HST-TBL-SELECT
 18049         TO  DEL-KBN         OF  WK-REC
 18050     ELSE
 18051       MOVE  CNS-X-0
 18052         TO  DEL-KBN         OF  WK-REC
 18053     END-IF
 18054*----------  確定フラグ
 18055     MOVE  H-KT-KBN          OF  HST-TBL-SELECT
 18056       TO  KT-KBN            OF  WK-REC
 18057*----------  取引通貨
 18058*------------------ <残タスク135の対応 START>---------------------
 18059*--------------------<DEBUG>--------------------------------------
 18060D    DISPLAY  CNS-PGM-ID":WK-TRHK-TUKA=["WK-TRHK-TUKA"]"
 18061D    DISPLAY  CNS-PGM-ID":WK-SEC-SBT-CD-3=["WK-SEC-SBT-CD-3"]"
 18062D    DISPLAY  CNS-PGM-ID":WK-TRHK-TUKA=["WK-TRHK-TUKA"]"
 18063D    DISPLAY  CNS-PGM-ID":WK-CAPITAL-TUKA-CD=["
 18064D             WK-CAPITAL-TUKA-CD"]"
 18065*-----------------------------------------------------------------
 18066     IF  (WK-SEC-SBT-CD-3  = CNS-SKSBT-FBMS
 18067         OR  WK-SEC-SBT-CD-3  = CNS-SKSBT-FSMS
 18068         OR  WK-SEC-SBT-CD-3  = CNS-SKSBT-CBMS
 18069         OR  WK-SEC-SBT-CD-3  = CNS-SKSBT-OOET)
 18070         AND WK-TRHK-TUKA = WK-CAPITAL-TUKA-CD
 18071     THEN
 18072       MOVE  CNS-TEXT-OTH
 18073         TO  TRHK-TUKA                 OF  WK-REC
 18074     ELSE
 18075       EVALUATE  WK-TRHK-TUKA
 18076         WHEN  CNS-TEXT-OTHR
 18077           MOVE  CNS-TEXT-OTH
 18078             TO  TRHK-TUKA             OF  WK-REC
 18079         WHEN   CNS-TEXT-WR
 18080           MOVE  CNS-TEXT-WRD
 18081             TO  TRHK-TUKA             OF  WK-REC
 18082         WHEN   CNS-TEXT-SUPN
 18083           MOVE  CNS-TEXT-SUP
 18084             TO  TRHK-TUKA             OF  WK-REC
 18085         WHEN  OTHER
 18086           MOVE  WK-TRHK-TUKA
 18087             TO  TRHK-TUKA             OF  WK-REC
 18088       END-EVALUATE
 18089     END-IF
 18090*------------------ <残タスク135の対応 END>-----------------------
 18091*--------------------<DEBUG>--------------------------------------
 18092D    DISPLAY  CNS-PGM-ID":取引通貨=["TRHK-TUKA    OF  WK-REC"]"
 18093*-----------------------------------------------------------------
 18094*----------  為替決済通貨
 18095*------------------ <残タスク135の対応 START>---------------------
 18096*--------------------<DEBUG>--------------------------------------
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 313
* MUSR2651.cob                                                     cpy)cpy)y)y)
 18097D    DISPLAY  CNS-PGM-ID":WK-KWS-TH-TUKA-CD=["
 18098D             WK-KWS-TH-TUKA-CD"]"
 18099*-----------------------------------------------------------------
 18100     EVALUATE  WK-KWS-TH-TUKA-CD
 18101       WHEN  CNS-TEXT-OTHR
 18102         MOVE  CNS-TEXT-OTH
 18103           TO  KWS-TH-TUKA-CD        OF  WK-REC
 18104       WHEN  CNS-TEXT-WR
 18105         MOVE  CNS-TEXT-WRD
 18106           TO  KWS-TH-TUKA-CD        OF  WK-REC
 18107       WHEN  CNS-TEXT-SUPN
 18108         MOVE  CNS-TEXT-SUP
 18109           TO  KWS-TH-TUKA-CD        OF  WK-REC
 18110       WHEN  OTHER
 18111         MOVE  WK-KWS-TH-TUKA-CD
 18112           TO  KWS-TH-TUKA-CD        OF  WK-REC
 18113     END-EVALUATE
 18114*------------------ <残タスク135の対応 END>-----------------------
 18115*--------------------<DEBUG>--------------------------------------
 18116D    DISPLAY  CNS-PGM-ID":為替決済通貨=["
 18117D             KWS-TH-TUKA-CD        OF  WK-REC"]"
 18118*-----------------------------------------------------------------
 18119*----------  証券発行元の所属する国
 18120     MOVE  WK-HAKO-CD-2
 18121       TO  HAKO-CD           OF  WK-REC
 18122*----------  銘柄コード体系
 18123     IF  FLG-DEFAULT-KRTU-CD = CNS-1
 18124     THEN
 18125       MOVE  CNS-R
 18126         TO  MEG-CD-GRP           OF  WK-REC
 18127     ELSE
 18128       MOVE  WK-CD-REF-KRTU-CD
 18129         TO  MEG-CD-GRP           OF  WK-REC
 18130     END-IF
 18131*----------  銘柄コード
 18132     MOVE  CNS-1             TO  WK-IDX-C
 18133     MOVE FUNCTION CURRENT-DATE(1:14) TO WK-RUN-SDATETIME
 18134*-------------------<DEBUG>---------------------------------------
 18135     DISPLAY "プログラムID:        ["CNS-PGM-ID"]"                GUT2013
 18136     DISPLAY "セクション:          [DATA-RTN]"                    GUT2013
 18137     DISPLAY "セクションの開始時間:["WK-RUN-SDATETIME"]"          GUT2013
 18138*-----------------------------------------------------------------
 18139     PERFORM                 VARYING  WK-IDX-D
 18140       FROM  CNS-1 BY CNS-1  UNTIL  WK-IDX-D > CNS-20
 18141       IF  WK-GAIBU-MEG-CD1(WK-IDX-D:CNS-1) NOT = SPACE
 18142       THEN
 18143         MOVE  WK-GAIBU-MEG-CD1(WK-IDX-D:CNS-1)
 18144           TO  MEG-CD   OF  WK-REC(WK-IDX-C:CNS-1)
 18145         COMPUTE  WK-IDX-C = WK-IDX-C  +  CNS-1
 18146       ELSE
 18147         CONTINUE
 18148       END-IF
 18149     END-PERFORM
 18150     MOVE FUNCTION CURRENT-DATE(1:14) TO WK-RUN-EDATETIME
 18151*--------------------<DEBUG>--------------------------------------
 18152     DISPLAY "プログラムID:        ["CNS-PGM-ID"]"                GUT2013
 18153     DISPLAY "セクション:          [DATA-RTN]"                    GUT2013
 18154     DISPLAY "セクションの終了時間:["WK-RUN-EDATETIME"]"          GUT2013
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 314
* MUSR2651.cob                                                     cpy)cpy)y)y)
 18155*-----------------------------------------------------------------
 18156
 18157*----------  買建/売建フラグ
 18158     MOVE  H-TATE-FLG        OF  HST-TBL-SELECT
 18159       TO  TATE-FLG          OF  WK-REC
 18160*----------  作成/更新年月日
 18161     MOVE  WK-SHORI-YMD-9
 18162       TO  UPD-YMD           OF  WK-REC
 18163*----------  作成/更新時刻
 18164     MOVE  WK-MAC-DATE-TIME(9:6)
 18165       TO  WK-UPD-TIME
 18166     MOVE  WK-UPD-TIME-9
 18167       TO  UPD-TIME          OF  WK-REC
 18168*----------  約定日
 18169     MOVE  H-TG-YKJ-YMD      OF  HST-TBL-SELECT
 18170       TO  YAKU-NITI         OF  WK-REC
 18171*----------  建玉/約定番号
 18172     MOVE  H-KB-KANRI-ID     OF  HST-TBL-SELECT
 18173       TO  KB-KANRI-ID
 18174                             OF  WK-REC
 18175*----------  カストディコード
 18176     MOVE  WK-CAST-CD-2
 18177       TO  CAST-CD           OF  WK-REC
 18178*----------  保有数量
 18179     MOVE  WK-HOU-SURYO
 18180       TO  WK-18-18-X
 18181     PERFORM  ZERO-COMPUTE-RTN
 18182     COMPUTE  WK-NUM-LENGTH = 25 - WK-NUM-1
 18183     MOVE  WK-18-18-X(WK-NUM-FROM:WK-NUM-LENGTH)
 18184       TO  HOU-SURYO         OF  WK-REC
 18185*----------  数量単位
 18186*----------　テーマ3276対応開始
 18187     IF    WK-RIYO-CMP-CD  =  CNS-CMP-1054
 18188       AND WK-GAIBU-MEG-CD =  CNS-MEG-RES1
 18189       AND WK-SEC-SBT-CD   =  CNS-SEC-XMOS
 18190     THEN
 18191       COMPUTE  WK-SURYO-TANI
 18192           =  H-SURYO-TANI   OF  HST-TBL-SELECT
 18193           /  WK-KANRI-SURYO-TANI  /  CNS-10
 18194     ELSE
 18195       COMPUTE  WK-SURYO-TANI
 18196           =  H-SURYO-TANI   OF  HST-TBL-SELECT
 18197           /  WK-KANRI-SURYO-TANI
 18198     END-IF
 18199*----------　テーマ3276対応終了
 18200     MOVE  WK-SURYO-TANI
 18201       TO  WK-18-18-X
 18202     PERFORM  ZERO-COMPUTE-RTN
 18203     COMPUTE  WK-NUM-LENGTH = 25 - WK-NUM-1
 18204     MOVE  WK-18-18-X(WK-NUM-FROM:WK-NUM-LENGTH)
 18205       TO  SURYO-TANI        OF  WK-REC
 18206*----------  取得金額(取引通貨)
 18207     MOVE  WK-THTK-ST-KNG
 18208       TO  WK-18-18-X
 18209     PERFORM  ZERO-COMPUTE-RTN
 18210     COMPUTE  WK-NUM-LENGTH = 22 - WK-NUM-1
 18211     MOVE  WK-18-18-X(WK-NUM-FROM:WK-NUM-LENGTH)
 18212       TO  THTK-ST-KNG       OF  WK-REC
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 315
* MUSR2651.cob                                                     cpy)cpy)y)y)
 18213*----------  取得単価(取引通貨)
 18214*----------　テーマ3276対応開始
 18215     IF    WK-RIYO-CMP-CD  =  CNS-CMP-1054
 18216       AND WK-GAIBU-MEG-CD =  CNS-MEG-RES1
 18217       AND WK-SEC-SBT-CD   =  CNS-SEC-XMOS
 18218     THEN
 18219       COMPUTE  WK-ITIOKU-TNK =
 18220             H-THTK-ST-TNK   OF  HST-TBL-SELECT  *  CNS-10
 18221       MOVE  WK-ITIOKU-TNK
 18222         TO  WK-18-18-X
 18223     ELSE
 18224       MOVE  WK-THTK-ST-TNK
 18225         TO  WK-18-18-X
 18226     END-IF
 18227*----------　テーマ3276対応終了
 18228     PERFORM  ZERO-COMPUTE-RTN
 18229     COMPUTE  WK-NUM-LENGTH = 29 - WK-NUM-1
 18230     MOVE  WK-18-18-X(WK-NUM-FROM:WK-NUM-LENGTH)
 18231       TO  THTK-ST-TNK       OF  WK-REC
 18232*----------  時価(取引通貨)
 18233*----------　テーマ3276対応開始
 18234     IF    WK-RIYO-CMP-CD  =  CNS-CMP-1054
 18235       AND WK-GAIBU-MEG-CD =  CNS-MEG-RES1
 18236       AND WK-SEC-SBT-CD   =  CNS-SEC-XMOS
 18237     THEN
 18238       COMPUTE  WK-ITIOKU-CP = WK-CP-KRTU-CD * CNS-10
 18239       MOVE  WK-ITIOKU-CP
 18240         TO  WK-18-18-X
 18241     ELSE
 18242       MOVE  WK-CP-KRTU-CD
 18243         TO  WK-18-18-X
 18244     END-IF
 18245*----------　テーマ3276対応終了
 18246     PERFORM  ZERO-COMPUTE-RTN
 18247     COMPUTE  WK-NUM-LENGTH = 29 - WK-NUM-1
 18248     MOVE  WK-18-18-X(WK-NUM-FROM:WK-NUM-LENGTH)
 18249       TO  CP-KRTU-CD        OF  WK-REC
 18250*----------  時価採用日付
 18251     MOVE  H-CP-SAIYO-YMD    OF  HST-TBL-SELECT
 18252       TO  CP-SAIYO-YMD      OF  WK-REC
 18253*----------  時価採用市場
 18254     MOVE  H-CP-SAIYO-SIJO   OF  HST-TBL-SELECT
 18255       TO  CP-SAIYO-SIJO     OF  WK-REC
 18256*----------  評価金額(取引通貨)
 18257     MOVE  WK-THTK-HYK-KN
 18258       TO  WK-18-18-X
 18259     PERFORM  ZERO-COMPUTE-RTN
 18260     COMPUTE  WK-NUM-LENGTH = 22 - WK-NUM-1
 18261     MOVE  WK-18-18-X(WK-NUM-FROM:WK-NUM-LENGTH)
 18262       TO  THTK-HYK-KN       OF  WK-REC
 18263*----------  評価損益(取引通貨)
 18264     MOVE  H-THTK-HYK-SNEKI  OF  HST-TBL-SELECT
 18265       TO  WK-18-18-X
 18266     PERFORM  ZERO-COMPUTE-RTN
 18267     COMPUTE  WK-NUM-LENGTH = 22 - WK-NUM-1
 18268     MOVE  WK-18-18-X(WK-NUM-FROM:WK-NUM-LENGTH)
 18269       TO  THTK-HYK-SNEKI    OF  WK-REC
 18270*----------  前払金残(取引通貨)
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 316
* MUSR2651.cob                                                     cpy)cpy)y)y)
 18271     MOVE  H-THTK-PPAYZN     OF  HST-TBL-SELECT
 18272       TO  WK-18-18-X
 18273     PERFORM  ZERO-COMPUTE-RTN
 18274     COMPUTE  WK-NUM-LENGTH = 22 - WK-NUM-1
 18275     MOVE  WK-18-18-X(WK-NUM-FROM:WK-NUM-LENGTH)
 18276       TO  THTK-PPAYZN       OF  WK-REC
 18277*----------  経過利息金額(取引通貨)
 18278     MOVE  H-THTK-KKRS       OF  HST-TBL-SELECT
 18279       TO  WK-18-18-X
 18280     PERFORM  ZERO-COMPUTE-RTN
 18281     COMPUTE  WK-NUM-LENGTH = 25 - WK-NUM-1
 18282     MOVE  WK-18-18-X(WK-NUM-FROM:WK-NUM-LENGTH)
 18283       TO  THTK-KKRS         OF  WK-REC
 18284*----------  未収収益(取引通貨)
 18285*----------　テーマ3344対応開始
 18286     IF    ( WK-SYOHIN-KBN = CNS-SYOHIN-KBN-11
 18287       OR    WK-SYOHIN-KBN = CNS-SYOHIN-KBN-24 )
 18288       AND   TATE-FLG        OF  WK-REC = CNS-TATE-FLG-S
 18289     THEN
 18290       COMPUTE  WK-THTK-MS-EKI
 18291             =  H-THTK-MS-EKI  OF  HST-TBL-SELECT * (-1)
 18292       MOVE  WK-THTK-MS-EKI  TO  WK-18-18-X
 18293     ELSE
 18294       MOVE  H-THTK-MS-EKI   OF  HST-TBL-SELECT
 18295         TO  WK-18-18-X
 18296     END-IF
 18297*----------　テーマ3344対応終了
 18298     PERFORM  ZERO-COMPUTE-RTN
 18299     COMPUTE  WK-NUM-LENGTH = 22 - WK-NUM-1
 18300     MOVE  WK-18-18-X(WK-NUM-FROM:WK-NUM-LENGTH)
 18301       TO  THTK-MS-EKI       OF  WK-REC
 18302*----------  評価為替レート
 18303     MOVE  WK-HYK-KWS
 18304       TO  WK-18-18-X
 18305     PERFORM  ZERO-COMPUTE-RTN
 18306     COMPUTE  WK-NUM-LENGTH = 29 - WK-NUM-1
 18307     MOVE  WK-18-18-X(WK-NUM-FROM:WK-NUM-LENGTH)
 18308       TO  HYK-KWS           OF  WK-REC
 18309*----------  為替採用日付
 18310     MOVE  H-KWS-SAIYO-YMD   OF  HST-TBL-SELECT
 18311       TO  KWS-SAIYO-YMD     OF  WK-REC
 18312*----------  為替採用ソース
 18313     MOVE  H-KWS-SAIYO-SOURCE
 18314                             OF  HST-TBL-SELECT
 18315       TO  KWS-SAIYO-SOURCE  OF  WK-REC
 18316*----------  取得金額(運用通貨)
 18317     MOVE  H-SHTK-KN-LC      OF  HST-TBL-SELECT
 18318       TO  WK-18-18-X
 18319     PERFORM  ZERO-COMPUTE-RTN
 18320     COMPUTE  WK-NUM-LENGTH = 22 - WK-NUM-1
 18321     MOVE  WK-18-18-X(WK-NUM-FROM:WK-NUM-LENGTH)
 18322       TO  SHTK-KN-LC        OF  WK-REC
 18323*----------  取得金額(運用通貨為替換算額)
 18324     MOVE  SHTK-KN-LC        OF  WK-REC
 18325       TO  UYTK-KWS-BOKAZN   OF  WK-REC
 18326*----------  取得単価(運用通貨)
 18327*----------　テーマ3276対応開始
 18328     IF    WK-RIYO-CMP-CD  =  CNS-CMP-1054
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 317
* MUSR2651.cob                                                     cpy)cpy)y)y)
 18329       AND WK-GAIBU-MEG-CD =  CNS-MEG-RES1
 18330       AND WK-SEC-SBT-CD   =  CNS-SEC-XMOS
 18331     THEN
 18332       COMPUTE  WK-ITIOKU-ST-TNK =
 18333             H-UYTK-ST-TNK   OF  HST-TBL-SELECT * CNS-10
 18334       MOVE  WK-ITIOKU-ST-TNK
 18335         TO  WK-18-18-X
 18336     ELSE
 18337       MOVE  H-UYTK-ST-TNK   OF  HST-TBL-SELECT
 18338         TO  WK-18-18-X
 18339     END-IF
 18340*----------　テーマ3276対応終了
 18341     PERFORM  ZERO-COMPUTE-RTN
 18342     COMPUTE  WK-NUM-LENGTH = 29 - WK-NUM-1
 18343     MOVE  WK-18-18-X(WK-NUM-FROM:WK-NUM-LENGTH)
 18344       TO  UYTK-ST-TNK       OF  WK-REC
 18345*----------  評価金額(運用通貨)
 18346     MOVE  WK-HYK-KN-LC
 18347       TO  WK-18-18-X
 18348     PERFORM  ZERO-COMPUTE-RTN
 18349     COMPUTE  WK-NUM-LENGTH = 22 - WK-NUM-1
 18350     MOVE  WK-18-18-X(WK-NUM-FROM:WK-NUM-LENGTH)
 18351       TO  HYK-KN-LC         OF  WK-REC
 18352*----------  評価損益(運用通貨)
 18353     MOVE  H-HYK-SNEKI-LC    OF  HST-TBL-SELECT
 18354       TO  WK-18-18-X
 18355     PERFORM  ZERO-COMPUTE-RTN
 18356     COMPUTE  WK-NUM-LENGTH = 22 - WK-NUM-1
 18357     MOVE  WK-18-18-X(WK-NUM-FROM:WK-NUM-LENGTH)
 18358       TO  HYK-SNEKI-LC      OF  WK-REC
 18359*----------  前払金残(運用通貨)
 18360     MOVE  H-UYTK-PPAY-ZN    OF  HST-TBL-SELECT
 18361       TO  WK-18-18-X
 18362     PERFORM  ZERO-COMPUTE-RTN
 18363     COMPUTE  WK-NUM-LENGTH = 22 - WK-NUM-1
 18364     MOVE  WK-18-18-X(WK-NUM-FROM:WK-NUM-LENGTH)
 18365       TO  UYTK-PPAY-ZN      OF  WK-REC
 18366*----------  経過利息金額(運用通貨)
 18367     MOVE  H-KEKA-RSK-LC     OF  HST-TBL-SELECT
 18368       TO  WK-18-18-X
 18369     PERFORM  ZERO-COMPUTE-RTN
 18370     COMPUTE  WK-NUM-LENGTH = 25 - WK-NUM-1
 18371     MOVE  WK-18-18-X(WK-NUM-FROM:WK-NUM-LENGTH)
 18372       TO  KEKA-RSK-LC       OF  WK-REC
 18373*----------  未収収益(運用通貨)
 18374*----------　テーマ3344対応開始
 18375     IF    ( WK-SYOHIN-KBN = CNS-SYOHIN-KBN-11
 18376       OR    WK-SYOHIN-KBN = CNS-SYOHIN-KBN-24 )
 18377       AND   TATE-FLG        OF  WK-REC = CNS-TATE-FLG-S
 18378     THEN
 18379       COMPUTE  WK-UYTK-MS-EKI
 18380             =  H-UYTK-MS-EKI  OF  HST-TBL-SELECT * (-1)
 18381       MOVE  WK-UYTK-MS-EKI  TO  WK-18-18-X
 18382     ELSE
 18383       MOVE  H-UYTK-MS-EKI   OF  HST-TBL-SELECT
 18384         TO  WK-18-18-X
 18385     END-IF
 18386*----------　テーマ3344対応終了
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 318
* MUSR2651.cob                                                     cpy)cpy)y)y)
 18387     PERFORM  ZERO-COMPUTE-RTN
 18388     COMPUTE  WK-NUM-LENGTH = 22 - WK-NUM-1
 18389     MOVE  WK-18-18-X(WK-NUM-FROM:WK-NUM-LENGTH)
 18390       TO  UYTK-MS-EKI       OF  WK-REC
 18391*----------  送付側銘柄コード
 18392     MOVE  MEG-CD            OF  WK-REC
 18393       TO  SEND-MEG-CD       OF  WK-REC
 18394*----------  銘柄名称(日本語)
 18395     MOVE  WK-MEG-MEI-JP
 18396       TO  MEG-MEI-JP        OF  WK-REC
 18397*----------  銘柄名称(英語)
 18398     MOVE  WK-MEG-MEI-EN
 18399       TO  MEG-MEI-EN        OF  WK-REC
 18400*----------  債券ｸｰﾎﾟﾝ
 18401     MOVE  WK-SAKEN-KP-KBN
 18402       TO  WK-18-18-X
 18403     PERFORM  ZERO-COMPUTE-RTN
 18404     COMPUTE  WK-NUM-LENGTH = 25 - WK-NUM-1
 18405     MOVE  WK-18-18-X(WK-NUM-FROM:WK-NUM-LENGTH)
 18406       TO  SK-KP             OF  WK-REC
 18407*----------  債券償還日
 18408     MOVE  WK-SAKEN-SK-YMD
 18409       TO  SHOKAN-YMD        OF  WK-REC
 18410*----------  備考１
 18411     MOVE  WK-BIKOU-1
 18412       TO  BIKOU-1           OF  WK-REC
 18413*----------  備考２
 18414     MOVE  H-BIKOU-2         OF  HST-TBL-SELECT
 18415       TO  BIKOU-2           OF  WK-REC
 18416*----------  備考３
 18417     MOVE  H-BIKOU-3         OF  HST-TBL-SELECT
 18418       TO  BIKOU-3           OF  WK-REC
 18419*----------  備考４
 18420     MOVE  H-BIKOU-4         OF  HST-TBL-SELECT
 18421       TO  BIKOU-4           OF  WK-REC
 18422*----------  備考５
 18423     MOVE  H-BIKOU-5         OF  HST-TBL-SELECT
 18424       TO  WK-18-18-X
 18425     PERFORM  ZERO-COMPUTE-RTN
 18426     COMPUTE  WK-NUM-LENGTH = 25 - WK-NUM-1
 18427     MOVE  WK-18-18-X(WK-NUM-FROM:WK-NUM-LENGTH)
 18428       TO  BIKOU-5           OF  WK-REC
 18429*----------  備考６
 18430     MOVE  H-BIKOU-6         OF  HST-TBL-SELECT
 18431       TO  WK-18-18-X
 18432     PERFORM  ZERO-COMPUTE-RTN
 18433     COMPUTE  WK-NUM-LENGTH = 25 - WK-NUM-1
 18434     MOVE  WK-18-18-X(WK-NUM-FROM:WK-NUM-LENGTH)
 18435       TO  BIKOU-6           OF  WK-REC
 18436*----------  備考７
 18437     MOVE  H-BIKOU-7         OF  HST-TBL-SELECT
 18438       TO  WK-18-18-X
 18439     PERFORM  ZERO-COMPUTE-RTN
 18440     COMPUTE  WK-NUM-LENGTH = 25 - WK-NUM-1
 18441     MOVE  WK-18-18-X(WK-NUM-FROM:WK-NUM-LENGTH)
 18442       TO  BIKOU-7           OF  WK-REC
 18443*----------  備考８
 18444     MOVE  H-BIKOU-8         OF  HST-TBL-SELECT
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 319
* MUSR2651.cob                                                     cpy)cpy)y)y)
 18445       TO  WK-18-18-X
 18446     PERFORM  ZERO-COMPUTE-RTN
 18447     COMPUTE  WK-NUM-LENGTH = 29 - WK-NUM-1
 18448     MOVE  WK-18-18-X(WK-NUM-FROM:WK-NUM-LENGTH)
 18449       TO  BIKOU-8           OF  WK-REC
 18450*----------  備考９
 18451     MOVE  H-BIKOU-9         OF  HST-TBL-SELECT
 18452       TO  WK-18-18-X
 18453     PERFORM  ZERO-COMPUTE-RTN
 18454     COMPUTE  WK-NUM-LENGTH = 25 - WK-NUM-1
 18455     MOVE  WK-18-18-X(WK-NUM-FROM:WK-NUM-LENGTH)
 18456       TO  BIKOU-9           OF  WK-REC
 18457*--------------------<DEBUG>--------------------------------------
 18458D    DISPLAY  CNS-PGM-ID":(メッセージコード)=["MSG-CODE  OF
 18459D                                                  WK-REC"]"
 18460D    DISPLAY  CNS-PGM-ID":自社コード(出力側)=["ZISYA-CODE  OF
 18461D                                                  WK-REC"]"
 18462D    DISPLAY  CNS-PGM-ID":ポートフォリオコード=["PTF-CD
 18463D                                  OF  WK-REC "]"
 18464D    DISPLAY  CNS-PGM-ID":約定/受渡区分=["YJ-UW-KBN
 18465D                                  OF  WK-REC "]"
 18466D    DISPLAY  CNS-PGM-ID":残高日付=["ZANTK-YMD
 18467D                                  OF  WK-REC "]"
 18468D    DISPLAY  CNS-PGM-ID":証券種別=["SEC-SBT-CD
 18469D                                  OF  WK-REC "]"
 18470D    DISPLAY  CNS-PGM-ID":取消フラグ=["DEL-KBN
 18471D                                  OF  WK-REC "]"
 18472D    DISPLAY  CNS-PGM-ID":確定フラグ=["KT-KBN
 18473D                                  OF  WK-REC "]"
 18474D    DISPLAY  CNS-PGM-ID":取引通貨=["TRHK-TUKA
 18475D                                  OF  WK-REC "]"
 18476D    DISPLAY  CNS-PGM-ID":為替決済通貨=["KWS-TH-TUKA-CD
 18477D                                  OF  WK-REC "]"
 18478D    DISPLAY  CNS-PGM-ID":証券発行元の所属する国=["HAKO-CD
 18479D                                  OF  WK-REC "]"
 18480D    DISPLAY  CNS-PGM-ID":銘柄コード体系=["MEG-CD-GRP
 18481D                                  OF  WK-REC "]"
 18482D    DISPLAY  CNS-PGM-ID":銘柄コード=["MEG-CD
 18483D                                  OF  WK-REC "]"
 18484D    DISPLAY  CNS-PGM-ID":買建/売建フラグ=["TATE-FLG
 18485D                                  OF  WK-REC "]"
 18486D    DISPLAY  CNS-PGM-ID":作成/更新年月日=["UPD-YMD
 18487D                                  OF  WK-REC "]"
 18488D    DISPLAY  CNS-PGM-ID":作成/更新時刻=["UPD-TIME
 18489D                                  OF  WK-REC "]"
 18490D    DISPLAY  CNS-PGM-ID":約定日=["YAKU-NITI
 18491D                                  OF  WK-REC "]"
 18492D    DISPLAY  CNS-PGM-ID":建玉/約定番号=["KB-KANRI-ID
 18493D                                  OF  WK-REC "]"
 18494D    DISPLAY  CNS-PGM-ID":カストディコード=["CAST-CD
 18495D                                  OF  WK-REC "]"
 18496D    DISPLAY  CNS-PGM-ID":保有数量=["HOU-SURYO
 18497D                                  OF  WK-REC "]"
 18498D    DISPLAY  CNS-PGM-ID":数量単位=["SURYO-TANI
 18499D                                  OF  WK-REC "]"
 18500D    DISPLAY  CNS-PGM-ID":取得金額(取引通貨)=["THTK-ST-KNG
 18501D                                  OF  WK-REC "]"
 18502D    DISPLAY  CNS-PGM-ID":取得単価(取引通貨)=["THTK-ST-TNK
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 320
* MUSR2651.cob                                                     cpy)cpy)y)y)
 18503D                                  OF  WK-REC "]"
 18504D    DISPLAY  CNS-PGM-ID":時価(取引通貨)=["CP-KRTU-CD
 18505D                                  OF  WK-REC "]"
 18506D    DISPLAY  CNS-PGM-ID":時価採用日付=["CP-SAIYO-YMD
 18507D                                  OF  WK-REC "]"
 18508D    DISPLAY  CNS-PGM-ID":時価採用市場=["CP-SAIYO-SIJO
 18509D                                  OF  WK-REC "]"
 18510D    DISPLAY  CNS-PGM-ID":評価金額(取引通貨)=["THTK-HYK-KN
 18511D                                  OF  WK-REC "]"
 18512D    DISPLAY  CNS-PGM-ID":評価損益(取引通貨)="
 18513D                                         "["THTK-HYK-SNEKI
 18514D                                  OF  WK-REC "]"
 18515D    DISPLAY  CNS-PGM-ID":前払金残(取引通貨)=["THTK-PPAYZN
 18516D                                  OF  WK-REC "]"
 18517D    DISPLAY  CNS-PGM-ID":経過利息(取引通貨)=["THTK-KKRS
 18518D                                  OF  WK-REC "]"
 18519D    DISPLAY  CNS-PGM-ID":未収収益(取引通貨)=["THTK-MS-EKI
 18520D                                  OF  WK-REC "]"
 18521D    DISPLAY  CNS-PGM-ID":評価為替レート=["HYK-KWS
 18522D                                  OF  WK-REC "]"
 18523D    DISPLAY  CNS-PGM-ID":為替採用日付=["KWS-SAIYO-YMD
 18524D                                  OF  WK-REC "]"
 18525D    DISPLAY  CNS-PGM-ID":為替採用ソース=["KWS-SAIYO-SOURCE
 18526D                                  OF  WK-REC "]"
 18527D    DISPLAY  CNS-PGM-ID":取得金額(運用通貨為替換算額)="
 18528D                                     "["UYTK-KWS-BOKAZN
 18529D                                  OF  WK-REC "]"
 18530D    DISPLAY  CNS-PGM-ID":取得金額(運用通貨)=["SHTK-KN-LC
 18531D                                 OF  WK-REC "]"
 18532D    DISPLAY  CNS-PGM-ID":取得単価(運用通貨)=["UYTK-ST-TNK
 18533D                                  OF  WK-REC "]"
 18534D    DISPLAY  CNS-PGM-ID":評価金額(運用通貨)=["HYK-KN-LC
 18535D                                  OF  WK-REC "]"
 18536D    DISPLAY  CNS-PGM-ID":評価損益(運用通貨)=["HYK-SNEKI-LC
 18537D                                  OF  WK-REC "]"
 18538D    DISPLAY  CNS-PGM-ID":前払金残(運用通貨)=["UYTK-PPAY-ZN
 18539D                                  OF  WK-REC "]"
 18540D    DISPLAY  CNS-PGM-ID":経過利息(運用通貨)=["KEKA-RSK-LC
 18541D                                  OF  WK-REC "]"
 18542D    DISPLAY  CNS-PGM-ID":未収収益(運用通貨)=["UYTK-MS-EKI
 18543D                                  OF  WK-REC "]"
 18544D    DISPLAY  CNS-PGM-ID":送付側銘柄コード=["SEND-MEG-CD
 18545D                                  OF  WK-REC "]"
 18546D    DISPLAY  CNS-PGM-ID":銘柄名称(日本語)=["MEG-MEI-JP
 18547D                                  OF  WK-REC "]"
 18548D    DISPLAY  CNS-PGM-ID":銘柄名称(英語)=["MEG-MEI-EN
 18549D                                  OF  WK-REC "]"
 18550D    DISPLAY  CNS-PGM-ID":債券ｸｰﾎﾟﾝ=[" SK-KP
 18551D                                  OF  WK-REC "]"
 18552D    DISPLAY  CNS-PGM-ID":債券償還日=["SHOKAN-YMD
 18553D                                  OF  WK-REC "]"
 18554D    DISPLAY  CNS-PGM-ID":備考１=["BIKOU-1   OF  WK-REC "]"
 18555D    DISPLAY  CNS-PGM-ID":備考２=["BIKOU-2   OF  WK-REC "]"
 18556D    DISPLAY  CNS-PGM-ID":備考３=["BIKOU-3   OF  WK-REC "]"
 18557D    DISPLAY  CNS-PGM-ID":備考４=["BIKOU-4   OF  WK-REC "]"
 18558D    DISPLAY  CNS-PGM-ID":備考５=["BIKOU-5   OF  WK-REC "]"
 18559D    DISPLAY  CNS-PGM-ID":備考６=["BIKOU-6   OF  WK-REC "]"
 18560D    DISPLAY  CNS-PGM-ID":備考７=["BIKOU-7   OF  WK-REC "]"
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 321
* MUSR2651.cob                                                     cpy)cpy)y)y)
 18561D    DISPLAY  CNS-PGM-ID":備考８=["BIKOU-8   OF  WK-REC "]"
 18562D    DISPLAY  CNS-PGM-ID":備考９=["BIKOU-9   OF  WK-REC "]"
 18563*-----------------------------------------------------------------
 18564*--------------------<DEBUG>--------------------------------------
 18565D    DISPLAY  CNS-PGM-ID":*** データ明細編輯 END  ***"
 18566*-----------------------------------------------------------------
 18567     CONTINUE.
 18568 DATA-EXT.
 18569     EXIT.
 18570*****************************************************************
 18571*   外部コード取得処理
 18572*****************************************************************
 18573 GAIBU-PTF-CD-RTN       SECTION.
 18574*--------------------<DEBUG>--------------------------------------
 18575D    DISPLAY  CNS-PGM-ID":***  外部コード取得処理  ***"
 18576*-----------------------------------------------------------------
 18577     INITIALIZE  PARM-SCZY4182-INOUT
 18578                 PARM-RTNPKG
 18579                 WK-TEMP-PTF-CD
 18580*----------  利用会社コード
 18581     MOVE  WK-RIYO-CMP-CD
 18582       TO  RIYO-CMP-CD            OF  PARM-SCZY4182-ARG1
 18583*----------  コード種類
 18584     MOVE  CNS-X-10
 18585       TO  CD-SHRU                OF  PARM-SCZY4182-ARG1
 18586*----------  コードリファレンス系列コード
 18587     MOVE  CNS-D001
 18588       TO  CD-REF-KRTU-CD         OF  PARM-SCZY4182-ARG1
 18589*----------  業務タスクID
 18590     MOVE  WK-GYOMU-TASK-ID
 18591       TO  GYOMU-TASK-ID          OF  PARM-SCZY4182-ARG1
 18592*----------  変換元コード
 18593     STRING  WK-FUND-CD-DETAIL    OF  WK-FUND-PTF-DETAIL(WK-IDX-J)
 18594             WK-PTF-CD-DETAIL     OF  WK-FUND-PTF-DETAIL(WK-IDX-J)
 18595             WK-DEFAUL-THYK-CD    OF  WK-FUND-PTF-DETAIL(WK-IDX-J)
 18596       INTO  NAIBU-CD             OF  PARM-SCZY4182-ARG1
 18597     END-STRING
 18598*----------  基準日
 18599     MOVE  H-ZANTK-YMD            OF  HST-TBL-SELECT-2
 18600       TO  KJN-YMD                OF  PARM-SCZY4182-ARG1
 18601*--------------------<DEBUG>--------------------------------------
 18602D    DISPLAY  CNS-PGM-ID":FUND-CD=["
 18603D          WK-FUND-CD-DETAIL   OF  WK-FUND-PTF-DETAIL(WK-IDX-J)"]"
 18604D    DISPLAY  CNS-PGM-ID":PTF-CD=["
 18605D          WK-PTF-CD-DETAIL    OF  WK-FUND-PTF-DETAIL(WK-IDX-J)"]"
 18606D    DISPLAY  CNS-PGM-ID":SCZY4182-ARG:"
 18607D    DISPLAY  CNS-PGM-ID":利用会社コード=["
 18608D             RIYO-CMP-CD         OF  PARM-SCZY4182-ARG1"]"
 18609D    DISPLAY  CNS-PGM-ID":コード種類=["
 18610D             CD-SHRU             OF  PARM-SCZY4182-ARG1"]"
 18611D    DISPLAY  CNS-PGM-ID":コードリファレンス系列コード=["
 18612D             CD-REF-KRTU-CD      OF  PARM-SCZY4182-ARG1"]"
 18613D    DISPLAY  CNS-PGM-ID":業務タスクID=["
 18614D             GYOMU-TASK-ID       OF  PARM-SCZY4182-ARG1"]"
 18615D    DISPLAY  CNS-PGM-ID":変換元コード=["
 18616D             NAIBU-CD            OF  PARM-SCZY4182-ARG1"]"
 18617D    DISPLAY  CNS-PGM-ID":基準日=["
 18618D             KJN-YMD             OF  PARM-SCZY4182-ARG1"]"
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 322
* MUSR2651.cob                                                     cpy)cpy)y)y)
 18619D    DISPLAY  CNS-PGM-ID":***  CALL SCZY4182 START  ***"
 18620*-----------------------------------------------------------------
 18621     CALL  "SCZY4182"             USING  PARM-SCZY4182-INOUT
 18622                                         PARM-RTNPKG
 18623*--------------------<DEBUG>--------------------------------------
 18624D    DISPLAY  CNS-PGM-ID":***  CALL SCZY4182 END  ***"
 18625D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY4182)       =["
 18626D             RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)"]"
 18627D    DISPLAY  CNS-PGM-ID":COUNTER OF PARM-RTNPKG =["
 18628D             COUNTER             OF PARM-RTNPKG "]"
 18629*-----------------------------------------------------------------
 18630     EVALUATE  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
 18631       WHEN  CNS-RTN-000
 18632       WHEN  CNS-RTN-002
 18633         MOVE  GAIBU-CD           OF  SAKI-AREA(CNS-1)(1:20)
 18634           TO  WK-TEMP-PTF-CD
 18635*--------------------<DEBUG>--------------------------------------
 18636D    DISPLAY  CNS-PGM-ID":外部コード         =["WK-TEMP-PTF-CD"]"
 18637D    DISPLAY  CNS-PGM-ID":外部コード取得処理  正常"
 18638*-----------------------------------------------------------------
 18639       WHEN  CNS-RTN-110
 18640         MOVE  CNS-ON           TO  FLG-FETCH-END2
 18641*--------------------<DEBUG>--------------------------------------
 18642D    DISPLAY  CNS-PGM-ID":FLG-FETCH-END2   =["FLG-FETCH-END2"]"
 18643*-----------------------------------------------------------------
 18644       WHEN  CNS-RTN-800
 18645*--------------------<DEBUG>--------------------------------------
 18646D    DISPLAY  CNS-PGM-ID":外部コード取得処理  業務エラー"
 18647*-----------------------------------------------------------------
 18648         MOVE  CNS-ON           TO  FLG-FETCH-END2
 18649*--------------------<DEBUG>--------------------------------------
 18650D    DISPLAY  CNS-PGM-ID":FLG-FETCH-END2   =["FLG-FETCH-END2"]"
 18651*-----------------------------------------------------------------
 18652*----------  ワーク実行ステータス
 18653         IF  WK-STATUS < CNS-4
 18654         THEN
 18655           MOVE  CNS-4                 TO  WK-STATUS
 18656         ELSE
 18657           CONTINUE
 18658         END-IF
 18659*----------  ワークリターンコード
 18660         IF  WK-STATUS > WK-RTN-CODE
 18661         THEN
 18662           MOVE  WK-STATUS           TO  WK-RTN-CODE
 18663         ELSE
 18664           CONTINUE
 18665         END-IF
 18666*----------  1190実行ステータス
 18667         IF  WK-STATUS > WK-1190-STATUS
 18668         THEN
 18669           MOVE  WK-STATUS      TO  WK-1190-STATUS
 18670         ELSE
 18671           CONTINUE
 18672         END-IF
 18673*-------------------<DEBUG>---------------------------------------
 18674D    DISPLAY  CNS-PGM-ID":WK-J=["WK-J"]"
 18675*-----------------------------------------------------------------
 18676         COMPUTE  WK-J = WK-J + CNS-1
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 323
* MUSR2651.cob                                                     cpy)cpy)y)y)
 18677*-------------------<DEBUG>---------------------------------------
 18678D    DISPLAY  CNS-PGM-ID":WK-J=["WK-J"]"
 18679*-----------------------------------------------------------------
 18680*----------  基準日実行ステータス
 18681*---------- ファンドコード
 18682         MOVE  WK-FUND-CD-DETAIL  OF  WK-FUND-PTF-DETAIL(WK-IDX-J)
 18683           TO  WK-GYOMU-FUND-CD
 18684                   OF  WK-GYOMU-ERR-INFO(WK-J)
 18685*---------- ポートフォリオコード
 18686         MOVE  WK-PTF-CD-DETAIL   OF  WK-FUND-PTF-DETAIL(WK-IDX-J)
 18687           TO  WK-GYOMU-PTF-CD
 18688                   OF  WK-GYOMU-ERR-INFO(WK-J)
 18689*---------- 評価系列コード
 18690         MOVE  WK-DEFAUL-THYK-CD  OF  WK-FUND-PTF-DETAIL(WK-IDX-J)
 18691            TO  WK-GYOMU-HYK-KRTU-CD
 18692                   OF  WK-GYOMU-ERR-INFO(WK-J)
 18693*---------- 基準日From
 18694         MOVE  WK-KIKAN-FR
 18695           TO  WK-GYOMU-KJN-YMD-FROM
 18696                   OF  WK-GYOMU-ERR-INFO(WK-J)
 18697*---------- 基準日To
 18698         MOVE  WK-KIKAN-TO
 18699           TO  WK-GYOMU-KJN-YMD-TO
 18700                   OF  WK-GYOMU-ERR-INFO(WK-J)
 18701*---------- メッセージID
 18702         MOVE  CNS-MSG-E000189
 18703           TO  WK-GYOMU-MSG-ID
 18704                   OF  WK-GYOMU-ERR-INFO(WK-J)
 18705*---------- 置換文字
 18706         MOVE  SPACE
 18707           TO  WK-GYOMU-TK-MOJI(WK-J,CNS-1)
 18708*---------- フリーメッセージ
 18709         MOVE  WK-TEMP-MSG
 18710           TO  WK-GYOMU-FREE-MSG
 18711                   OF  WK-GYOMU-ERR-INFO(WK-J)
 18712*----------  明細業務エラーフラグ
 18713         MOVE  CNS-ON             TO  FLG-MEISAI-GYOMU-ERR
 18714       WHEN  OTHER
 18715*--------------------<DEBUG>--------------------------------------
 18716D    DISPLAY  CNS-PGM-ID":外部コード取得処理 システムエラー"
 18717*-----------------------------------------------------------------
 18718*----------  WK-STATUS
 18719       MOVE  CNS-16               TO  WK-STATUS
 18720*----------  1190実行ステータス
 18721       MOVE  CNS-16               TO  WK-1190-STATUS
 18722*----------  ワークリターンコード
 18723       MOVE  CNS-16               TO  WK-RTN-CODE
 18724       PERFORM  SUB-ERR-MSG-RTN
 18725       INITIALIZE  WK-SYS-ERR-INFO
 18726*----------  エラー検知プログラムID
 18727       MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
 18728*----------  ポジション
 18729       MOVE  CNS-POS-024          TO  WK-ERR-POS
 18730*----------  リターンコード
 18731       MOVE  CNS-RTN-901          TO  WK-RTN-CD
 18732*----------  詳細リターンコード
 18733       MOVE  RTN-CD               OF  PARM-RTNPKG
 18734                                      (COUNTER OF PARM-RTNPKG)
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 324
* MUSR2651.cob                                                     cpy)cpy)y)y)
 18735                                  TO  WK-DETAIL-RTN-CD
 18736*----------  詳細リターンコードデコードフラグ
 18737       MOVE  CNS-DETAIL-0         TO  WK-DETAIL-RTN-CD-FLG
 18738*---------- フリーメッセージ
 18739       MOVE  SPACE                TO  WK-FREE-MSG
 18740*----------  エラー情報追加処理
 18741       PERFORM  ERR-INFO-ADD-RTN
 18742     END-EVALUATE
 18743*--------------------<DEBUG>--------------------------------------
 18744D    DISPLAY  CNS-PGM-ID":***  外部コード取得処理 END  ***"
 18745*-----------------------------------------------------------------
 18746     CONTINUE.
 18747 GAIBU-PTF-CD-EXT.
 18748     EXIT.
 18749******************************************************************
 18750*    銘柄属性取得処理
 18751******************************************************************
 18752 SCZY3004-CHAN-RTN      SECTION.
 18753*--------------------<DEBUG>--------------------------------------
 18754D    DISPLAY  CNS-PGM-ID":***  銘柄属性取得処理"
 18755D             " START  ***"
 18756*----------------------------------------------------------------
 18757     INITIALIZE  PARM-SCZY3004-INOUT
 18758                 PARM-RTNPKG
 18759                 WK-MEG-MEI-JP
 18760                 WK-MEG-MEI-EN
 18761                 WK-SAKEN-KP-KBN
 18762                 WK-SAKEN-SK-YMD
 18763                 WK-SISAN-BUNRUI-CD
 18764                 WK-CALL-PUT-KBN
 18765                 WK-MEG-CD-3004
 18766                 WK-RTN-3004
 18767*----------  利用会社コード
 18768     MOVE  WK-RIYO-CMP-CD         OF  WK-ARGUMENT
 18769       TO  RIYO-CMP-CD            OF  PARM-SCZY3004-ARG1
 18770*----------  内部銘柄コード
 18771     MOVE  H-MEG-CD               OF  HST-TBL-SELECT
 18772       TO  NAIBU-MEG-CD           OF  PARM-SCZY3004-ARG1
 18773*---------- 商品分類コード
 18774*---------- 元証券種別コード
 18775*--------------------テーマ2185対応-------------------------------
 18776*----------  銘柄リファレンス系列コード
 18777*    MOVE  I-CD-REF-KRTU-CD         OF  WK-DENBUN-INFO
 18778*      TO  KEIRETU-CD             OF  PARM-SCZY3004-ARG1
 18779*----------  業務タスクID
 18780*    MOVE  WK-GYOMU-TASK-ID       OF  WK-ARGUMENT
 18781*      TO  GYOUMU-TASKU-CD        OF  PARM-SCZY3004-ARG1
 18782*--------------------テーマ2185対応-------------------------------
 18783*----------  基本属性取得用基準日
 18784     MOVE  H-ZANTK-YMD            OF  HST-TBL-SELECT
 18785       TO  KIHON-KIJYUN-BI        OF  PARM-SCZY3004-ARG1
 18786*----------  付加属性取得用基準日
 18787*--------------------<DEBUG>--------------------------------------
 18788D    DISPLAY  CNS-PGM-ID":RIYO-CMP-CD=["
 18789D             RIYO-CMP-CD         OF  PARM-SCZY3004-ARG1"]"
 18790D    DISPLAY  CNS-PGM-ID":NAIBU-MEG-CD=["
 18791D             NAIBU-MEG-CD        OF  PARM-SCZY3004-ARG1"]"
 18792D    DISPLAY  CNS-PGM-ID":SYOUHIN-CD=["
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 325
* MUSR2651.cob                                                     cpy)cpy)y)y)
 18793D             SYOUHIN-CD          OF  PARM-SCZY3004-ARG1"]"
 18794D    DISPLAY  CNS-PGM-ID":SYOUKEN-CD=["
 18795D             SYOUKEN-CD          OF  PARM-SCZY3004-ARG1"]"
 18796D    DISPLAY  CNS-PGM-ID":GEN-SYOUKEN-CD=["
 18797D             GEN-SYOUKEN-CD      OF  PARM-SCZY3004-ARG1"]"
 18798D    DISPLAY  CNS-PGM-ID":MEIGAR-TUKA-CD=["
 18799D             MEIGAR-TUKA-CD      OF  PARM-SCZY3004-ARG1"]"
 18800D    DISPLAY  CNS-PGM-ID":KEIRETU-CD=["
 18801D             KEIRETU-CD          OF  PARM-SCZY3004-ARG1"]"
 18802D    DISPLAY  CNS-PGM-ID":GYOUMU-TASKU-CD=["
 18803D             GYOUMU-TASKU-CD     OF  PARM-SCZY3004-ARG1"]"
 18804D    DISPLAY  CNS-PGM-ID":KIHON-KIJYUN-BI=["
 18805D             KIHON-KIJYUN-BI     OF  PARM-SCZY3004-ARG1"]"
 18806D    DISPLAY  CNS-PGM-ID":FUKA-KIJYUN-BI=["
 18807D             FUKA-KIJYUN-BI      OF  PARM-SCZY3004-ARG1"]"
 18808D    DISPLAY  CNS-PGM-ID":***  CALL SCZY3004 START  ***"
 18809*----------------------------------------------------------------
 18810     CALL  "SCZY3004"             USING  PARM-SCZY3004-INOUT
 18811                                         PARM-RTNPKG
 18812*--------------------<DEBUG>-------------------------------------
 18813D    DISPLAY  CNS-PGM-ID":***  CALL SCZY3004 END  ***"
 18814D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY3004)       =["
 18815D             RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)"]"
 18816D    DISPLAY  CNS-PGM-ID":COUNTER OF PARM-RTNPKG =["
 18817D             COUNTER             OF PARM-RTNPKG "]"
 18818*----------------------------------------------------------------
 18819     MOVE  H-MEG-CD               OF  HST-TBL-SELECT
 18820       TO  WK-MEG-CD-3004
 18821     MOVE  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
 18822       TO  WK-RTN-3004
 18823     EVALUATE  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
 18824*----------  正常
 18825       WHEN  CNS-RTN-000
 18826       WHEN  CNS-RTN-111
 18827       WHEN  CNS-RTN-112
 18828*---------- 銘柄名称(日本語)
 18829         MOVE  MEG-NAME-J         OF  PARM-SCZY3004-ARG2
 18830           TO  WK-MEG-MEI-JP
 18831*---------- 銘柄名称(英語)
 18832         MOVE  MEG-NAME-E         OF  PARM-SCZY3004-ARG2
 18833           TO  WK-MEG-MEI-EN
 18834*---------- 債券ｸｰﾎﾟﾝ
 18835         MOVE  RRT-WARI-RT        OF  PARM-SCZY3004-ARG2
 18836           TO  WK-SAKEN-KP-KBN
 18837*---------- 債券償還日
 18838         MOVE  SHOKAN-YMD         OF  PARM-SCZY3004-ARG2
 18839           TO  WK-SAKEN-SK-YMD
 18840         IF  WK-SAKEN-SK-YMD  =  ZERO
 18841         THEN
 18842*---------- 満期日
 18843           MOVE  MNK-YMD          OF  PARM-SCZY3004-ARG2
 18844             TO  WK-SAKEN-SK-YMD
 18845         ELSE
 18846           CONTINUE
 18847         END-IF
 18848*---------- 資産分類コード
 18849         MOVE  SISAN-BUNRUI-CD    OF  PARM-SCZY3004-ARG2
 18850           TO  WK-SISAN-BUNRUI-CD
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 326
* MUSR2651.cob                                                     cpy)cpy)y)y)
 18851*---------- コールプット区分
 18852         MOVE  CALL-PUT-KBN       OF  PARM-SCZY3004-ARG2
 18853           TO  WK-CALL-PUT-KBN
 18854*---------- 株式種別
 18855         MOVE  RF-KABU-SBT        OF  PARM-SCZY3004-ARG2
 18856           TO  WK-RF-KABU-SBT
 18857*--------------------<DEBUG>--------------------------------------
 18858D    DISPLAY  CNS-PGM-ID":銘柄属性取得処理 正常"
 18859*-----------------------------------------------------------------
 18860*----------  異常
 18861       WHEN  CNS-RTN-110
 18862*---------- 銘柄名称(日本語)
 18863         MOVE  SPACE
 18864           TO  WK-MEG-MEI-JP
 18865*---------- 銘柄名称(英語)
 18866         MOVE  SPACE
 18867           TO  WK-MEG-MEI-EN
 18868*---------- 債券ｸｰﾎﾟﾝ
 18869         MOVE  ZERO
 18870           TO  WK-SAKEN-KP-KBN
 18871*---------- 債券償還日
 18872         MOVE  ZERO
 18873           TO  WK-SAKEN-SK-YMD
 18874*---------- 資産分類コード
 18875         MOVE  SPACE
 18876           TO  WK-SISAN-BUNRUI-CD
 18877*---------- コールプット区分
 18878         MOVE  SPACE
 18879           TO  WK-CALL-PUT-KBN
 18880*---------- 株式種別
 18881         MOVE  SPACE
 18882           TO  WK-RF-KABU-SBT
 18883       WHEN  CNS-RTN-800
 18884*--------------------<DEBUG>--------------------------------------
 18885D    DISPLAY  CNS-PGM-ID":外部コード取得処理  業務エラー"
 18886*-----------------------------------------------------------------
 18887*----------  ワーク実行ステータス
 18888         IF  WK-STATUS < CNS-4
 18889         THEN
 18890           MOVE  CNS-4                 TO  WK-STATUS
 18891         ELSE
 18892           CONTINUE
 18893         END-IF
 18894*----------  ワークリターンコード
 18895         IF  WK-STATUS > WK-RTN-CODE
 18896         THEN
 18897           MOVE  WK-STATUS           TO  WK-RTN-CODE
 18898         ELSE
 18899           CONTINUE
 18900         END-IF
 18901*----------  1190実行ステータス
 18902         IF  WK-STATUS > WK-1190-STATUS
 18903         THEN
 18904           MOVE  WK-STATUS      TO  WK-1190-STATUS
 18905         ELSE
 18906           CONTINUE
 18907         END-IF
 18908*-------------------<DEBUG>---------------------------------------
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 327
* MUSR2651.cob                                                     cpy)cpy)y)y)
 18909D    DISPLAY  CNS-PGM-ID":WK-J=["WK-J"]"
 18910*-----------------------------------------------------------------
 18911         COMPUTE  WK-J = WK-J + CNS-1
 18912*-------------------<DEBUG>---------------------------------------
 18913D    DISPLAY  CNS-PGM-ID":WK-J=["WK-J"]"
 18914*-----------------------------------------------------------------
 18915*----------  基準日実行ステータス
 18916*---------- ファンドコード
 18917         MOVE  WK-FUND-CD-DETAIL  OF  WK-FUND-PTF-DETAIL(WK-IDX-J)
 18918           TO  WK-GYOMU-FUND-CD
 18919                   OF  WK-GYOMU-ERR-INFO(WK-J)
 18920*---------- ポートフォリオコード
 18921         MOVE  WK-PTF-CD-DETAIL   OF  WK-FUND-PTF-DETAIL(WK-IDX-J)
 18922           TO  WK-GYOMU-PTF-CD
 18923                   OF  WK-GYOMU-ERR-INFO(WK-J)
 18924*---------- 評価系列コード
 18925         MOVE  WK-DEFAUL-THYK-CD  OF  WK-FUND-PTF-DETAIL(WK-IDX-J)
 18926            TO  WK-GYOMU-HYK-KRTU-CD
 18927                   OF  WK-GYOMU-ERR-INFO(WK-J)
 18928*---------- 基準日From
 18929         MOVE  WK-KIKAN-FR
 18930           TO  WK-GYOMU-KJN-YMD-FROM
 18931                   OF  WK-GYOMU-ERR-INFO(WK-J)
 18932*---------- 基準日To
 18933         MOVE  WK-KIKAN-TO
 18934           TO  WK-GYOMU-KJN-YMD-TO
 18935                   OF  WK-GYOMU-ERR-INFO(WK-J)
 18936*---------- メッセージID
 18937         MOVE  CNS-MSG-E000189
 18938           TO  WK-GYOMU-MSG-ID
 18939                   OF  WK-GYOMU-ERR-INFO(WK-J)
 18940*---------- 置換文字
 18941         MOVE  SPACE
 18942           TO  WK-GYOMU-TK-MOJI(WK-J,CNS-1)
 18943*---------- フリーメッセージ
 18944         MOVE  WK-TEMP-MSG
 18945           TO  WK-GYOMU-FREE-MSG
 18946                   OF  WK-GYOMU-ERR-INFO(WK-J)
 18947*----------  明細業務エラーフラグ
 18948         MOVE  CNS-ON             TO  FLG-MEISAI-GYOMU-ERR
 18949*----------  上記以外
 18950       WHEN  OTHER
 18951*--------------------<DEBUG>-------------------------------------
 18952D    DISPLAY  CNS-PGM-ID":銘柄属性取得処理  エラー"
 18953*----------------------------------------------------------------
 18954*----------  WK-STATUS
 18955         MOVE  CNS-16              TO  WK-STATUS
 18956*----------  1190実行ステータス
 18957         MOVE  CNS-16              TO  WK-1190-STATUS
 18958*----------  ワークリターンコード
 18959         MOVE  CNS-16              TO  WK-RTN-CODE
 18960*----------  ワークエラーパッケージを編集
 18961         PERFORM  SUB-ERR-MSG-RTN
 18962         INITIALIZE  WK-SYS-ERR-INFO
 18963*----------  エラー検知プログラムID
 18964         MOVE  CNS-PGM-ID         TO  WK-ERR-PGM-ID
 18965*----------  ポジション
 18966         MOVE  CNS-POS-025        TO  WK-ERR-POS
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 328
* MUSR2651.cob                                                     cpy)cpy)y)y)
 18967*----------  リターンコード
 18968         MOVE  CNS-RTN-901        TO  WK-RTN-CD
 18969*----------  詳細リターンコード
 18970         MOVE  RTN-CD             OF  PARM-RTNPKG
 18971                                  (COUNTER OF PARM-RTNPKG)
 18972                                  TO  WK-DETAIL-RTN-CD
 18973*----------  詳細リターンコードデコードフラグ
 18974         MOVE  CNS-DETAIL-0       TO  WK-DETAIL-RTN-CD-FLG
 18975*---------- フリーメッセージ
 18976         MOVE  SPACE              TO  WK-FREE-MSG
 18977*----------  エラー情報追加処理
 18978         PERFORM  ERR-INFO-ADD-RTN
 18979     END-EVALUATE
 18980*--------------------<DEBUG>--------------------------------------
 18981D    DISPLAY  CNS-PGM-ID":銘柄名称(日本語)=["WK-MEG-MEI-JP"]"
 18982D    DISPLAY  CNS-PGM-ID":銘柄名称(英語)=["WK-MEG-MEI-EN"]"
 18983D    DISPLAY  CNS-PGM-ID":債券ｸｰﾎﾟﾝ=["WK-SAKEN-KP-KBN"]"
 18984D    DISPLAY  CNS-PGM-ID":債券償還日=["WK-SAKEN-SK-YMD"]"
 18985D    DISPLAY  CNS-PGM-ID":資産分類コード=["WK-SISAN-BUNRUI-CD"]"
 18986D    DISPLAY  CNS-PGM-ID":コールプット区分=["WK-CALL-PUT-KBN"]"
 18987D    DISPLAY  CNS-PGM-ID":***  銘柄属性取得処理"
 18988D             " END  ***"
 18989*-----------------------------------------------------------------
 18990     CONTINUE.
 18991 SCZY3004-CHAN-EXT.
 18992     EXIT.
 18993******************************************************************
 18994*    内部⇒外部銘柄コード変換処理
 18995******************************************************************
 18996 SCZY3002-CHAN-RTN      SECTION.
 18997*--------------------<DEBUG>--------------------------------------
 18998D    DISPLAY  CNS-PGM-ID":***  内部⇒外部銘柄コード変換処理"
 18999D             " START  ***"
 19000*-----------------------------------------------------------------
 19001     INITIALIZE  PARM-SCZY3002-INOUT
 19002                 PARM-RTNPKG
 19003                 WK-GAIBU-MEG-CD
 19004                 WK-CD-REF-KRTU-CD
 19005                 WK-JS-CD-FLG
 19006                 WK-SEC-SBT-CD
 19007                 WK-HAKO-CD
 19008                 WK-TS-TARGET-KUNI
 19009                 WK-MEG-CD-3002
 19010                 WK-SEC-SBT-3002
 19011                 WK-RTN-3002
 19012*----------  利用会社コード
 19013     MOVE  WK-RIYO-CMP-CD         OF  WK-ARGUMENT
 19014       TO  RIYO-CMP-CD            OF  PARM-SCZY3002-ARG1
 19015*----------  内部銘柄コード
 19016     MOVE  H-MEG-CD               OF  HST-TBL-SELECT
 19017       TO  NAIBU-MEG-CD           OF  PARM-SCZY3002-ARG1
 19018*---------- 商品分類コード
 19019     MOVE  SPACE
 19020       TO  SYOHIN-BUNRUI-CD       OF  PARM-SCZY3002-ARG1
 19021*---------- 証券種別コード
 19022     IF  H-DATA-KBN  =  CNS-X-1
 19023     THEN
 19024       MOVE  SPACE
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 329
* MUSR2651.cob                                                     cpy)cpy)y)y)
 19025         TO  SEC-SBT-CD           OF  PARM-SCZY3002-ARG1
 19026     ELSE
 19027       MOVE  H-SEC-SBT-CD
 19028         TO  SEC-SBT-CD           OF  PARM-SCZY3002-ARG1
 19029     END-IF
 19030*---------- 元証券種別コード
 19031     MOVE  SPACE
 19032       TO  MOTO-SEC-SBT-CD        OF  PARM-SCZY3002-ARG1
 19033*----------  銘柄リファレンス系列コード
 19034     MOVE  I-CD-REF-KRTU-CD       OF  WK-DENBUN-INFO
 19035       TO  CD-REF-KRTU-CD         OF  PARM-SCZY3002-ARG1
 19036*----------  業務タスクID
 19037     MOVE  WK-GYOMU-TASK-ID       OF  WK-ARGUMENT
 19038       TO  GYOMU-TASK-ID          OF  PARM-SCZY3002-ARG1
 19039*----------  基準日
 19040     MOVE  H-ZANTK-YMD            OF  HST-TBL-SELECT
 19041       TO  KJN-YMD                OF  PARM-SCZY3002-ARG1
 19042*--------------------<DEBUG>--------------------------------------
 19043D    DISPLAY  CNS-PGM-ID":RIYO-CMP-CD=["
 19044D             RIYO-CMP-CD         OF  PARM-SCZY3002-ARG1"]"
 19045D    DISPLAY  CNS-PGM-ID":NAIBU-MEG-CD=["
 19046D             NAIBU-MEG-CD        OF  PARM-SCZY3002-ARG1"]"
 19047D    DISPLAY  CNS-PGM-ID":SYOHIN-BUNRUI-CD=["
 19048D             SYOHIN-BUNRUI-CD    OF  PARM-SCZY3002-ARG1"]"
 19049D    DISPLAY  CNS-PGM-ID":テータ区分=["
 19050D             H-DATA-KBN "]"
 19051D    DISPLAY  CNS-PGM-ID":SEC-SBT-CD=["
 19052D             SEC-SBT-CD          OF  PARM-SCZY3002-ARG1"]"
 19053D    DISPLAY  CNS-PGM-ID":MOTO-SEC-SBT-CD=["
 19054D             MOTO-SEC-SBT-CD     OF  PARM-SCZY3002-ARG1"]"
 19055D    DISPLAY  CNS-PGM-ID":MEG-TUKA-CD=["
 19056D             MEG-TUKA-CD         OF  PARM-SCZY3002-ARG1"]"
 19057D    DISPLAY  CNS-PGM-ID":CD-REF-KRTU-CD=["
 19058D             CD-REF-KRTU-CD      OF  PARM-SCZY3002-ARG1"]"
 19059D    DISPLAY  CNS-PGM-ID":KJN-YMD=["
 19060D             KJN-YMD             OF  PARM-SCZY3002-ARG1"]"
 19061D    DISPLAY  CNS-PGM-ID":GYOMU-TASK-ID=["
 19062D             GYOMU-TASK-ID       OF  PARM-SCZY3002-ARG1"]"
 19063D    DISPLAY  CNS-PGM-ID":***  CALL SCZY3002 START  ***"
 19064*-----------------------------------------------------------------
 19065     CALL  "SCZY3002"             USING  PARM-SCZY3002-INOUT
 19066                                         PARM-RTNPKG
 19067*--------------------<DEBUG>--------------------------------------
 19068D    DISPLAY  CNS-PGM-ID":***  CALL SCZY3002 END  ***"
 19069D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY3002)       =["
 19070D             RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)"]"
 19071D    DISPLAY  CNS-PGM-ID":COUNTER OF PARM-RTNPKG =["
 19072D             COUNTER             OF PARM-RTNPKG "]"
 19073*-----------------------------------------------------------------
 19074     MOVE  H-MEG-CD               OF  HST-TBL-SELECT
 19075       TO  WK-MEG-CD-3002
 19076     MOVE  H-SEC-SBT-CD
 19077       TO  WK-SEC-SBT-3002
 19078     MOVE  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
 19079       TO  WK-RTN-3002
 19080     EVALUATE  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
 19081*----------  正常
 19082       WHEN  CNS-RTN-000
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 330
* MUSR2651.cob                                                     cpy)cpy)y)y)
 19083*---------- 外部銘柄コード
 19084         MOVE  GAIBU-MEG-CD          OF  PARM-SCZY3002-ARG2
 19085           TO  WK-GAIBU-MEG-CD
 19086*---------- コードリファレンス系列コード
 19087         MOVE  CD-REF-KRTU-CD        OF  PARM-SCZY3002-ARG2
 19088           TO  WK-CD-REF-KRTU-CD
 19089*---------- 自社コードフラグ
 19090         MOVE  JS-CD-FLG             OF  PARM-SCZY3002-ARG2
 19091           TO  WK-JS-CD-FLG
 19092*---------- 証券種別コード
 19093         MOVE  SEC-SBT-CD            OF  PARM-SCZY3002-ARG2
 19094           TO  WK-SEC-SBT-CD
 19095*---------- 発行体国コード
 19096         MOVE  HAKKO-TAI-KUNI-CD     OF  PARM-SCZY3002-ARG2
 19097           TO  WK-HAKO-CD
 19098*---------- 投資対象国コード
 19099         MOVE  TOUSI-TARGET-KUNI-CD  OF  PARM-SCZY3002-ARG2
 19100           TO  WK-TS-TARGET-KUNI
 19101*--------------------<DEBSUG>-------------------------------------
 19102D    DISPLAY  CNS-PGM-ID":外部銘柄コード=["WK-GAIBU-MEG-CD"]"
 19103D    DISPLAY  CNS-PGM-ID":コードリファレンス系列コード=["
 19104D             WK-CD-REF-KRTU-CD"]"
 19105D    DISPLAY  CNS-PGM-ID":自社コードフラグ=["WK-JS-CD-FLG"]"
 19106D    DISPLAY  CNS-PGM-ID":証券種別コード=["WK-SEC-SBT-CD"]"
 19107D    DISPLAY  CNS-PGM-ID":発行体国コード=["WK-HAKO-CD"]"
 19108D    DISPLAY  CNS-PGM-ID":投資対象国コード=["WK-TS-TARGET-KUNI"]"
 19109D    DISPLAY  CNS-PGM-ID
 19110D          ":外部銘柄コード変換ルーチンをコールする  正常"
 19111*-----------------------------------------------------------------
 19112*----------  異常
 19113       WHEN  CNS-RTN-110
 19114       WHEN  CNS-RTN-002
 19115         PERFORM  SCZY3002-CHAN-3-RTN
 19116       WHEN  CNS-RTN-800
 19117*--------------------<DEBUG>--------------------------------------
 19118D    DISPLAY  CNS-PGM-ID":外部コード取得処理  業務エラー"
 19119*-----------------------------------------------------------------
 19120*----------  ワーク実行ステータス
 19121         IF  WK-STATUS < CNS-4
 19122         THEN
 19123           MOVE  CNS-4                 TO  WK-STATUS
 19124         ELSE
 19125           CONTINUE
 19126         END-IF
 19127*----------  ワークリターンコード
 19128         IF  WK-STATUS > WK-RTN-CODE
 19129         THEN
 19130           MOVE  WK-STATUS           TO  WK-RTN-CODE
 19131         ELSE
 19132           CONTINUE
 19133         END-IF
 19134*----------  1190実行ステータス
 19135         IF  WK-STATUS > WK-1190-STATUS
 19136         THEN
 19137           MOVE  WK-STATUS      TO  WK-1190-STATUS
 19138         ELSE
 19139           CONTINUE
 19140         END-IF
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 331
* MUSR2651.cob                                                     cpy)cpy)y)y)
 19141*-------------------<DEBUG>---------------------------------------
 19142D    DISPLAY  CNS-PGM-ID":WK-J=["WK-J"]"
 19143*-----------------------------------------------------------------
 19144         COMPUTE  WK-J = WK-J + CNS-1
 19145*-------------------<DEBUG>---------------------------------------
 19146D    DISPLAY  CNS-PGM-ID":WK-J=["WK-J"]"
 19147*-----------------------------------------------------------------
 19148*----------  基準日実行ステータス
 19149*---------- ファンドコード
 19150         MOVE  WK-FUND-CD-DETAIL  OF  WK-FUND-PTF-DETAIL(WK-IDX-J)
 19151           TO  WK-GYOMU-FUND-CD
 19152                   OF  WK-GYOMU-ERR-INFO(WK-J)
 19153*---------- ポートフォリオコード
 19154         MOVE  WK-PTF-CD-DETAIL   OF  WK-FUND-PTF-DETAIL(WK-IDX-J)
 19155           TO  WK-GYOMU-PTF-CD
 19156                   OF  WK-GYOMU-ERR-INFO(WK-J)
 19157*---------- 評価系列コード
 19158         MOVE  WK-DEFAUL-THYK-CD  OF  WK-FUND-PTF-DETAIL(WK-IDX-J)
 19159            TO  WK-GYOMU-HYK-KRTU-CD
 19160                   OF  WK-GYOMU-ERR-INFO(WK-J)
 19161*---------- 基準日From
 19162         MOVE  WK-KIKAN-FR
 19163           TO  WK-GYOMU-KJN-YMD-FROM
 19164                   OF  WK-GYOMU-ERR-INFO(WK-J)
 19165*---------- 基準日To
 19166         MOVE  WK-KIKAN-TO
 19167           TO  WK-GYOMU-KJN-YMD-TO
 19168                   OF  WK-GYOMU-ERR-INFO(WK-J)
 19169*---------- メッセージID
 19170         MOVE  CNS-MSG-E000189
 19171           TO  WK-GYOMU-MSG-ID
 19172                   OF  WK-GYOMU-ERR-INFO(WK-J)
 19173*---------- 置換文字
 19174         MOVE  SPACE
 19175           TO  WK-GYOMU-TK-MOJI(WK-J,CNS-1)
 19176*---------- フリーメッセージ
 19177         MOVE  WK-TEMP-MSG
 19178           TO  WK-GYOMU-FREE-MSG
 19179                   OF  WK-GYOMU-ERR-INFO(WK-J)
 19180*----------  明細業務エラーフラグ
 19181         MOVE  CNS-ON             TO  FLG-MEISAI-GYOMU-ERR
 19182*----------  上記以外
 19183       WHEN  OTHER
 19184*--------------------<DEBUG>--------------------------------------
 19185D    DISPLAY  CNS-PGM-ID":内部⇒外部銘柄コード変換処理  エラー"
 19186*-----------------------------------------------------------------
 19187*----------  WK-STATUS
 19188         MOVE  CNS-16              TO  WK-STATUS
 19189*----------  1190実行ステータス
 19190         MOVE  CNS-16              TO  WK-1190-STATUS
 19191*----------  ワークリターンコード
 19192         MOVE  CNS-16              TO  WK-RTN-CODE
 19193*----------  ワークエラーパッケージを編集
 19194         PERFORM  SUB-ERR-MSG-RTN
 19195         INITIALIZE  WK-SYS-ERR-INFO
 19196*----------  エラー検知プログラムID
 19197         MOVE  CNS-PGM-ID         TO  WK-ERR-PGM-ID
 19198*----------  ポジション
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 332
* MUSR2651.cob                                                     cpy)cpy)y)y)
 19199         MOVE  CNS-POS-026        TO  WK-ERR-POS
 19200*----------  リターンコード
 19201         MOVE  CNS-RTN-901        TO  WK-RTN-CD
 19202*----------  詳細リターンコード
 19203         MOVE  RTN-CD             OF  PARM-RTNPKG
 19204                                  (COUNTER OF PARM-RTNPKG)
 19205                                  TO  WK-DETAIL-RTN-CD
 19206*----------  詳細リターンコードデコードフラグ
 19207         MOVE  CNS-DETAIL-0       TO  WK-DETAIL-RTN-CD-FLG
 19208*---------- フリーメッセージ
 19209         MOVE  SPACE              TO  WK-FREE-MSG
 19210*----------  エラー情報追加処理
 19211         PERFORM  ERR-INFO-ADD-RTN
 19212     END-EVALUATE
 19213*--------------------<DEBUG>--------------------------------------
 19214D    DISPLAY  CNS-PGM-ID":***  内部⇒外部銘柄コード変換処理"
 19215D             " END  ***"
 19216*-----------------------------------------------------------------
 19217     CONTINUE.
 19218 SCZY3002-CHAN-EXT.
 19219     EXIT.
 19220******************************************************************
 19221*    国全項目取得
 19222******************************************************************
 19223 SCZY4102-RTN           SECTION.
 19224*--------------------<DEBUG>--------------------------------------
 19225D    DISPLAY  CNS-PGM-ID":***  国全項目取得  START  ***"
 19226*-----------------------------------------------------------------
 19227     INITIALIZE  PARM-SCZY4102-INOUT
 19228                 PARM-RTNPKG
 19229                 WK-HAKO-CD-2
 19230                 WK-HAKO-CD-4102
 19231                 WK-RTN-4102
 19232*----------  利用会社コード
 19233     MOVE  WK-RIYO-CMP-CD         OF  WK-ARGUMENT
 19234       TO  RIYO-CMP-CD            OF  PARM-SCZY4102-ARG1
 19235*----------  国コード
 19236     MOVE  WK-HAKO-CD
 19237       TO  KUNI-CD                OF  PARM-SCZY4102-ARG1
 19238*---------- 適用開始日
 19239     MOVE  H-ZANTK-YMD            OF  HST-TBL-SELECT
 19240       TO  TEKIYO-FROM            OF  PARM-SCZY4102-ARG1
 19241*--------------------<DEBUG>--------------------------------------
 19242D    DISPLAY  CNS-PGM-ID":利用会社コード=["
 19243D             RIYO-CMP-CD         OF  PARM-SCZY4102-ARG1"]"
 19244D    DISPLAY  CNS-PGM-ID":国コード=["
 19245D             KUNI-CD             OF  PARM-SCZY4102-ARG1"]"
 19246D    DISPLAY  CNS-PGM-ID":適用開始日=["
 19247D             TEKIYO-FROM         OF  PARM-SCZY4102-ARG1"]"
 19248D    DISPLAY  CNS-PGM-ID":***  CALL SCZY4102 START  ***"
 19249*-----------------------------------------------------------------
 19250     CALL  "SCZY4102"             USING  PARM-SCZY4102-INOUT
 19251                                         PARM-RTNPKG
 19252*--------------------<DEBUG>--------------------------------------
 19253D    DISPLAY  CNS-PGM-ID":***  CALL SCZY4102 END  ***"
 19254D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY4102)       =["
 19255D             RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)"]"
 19256D    DISPLAY  CNS-PGM-ID":COUNTER OF PARM-RTNPKG =["
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 333
* MUSR2651.cob                                                     cpy)cpy)y)y)
 19257D             COUNTER             OF PARM-RTNPKG "]"
 19258*-----------------------------------------------------------------
 19259     MOVE  WK-HAKO-CD
 19260       TO  WK-HAKO-CD-4102
 19261     MOVE  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
 19262       TO  WK-RTN-4102
 19263     EVALUATE  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
 19264*----------  正常
 19265       WHEN  CNS-RTN-000
 19266*---------- 国コード_略式
 19267         MOVE  KUNI-CD-RYAKU         OF  PARM-SCZY4102-ARG2
 19268           TO  WK-HAKO-CD-2
 19269*--------------------<DEBSUG>-------------------------------------
 19270D    DISPLAY  CNS-PGM-ID":国コード_略式=["WK-HAKO-CD-2"]"
 19271D    DISPLAY  CNS-PGM-ID":国全項目取得  正常"
 19272*-----------------------------------------------------------------
 19273*----------  異常
 19274       WHEN  CNS-RTN-110
 19275*----------  ワーク実行ステータス
 19276*------------------ <残タスク157の対応 START>---------------------
 19277         IF   WK-STATUS < CNS-4
 19278         THEN
 19279           MOVE  CNS-4              TO  WK-STATUS
 19280         ELSE
 19281           CONTINUE
 19282         END-IF
 19283*------------------ <残タスク157の対応 END>-----------------------
 19284*----------  1190実行ステータス
 19285         IF   WK-STATUS > WK-1190-STATUS
 19286         THEN
 19287           MOVE  WK-STATUS      TO  WK-1190-STATUS
 19288         ELSE
 19289           CONTINUE
 19290         END-IF
 19291*----------  ワークリターンコード
 19292         IF  WK-STATUS > WK-RTN-CODE
 19293         THEN
 19294           MOVE  WK-STATUS        TO  WK-RTN-CODE
 19295         ELSE
 19296           CONTINUE
 19297         END-IF
 19298*-------------------<DEBUG>---------------------------------------
 19299D    DISPLAY  CNS-PGM-ID":WK-J=["WK-J"]"
 19300*-----------------------------------------------------------------
 19301         COMPUTE  WK-J = WK-J + CNS-1
 19302*-------------------<DEBUG>---------------------------------------
 19303D    DISPLAY  CNS-PGM-ID":WK-J=["WK-J"]"
 19304*-----------------------------------------------------------------
 19305*---------- ファンドコード
 19306         MOVE  WK-FUND-CD-DETAIL  OF  WK-FUND-PTF-DETAIL(WK-IDX-J)
 19307           TO  WK-GYOMU-FUND-CD   OF
 19308                                  WK-GYOMU-ERR-INFO(WK-J)
 19309*---------- ポートフォリオコード
 19310         MOVE  WK-PTF-CD-DETAIL   OF  WK-FUND-PTF-DETAIL(WK-IDX-J)
 19311           TO  WK-GYOMU-PTF-CD    OF
 19312                                  WK-GYOMU-ERR-INFO(WK-J)
 19313*---------- 評価系列コード
 19314         MOVE  WK-DEFAUL-THYK-CD  OF  WK-FUND-PTF-DETAIL(WK-IDX-J)
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 334
* MUSR2651.cob                                                     cpy)cpy)y)y)
 19315            TO  WK-GYOMU-HYK-KRTU-CD
 19316                   OF  WK-GYOMU-ERR-INFO(WK-J)
 19317*---------- 基準日From
 19318         MOVE  WK-KIKAN-FR
 19319           TO  WK-GYOMU-KJN-YMD-FROM
 19320                                  OF WK-GYOMU-ERR-INFO(WK-J)
 19321*---------- 基準日To
 19322         MOVE  WK-KIKAN-TO
 19323           TO  WK-GYOMU-KJN-YMD-TO
 19324                                  OF WK-GYOMU-ERR-INFO(WK-J)
 19325*---------- メッセージID
 19326         MOVE  CNS-MSG-E000090
 19327           TO  WK-GYOMU-MSG-ID    OF WK-GYOMU-ERR-INFO(WK-J)
 19328*---------- 置換文字
 19329         STRING  CNS-HAKO
 19330                 WK-HAKO-CD
 19331                 DELIMITED BY SPACE
 19332                 INTO  WK-GYOMU-TK-MOJI(WK-J,CNS-1)
 19333         END-STRING
 19334*---------- フリーメッセージ
 19335         MOVE  WK-TEMP-MSG
 19336           TO  WK-GYOMU-FREE-MSG  OF WK-GYOMU-ERR-INFO(WK-J)
 19337*----------  明細業務エラーフラグ
 19338         MOVE  CNS-ON             TO  FLG-MEISAI-GYOMU-ERR
 19339       WHEN  CNS-RTN-800
 19340*--------------------<DEBUG>--------------------------------------
 19341D    DISPLAY  CNS-PGM-ID":外部コード取得処理  業務エラー"
 19342*-----------------------------------------------------------------
 19343*----------  ワーク実行ステータス
 19344         IF  WK-STATUS < CNS-4
 19345         THEN
 19346           MOVE  CNS-4                 TO  WK-STATUS
 19347         ELSE
 19348           CONTINUE
 19349         END-IF
 19350*----------  ワークリターンコード
 19351         IF  WK-STATUS > WK-RTN-CODE
 19352         THEN
 19353           MOVE  WK-STATUS           TO  WK-RTN-CODE
 19354         ELSE
 19355           CONTINUE
 19356         END-IF
 19357*----------  1190実行ステータス
 19358         IF  WK-STATUS > WK-1190-STATUS
 19359         THEN
 19360           MOVE  WK-STATUS      TO  WK-1190-STATUS
 19361         ELSE
 19362           CONTINUE
 19363         END-IF
 19364*-------------------<DEBUG>---------------------------------------
 19365D    DISPLAY  CNS-PGM-ID":WK-J=["WK-J"]"
 19366*-----------------------------------------------------------------
 19367         COMPUTE  WK-J = WK-J + CNS-1
 19368*-------------------<DEBUG>---------------------------------------
 19369D    DISPLAY  CNS-PGM-ID":WK-J=["WK-J"]"
 19370*-----------------------------------------------------------------
 19371*----------  基準日実行ステータス
 19372*---------- ファンドコード
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 335
* MUSR2651.cob                                                     cpy)cpy)y)y)
 19373         MOVE  WK-FUND-CD-DETAIL  OF  WK-FUND-PTF-DETAIL(WK-IDX-J)
 19374           TO  WK-GYOMU-FUND-CD
 19375                   OF  WK-GYOMU-ERR-INFO(WK-J)
 19376*---------- ポートフォリオコード
 19377         MOVE  WK-PTF-CD-DETAIL   OF  WK-FUND-PTF-DETAIL(WK-IDX-J)
 19378           TO  WK-GYOMU-PTF-CD
 19379                   OF  WK-GYOMU-ERR-INFO(WK-J)
 19380*---------- 評価系列コード
 19381         MOVE  WK-DEFAUL-THYK-CD  OF  WK-FUND-PTF-DETAIL(WK-IDX-J)
 19382            TO  WK-GYOMU-HYK-KRTU-CD
 19383                   OF  WK-GYOMU-ERR-INFO(WK-J)
 19384*---------- 基準日From
 19385         MOVE  WK-KIKAN-FR
 19386           TO  WK-GYOMU-KJN-YMD-FROM
 19387                   OF  WK-GYOMU-ERR-INFO(WK-J)
 19388*---------- 基準日To
 19389         MOVE  WK-KIKAN-TO
 19390           TO  WK-GYOMU-KJN-YMD-TO
 19391                   OF  WK-GYOMU-ERR-INFO(WK-J)
 19392*---------- メッセージID
 19393         MOVE  CNS-MSG-E000189
 19394           TO  WK-GYOMU-MSG-ID
 19395                   OF  WK-GYOMU-ERR-INFO(WK-J)
 19396*---------- 置換文字
 19397         MOVE  SPACE
 19398           TO  WK-GYOMU-TK-MOJI(WK-J,CNS-1)
 19399*---------- フリーメッセージ
 19400         MOVE  WK-TEMP-MSG
 19401           TO  WK-GYOMU-FREE-MSG
 19402                   OF  WK-GYOMU-ERR-INFO(WK-J)
 19403*----------  明細業務エラーフラグ
 19404         MOVE  CNS-ON             TO  FLG-MEISAI-GYOMU-ERR
 19405*----------  上記以外
 19406       WHEN  OTHER
 19407*--------------------<DEBUG>--------------------------------------
 19408D    DISPLAY  CNS-PGM-ID":国全項目取得  エラー"
 19409*-----------------------------------------------------------------
 19410*----------  WK-STATUS
 19411         MOVE  CNS-16              TO  WK-STATUS
 19412*----------  1190実行ステータス
 19413         MOVE  CNS-16              TO  WK-1190-STATUS
 19414*----------  ワークリターンコード
 19415         MOVE  CNS-16              TO  WK-RTN-CODE
 19416*----------  ワークエラーパッケージを編集
 19417         PERFORM  SUB-ERR-MSG-RTN
 19418         INITIALIZE  WK-SYS-ERR-INFO
 19419*----------  エラー検知プログラムID
 19420         MOVE  CNS-PGM-ID         TO  WK-ERR-PGM-ID
 19421*----------  ポジション
 19422         MOVE  CNS-POS-027        TO  WK-ERR-POS
 19423*----------  リターンコード
 19424         MOVE  CNS-RTN-901        TO  WK-RTN-CD
 19425*----------  詳細リターンコード
 19426         MOVE  RTN-CD             OF  PARM-RTNPKG
 19427                                  (COUNTER OF PARM-RTNPKG)
 19428                                  TO  WK-DETAIL-RTN-CD
 19429*----------  詳細リターンコードデコードフラグ
 19430         MOVE  CNS-DETAIL-0       TO  WK-DETAIL-RTN-CD-FLG
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 336
* MUSR2651.cob                                                     cpy)cpy)y)y)
 19431*---------- フリーメッセージ
 19432         MOVE  SPACE              TO  WK-FREE-MSG
 19433*----------  エラー情報追加処理
 19434         PERFORM  ERR-INFO-ADD-RTN
 19435     END-EVALUATE
 19436*--------------------<DEBUG>--------------------------------------
 19437D    DISPLAY  CNS-PGM-ID":***  国全項目取得 END  ***"
 19438*-----------------------------------------------------------------
 19439     CONTINUE.
 19440 SCZY4102-EXT.
 19441     EXIT.
 19442*------------------ <連結障害841の対応 START>---------------------
 19443*****************************************************************
 19444*   外部コード取得処理3
 19445*****************************************************************
 19446 SEC-SBT-CD-RTN         SECTION.
 19447*--------------------<DEBUG>--------------------------------------
 19448D    DISPLAY  CNS-PGM-ID":***  外部コード取得処理3  ***"
 19449*-----------------------------------------------------------------
 19450     INITIALIZE  PARM-SCZY4182-INOUT
 19451                 PARM-RTNPKG
 19452                 WK-GAIBU-CD
 19453                 WK-SEC-SBT-4182-2
 19454                 WK-RTN-4182-2
 19455*----------  利用会社コード
 19456     MOVE  WK-RIYO-CMP-CD
 19457       TO  RIYO-CMP-CD            OF  PARM-SCZY4182-ARG1
 19458*----------  コード種類
 19459     MOVE  CNS-X-01
 19460       TO  CD-SHRU                OF  PARM-SCZY4182-ARG1
 19461*----------  コードリファレンス系列コード
 19462     MOVE  CNS-D001
 19463       TO  CD-REF-KRTU-CD         OF  PARM-SCZY4182-ARG1
 19464*----------  業務タスクID
 19465     MOVE  WK-GYOMU-TASK-ID
 19466       TO  GYOMU-TASK-ID          OF  PARM-SCZY4182-ARG1
 19467*----------  変換元コード
 19468     MOVE  WK-SEC-SBT-CD
 19469       TO  NAIBU-CD               OF  PARM-SCZY4182-ARG1
 19470*----------  基準日
 19471     MOVE  H-ZANTK-YMD            OF  HST-TBL-SELECT
 19472       TO  KJN-YMD                OF  PARM-SCZY4182-ARG1
 19473*--------------------<DEBUG>--------------------------------------
 19474D    DISPLAY  CNS-PGM-ID":FUND-CD=["
 19475D          WK-FUND-CD-DETAIL   OF  WK-FUND-PTF-DETAIL(WK-IDX-J)"]"
 19476D    DISPLAY  CNS-PGM-ID":PTF-CD=["
 19477D          WK-PTF-CD-DETAIL    OF  WK-FUND-PTF-DETAIL(WK-IDX-J)"]"
 19478D    DISPLAY  CNS-PGM-ID":SCZY4182-ARG:"
 19479D    DISPLAY  CNS-PGM-ID":利用会社コード=["
 19480D             RIYO-CMP-CD         OF  PARM-SCZY4182-ARG1"]"
 19481D    DISPLAY  CNS-PGM-ID":コード種類=["
 19482D             CD-SHRU             OF  PARM-SCZY4182-ARG1"]"
 19483D    DISPLAY  CNS-PGM-ID":コードリファレンス系列コード=["
 19484D             CD-REF-KRTU-CD      OF  PARM-SCZY4182-ARG1"]"
 19485D    DISPLAY  CNS-PGM-ID":業務タスクID=["
 19486D             GYOMU-TASK-ID       OF  PARM-SCZY4182-ARG1"]"
 19487D    DISPLAY  CNS-PGM-ID":変換元コード=["
 19488D             NAIBU-CD            OF  PARM-SCZY4182-ARG1"]"
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 337
* MUSR2651.cob                                                     cpy)cpy)y)y)
 19489D    DISPLAY  CNS-PGM-ID":基準日=["
 19490D             KJN-YMD             OF  PARM-SCZY4182-ARG1"]"
 19491D    DISPLAY  CNS-PGM-ID":***  CALL SCZY4182 START  ***"
 19492*-----------------------------------------------------------------
 19493     CALL  "SCZY4182"             USING  PARM-SCZY4182-INOUT
 19494                                         PARM-RTNPKG
 19495*--------------------<DEBUG>--------------------------------------
 19496D    DISPLAY  CNS-PGM-ID":***  CALL SCZY4182 END  ***"
 19497D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY4182)       =["
 19498D             RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)"]"
 19499D    DISPLAY  CNS-PGM-ID":COUNTER OF PARM-RTNPKG =["
 19500D             COUNTER             OF PARM-RTNPKG "]"
 19501*-----------------------------------------------------------------
 19502     MOVE  WK-SEC-SBT-CD
 19503       TO  WK-SEC-SBT-4182-2
 19504     MOVE  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
 19505       TO  WK-RTN-4182-2
 19506     EVALUATE  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
 19507       WHEN  CNS-RTN-000
 19508       WHEN  CNS-RTN-002
 19509*----------  外部コード
 19510         MOVE  GAIBU-CD           OF  SAKI-AREA(CNS-1)
 19511           TO  WK-GAIBU-CD
 19512*--------------------<DEBUG>--------------------------------------
 19513D    DISPLAY  CNS-PGM-ID":ワーク変換先コード=["WK-GAIBU-CD"]"
 19514D    DISPLAY  CNS-PGM-ID":外部コード取得処理  正常"
 19515*-----------------------------------------------------------------
 19516       WHEN  CNS-RTN-110
 19517*--------------------<DEBUG>--------------------------------------
 19518D    DISPLAY  CNS-PGM-ID":外部コード取得処理3  業務エラー"
 19519*-----------------------------------------------------------------
 19520*----------  ワーク実行ステータス
 19521         IF  WK-STATUS < CNS-4
 19522         THEN
 19523           MOVE  CNS-4             TO  WK-STATUS
 19524         ELSE
 19525           CONTINUE
 19526         END-IF
 19527*----------  ワークリターンコード
 19528         IF  WK-STATUS > WK-RTN-CODE
 19529         THEN
 19530           MOVE  WK-STATUS           TO  WK-RTN-CODE
 19531         ELSE
 19532           CONTINUE
 19533         END-IF
 19534*----------  1190実行ステータス
 19535         IF  WK-STATUS > WK-1190-STATUS
 19536         THEN
 19537           MOVE  WK-STATUS      TO  WK-1190-STATUS
 19538         ELSE
 19539           CONTINUE
 19540         END-IF
 19541*-------------------<DEBUG>---------------------------------------
 19542D    DISPLAY  CNS-PGM-ID":WK-J=["WK-J"]"
 19543*-----------------------------------------------------------------
 19544         COMPUTE  WK-J = WK-J + CNS-1
 19545*-------------------<DEBUG>---------------------------------------
 19546D    DISPLAY  CNS-PGM-ID":WK-J=["WK-J"]"
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 338
* MUSR2651.cob                                                     cpy)cpy)y)y)
 19547*-----------------------------------------------------------------
 19548*----------  明細業務エラーフラグ
 19549         MOVE  CNS-ON             TO  FLG-MEISAI-GYOMU-ERR
 19550*----------  基準日実行ステータス
 19551*---------- ファンドコード
 19552         MOVE  WK-FUND-CD-DETAIL  OF  WK-FUND-PTF-DETAIL(WK-IDX-J)
 19553           TO  WK-GYOMU-FUND-CD
 19554                   OF  WK-GYOMU-ERR-INFO(WK-J)
 19555*---------- ポートフォリオコード
 19556         MOVE  WK-PTF-CD-DETAIL   OF  WK-FUND-PTF-DETAIL(WK-IDX-J)
 19557           TO  WK-GYOMU-PTF-CD
 19558                   OF  WK-GYOMU-ERR-INFO(WK-J)
 19559*---------- 評価系列コード
 19560         MOVE  WK-DEFAUL-THYK-CD  OF  WK-FUND-PTF-DETAIL(WK-IDX-J)
 19561            TO  WK-GYOMU-HYK-KRTU-CD
 19562                   OF  WK-GYOMU-ERR-INFO(WK-J)
 19563*---------- 基準日From
 19564         MOVE  WK-KIKAN-FR
 19565           TO  WK-GYOMU-KJN-YMD-FROM
 19566                   OF  WK-GYOMU-ERR-INFO(WK-J)
 19567*---------- 基準日To
 19568         MOVE  WK-KIKAN-TO
 19569           TO  WK-GYOMU-KJN-YMD-TO
 19570                   OF  WK-GYOMU-ERR-INFO(WK-J)
 19571*---------- メッセージID
 19572         MOVE  CNS-MSG-E000090
 19573           TO  WK-GYOMU-MSG-ID
 19574                   OF  WK-GYOMU-ERR-INFO(WK-J)
 19575*---------- 置換文字
 19576         STRING  CNS-SEC-SBT-GAIBU-CD
 19577                 WK-SEC-SBT-CD
 19578                 DELIMITED BY SPACE
 19579                 INTO  WK-GYOMU-TK-MOJI(WK-J,CNS-1)
 19580         END-STRING
 19581*---------- フリーメッセージ
 19582         MOVE  WK-TEMP-MSG
 19583           TO  WK-GYOMU-FREE-MSG
 19584                   OF  WK-GYOMU-ERR-INFO(WK-J)
 19585       WHEN  CNS-RTN-800
 19586*--------------------<DEBUG>--------------------------------------
 19587D    DISPLAY  CNS-PGM-ID":外部コード取得処理  業務エラー"
 19588*-----------------------------------------------------------------
 19589*----------  ワーク実行ステータス
 19590         IF  WK-STATUS < CNS-4
 19591         THEN
 19592           MOVE  CNS-4                 TO  WK-STATUS
 19593         ELSE
 19594           CONTINUE
 19595         END-IF
 19596*----------  ワークリターンコード
 19597         IF  WK-STATUS > WK-RTN-CODE
 19598         THEN
 19599           MOVE  WK-STATUS           TO  WK-RTN-CODE
 19600         ELSE
 19601           CONTINUE
 19602         END-IF
 19603*----------  1190実行ステータス
 19604         IF  WK-STATUS > WK-1190-STATUS
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 339
* MUSR2651.cob                                                     cpy)cpy)y)y)
 19605         THEN
 19606           MOVE  WK-STATUS      TO  WK-1190-STATUS
 19607         ELSE
 19608           CONTINUE
 19609         END-IF
 19610*-------------------<DEBUG>---------------------------------------
 19611D    DISPLAY  CNS-PGM-ID":WK-J=["WK-J"]"
 19612*-----------------------------------------------------------------
 19613         COMPUTE  WK-J = WK-J + CNS-1
 19614*-------------------<DEBUG>---------------------------------------
 19615D    DISPLAY  CNS-PGM-ID":WK-J=["WK-J"]"
 19616*-----------------------------------------------------------------
 19617*----------  基準日実行ステータス
 19618*---------- ファンドコード
 19619         MOVE  WK-FUND-CD-DETAIL  OF  WK-FUND-PTF-DETAIL(WK-IDX-J)
 19620           TO  WK-GYOMU-FUND-CD
 19621                   OF  WK-GYOMU-ERR-INFO(WK-J)
 19622*---------- ポートフォリオコード
 19623         MOVE  WK-PTF-CD-DETAIL   OF  WK-FUND-PTF-DETAIL(WK-IDX-J)
 19624           TO  WK-GYOMU-PTF-CD
 19625                   OF  WK-GYOMU-ERR-INFO(WK-J)
 19626*---------- 評価系列コード
 19627         MOVE  WK-DEFAUL-THYK-CD  OF  WK-FUND-PTF-DETAIL(WK-IDX-J)
 19628            TO  WK-GYOMU-HYK-KRTU-CD
 19629                   OF  WK-GYOMU-ERR-INFO(WK-J)
 19630*---------- 基準日From
 19631         MOVE  WK-KIKAN-FR
 19632           TO  WK-GYOMU-KJN-YMD-FROM
 19633                   OF  WK-GYOMU-ERR-INFO(WK-J)
 19634*---------- 基準日To
 19635         MOVE  WK-KIKAN-TO
 19636           TO  WK-GYOMU-KJN-YMD-TO
 19637                   OF  WK-GYOMU-ERR-INFO(WK-J)
 19638*---------- メッセージID
 19639         MOVE  CNS-MSG-E000189
 19640           TO  WK-GYOMU-MSG-ID
 19641                   OF  WK-GYOMU-ERR-INFO(WK-J)
 19642*---------- 置換文字
 19643         MOVE  SPACE
 19644           TO  WK-GYOMU-TK-MOJI(WK-J,CNS-1)
 19645*---------- フリーメッセージ
 19646         MOVE  WK-TEMP-MSG
 19647           TO  WK-GYOMU-FREE-MSG
 19648                   OF  WK-GYOMU-ERR-INFO(WK-J)
 19649*----------  明細業務エラーフラグ
 19650         MOVE  CNS-ON             TO  FLG-MEISAI-GYOMU-ERR
 19651       WHEN  OTHER
 19652*--------------------<DEBUG>--------------------------------------
 19653D    DISPLAY  CNS-PGM-ID":外部コード取得処理3 システムエラー"
 19654*-----------------------------------------------------------------
 19655*----------  WK-STATUS
 19656         MOVE  CNS-16              TO  WK-STATUS
 19657*----------  1190実行ステータス
 19658         MOVE  CNS-16              TO  WK-1190-STATUS
 19659*----------  ワークリターンコード
 19660         MOVE  CNS-16              TO  WK-RTN-CODE
 19661         PERFORM  SUB-ERR-MSG-RTN
 19662         INITIALIZE  WK-SYS-ERR-INFO
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 340
* MUSR2651.cob                                                     cpy)cpy)y)y)
 19663*----------  エラー検知プログラムID
 19664         MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
 19665*----------  ポジション
 19666         MOVE  CNS-POS-029          TO  WK-ERR-POS
 19667*----------  リターンコード
 19668         MOVE  CNS-RTN-901          TO  WK-RTN-CD
 19669*----------  詳細リターンコード
 19670         MOVE  RTN-CD               OF  PARM-RTNPKG
 19671                                      (COUNTER OF PARM-RTNPKG)
 19672                                  TO  WK-DETAIL-RTN-CD
 19673*----------  詳細リターンコードデコードフラグ
 19674         MOVE  CNS-DETAIL-0         TO  WK-DETAIL-RTN-CD-FLG
 19675*---------- フリーメッセージ
 19676         MOVE  SPACE                TO  WK-FREE-MSG
 19677*----------  エラー情報追加処理
 19678         PERFORM  ERR-INFO-ADD-RTN
 19679     END-EVALUATE
 19680*--------------------<DEBUG>--------------------------------------
 19681D    DISPLAY  CNS-PGM-ID":***  外部コード取得処理3 END  ***"
 19682*-----------------------------------------------------------------
 19683     CONTINUE.
 19684 SEC-SBT-CD-EXT.
 19685     EXIT.
 19686*------------------ <連結障害841の対応 END>-----------------------
 19687******************************************************************
 19688*    データ出力処理
 19689******************************************************************
 19690 DATA-WRITE-RTN         SECTION.
 19691*--------------------<DEBUG>--------------------------------------
 19692D    DISPLAY  CNS-PGM-ID":***** データ出力処理 START  *****"
 19693*-----------------------------------------------------------------
 19694     WRITE  DAT-REC
 19695*-------------------<DEBUG>---------------------------------------
 19696D    DISPLAY  CNS-PGM-ID":DAT-REC=["DAT-REC"]"
 19697D    DISPLAY  CNS-PGM-ID":FILE-STATUS=[" WK-FILE-STATUS "]"
 19698*-----------------------------------------------------------------
 19699     EVALUATE  WK-FILE-STATUS
 19700       WHEN  CNS-FILE-NORMAL
 19701*--------------------<DEBUG>--------------------------------------
 19702D    DISPLAY  CNS-PGM-ID":WK-WRITE-KENSUU=["WK-WRITE-KENSUU"]"
 19703*-----------------------------------------------------------------
 19704         COMPUTE  WK-WRITE-KENSUU = WK-WRITE-KENSUU + 1
 19705*--------------------<DEBUG>--------------------------------------
 19706D    DISPLAY  CNS-PGM-ID":WK-WRITE-KENSUU=["WK-WRITE-KENSUU"]"
 19707D    DISPLAY  CNS-PGM-ID":データ出力処理正常"
 19708*-----------------------------------------------------------------
 19709         CONTINUE
 19710       WHEN  OTHER
 19711*--------------------<DEBUG>--------------------------------------
 19712D    DISPLAY  CNS-PGM-ID":データ出力処理エラー"
 19713*-----------------------------------------------------------------
 19714*----------  メッセージ出力用 RTNパッケージの設定
 19715*----------  ワーク実行ステータス
 19716         MOVE  CNS-16                   TO  WK-STATUS
 19717         MOVE  CNS-16                   TO  WK-1190-STATUS
 19718*----------  ワークリターンコード
 19719         MOVE  WK-STATUS                TO  WK-RTN-CODE
 19720*----------  ワークエラーパッケージを編集
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 341
* MUSR2651.cob                                                     cpy)cpy)y)y)
 19721         INITIALIZE  WK-SYS-ERR-INFO
 19722*----------  エラー検知プログラムID
 19723         MOVE  CNS-PGM-ID               TO  WK-ERR-PGM-ID
 19724*----------  ポジション
 19725         MOVE  CNS-POS-030              TO  WK-ERR-POS
 19726*----------  リターンコード
 19727         MOVE  CNS-RTN-220              TO  WK-RTN-CD
 19728*----------  詳細リターンコードデコードフラグ
 19729         MOVE  FUNCTION NUMVAL(WK-FILE-STATUS)
 19730                                        TO  WK-DETAIL-RTN-CD
 19731*----------  詳細リターンコードデコードフラグ
 19732         MOVE  CNS-DETAIL-0             TO  WK-DETAIL-RTN-CD-FLG
 19733*---------- フリーメッセージ
 19734         STRING  "ファイル:["
 19735                 WK-PSACT-DAT-FILE
 19736                 "]書き込むエラー"
 19737          DELIMITED BY SPACE            INTO  WK-FREE-MSG
 19738         END-STRING
 19739*----------  エラー情報追加処理
 19740         PERFORM  ERR-INFO-ADD-RTN
 19741     END-EVALUATE
 19742*--------------------<DEBUG>--------------------------------------
 19743D    DISPLAY  CNS-PGM-ID":***** データ出力処理  END  *****"
 19744*-----------------------------------------------------------------
 19745     CONTINUE.
 19746 DATA-WRITE-EXT.
 19747     EXIT.
 19748******************************************************************
 19749*    データ出力処理1
 19750******************************************************************
 19751 DATA-WRITE1-RTN        SECTION.
 19752*--------------------<DEBUG>--------------------------------------
 19753D    DISPLAY  CNS-PGM-ID":***** データ出力処理H1 START  *****"
 19754*-----------------------------------------------------------------
 19755     WRITE  DAT-REC
 19756*-------------------<DEBUG>---------------------------------------
 19757D    DISPLAY  CNS-PGM-ID":DAT-REC=["DAT-REC"]"
 19758D    DISPLAY  CNS-PGM-ID":FILE-STATUS=[" WK-FILE-STATUS "]"
 19759*-----------------------------------------------------------------
 19760     EVALUATE  WK-FILE-STATUS
 19761       WHEN  CNS-FILE-NORMAL
 19762*--------------------<DEBUG>--------------------------------------
 19763D    DISPLAY  CNS-PGM-ID":WK-WRITE-KENSUU=["WK-WRITE-KENSUU"]"
 19764*-----------------------------------------------------------------
 19765         COMPUTE  WK-WRITE-KENSUU = WK-WRITE-KENSUU + 1
 19766*--------------------<DEBUG>--------------------------------------
 19767D    DISPLAY  CNS-PGM-ID":WK-WRITE-KENSUU=["WK-WRITE-KENSUU"]"
 19768D    DISPLAY  CNS-PGM-ID":データ出力処理正常"
 19769*-----------------------------------------------------------------
 19770         CONTINUE
 19771       WHEN  OTHER
 19772*--------------------<DEBUG>--------------------------------------
 19773D    DISPLAY  CNS-PGM-ID":データ出力処理エラー"
 19774*-----------------------------------------------------------------
 19775*----------  メッセージ出力用 RTNパッケージの設定
 19776*----------  ワーク実行ステータス
 19777         MOVE  CNS-16                   TO  WK-RTN-CODE
 19778*----------  ワークエラーパッケージを編集
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 342
* MUSR2651.cob                                                     cpy)cpy)y)y)
 19779         INITIALIZE  WK-SYS-ERR-INFO
 19780*----------  エラー検知プログラムID
 19781         MOVE  CNS-PGM-ID               TO  WK-ERR-PGM-ID
 19782*----------  ポジション
 19783         MOVE  CNS-POS-071              TO  WK-ERR-POS
 19784*----------  リターンコード
 19785         MOVE  CNS-RTN-220              TO  WK-RTN-CD
 19786*----------  詳細リターンコードデコードフラグ
 19787         MOVE  FUNCTION NUMVAL(WK-FILE-STATUS)
 19788                                        TO  WK-DETAIL-RTN-CD
 19789*----------  詳細リターンコードデコードフラグ
 19790         MOVE  CNS-DETAIL-0             TO  WK-DETAIL-RTN-CD-FLG
 19791*---------- フリーメッセージ
 19792         STRING  "ファイル:["
 19793                 WK-PSACT-DAT-FILE
 19794                 "]書き込むエラー"
 19795          DELIMITED BY SPACE            INTO  WK-FREE-MSG
 19796         END-STRING
 19797*----------  エラー処理
 19798         PERFORM  ERR-RTN
 19799     END-EVALUATE
 19800*--------------------<DEBUG>--------------------------------------
 19801D    DISPLAY  CNS-PGM-ID":***** データ出力処理H1  END  *****"
 19802*-----------------------------------------------------------------
 19803     CONTINUE.
 19804 DATA-WRITE1-EXT.
 19805     EXIT.
 19806******************************************************************
 19807*    データ出力処理2
 19808******************************************************************
 19809 DATA-WRITE-2-RTN       SECTION.
 19810*--------------------<DEBUG>--------------------------------------
 19811D    DISPLAY  CNS-PGM-ID":***** データ出力処理2 START  *****"
 19812*-----------------------------------------------------------------
 19813     WRITE  DAT-REC2
 19814*-------------------<DEBUG>---------------------------------------
 19815D    DISPLAY  CNS-PGM-ID":DAT-REC2=["DAT-REC2"]"
 19816D    DISPLAY  CNS-PGM-ID":WK-FILE-STATUS-2=[" WK-FILE-STATUS-2 "]"
 19817*-----------------------------------------------------------------
 19818     EVALUATE  WK-FILE-STATUS-2
 19819       WHEN  CNS-FILE-NORMAL
 19820*--------------------<DEBUG>--------------------------------------
 19821D    DISPLAY  CNS-PGM-ID":WK-WRITE-KENSUU2=["WK-WRITE-KENSUU2"]"
 19822*-----------------------------------------------------------------
 19823         COMPUTE  WK-WRITE-KENSUU2 = WK-WRITE-KENSUU2 + 1
 19824*--------------------<DEBUG>--------------------------------------
 19825D    DISPLAY  CNS-PGM-ID":WK-WRITE-KENSUU2=["WK-WRITE-KENSUU2"]"
 19826D    DISPLAY  CNS-PGM-ID":データ出力処理2正常"
 19827*-----------------------------------------------------------------
 19828         CONTINUE
 19829       WHEN  OTHER
 19830*--------------------<DEBUG>--------------------------------------
 19831D    DISPLAY  CNS-PGM-ID":データ出力処理2エラー"
 19832*-----------------------------------------------------------------
 19833*----------  メッセージ出力用 RTNパッケージの設定
 19834*----------  ワーク実行ステータス
 19835         MOVE  CNS-16                   TO  WK-STATUS
 19836         MOVE  CNS-16                   TO  WK-1190-STATUS
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 343
* MUSR2651.cob                                                     cpy)cpy)y)y)
 19837*----------  ワークリターンコード
 19838         MOVE  WK-STATUS                TO  WK-RTN-CODE
 19839*----------  ワークエラーパッケージを編集
 19840         INITIALIZE  WK-SYS-ERR-INFO
 19841*----------  エラー検知プログラムID
 19842         MOVE  CNS-PGM-ID               TO  WK-ERR-PGM-ID
 19843*----------  ポジション
 19844         MOVE  CNS-POS-031              TO  WK-ERR-POS
 19845*----------  リターンコード
 19846         MOVE  CNS-RTN-220              TO  WK-RTN-CD
 19847*----------  詳細リターンコードデコードフラグ
 19848         MOVE  FUNCTION NUMVAL(WK-FILE-STATUS-2)
 19849                                        TO  WK-DETAIL-RTN-CD
 19850*----------  詳細リターンコードデコードフラグ
 19851         MOVE  CNS-DETAIL-0             TO  WK-DETAIL-RTN-CD-FLG
 19852*---------- フリーメッセージ
 19853         STRING  "ファイル:["
 19854                 WK-PSACT-DAT-FILE-2
 19855                 "]書き込むエラー"
 19856          DELIMITED BY SPACE            INTO  WK-FREE-MSG
 19857         END-STRING
 19858*----------  エラー情報追加処理
 19859         PERFORM  ERR-INFO-ADD-RTN
 19860     END-EVALUATE
 19861*--------------------<DEBUG>--------------------------------------
 19862D    DISPLAY  CNS-PGM-ID":***** データ出力処理2  END  *****"
 19863*-----------------------------------------------------------------
 19864     CONTINUE.
 19865 DATA-WRITE-2-EXT.
 19866     EXIT.
 19867******************************************************************
 19868*    データ出力処理2
 19869******************************************************************
 19870 DATA-WRITE2-RTN        SECTION.
 19871*--------------------<DEBUG>--------------------------------------
 19872D    DISPLAY  CNS-PGM-ID":***** データ出力処理H2 START  *****"
 19873*-----------------------------------------------------------------
 19874     WRITE  DAT-REC2
 19875*-------------------<DEBUG>---------------------------------------
 19876D    DISPLAY  CNS-PGM-ID":DAT-REC2=["DAT-REC2"]"
 19877D    DISPLAY  CNS-PGM-ID":WK-FILE-STATUS-2=[" WK-FILE-STATUS-2 "]"
 19878*-----------------------------------------------------------------
 19879     EVALUATE  WK-FILE-STATUS-2
 19880       WHEN  CNS-FILE-NORMAL
 19881*--------------------<DEBUG>--------------------------------------
 19882D    DISPLAY  CNS-PGM-ID":WK-WRITE-KENSUU2=["WK-WRITE-KENSUU2"]"
 19883*-----------------------------------------------------------------
 19884         COMPUTE  WK-WRITE-KENSUU2 = WK-WRITE-KENSUU2 + 1
 19885*--------------------<DEBUG>--------------------------------------
 19886D    DISPLAY  CNS-PGM-ID":WK-WRITE-KENSUU2=["WK-WRITE-KENSUU2"]"
 19887D    DISPLAY  CNS-PGM-ID":データ出力処理2正常"
 19888*-----------------------------------------------------------------
 19889         CONTINUE
 19890       WHEN  OTHER
 19891*--------------------<DEBUG>--------------------------------------
 19892D    DISPLAY  CNS-PGM-ID":データ出力処理2エラー"
 19893*-----------------------------------------------------------------
 19894*----------  メッセージ出力用 RTNパッケージの設定
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 344
* MUSR2651.cob                                                     cpy)cpy)y)y)
 19895*----------  ワーク実行ステータス
 19896         MOVE  CNS-16                   TO  WK-RTN-CODE
 19897*----------  ワークエラーパッケージを編集
 19898         INITIALIZE  WK-SYS-ERR-INFO
 19899*----------  エラー検知プログラムID
 19900         MOVE  CNS-PGM-ID               TO  WK-ERR-PGM-ID
 19901*----------  ポジション
 19902         MOVE  CNS-POS-072              TO  WK-ERR-POS
 19903*----------  リターンコード
 19904         MOVE  CNS-RTN-220              TO  WK-RTN-CD
 19905*----------  詳細リターンコードデコードフラグ
 19906         MOVE  FUNCTION NUMVAL(WK-FILE-STATUS-2)
 19907                                        TO  WK-DETAIL-RTN-CD
 19908*----------  詳細リターンコードデコードフラグ
 19909         MOVE  CNS-DETAIL-0             TO  WK-DETAIL-RTN-CD-FLG
 19910*---------- フリーメッセージ
 19911         STRING  "ファイル:["
 19912                 WK-PSACT-DAT-FILE-2
 19913                 "]書き込むエラー"
 19914          DELIMITED BY SPACE            INTO  WK-FREE-MSG
 19915         END-STRING
 19916*----------  エラー処理
 19917         PERFORM  ERR-RTN
 19918     END-EVALUATE
 19919*--------------------<DEBUG>--------------------------------------
 19920D    DISPLAY  CNS-PGM-ID":***** データ出力処理H2  END  *****"
 19921*-----------------------------------------------------------------
 19922     CONTINUE.
 19923 DATA-WRITE2-EXT.
 19924     EXIT.
 19925******************************************************************
 19926*    データ出力処理3
 19927******************************************************************
 19928 DATA-WRITE-3-RTN       SECTION.
 19929*--------------------<DEBUG>--------------------------------------
 19930D    DISPLAY  CNS-PGM-ID":***** データ出力処理3 START  *****"
 19931*-----------------------------------------------------------------
 19932     WRITE  DAT-REC3
 19933*-------------------<DEBUG>---------------------------------------
 19934D    DISPLAY  CNS-PGM-ID":DAT-REC3=["DAT-REC3"]"
 19935D    DISPLAY  CNS-PGM-ID":WK-FILE-STATUS-3=[" WK-FILE-STATUS-3 "]"
 19936*-----------------------------------------------------------------
 19937     EVALUATE  WK-FILE-STATUS-3
 19938       WHEN  CNS-FILE-NORMAL
 19939*--------------------<DEBUG>--------------------------------------
 19940D    DISPLAY  CNS-PGM-ID":WK-WRITE-KENSUU3=["WK-WRITE-KENSUU3"]"
 19941*-----------------------------------------------------------------
 19942         COMPUTE  WK-WRITE-KENSUU3 = WK-WRITE-KENSUU3 + 1
 19943*--------------------<DEBUG>--------------------------------------
 19944D    DISPLAY  CNS-PGM-ID":WK-WRITE-KENSUU3=["WK-WRITE-KENSUU3"]"
 19945D    DISPLAY  CNS-PGM-ID":データ出力処理3正常"
 19946*-----------------------------------------------------------------
 19947         CONTINUE
 19948       WHEN  OTHER
 19949*--------------------<DEBUG>--------------------------------------
 19950D    DISPLAY  CNS-PGM-ID":データ出力処理3エラー"
 19951*-----------------------------------------------------------------
 19952*----------  メッセージ出力用 RTNパッケージの設定
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 345
* MUSR2651.cob                                                     cpy)cpy)y)y)
 19953*----------  ワーク実行ステータス
 19954         MOVE  CNS-16                   TO  WK-STATUS
 19955         MOVE  CNS-16                   TO  WK-1190-STATUS
 19956*----------  ワークリターンコード
 19957         MOVE  WK-STATUS                TO  WK-RTN-CODE
 19958*----------  ワークエラーパッケージを編集
 19959         INITIALIZE  WK-SYS-ERR-INFO
 19960*----------  エラー検知プログラムID
 19961         MOVE  CNS-PGM-ID               TO  WK-ERR-PGM-ID
 19962*----------  ポジション
 19963         MOVE  CNS-POS-032              TO  WK-ERR-POS
 19964*----------  リターンコード
 19965         MOVE  CNS-RTN-220              TO  WK-RTN-CD
 19966*----------  詳細リターンコードデコードフラグ
 19967         MOVE  FUNCTION NUMVAL(WK-FILE-STATUS-3)
 19968                                        TO  WK-DETAIL-RTN-CD
 19969*----------  詳細リターンコードデコードフラグ
 19970         MOVE  CNS-DETAIL-0             TO  WK-DETAIL-RTN-CD-FLG
 19971*---------- フリーメッセージ
 19972         STRING  "ファイル:["
 19973                 WK-PSACT-DAT-FILE-3
 19974                 "]書き込むエラー"
 19975          DELIMITED BY SPACE            INTO  WK-FREE-MSG
 19976         END-STRING
 19977*----------  エラー情報追加処理
 19978         PERFORM  ERR-INFO-ADD-RTN
 19979     END-EVALUATE
 19980*--------------------<DEBUG>--------------------------------------
 19981D    DISPLAY  CNS-PGM-ID":***** データ出力処理3  END  *****"
 19982*-----------------------------------------------------------------
 19983     CONTINUE.
 19984 DATA-WRITE-3-EXT.
 19985     EXIT.
 19986******************************************************************
 19987*    データ出力処理3
 19988******************************************************************
 19989 DATA-WRITE3-RTN        SECTION.
 19990*--------------------<DEBUG>--------------------------------------
 19991D    DISPLAY  CNS-PGM-ID":***** データ出力処理H3 START  *****"
 19992*-----------------------------------------------------------------
 19993     WRITE  DAT-REC3
 19994*-------------------<DEBUG>---------------------------------------
 19995D    DISPLAY  CNS-PGM-ID":DAT-REC3=["DAT-REC3"]"
 19996D    DISPLAY  CNS-PGM-ID":WK-FILE-STATUS-3=[" WK-FILE-STATUS-3 "]"
 19997*-----------------------------------------------------------------
 19998     EVALUATE  WK-FILE-STATUS-3
 19999       WHEN  CNS-FILE-NORMAL
 20000*--------------------<DEBUG>--------------------------------------
 20001D    DISPLAY  CNS-PGM-ID":WK-WRITE-KENSUU3=["WK-WRITE-KENSUU3"]"
 20002*-----------------------------------------------------------------
 20003         COMPUTE  WK-WRITE-KENSUU3 = WK-WRITE-KENSUU3 + 1
 20004*--------------------<DEBUG>--------------------------------------
 20005D    DISPLAY  CNS-PGM-ID":WK-WRITE-KENSUU3=["WK-WRITE-KENSUU3"]"
 20006D    DISPLAY  CNS-PGM-ID":データ出力処理3正常"
 20007*-----------------------------------------------------------------
 20008         CONTINUE
 20009       WHEN  OTHER
 20010*--------------------<DEBUG>--------------------------------------
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 346
* MUSR2651.cob                                                     cpy)cpy)y)y)
 20011D    DISPLAY  CNS-PGM-ID":データ出力処理3エラー"
 20012*-----------------------------------------------------------------
 20013*----------  メッセージ出力用 RTNパッケージの設定
 20014*----------  ワーク実行ステータス
 20015         MOVE  CNS-16                   TO  WK-RTN-CODE
 20016*----------  ワークエラーパッケージを編集
 20017         INITIALIZE  WK-SYS-ERR-INFO
 20018*----------  エラー検知プログラムID
 20019         MOVE  CNS-PGM-ID               TO  WK-ERR-PGM-ID
 20020*----------  ポジション
 20021         MOVE  CNS-POS-073              TO  WK-ERR-POS
 20022*----------  リターンコード
 20023         MOVE  CNS-RTN-220              TO  WK-RTN-CD
 20024*----------  詳細リターンコードデコードフラグ
 20025         MOVE  FUNCTION NUMVAL(WK-FILE-STATUS-3)
 20026                                        TO  WK-DETAIL-RTN-CD
 20027*----------  詳細リターンコードデコードフラグ
 20028         MOVE  CNS-DETAIL-0             TO  WK-DETAIL-RTN-CD-FLG
 20029*---------- フリーメッセージ
 20030         STRING  "ファイル:["
 20031                 WK-PSACT-DAT-FILE-3
 20032                 "]書き込むエラー"
 20033          DELIMITED BY SPACE            INTO  WK-FREE-MSG
 20034         END-STRING
 20035*----------  エラー処理
 20036         PERFORM  ERR-RTN
 20037     END-EVALUATE
 20038*--------------------<DEBUG>--------------------------------------
 20039D    DISPLAY  CNS-PGM-ID":***** データ出力処理H3  END  *****"
 20040*-----------------------------------------------------------------
 20041     CONTINUE.
 20042 DATA-WRITE3-EXT.
 20043     EXIT.
 20044******************************************************************
 20045*    データ出力処理4
 20046******************************************************************
 20047 DATA-WRITE-4-RTN       SECTION.
 20048*--------------------<DEBUG>--------------------------------------
 20049D    DISPLAY  CNS-PGM-ID":***** データ出力処理4 START  *****"
 20050*-----------------------------------------------------------------
 20051     WRITE  DAT-REC4
 20052*-------------------<DEBUG>---------------------------------------
 20053D    DISPLAY  CNS-PGM-ID":DAT-REC4=["DAT-REC4"]"
 20054D    DISPLAY  CNS-PGM-ID":WK-FILE-STATUS-4=[" WK-FILE-STATUS-4 "]"
 20055*-----------------------------------------------------------------
 20056     EVALUATE  WK-FILE-STATUS-4
 20057       WHEN  CNS-FILE-NORMAL
 20058*--------------------<DEBUG>--------------------------------------
 20059D    DISPLAY  CNS-PGM-ID":WK-WRITE-KENSUU4=["WK-WRITE-KENSUU4"]"
 20060*-----------------------------------------------------------------
 20061         COMPUTE  WK-WRITE-KENSUU4 = WK-WRITE-KENSUU4 + 1
 20062*--------------------<DEBUG>--------------------------------------
 20063D    DISPLAY  CNS-PGM-ID":WK-WRITE-KENSUU4=["WK-WRITE-KENSUU4"]"
 20064D    DISPLAY  CNS-PGM-ID":データ出力処理4正常"
 20065*-----------------------------------------------------------------
 20066         CONTINUE
 20067       WHEN  OTHER
 20068*--------------------<DEBUG>--------------------------------------
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 347
* MUSR2651.cob                                                     cpy)cpy)y)y)
 20069D    DISPLAY  CNS-PGM-ID":データ出力処理4エラー"
 20070*-----------------------------------------------------------------
 20071*----------  メッセージ出力用 RTNパッケージの設定
 20072*----------  ワーク実行ステータス
 20073         MOVE  CNS-16                   TO  WK-STATUS
 20074         MOVE  CNS-16                   TO  WK-1190-STATUS
 20075*----------  ワークリターンコード
 20076         MOVE  WK-STATUS                TO  WK-RTN-CODE
 20077*----------  ワークエラーパッケージを編集
 20078         INITIALIZE  WK-SYS-ERR-INFO
 20079*----------  エラー検知プログラムID
 20080         MOVE  CNS-PGM-ID               TO  WK-ERR-PGM-ID
 20081*----------  ポジション
 20082         MOVE  CNS-POS-033              TO  WK-ERR-POS
 20083*----------  リターンコード
 20084         MOVE  CNS-RTN-220              TO  WK-RTN-CD
 20085*----------  詳細リターンコードデコードフラグ
 20086         MOVE  FUNCTION NUMVAL(WK-FILE-STATUS-4)
 20087                                        TO  WK-DETAIL-RTN-CD
 20088*----------  詳細リターンコードデコードフラグ
 20089         MOVE  CNS-DETAIL-0             TO  WK-DETAIL-RTN-CD-FLG
 20090*---------- フリーメッセージ
 20091         STRING  "ファイル:["
 20092                 WK-PSACT-DAT-FILE-4
 20093                 "]書き込むエラー"
 20094          DELIMITED BY SPACE            INTO  WK-FREE-MSG
 20095         END-STRING
 20096*----------  エラー情報追加処理
 20097         PERFORM  ERR-INFO-ADD-RTN
 20098     END-EVALUATE
 20099*--------------------<DEBUG>--------------------------------------
 20100D    DISPLAY  CNS-PGM-ID":***** データ出力処理4  END  *****"
 20101*-----------------------------------------------------------------
 20102     CONTINUE.
 20103 DATA-WRITE-4-EXT.
 20104     EXIT.
 20105******************************************************************
 20106*    データ出力処理4
 20107******************************************************************
 20108 DATA-WRITE4-RTN        SECTION.
 20109*--------------------<DEBUG>--------------------------------------
 20110D    DISPLAY  CNS-PGM-ID":***** データ出力処理H4 START  *****"
 20111*-----------------------------------------------------------------
 20112     WRITE  DAT-REC4
 20113*-------------------<DEBUG>---------------------------------------
 20114D    DISPLAY  CNS-PGM-ID":DAT-REC4=["DAT-REC4"]"
 20115D    DISPLAY  CNS-PGM-ID":WK-FILE-STATUS-4=[" WK-FILE-STATUS-4 "]"
 20116*-----------------------------------------------------------------
 20117     EVALUATE  WK-FILE-STATUS-4
 20118       WHEN  CNS-FILE-NORMAL
 20119*--------------------<DEBUG>--------------------------------------
 20120D    DISPLAY  CNS-PGM-ID":WK-WRITE-KENSUU4=["WK-WRITE-KENSUU4"]"
 20121*-----------------------------------------------------------------
 20122         COMPUTE  WK-WRITE-KENSUU4 = WK-WRITE-KENSUU4 + 1
 20123*--------------------<DEBUG>--------------------------------------
 20124D    DISPLAY  CNS-PGM-ID":WK-WRITE-KENSUU4=["WK-WRITE-KENSUU4"]"
 20125D    DISPLAY  CNS-PGM-ID":データ出力処理4正常"
 20126*-----------------------------------------------------------------
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 348
* MUSR2651.cob                                                     cpy)cpy)y)y)
 20127         CONTINUE
 20128       WHEN  OTHER
 20129*--------------------<DEBUG>--------------------------------------
 20130D    DISPLAY  CNS-PGM-ID":データ出力処理4エラー"
 20131*-----------------------------------------------------------------
 20132*----------  メッセージ出力用 RTNパッケージの設定
 20133*----------  ワーク実行ステータス
 20134         MOVE  CNS-16                   TO  WK-RTN-CODE
 20135*----------  ワークエラーパッケージを編集
 20136         INITIALIZE  WK-SYS-ERR-INFO
 20137*----------  エラー検知プログラムID
 20138         MOVE  CNS-PGM-ID               TO  WK-ERR-PGM-ID
 20139*----------  ポジション
 20140         MOVE  CNS-POS-074              TO  WK-ERR-POS
 20141*----------  リターンコード
 20142         MOVE  CNS-RTN-220              TO  WK-RTN-CD
 20143*----------  詳細リターンコードデコードフラグ
 20144         MOVE  FUNCTION NUMVAL(WK-FILE-STATUS-4)
 20145                                        TO  WK-DETAIL-RTN-CD
 20146*----------  詳細リターンコードデコードフラグ
 20147         MOVE  CNS-DETAIL-0             TO  WK-DETAIL-RTN-CD-FLG
 20148*---------- フリーメッセージ
 20149         STRING  "ファイル:["
 20150                 WK-PSACT-DAT-FILE-4
 20151                 "]書き込むエラー"
 20152          DELIMITED BY SPACE            INTO  WK-FREE-MSG
 20153         END-STRING
 20154*----------  エラー処理
 20155         PERFORM  ERR-RTN
 20156     END-EVALUATE
 20157*--------------------<DEBUG>--------------------------------------
 20158D    DISPLAY  CNS-PGM-ID":***** データ出力処理H4  END  *****"
 20159*-----------------------------------------------------------------
 20160     CONTINUE.
 20161 DATA-WRITE4-EXT.
 20162     EXIT.
 20163******************************************************************
 20164*    6) 業務エラー1処理
 20165******************************************************************
 20166 GYOMU-ERR-1-RTN        SECTION.
 20167*--------------------<DEBUG>--------------------------------------
 20168D    DISPLAY  CNS-PGM-ID":***  業務エラー1処理 START  ***"
 20169*-----------------------------------------------------------------
 20170     INITIALIZE  PARM-SCZY7080-INOUT
 20171                 PARM-RTNPKG
 20172*----------  利用会社コード
 20173     MOVE  WK-RIYO-CMP-CD
 20174       TO  RIYO-CMP-CD            OF  PARM-SCZY7080-ARG1
 20175*----------  処理実行日
 20176     MOVE  WK-SHORI-YMD
 20177       TO  SYORI-YMD              OF  PARM-SCZY7080-ARG1
 20178*----------  起動ID
 20179     MOVE  WK-KIDOU-ID
 20180       TO  KIDOU-ID               OF  PARM-SCZY7080-ARG1
 20181*----------  業務タスクID
 20182     MOVE  WK-GYOMU-TASK-ID       OF  WK-ARGUMENT
 20183       TO  GYOMU-TASK-ID          OF  PARM-SCZY7080-ARG1
 20184*----------  メッセージエリア
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 349
* MUSR2651.cob                                                     cpy)cpy)y)y)
 20185     MOVE  WK-GYOMU-ERR-INFO      TO  PARM-SCZY7080-ARG2
 20186*-------------------<DEBUG>---------------------------------------
 20187D    DISPLAY  CNS-PGM-ID":利用会社コード=["
 20188D             RIYO-CMP-CD         OF  PARM-SCZY7080-ARG1"]"
 20189D    DISPLAY  CNS-PGM-ID":処理実行日=["
 20190D             SYORI-YMD           OF  PARM-SCZY7080-ARG1"]"
 20191D    DISPLAY  CNS-PGM-ID":起動ID=["
 20192D             KIDOU-ID            OF  PARM-SCZY7080-ARG1"]"
 20193D    DISPLAY  CNS-PGM-ID":業務タスクID=["
 20194D             GYOMU-TASK-ID       OF  PARM-SCZY7080-ARG1"]"
 20195D    DISPLAY  CNS-PGM-ID":メッセージエリア=["
 20196D             PARM-SCZY7080-ARG2"]"
 20197D    DISPLAY  CNS-PGM-ID": ***  CALL SCZY7080  START  ***"
 20198*-----------------------------------------------------------------
 20199     CALL  "SCZY7080"             USING  PARM-SCZY7080-INOUT
 20200                                         PARM-RTNPKG
 20201*-------------------<DEBUG>---------------------------------------
 20202D    DISPLAY  CNS-PGM-ID": ***  CALL SCZY7080  END  ***"
 20203D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY7080)        =["
 20204D             RTN-CD OF PARM-RTNPKG(COUNTER   OF PARM-RTNPKG) "]"
 20205D    DISPLAY  CNS-PGM-ID":COUNTER  OF  PARM-RTNPKG=["
 20206D             COUNTER              OF PARM-RTNPKG"]"
 20207*-----------------------------------------------------------------
 20208     IF  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
 20209      =  CNS-RTN-000
 20210     THEN
 20211       PERFORM  DB-COMMIT1-RTN
 20212*--------------------<DEBUG>--------------------------------------
 20213D    DISPLAY  CNS-PGM-ID":***  業務エラー1処理  正常  ***"
 20214*-----------------------------------------------------------------
 20215     ELSE
 20216*--------------------<DEBUG>--------------------------------------
 20217D    DISPLAY  CNS-PGM-ID":***  業務エラー1処理  エラー  ***"
 20218*-----------------------------------------------------------------
 20219*----------  ワーク実行ステータス
 20220       MOVE  CNS-16               TO  WK-STATUS
 20221*----------  1190実行ステータス
 20222       MOVE  CNS-16               TO  WK-1190-STATUS
 20223*----------  ワークリターンコード
 20224       MOVE  WK-STATUS            TO  WK-RTN-CODE
 20225*----------  ワークエラーパッケージを編集
 20226       PERFORM  SUB-ERR-MSG-RTN
 20227       INITIALIZE  WK-SYS-ERR-INFO
 20228*----------  エラー検知プログラムID
 20229       MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
 20230*----------  ポジション
 20231       MOVE  CNS-POS-034          TO  WK-ERR-POS
 20232*----------  リターンコード
 20233       MOVE  CNS-RTN-901          TO  WK-RTN-CD
 20234*----------  詳細リターンコード
 20235       MOVE  RTN-CD               OF  PARM-RTNPKG
 20236                                      (COUNTER OF PARM-RTNPKG)
 20237                                  TO  WK-DETAIL-RTN-CD
 20238*----------  詳細リターンコードデコードフラグ
 20239       MOVE  CNS-DETAIL-0         TO  WK-DETAIL-RTN-CD-FLG
 20240*---------- フリーメッセージ
 20241       MOVE  SPACE                TO  WK-FREE-MSG
 20242*----------  エラー情報追加処理
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 350
* MUSR2651.cob                                                     cpy)cpy)y)y)
 20243       PERFORM  ERR-INFO-ADD-RTN
 20244     END-IF
 20245*--------------------<DEBUG>--------------------------------------
 20246D    DISPLAY  CNS-PGM-ID":***  業務エラー1処理 END  ***"
 20247*-----------------------------------------------------------------
 20248     CONTINUE.
 20249 GYOMU-ERR-1-EXT.
 20250     EXIT.
 20251*------------------ <連結障害1077の対応 START>--------------------
 20252******************************************************************
 20253*       ファイル出力件数処理
 20254******************************************************************
 20255 WRITE-KENSUU-RTN       SECTION.
 20256*--------------------<DEBUG>--------------------------------------
 20257D    DISPLAY  CNS-PGM-ID":*** ファイル出力件数処理 START ***"
 20258D    DISPLAY  CNS-PGM-ID":WK-WRITE-TEMP=["WK-WRITE-TEMP"]"
 20259D    DISPLAY  CNS-PGM-ID":WK-WRITE-TEMP2=["WK-WRITE-TEMP2"]"
 20260D    DISPLAY  CNS-PGM-ID":WK-WRITE-TEMP3=["WK-WRITE-TEMP3"]"
 20261D    DISPLAY  CNS-PGM-ID":WK-WRITE-TEMP4=["WK-WRITE-TEMP4"]"
 20262D    DISPLAY  CNS-PGM-ID":WK-STATUS=["WK-STATUS"]"
 20263D    DISPLAY  CNS-PGM-ID":WK-RTN-CODE=["WK-RTN-CODE"]"
 20264*-----------------------------------------------------------------
 20265     IF  WK-WRITE-TEMP = ZERO  AND  WK-WRITE-TEMP2 = ZERO
 20266       AND  WK-WRITE-TEMP3 = ZERO  AND  WK-WRITE-TEMP4 = ZERO
 20267     THEN
 20268         INITIALIZE  WK-GYOMU-ERR-INFO
 20269*---------- 基準日From
 20270         MOVE  WK-KIKAN-FR
 20271           TO  WK-GYOMU-KJN-YMD-FROM
 20272                   OF  WK-GYOMU-ERR-INFO(CNS-1)
 20273*---------- 基準日To
 20274         MOVE  WK-KIKAN-TO
 20275           TO  WK-GYOMU-KJN-YMD-TO
 20276                   OF  WK-GYOMU-ERR-INFO(CNS-1)
 20277*---------- メッセージID
 20278         MOVE  CNS-MSG-I000653
 20279           TO  WK-GYOMU-MSG-ID
 20280                   OF  WK-GYOMU-ERR-INFO(CNS-1)
 20281*---------- 置換文字
 20282         MOVE  CNS-GX-ZANKO
 20283           TO  WK-GYOMU-TK-MOJI(CNS-1,CNS-1)
 20284*---------- フリーメッセージ
 20285         MOVE  SPACE
 20286           TO  WK-GYOMU-FREE-MSG
 20287                   OF  WK-GYOMU-ERR-INFO(CNS-1)
 20288*--------------------<DEBUG>--------------------------------------
 20289D    DISPLAY  CNS-PGM-ID":WK-STATUS=["WK-STATUS"]"
 20290D    DISPLAY  CNS-PGM-ID":WK-RTN-CODE=["WK-RTN-CODE"]"
 20291*-----------------------------------------------------------------
 20292       PERFORM  GYOMU-ERR-1-RTN
 20293     ELSE
 20294       CONTINUE
 20295     END-IF
 20296*--------------------<DEBUG>--------------------------------------
 20297D    DISPLAY  CNS-PGM-ID":WK-STATUS=["WK-STATUS"]"
 20298D    DISPLAY  CNS-PGM-ID":WK-RTN-CODE=["WK-RTN-CODE"]"
 20299D    DISPLAY  CNS-PGM-ID":*** ファイル出力件数処理 END ***"
 20300*-----------------------------------------------------------------
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 351
* MUSR2651.cob                                                     cpy)cpy)y)y)
 20301     CONTINUE.
 20302 WRITE-KENSUU-EXT.
 20303     EXIT.
 20304*------------------ <連結障害1077の対応 END>----------------------
 20305******************************************************************
 20306*       実行状況更新処理2
 20307******************************************************************
 20308 STATUS-KOUSIN-2-RTN    SECTION.
 20309*--------------------<DEBUG>--------------------------------------
 20310D    DISPLAY  CNS-PGM-ID":***  実行状況更新処理2 START  ***"
 20311*----------------------------------------------------------------
 20312     INITIALIZE  PARM-SCZY7210-INOUT
 20313                 PARM-RTNPKG
 20314*----------  セッション区分
 20315     MOVE  CNS-X-1
 20316       TO  SESSION-KBN            OF  PARM-SCZY7210-ARG1
 20317*----------  利用会社コード
 20318     MOVE  WK-RIYO-CMP-CD
 20319       TO  RIYO-CMP-CD            OF  PARM-SCZY7210-ARG2
 20320*----------  処理実行日
 20321     MOVE  WK-SHORI-YMD-9
 20322       TO  SYORI-YMD              OF  PARM-SCZY7210-ARG2
 20323*----------  起動ID
 20324     MOVE  WK-KIDOU-ID
 20325       TO  KIDOU-ID               OF  PARM-SCZY7210-ARG2
 20326*----------  基準日FROM
 20327     MOVE  WK-KIKAN-FR-9
 20328       TO  KJN-YMD-FROM           OF  PARM-SCZY7210-ARG2
 20329*----------  実行ステータス
 20330     EVALUATE  WK-RTN-CODE
 20331       WHEN  ZERO
 20332*----------  実行ステータス0(正常終了)
 20333         MOVE  CNS-STS-100
 20334           TO  JIKOU-STS          OF  PARM-SCZY7210-ARG2
 20335       WHEN  CNS-2
 20336*----------  実行ステータス2(警告終了)
 20337         MOVE  CNS-STS-200
 20338           TO  JIKOU-STS          OF  PARM-SCZY7210-ARG2
 20339*----------  実行ステータス4(業務エラー(続行可能))
 20340       WHEN  CNS-4
 20341         MOVE  CNS-STS-270
 20342           TO  JIKOU-STS          OF  PARM-SCZY7210-ARG2
 20343*----------  実行ステータス6
 20344       WHEN  CNS-6
 20345         MOVE  CNS-STS-275
 20346           TO  JIKOU-STS          OF  PARM-SCZY7210-ARG2
 20347*----------  実行ステータス8(業務エラー(明細続行不可))
 20348       WHEN  CNS-8
 20349         MOVE  CNS-STS-277
 20350           TO  JIKOU-STS          OF  PARM-SCZY7210-ARG2
 20351*----------  実行ステータス10
 20352       WHEN  CNS-10
 20353         MOVE  CNS-STS-375
 20354           TO  JIKOU-STS          OF  PARM-SCZY7210-ARG2
 20355       WHEN  OTHER
 20356*----------  実行ステータス16(システムエラー)
 20357         MOVE  CNS-STS-400
 20358           TO  JIKOU-STS          OF  PARM-SCZY7210-ARG2
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 352
* MUSR2651.cob                                                     cpy)cpy)y)y)
 20359     END-EVALUATE
 20360*--------------------<DEBUG>-------------------------------------
 20361D    DISPLAY  CNS-PGM-ID":WK-RTN-CODE   =[" WK-RTN-CODE"]"
 20362D    DISPLAY  CNS-PGM-ID":JIKOU-STS     =["
 20363D             JIKOU-STS           OF  PARM-SCZY7210-ARG2"]"
 20364D    DISPLAY  CNS-PGM-ID":SCZY7210-ARG:"
 20365D    DISPLAY  CNS-PGM-ID":SESSION-KBN   =["
 20366D             SESSION-KBN         OF  PARM-SCZY7210-ARG1"]"
 20367D    DISPLAY  CNS-PGM-ID":RIYO-CMP-CD   =["
 20368D             RIYO-CMP-CD         OF  PARM-SCZY7210-ARG2"]"
 20369D    DISPLAY  CNS-PGM-ID":SYORI-YMD     =["
 20370D             SYORI-YMD           OF  PARM-SCZY7210-ARG2"]"
 20371D    DISPLAY  CNS-PGM-ID":KIDOU-ID      =["
 20372D             KIDOU-ID            OF  PARM-SCZY7210-ARG2"]"
 20373D    DISPLAY  CNS-PGM-ID":JIKOU-STS     =["
 20374D             JIKOU-STS           OF  PARM-SCZY7210-ARG2"]"
 20375D    DISPLAY  CNS-PGM-ID":***  CALL SCZY7210 START  ***"
 20376*----------------------------------------------------------------
 20377     CALL  "SCZY7210"             USING  PARM-SCZY7210-INOUT
 20378                                         PARM-RTNPKG
 20379*--------------------<DEBUG>-------------------------------------
 20380D    DISPLAY  CNS-PGM-ID":***  CALL SCZY7210 END  ***"
 20381D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY7210)       =["
 20382D             RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)"]"
 20383D    DISPLAY  CNS-PGM-ID":COUNTER OF PARM-RTNPKG =["
 20384D             COUNTER             OF PARM-RTNPKG "]"
 20385*----------------------------------------------------------------
 20386     IF  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
 20387      =  CNS-RTN-000
 20388     THEN
 20389*--------------------<DEBSUG>------------------------------------
 20390D    DISPLAY  CNS-PGM-ID":実行状況更新処理2  正常"
 20391*----------------------------------------------------------------
 20392*----------  ＤＢコミット処理
 20393       PERFORM  DB-COMMIT-RTN
 20394     ELSE
 20395*--------------------<DEBUG>-------------------------------------
 20396D    DISPLAY  CNS-PGM-ID":実行状況更新処理2 システムエラー"
 20397*----------------------------------------------------------------
 20398*----------  ワーク実行ステータス
 20399       MOVE  CNS-RTN-BT16         TO  WK-RTN-CODE
 20400*----------  ワークエラーパッケージを編集
 20401       MOVE  PARM-RTNPKG          TO  PARM-SCZY1170-RTNPKG
 20402       INITIALIZE  WK-SYS-ERR-INFO
 20403*----------  エラー検知プログラムID
 20404       MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
 20405*----------  ポジション
 20406       MOVE  CNS-POS-035          TO  WK-ERR-POS
 20407*----------  リターンコード
 20408       MOVE  CNS-RTN-901          TO  WK-RTN-CD
 20409*----------  詳細リターンコード
 20410       MOVE  RTN-CD               OF  PARM-RTNPKG
 20411                                      (COUNTER OF PARM-RTNPKG)
 20412                                  TO  WK-DETAIL-RTN-CD
 20413*----------  詳細リターンコードデコードフラグ
 20414       MOVE  CNS-DETAIL-0         TO  WK-DETAIL-RTN-CD-FLG
 20415*---------- フリーメッセージ
 20416       MOVE  SPACE                TO  WK-FREE-MSG
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 353
* MUSR2651.cob                                                     cpy)cpy)y)y)
 20417*----------  エラー処理
 20418       PERFORM  ERR-RTN
 20419     END-IF
 20420*--------------------<DEBUG>--------------------------------------
 20421D    DISPLAY  CNS-PGM-ID":***  実行状況更新処理1 END  ***"
 20422*-----------------------------------------------------------------
 20423     CONTINUE.
 20424 STATUS-KOUSIN-2-EXT.
 20425     EXIT.
 20426*******         テーマ2693     20100404 修正  開始        ********
 20427******************************************************************
 20428*    SQL作成（PREPARE）
 20429******************************************************************
 20430 CR-PREPARE-3-RTN       SECTION.
 20431*-------------------<DEBUG>---------------------------------------
 20432D    DISPLAY  CNS-PGM-ID":***  SQL作成(PREPARE3)  START  ***"
 20433*-----------------------------------------------------------------
 20434     INITIALIZE  SQLSTMT-S3
 20435                 HST-SELECT-3-WHERE
 20436                 WK-SELECT-FREE-MSG3
 20437*----------  テーブルTKDYAA40
 20438     MOVE  WK-TBL-TKDYAA40
 20439       TO  SQL-TBL-TKDYAA40       OF  SQL-SELECT-3
 20440*----------  テーブルTKPFZK04
 20441     MOVE  WK-TBL-TKPFZK04
 20442       TO  SQL-TBL-TKPFZK04       OF  SQL-SELECT-3
 20443*----------  利用会社コード
 20444     MOVE  WK-RIYO-CMP-CD
 20445       TO  H-RIYO-CMP-CD-1        OF  HST-SELECT-3-WHERE
 20446*----------  利用会社コード
 20447     MOVE  WK-RIYO-CMP-CD
 20448       TO  H-RIYO-CMP-CD-2        OF  HST-SELECT-3-WHERE
 20449*----------  ファンドコード
 20450     MOVE  WK-FUND-CD-DETAIL      OF  WK-FUND-PTF-DETAIL(WK-IDX-J)
 20451       TO  H-FUND-CD              OF  HST-SELECT-3-WHERE
 20452*----------  ポートフォリオコード
 20453     MOVE  WK-PTF-CD-DETAIL       OF  WK-FUND-PTF-DETAIL(WK-IDX-J)
 20454       TO  H-PTF-CD               OF  HST-SELECT-3-WHERE
 20455*----------  進捗タスクID
 20456     MOVE  CNS-ST01100
 20457       TO  H-SHINTK-TASK-ID       OF  HST-SELECT-3-WHERE
 20458*----------  期間FROM
 20459     MOVE  WK-KIKAN-FR-9
 20460       TO  H-KIKAN-FR             OF  HST-SELECT-3-WHERE
 20461*----------  期間TO
 20462     MOVE  WK-KIKAN-TO-9
 20463       TO  H-KIKAN-TO             OF  HST-SELECT-3-WHERE
 20464     STRING  SQL-SELECT-3
 20465             DELIMITED BY SIZE
 20466             INTO SQLSTMT-S3
 20467     END-STRING
 20468     STRING SQLSTMT-S3(1:FUNCTION  LENGTH(SQL-SELECT-3))
 20469          "[:V1="
 20470           H-RIYO-CMP-CD-1      OF  HST-SELECT-3-WHERE
 20471          "][:V2="
 20472           H-RIYO-CMP-CD-2      OF  HST-SELECT-3-WHERE
 20473          "][:V3="
 20474           H-FUND-CD            OF  HST-SELECT-3-WHERE
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 354
* MUSR2651.cob                                                     cpy)cpy)y)y)
 20475          "][:V4="
 20476           H-PTF-CD             OF  HST-SELECT-3-WHERE
 20477          "][:V6="
 20478           H-SHINTK-TASK-ID     OF  HST-SELECT-3-WHERE
 20479          "][:V7="
 20480           H-KIKAN-FR           OF  HST-SELECT-3-WHERE
 20481          "][:V8="
 20482           H-KIKAN-TO           OF  HST-SELECT-3-WHERE
 20483          "]"
 20484          DELIMITED BY SIZE
 20485          INTO  WK-SELECT-FREE-MSG3
 20486     END-STRING
 20487*-------------------<DEBUG>---------------------------------------
 20488D    DISPLAY  CNS-PGM-ID "テーブルTKDYAA40 =["
 20489D             SQL-TBL-TKDYAA40       OF  SQL-SELECT-3"]"
 20490D    DISPLAY  CNS-PGM-ID "テーブルTKPFZK04 =["
 20491D             SQL-TBL-TKPFZK04       OF  SQL-SELECT-3"]"
 20492D    DISPLAY  CNS-PGM-ID ":利用会社コードH-RIYO-CMP-CD-1 =["
 20493D                 H-RIYO-CMP-CD-1    OF  HST-SELECT-3-WHERE "]"
 20494D    DISPLAY  CNS-PGM-ID ":利用会社コードH-RIYO-CMP-CD-2 =["
 20495D                 H-RIYO-CMP-CD-2    OF  HST-SELECT-3-WHERE "]"
 20496D    DISPLAY  CNS-PGM-ID ":ファンドコードH-FUND-CD     =["
 20497D                 H-FUND-CD          OF  HST-SELECT-3-WHERE "]"
 20498D    DISPLAY  CNS-PGM-ID ":ポートフォリオコードH-PTF-CD      =["
 20499D                 H-PTF-CD           OF  HST-SELECT-3-WHERE "]"
 20500D    DISPLAY  CNS-PGM-ID ":進捗タスクID H-SHINTK-TASK-ID     =["
 20501D                 H-SHINTK-TASK-ID   OF  HST-SELECT-3-WHERE "]"
 20502D    DISPLAY  CNS-PGM-ID ":期間FROM H-KIKAN-FR      =["
 20503D                 H-KIKAN-FR         OF  HST-SELECT-3-WHERE "]"
 20504D    DISPLAY  CNS-PGM-ID ":期間TO H-KIKAN-TO      =["
 20505D                 H-KIKAN-TO         OF  HST-SELECT-3-WHERE "]"
 20506D    DISPLAY  CNS-PGM-ID":SQLSTMT-S3      =["SQLSTMT-S3"]"
 20507D    DISPLAY  CNS-PGM-ID":WK-SELECT-FREE-MSG3 =["
 20508D                 WK-SELECT-FREE-MSG3"]"
 20509*-----------------------------------------------------------------
 20510*    EXEC  SQL
 20511*      PREPARE  SS3  FROM  :SQLSTMT-S3
 20512*    END-EXEC
 20513     MOVE 1 TO SQL-ITERS
 20514     MOVE 673 TO SQL-OFFSET
 20515     MOVE 0 TO SQL-OCCURS
 20516     CALL "SQLADR" USING
 20517         SQLCUD
 20518         SQL-CUD
 20519     CALL "SQLADR" USING
 20520         SQLCA
 20521         SQL-SQLEST
 20522     MOVE 256 TO SQL-SQLETY
 20523     CALL "SQLADR" USING
 20524         SQLSTMT-S3 IN
 20525         HST-AREA
 20526         SQL-SQHSTV(1)
 20527     MOVE 3000 TO SQL-SQHSTL(1)
 20528     MOVE 0 TO SQL-SQHSTS(1)
 20529     MOVE 0 TO SQL-SQINDV(1)
 20530     MOVE 0 TO SQL-SQINDS(1)
 20531     MOVE 0 TO SQL-SQHARM(1)
 20532     CALL "SQLADR" USING
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 355
* MUSR2651.cob                                                     cpy)cpy)y)y)
 20533         SQL-SQHSTV(1)
 20534         SQL-SQPHSV
 20535     CALL "SQLADR" USING
 20536         SQL-SQHSTL(1)
 20537         SQL-SQPHSL
 20538     CALL "SQLADR" USING
 20539         SQL-SQHSTS(1)
 20540         SQL-SQPHSS
 20541     CALL "SQLADR" USING
 20542         SQL-SQINDV(1)
 20543         SQL-SQPIND
 20544     CALL "SQLADR" USING
 20545         SQL-SQINDS(1)
 20546         SQL-SQPINS
 20547     CALL "SQLADR" USING
 20548         SQL-SQHARM(1)
 20549         SQL-SQPARM
 20550     CALL "SQLADR" USING
 20551         SQL-SQHARC(1)
 20552         SQL-SQPARC
 20553
 20554     CALL "SQLBEX" USING
 20555         SQLCTX
 20556         SQLEXD
 20557         SQLFPN
 20558*-------------------<DEBUG>---------------------------------------
 20559D    DISPLAY  CNS-PGM-ID":SQLCODE(PREPARE3)       =["SQLCODE"]"
 20560*-----------------------------------------------------------------
 20561     EVALUATE  SQLCODE
 20562       WHEN  CNS-SQL-NORMAL
 20563         CONTINUE
 20564       WHEN   OTHER
 20565*----------  ワーク実行ステータス
 20566         MOVE  CNS-16             TO  WK-STATUS
 20567*----------  ワークリターンコード
 20568         MOVE  WK-STATUS          TO  WK-RTN-CODE
 20569*----------  ワークエラーパッケージを編集
 20570         INITIALIZE  WK-SYS-ERR-INFO
 20571*----------  エラー検知プログラムID
 20572         MOVE  CNS-PGM-ID         TO  WK-ERR-PGM-ID
 20573*----------  ポジション
 20574         MOVE  CNS-POS-079        TO  WK-ERR-POS
 20575*----------  リターンコード
 20576         MOVE  CNS-RTN-900        TO  WK-RTN-CD
 20577*----------  詳細リターンコード
 20578         MOVE  SQLCODE            TO  WK-DETAIL-RTN-CD
 20579*----------  詳細リターンコードデコードフラグ
 20580         MOVE  CNS-DETAIL-1       TO  WK-DETAIL-RTN-CD-FLG
 20581*---------- フリーメッセージ
 20582         MOVE  WK-SELECT-FREE-MSG3
 20583           TO  WK-FREE-MSG
 20584*----------  エラー情報追加処理
 20585         PERFORM  ERR-INFO-ADD-RTN
 20586     END-EVALUATE
 20587*-------------------<DEBUG>---------------------------------------
 20588D    DISPLAY  CNS-PGM-ID":***  SQL作成(PREPARE3)  END  ***"
 20589*-----------------------------------------------------------------
 20590     CONTINUE.
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 356
* MUSR2651.cob                                                     cpy)cpy)y)y)
 20591 CR-PREPARE-3-EXT.
 20592     EXIT.
 20593******************************************************************
 20594*    カーソル作成（DECLARE，OPEN）
 20595******************************************************************
 20596 CR-OPEN-3-RTN          SECTION.
 20597*-------------------<DEBUG>---------------------------------------
 20598D    DISPLAY  CNS-PGM-ID
 20599D             ":***  カーソル作成(DECLARE，OPEN3)  START  ***"
 20600*-----------------------------------------------------------------
 20601*----------DECLARE CURSOR
 20602*    EXEC  SQL
 20603*      DECLARE  CR3  CURSOR  FOR  SS3
 20604*    END-EXEC
 20605*-------------------<DEBUG>---------------------------------------
 20606D    DISPLAY  CNS-PGM-ID":SQLCODE(CURSOR3 DECLARE)=["SQLCODE"]"
 20607*-----------------------------------------------------------------
 20608*----------OPEN    CURSOR
 20609*    EXEC  SQL
 20610*      OPEN  CR3
 20611*    USING  :HST-SELECT-3-WHERE
 20612*    END-EXEC
 20613     MOVE 1 TO SQL-ITERS
 20614     MOVE 692 TO SQL-OFFSET
 20615     MOVE 0 TO SQL-OCCURS
 20616     MOVE 1 TO SQL-SELERR
 20617     CALL "SQLADR" USING
 20618         SQLCUD
 20619         SQL-CUD
 20620     CALL "SQLADR" USING
 20621         SQLCA
 20622         SQL-SQLEST
 20623     MOVE 256 TO SQL-SQLETY
 20624     CALL "SQLADR" USING
 20625         H-RIYO-CMP-CD-1 IN
 20626         HST-SELECT-3-WHERE IN
 20627         HST-AREA
 20628         SQL-SQHSTV(1)
 20629     MOVE 4 TO SQL-SQHSTL(1)
 20630     MOVE 0 TO SQL-SQHSTS(1)
 20631     MOVE 0 TO SQL-SQINDV(1)
 20632     MOVE 0 TO SQL-SQINDS(1)
 20633     MOVE 0 TO SQL-SQHARM(1)
 20634     CALL "SQLADR" USING
 20635         H-RIYO-CMP-CD-2 IN
 20636         HST-SELECT-3-WHERE IN
 20637         HST-AREA
 20638         SQL-SQHSTV(2)
 20639     MOVE 4 TO SQL-SQHSTL(2)
 20640     MOVE 0 TO SQL-SQHSTS(2)
 20641     MOVE 0 TO SQL-SQINDV(2)
 20642     MOVE 0 TO SQL-SQINDS(2)
 20643     MOVE 0 TO SQL-SQHARM(2)
 20644     CALL "SQLADR" USING
 20645         H-FUND-CD IN
 20646         HST-SELECT-3-WHERE IN
 20647         HST-AREA
 20648         SQL-SQHSTV(3)
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 357
* MUSR2651.cob                                                     cpy)cpy)y)y)
 20649     MOVE 12 TO SQL-SQHSTL(3)
 20650     MOVE 0 TO SQL-SQHSTS(3)
 20651     MOVE 0 TO SQL-SQINDV(3)
 20652     MOVE 0 TO SQL-SQINDS(3)
 20653     MOVE 0 TO SQL-SQHARM(3)
 20654     CALL "SQLADR" USING
 20655         H-PTF-CD IN
 20656         HST-SELECT-3-WHERE IN
 20657         HST-AREA
 20658         SQL-SQHSTV(4)
 20659     MOVE 4 TO SQL-SQHSTL(4)
 20660     MOVE 0 TO SQL-SQHSTS(4)
 20661     MOVE 0 TO SQL-SQINDV(4)
 20662     MOVE 0 TO SQL-SQINDS(4)
 20663     MOVE 0 TO SQL-SQHARM(4)
 20664     CALL "SQLADR" USING
 20665         H-SHINTK-TASK-ID IN
 20666         HST-SELECT-3-WHERE IN
 20667         HST-AREA
 20668         SQL-SQHSTV(5)
 20669     MOVE 7 TO SQL-SQHSTL(5)
 20670     MOVE 0 TO SQL-SQHSTS(5)
 20671     MOVE 0 TO SQL-SQINDV(5)
 20672     MOVE 0 TO SQL-SQINDS(5)
 20673     MOVE 0 TO SQL-SQHARM(5)
 20674     CALL "SQLADR" USING
 20675         H-KIKAN-FR IN
 20676         HST-SELECT-3-WHERE IN
 20677         HST-AREA
 20678         SQL-SQHSTV(6)
 20679     MOVE 8 TO SQL-SQHSTL(6)
 20680     MOVE 0 TO SQL-SQHSTS(6)
 20681     MOVE 0 TO SQL-SQINDV(6)
 20682     MOVE 0 TO SQL-SQINDS(6)
 20683     MOVE 0 TO SQL-SQHARM(6)
 20684     CALL "SQLADR" USING
 20685         H-KIKAN-TO IN
 20686         HST-SELECT-3-WHERE IN
 20687         HST-AREA
 20688         SQL-SQHSTV(7)
 20689     MOVE 8 TO SQL-SQHSTL(7)
 20690     MOVE 0 TO SQL-SQHSTS(7)
 20691     MOVE 0 TO SQL-SQINDV(7)
 20692     MOVE 0 TO SQL-SQINDS(7)
 20693     MOVE 0 TO SQL-SQHARM(7)
 20694     CALL "SQLADR" USING
 20695         SQL-SQHSTV(1)
 20696         SQL-SQPHSV
 20697     CALL "SQLADR" USING
 20698         SQL-SQHSTL(1)
 20699         SQL-SQPHSL
 20700     CALL "SQLADR" USING
 20701         SQL-SQHSTS(1)
 20702         SQL-SQPHSS
 20703     CALL "SQLADR" USING
 20704         SQL-SQINDV(1)
 20705         SQL-SQPIND
 20706     CALL "SQLADR" USING
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 358
* MUSR2651.cob                                                     cpy)cpy)y)y)
 20707         SQL-SQINDS(1)
 20708         SQL-SQPINS
 20709     CALL "SQLADR" USING
 20710         SQL-SQHARM(1)
 20711         SQL-SQPARM
 20712     CALL "SQLADR" USING
 20713         SQL-SQHARC(1)
 20714         SQL-SQPARC
 20715
 20716     CALL "SQLBEX" USING
 20717         SQLCTX
 20718         SQLEXD
 20719         SQLFPN
 20720*-------------------<DEBUG>---------------------------------------
 20721D    DISPLAY  CNS-PGM-ID":SQLCODE(CURSOR3 OPEN)   =["SQLCODE"]"
 20722*-----------------------------------------------------------------
 20723     EVALUATE  SQLCODE
 20724       WHEN  CNS-SQL-NORMAL
 20725         MOVE  CNS-ON               TO  FLG-CR-OPEN3
 20726*-------------------<DEBUG>---------------------------------------
 20727D    DISPLAY  CNS-PGM-ID":FLG-CR-OPEN3 =["FLG-CR-OPEN3"]"
 20728*-----------------------------------------------------------------
 20729       WHEN   OTHER
 20730*----------  ワーク実行ステータス
 20731         MOVE  CNS-16               TO  WK-STATUS
 20732*----------  ワークリターンコード
 20733         MOVE  WK-STATUS            TO  WK-RTN-CODE
 20734*----------  ワークエラーパッケージを編集
 20735         INITIALIZE  WK-SYS-ERR-INFO
 20736*----------  エラー検知プログラムID
 20737         MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
 20738*----------  ポジション
 20739         MOVE  CNS-POS-080          TO  WK-ERR-POS
 20740*----------  リターンコード
 20741         MOVE  CNS-RTN-900          TO  WK-RTN-CD
 20742*----------  詳細リターンコード
 20743         MOVE  SQLCODE              TO  WK-DETAIL-RTN-CD
 20744*----------  詳細リターンコードデコードフラグ
 20745         MOVE  CNS-DETAIL-1         TO  WK-DETAIL-RTN-CD-FLG
 20746*---------- フリーメッセージ
 20747         MOVE  WK-SELECT-FREE-MSG3  TO  WK-FREE-MSG
 20748*----------  エラー情報追加処理
 20749         PERFORM  ERR-INFO-ADD-RTN
 20750     END-EVALUATE
 20751*-------------------<DEBUG>---------------------------------------
 20752D    DISPLAY  CNS-PGM-ID
 20753D             ":***  カーソル作成(DECLARE，OPEN3)  END  ***"
 20754*-----------------------------------------------------------------
 20755     CONTINUE.
 20756 CR-OPEN-3-EXT.
 20757     EXIT.
 20758******************************************************************
 20759*    カーソル（FETCH）
 20760******************************************************************
 20761 CR-FETCH-3-RTN         SECTION.
 20762*-------------------<DEBUG>---------------------------------------
 20763D    DISPLAY  CNS-PGM-ID":***  カーソル3(FETCH)  START  ***"
 20764*-----------------------------------------------------------------
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 359
* MUSR2651.cob                                                     cpy)cpy)y)y)
 20765     INITIALIZE  HST-TBL-SELECT-3
 20766*----------  CURSOR FETCH
 20767*    EXEC SQL
 20768*      FETCH CR3
 20769*      INTO  :HST-TBL-SELECT-3.H-TEKIYO-FR
 20770*    END-EXEC
 20771     MOVE 1 TO SQL-ITERS
 20772     MOVE 735 TO SQL-OFFSET
 20773     MOVE 0 TO SQL-OCCURS
 20774     MOVE 1 TO SQL-SELERR
 20775     CALL "SQLADR" USING
 20776         SQLCUD
 20777         SQL-CUD
 20778     CALL "SQLADR" USING
 20779         SQLCA
 20780         SQL-SQLEST
 20781     MOVE 256 TO SQL-SQLETY
 20782     CALL "SQLADR" USING
 20783         H-TEKIYO-FR IN
 20784         HST-TBL-SELECT-3 IN
 20785         HST-AREA
 20786         SQL-SQHSTV(1)
 20787     MOVE 8 TO SQL-SQHSTL(1)
 20788     MOVE 0 TO SQL-SQHSTS(1)
 20789     MOVE 0 TO SQL-SQINDV(1)
 20790     MOVE 0 TO SQL-SQINDS(1)
 20791     MOVE 0 TO SQL-SQHARM(1)
 20792     CALL "SQLADR" USING
 20793         SQL-SQHSTV(1)
 20794         SQL-SQPHSV
 20795     CALL "SQLADR" USING
 20796         SQL-SQHSTL(1)
 20797         SQL-SQPHSL
 20798     CALL "SQLADR" USING
 20799         SQL-SQHSTS(1)
 20800         SQL-SQPHSS
 20801     CALL "SQLADR" USING
 20802         SQL-SQINDV(1)
 20803         SQL-SQPIND
 20804     CALL "SQLADR" USING
 20805         SQL-SQINDS(1)
 20806         SQL-SQPINS
 20807     CALL "SQLADR" USING
 20808         SQL-SQHARM(1)
 20809         SQL-SQPARM
 20810     CALL "SQLADR" USING
 20811         SQL-SQHARC(1)
 20812         SQL-SQPARC
 20813
 20814     CALL "SQLBEX" USING
 20815         SQLCTX
 20816         SQLEXD
 20817         SQLFPN
 20818*-------------------<DEBUG>---------------------------------------
 20819D    DISPLAY  CNS-PGM-ID":SQLCODE(CURSOR3 FETCH)  =["SQLCODE"]"
 20820*-----------------------------------------------------------------
 20821     EVALUATE  SQLCODE
 20822       WHEN  CNS-SQL-NORMAL
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 360
* MUSR2651.cob                                                     cpy)cpy)y)y)
 20823*----------  次のto年月日へ進む
 20824         MOVE  CNS-ON             TO  FLG-NEXT-MEISAI
 20825*----------  ワーク実行ステータス
 20826         IF  WK-STATUS < CNS-4
 20827         THEN
 20828           MOVE  CNS-4            TO  WK-STATUS
 20829         ELSE
 20830           CONTINUE
 20831         END-IF
 20832*----------  ワークリターンコード
 20833         IF  WK-STATUS > WK-RTN-CODE
 20834         THEN
 20835           MOVE  WK-STATUS        TO  WK-RTN-CODE
 20836         ELSE
 20837           CONTINUE
 20838         END-IF
 20839*--------------------<DEBUG>--------------------------------------
 20840D    DISPLAY  CNS-PGM-ID":WK-RTN-CODE=["WK-RTN-CODE"]"
 20841*-----------------------------------------------------------------
 20842*----------  ワーク業務エラーパッケージを編集
 20843         INITIALIZE  WK-GYOMU-ERR-INFO
 20844*----------  基準日実行ステータス
 20845*---------- ファンドコード
 20846         MOVE  WK-FUND-CD-DETAIL    OF  WK-PTF-ATT-DATA(WK-IDX-J)
 20847           TO  WK-GYOMU-FUND-CD     OF  WK-GYOMU-ERR-INFO(CNS-1)
 20848*---------- ポートフォリオコード
 20849         MOVE  WK-PTF-CD-DETAIL     OF  WK-PTF-ATT-DATA(WK-IDX-J)
 20850           TO  WK-GYOMU-PTF-CD      OF  WK-GYOMU-ERR-INFO(CNS-1)
 20851*---------- 評価系列コード
 20852         MOVE  WK-DEFAUL-THYK-CD    OF  WK-PTF-ATT-DATA(WK-IDX-J)
 20853           TO  WK-GYOMU-HYK-KRTU-CD  OF  WK-GYOMU-ERR-INFO(CNS-1)
 20854*---------- 基準日From
 20855         MOVE  WK-KIKAN-FR
 20856           TO  WK-GYOMU-KJN-YMD-FROM  OF  WK-GYOMU-ERR-INFO(CNS-1)
 20857*---------- 基準日To
 20858         MOVE  WK-KIKAN-TO
 20859           TO  WK-GYOMU-KJN-YMD-TO  OF  WK-GYOMU-ERR-INFO(CNS-1)
 20860*---------- メッセージID
 20861         MOVE  CNS-MSG-E000355
 20862           TO  WK-GYOMU-MSG-ID      OF  WK-GYOMU-ERR-INFO(CNS-1)
 20863*---------- 置換文字
 20864         MOVE  SPACE
 20865           TO  WK-GYOMU-TK-MOJI(CNS-1,CNS-1)
 20866*---------- フリーメッセージ
 20867         MOVE  SPACE
 20868           TO  WK-GYOMU-FREE-MSG    OF  WK-GYOMU-ERR-INFO(CNS-1)
 20869*----------  業務エラー1処理
 20870         PERFORM  GYOMU-ERR-1-RTN
 20871       WHEN  CNS-SQL-NOTFOUND
 20872         CONTINUE
 20873       WHEN  OTHER
 20874*----------  ワーク実行ステータス
 20875         MOVE  CNS-16               TO  WK-STATUS
 20876*----------  ワークリターンコード
 20877         MOVE  WK-STATUS            TO  WK-RTN-CODE
 20878*----------  ワークエラーパッケージを編集
 20879         INITIALIZE  WK-SYS-ERR-INFO
 20880*----------  エラー検知プログラムID
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 361
* MUSR2651.cob                                                     cpy)cpy)y)y)
 20881         MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
 20882*----------  ポジション
 20883         MOVE  CNS-POS-081          TO  WK-ERR-POS
 20884*----------  リターンコード
 20885         MOVE  CNS-RTN-900          TO  WK-RTN-CD
 20886*----------  詳細リターンコード
 20887         MOVE  SQLCODE              TO  WK-DETAIL-RTN-CD
 20888*----------  詳細リターンコードデコードフラグ
 20889         MOVE  CNS-DETAIL-1         TO  WK-DETAIL-RTN-CD-FLG
 20890*---------- フリーメッセージ
 20891         MOVE  WK-SELECT-FREE-MSG3  TO  WK-FREE-MSG
 20892*----------  エラー情報追加処理
 20893         PERFORM  ERR-INFO-ADD-RTN
 20894     END-EVALUATE
 20895*-------------------<DEBUG>---------------------------------------
 20896D    DISPLAY  CNS-PGM-ID":= ["WK-TEMP-MSG"]"
 20897*-----------------------------------------------------------------
 20898     CONTINUE.
 20899 CR-FETCH-3-EXT.
 20900     EXIT.
 20901*******         テーマ2693     20100404 修正  終了        ********
 20902******************************************************************
 20903*    3.3.後処理
 20904******************************************************************
 20905 END-RTN                SECTION.
 20906*--------------------<DEBUG>--------------------------------------
 20907D    DISPLAY  CNS-PGM-ID":***  後処理  START  ***"
 20908D    DISPLAY  CNS-PGM-ID":WK-RTN-CODE=["WK-RTN-CODE"]"
 20909*-----------------------------------------------------------------
 20910*******    連結障害対応No.362      20081104 修正  開始    ********
 20911*----------   転送制御ファイル作成
 20912     PERFORM  SCZY7180-RTN
 20913*******    連結障害対応No.362      20081104 修正  終了    ********
 20914*--------------------<DEBUG>--------------------------------------
 20915D    DISPLAY  CNS-PGM-ID":FLG-GYOMU-ERR=["FLG-GYOMU-ERR"]"
 20916*-----------------------------------------------------------------
 20917*----------  3.3.1.業務エラー2処理
 20918     IF  FLG-GYOMU-ERR = CNS-ON
 20919     THEN
 20920       PERFORM  GYOMU-ERR-2-RTN
 20921     ELSE
 20922*-------------------<DEBUG>---------------------------------------
 20923D    DISPLAY  CNS-PGM-ID":**** 業務エラー2処理しない ****"
 20924*-----------------------------------------------------------------
 20925       CONTINUE
 20926     END-IF
 20927     IF  FLG-CR-OPEN = CNS-ON
 20928     THEN
 20929       PERFORM  CR-CLOSE-2-RTN
 20930     ELSE
 20931*-------------------<DEBUG>---------------------------------------
 20932D    DISPLAY  CNS-PGM-ID":**** カーソルクローズ処理しない ****"
 20933*-----------------------------------------------------------------
 20934       CONTINUE
 20935     END-IF
 20936     IF  FLG-CR-OPEN2 = CNS-ON
 20937     THEN
 20938       PERFORM  CR-CLOSE-4-RTN
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 362
* MUSR2651.cob                                                     cpy)cpy)y)y)
 20939     ELSE
 20940*-------------------<DEBUG>---------------------------------------
 20941D    DISPLAY  CNS-PGM-ID":**** カーソルクローズ処理2しない ****"
 20942*-----------------------------------------------------------------
 20943       CONTINUE
 20944     END-IF
 20945*******         テーマ2693     20100404 修正  開始        ********
 20946     IF  FLG-CR-OPEN3 = CNS-ON
 20947     THEN
 20948       PERFORM  CR-CLOSE-6-RTN
 20949     ELSE
 20950*-------------------<DEBUG>---------------------------------------
 20951D    DISPLAY  CNS-PGM-ID":**** カーソルクローズ処理3しない ****"
 20952*-----------------------------------------------------------------
 20953       CONTINUE
 20954     END-IF
 20955*******         テーマ2693     20100404 修正  終了        ********
 20956*----------  3.3.2.ダウンロードファイル1をクローズ
 20957*--------------------<DEBUG>--------------------------------------
 20958D    DISPLAY  CNS-PGM-ID":FLG-FILE-OPEN=["FLG-FILE-OPEN"]"
 20959*-----------------------------------------------------------------
 20960     IF  FLG-FILE-OPEN = CNS-ON
 20961     THEN
 20962       PERFORM  CLOSE-FILE-RTN
 20963     ELSE
 20964*--------------------<DEBUG>--------------------------------------
 20965D    DISPLAY  CNS-PGM-ID":*** ファイル1をクローズしない  ***"
 20966*-----------------------------------------------------------------
 20967       CONTINUE
 20968     END-IF
 20969*----------  3.3.2.ダウンロードファイル2をクローズ
 20970*--------------------<DEBUG>--------------------------------------
 20971D    DISPLAY  CNS-PGM-ID":FLG-FILE-OPEN-2=["FLG-FILE-OPEN-2"]"
 20972*-----------------------------------------------------------------
 20973     IF  FLG-FILE-OPEN-2 = CNS-ON
 20974     THEN
 20975       PERFORM  CLOSE-FILE-2-RTN
 20976     ELSE
 20977*--------------------<DEBUG>--------------------------------------
 20978D    DISPLAY  CNS-PGM-ID":*** ファイル2をクローズしない  ***"
 20979*-----------------------------------------------------------------
 20980       CONTINUE
 20981     END-IF
 20982*----------   ダウンロードファイル3をクローズ
 20983*--------------------<DEBUG>--------------------------------------
 20984D    DISPLAY  CNS-PGM-ID":FLG-FILE-OPEN-3=["FLG-FILE-OPEN-3"]"
 20985*-----------------------------------------------------------------
 20986     IF  FLG-FILE-OPEN-3 = CNS-ON
 20987     THEN
 20988       PERFORM  CLOSE-FILE-3-RTN
 20989     ELSE
 20990*--------------------<DEBUG>--------------------------------------
 20991D    DISPLAY  CNS-PGM-ID":*** ファイル3をクローズしない  ***"
 20992*-----------------------------------------------------------------
 20993       CONTINUE
 20994     END-IF
 20995*----------   ダウンロードファイル4をクローズ
 20996*--------------------<DEBUG>--------------------------------------
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 363
* MUSR2651.cob                                                     cpy)cpy)y)y)
 20997D    DISPLAY  CNS-PGM-ID":FLG-FILE-OPEN-4=["FLG-FILE-OPEN-4"]"
 20998*-----------------------------------------------------------------
 20999     IF  FLG-FILE-OPEN-4 = CNS-ON
 21000     THEN
 21001       PERFORM  CLOSE-FILE-4-RTN
 21002     ELSE
 21003*--------------------<DEBUG>--------------------------------------
 21004D    DISPLAY  CNS-PGM-ID":*** ファイル4をクローズしない  ***"
 21005*-----------------------------------------------------------------
 21006       CONTINUE
 21007     END-IF
 21008*----------   ダウンロードファイル5をクローズ
 21009*--------------------<DEBUG>--------------------------------------
 21010D    DISPLAY  CNS-PGM-ID":FLG-FILE-OPEN-5=["FLG-FILE-OPEN-5"]"
 21011*-----------------------------------------------------------------
 21012     IF  FLG-FILE-OPEN-5 = CNS-ON
 21013     THEN
 21014       PERFORM  CLOSE-FILE-5-RTN
 21015     ELSE
 21016*--------------------<DEBUG>--------------------------------------
 21017D    DISPLAY  CNS-PGM-ID":*** ファイル5をクローズしない  ***"
 21018*-----------------------------------------------------------------
 21019       CONTINUE
 21020     END-IF
 21021*----------   ダウンロードファイル6をクローズ
 21022*--------------------<DEBUG>--------------------------------------
 21023D    DISPLAY  CNS-PGM-ID":FLG-FILE-OPEN-6=["FLG-FILE-OPEN-6"]"
 21024*-----------------------------------------------------------------
 21025     IF  FLG-FILE-OPEN-6 = CNS-ON
 21026     THEN
 21027       PERFORM  CLOSE-FILE-6-RTN
 21028     ELSE
 21029*--------------------<DEBUG>--------------------------------------
 21030D    DISPLAY  CNS-PGM-ID":*** ファイル6をクローズしない  ***"
 21031*-----------------------------------------------------------------
 21032       CONTINUE
 21033     END-IF
 21034*----------   ダウンロードファイル7をクローズ
 21035*--------------------<DEBUG>--------------------------------------
 21036D    DISPLAY  CNS-PGM-ID":FLG-FILE-OPEN-7=["FLG-FILE-OPEN-7"]"
 21037*-----------------------------------------------------------------
 21038     IF  FLG-FILE-OPEN-7 = CNS-ON
 21039     THEN
 21040       PERFORM  CLOSE-FILE-7-RTN
 21041     ELSE
 21042*--------------------<DEBUG>--------------------------------------
 21043D    DISPLAY  CNS-PGM-ID":*** ファイル7をクローズしない  ***"
 21044*-----------------------------------------------------------------
 21045       CONTINUE
 21046     END-IF
 21047*----------   ダウンロードファイル8をクローズ
 21048*--------------------<DEBUG>--------------------------------------
 21049D    DISPLAY  CNS-PGM-ID":FLG-FILE-OPEN-8=["FLG-FILE-OPEN-8"]"
 21050*-----------------------------------------------------------------
 21051     IF  FLG-FILE-OPEN-8 = CNS-ON
 21052     THEN
 21053       PERFORM  CLOSE-FILE-8-RTN
 21054     ELSE
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 364
* MUSR2651.cob                                                     cpy)cpy)y)y)
 21055*--------------------<DEBUG>--------------------------------------
 21056D    DISPLAY  CNS-PGM-ID":*** ファイル8をクローズしない  ***"
 21057*-----------------------------------------------------------------
 21058       CONTINUE
 21059     END-IF
 21060*----------  3.3.3.ＤＢコミットリリース処理
 21061     PERFORM  COMMIT-ORA-REL-RTN
 21062*----------  3.3.4.処理件数メッセージ出力処理
 21063     PERFORM  SYORI-CNT-MSG-RTN
 21064*--------------------<DEBUG>--------------------------------------
 21065D    DISPLAY  CNS-PGM-ID":WK-RTN-CODE=["WK-RTN-CODE"]"
 21066*-----------------------------------------------------------------
 21067*----------  3.3.5.終了メッセージ出力処理
 21068     IF  WK-RTN-CODE >= CNS-RTN-BT4
 21069     THEN
 21070       MOVE  CNS-U                TO  WK-ERR-SYUBETU
 21071     ELSE
 21072       MOVE  CNS-N                TO  WK-ERR-SYUBETU
 21073     END-IF
 21074     PERFORM  END-MSG-OUT-RTN
 21075*--------------------<DEBUG>--------------------------------------
 21076D    DISPLAY  CNS-PGM-ID":***  後処理  END  ***"
 21077D    DISPLAY  CNS-PGM-ID":ワークリターンコード=["WK-RTN-CODE"]"
 21078*-----------------------------------------------------------------
 21079     CONTINUE.
 21080 END-EXT.
 21081     STOP RUN  WK-RTN-CODE.
 21082******************************************************************
 21083*    3.4.エラー処理
 21084******************************************************************
 21085 ERR-RTN                SECTION.
 21086*--------------------<DEBUG>--------------------------------------
 21087D    DISPLAY  CNS-PGM-ID":***  エラー処理  START  ***"
 21088D    DISPLAY  CNS-PGM-ID":FLG-SYSTEM-ERR=["FLG-SYSTEM-ERR"]"
 21089*-----------------------------------------------------------------
 21090*----------  3.4.1.ダウンロードファイルをクローズ
 21091*--------------------<DEBUG>--------------------------------------
 21092D    DISPLAY  CNS-PGM-ID":FLG-FILE-OPEN=["FLG-FILE-OPEN"]"
 21093*-----------------------------------------------------------------
 21094     IF  FLG-FILE-OPEN = CNS-ON
 21095     THEN
 21096       MOVE  CNS-OFF                 TO  FLG-FILE-OPEN
 21097       CLOSE  OUT-FILE
 21098*--------------------<DEBUG>--------------------------------------
 21099D    DISPLAY  CNS-PGM-ID":*** ファイル1をクローズ  ***"
 21100D    DISPLAY  CNS-PGM-ID":FILE-STATUS=[" WK-FILE-STATUS "]"
 21101*-----------------------------------------------------------------
 21102     ELSE
 21103*--------------------<DEBUG>--------------------------------------
 21104D    DISPLAY  CNS-PGM-ID":*** ファイル1をクローズしない  ***"
 21105*-----------------------------------------------------------------
 21106       CONTINUE
 21107     END-IF
 21108*----------  3.4.2.ダウンロードファイル2をクローズ
 21109*--------------------<DEBUG>--------------------------------------
 21110D    DISPLAY  CNS-PGM-ID":FLG-FILE-OPEN-2=["FLG-FILE-OPEN-2"]"
 21111*-----------------------------------------------------------------
 21112     IF  FLG-FILE-OPEN-2 = CNS-ON
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 365
* MUSR2651.cob                                                     cpy)cpy)y)y)
 21113     THEN
 21114       MOVE  CNS-OFF                 TO  FLG-FILE-OPEN-2
 21115       CLOSE  OUT-FILE-2
 21116*--------------------<DEBUG>--------------------------------------
 21117D    DISPLAY  CNS-PGM-ID":*** ファイル2をクローズ  ***"
 21118D    DISPLAY  CNS-PGM-ID":FILE-STATUS-2=[" WK-FILE-STATUS-2 "]"
 21119*-----------------------------------------------------------------
 21120     ELSE
 21121*--------------------<DEBUG>--------------------------------------
 21122D    DISPLAY  CNS-PGM-ID":*** ファイル2をクローズしない  ***"
 21123*-----------------------------------------------------------------
 21124       CONTINUE
 21125     END-IF
 21126*----------   ダウンロードファイル3をクローズ
 21127*--------------------<DEBUG>--------------------------------------
 21128D    DISPLAY  CNS-PGM-ID":FLG-FILE-OPEN-3=["FLG-FILE-OPEN-3"]"
 21129*-----------------------------------------------------------------
 21130     IF  FLG-FILE-OPEN-3 = CNS-ON
 21131     THEN
 21132       MOVE  CNS-OFF                 TO  FLG-FILE-OPEN-3
 21133       CLOSE  OUT-FILE-3
 21134*--------------------<DEBUG>--------------------------------------
 21135D    DISPLAY  CNS-PGM-ID":*** ファイル3をクローズ  ***"
 21136D    DISPLAY  CNS-PGM-ID":FILE-STATUS-3=[" WK-FILE-STATUS-3 "]"
 21137*-----------------------------------------------------------------
 21138     ELSE
 21139*--------------------<DEBUG>--------------------------------------
 21140D    DISPLAY  CNS-PGM-ID":*** ファイル3をクローズしない  ***"
 21141*-----------------------------------------------------------------
 21142       CONTINUE
 21143     END-IF
 21144*----------   ダウンロードファイル4をクローズ
 21145*--------------------<DEBUG>--------------------------------------
 21146D    DISPLAY  CNS-PGM-ID":FLG-FILE-OPEN-4=["FLG-FILE-OPEN-4"]"
 21147*-----------------------------------------------------------------
 21148     IF  FLG-FILE-OPEN-4 = CNS-ON
 21149     THEN
 21150       MOVE  CNS-OFF                 TO  FLG-FILE-OPEN-4
 21151       CLOSE  OUT-FILE-4
 21152*--------------------<DEBUG>--------------------------------------
 21153D    DISPLAY  CNS-PGM-ID":*** ファイル4をクローズ  ***"
 21154D    DISPLAY  CNS-PGM-ID":FILE-STATUS-4=[" WK-FILE-STATUS-4 "]"
 21155*-----------------------------------------------------------------
 21156     ELSE
 21157*--------------------<DEBUG>--------------------------------------
 21158D    DISPLAY  CNS-PGM-ID":*** ファイル4をクローズしない  ***"
 21159*-----------------------------------------------------------------
 21160       CONTINUE
 21161     END-IF
 21162*----------   ダウンロードファイル5をクローズ
 21163*--------------------<DEBUG>--------------------------------------
 21164D    DISPLAY  CNS-PGM-ID":FLG-FILE-OPEN-5=["FLG-FILE-OPEN-5"]"
 21165*-----------------------------------------------------------------
 21166     IF  FLG-FILE-OPEN-5 = CNS-ON
 21167     THEN
 21168       MOVE  CNS-OFF                 TO  FLG-FILE-OPEN-5
 21169       CLOSE  OUT-FILE-5
 21170*--------------------<DEBUG>--------------------------------------
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 366
* MUSR2651.cob                                                     cpy)cpy)y)y)
 21171D    DISPLAY  CNS-PGM-ID":*** ファイル5をクローズ  ***"
 21172D    DISPLAY  CNS-PGM-ID":FILE-STATUS-5=[" WK-FILE-STATUS-5 "]"
 21173*-----------------------------------------------------------------
 21174     ELSE
 21175*--------------------<DEBUG>--------------------------------------
 21176D    DISPLAY  CNS-PGM-ID":*** ファイル5をクローズしない  ***"
 21177*-----------------------------------------------------------------
 21178       CONTINUE
 21179     END-IF
 21180*----------   ダウンロードファイル6をクローズ
 21181*--------------------<DEBUG>--------------------------------------
 21182D    DISPLAY  CNS-PGM-ID":FLG-FILE-OPEN-6=["FLG-FILE-OPEN-6"]"
 21183*-----------------------------------------------------------------
 21184     IF  FLG-FILE-OPEN-6 = CNS-ON
 21185     THEN
 21186       MOVE  CNS-OFF                 TO  FLG-FILE-OPEN-6
 21187       CLOSE  OUT-FILE-6
 21188*--------------------<DEBUG>--------------------------------------
 21189D    DISPLAY  CNS-PGM-ID":*** ファイル6をクローズ  ***"
 21190D    DISPLAY  CNS-PGM-ID":FILE-STATUS-6=[" WK-FILE-STATUS-6 "]"
 21191*-----------------------------------------------------------------
 21192     ELSE
 21193*--------------------<DEBUG>--------------------------------------
 21194D    DISPLAY  CNS-PGM-ID":*** ファイル6をクローズしない  ***"
 21195*-----------------------------------------------------------------
 21196       CONTINUE
 21197     END-IF
 21198*----------   ダウンロードファイル7をクローズ
 21199*--------------------<DEBUG>--------------------------------------
 21200D    DISPLAY  CNS-PGM-ID":FLG-FILE-OPEN-7=["FLG-FILE-OPEN-7"]"
 21201*-----------------------------------------------------------------
 21202     IF  FLG-FILE-OPEN-7 = CNS-ON
 21203     THEN
 21204       MOVE  CNS-OFF                 TO  FLG-FILE-OPEN-7
 21205       CLOSE  OUT-FILE-7
 21206*--------------------<DEBUG>--------------------------------------
 21207D    DISPLAY  CNS-PGM-ID":*** ファイル7をクローズ  ***"
 21208D    DISPLAY  CNS-PGM-ID":FILE-STATUS-7=[" WK-FILE-STATUS-7 "]"
 21209*-----------------------------------------------------------------
 21210     ELSE
 21211*--------------------<DEBUG>--------------------------------------
 21212D    DISPLAY  CNS-PGM-ID":*** ファイル7をクローズしない  ***"
 21213*-----------------------------------------------------------------
 21214       CONTINUE
 21215     END-IF
 21216*----------   ダウンロードファイル8をクローズ
 21217*--------------------<DEBUG>--------------------------------------
 21218D    DISPLAY  CNS-PGM-ID":FLG-FILE-OPEN-8=["FLG-FILE-OPEN-8"]"
 21219*-----------------------------------------------------------------
 21220     IF  FLG-FILE-OPEN-8 = CNS-ON
 21221     THEN
 21222       MOVE  CNS-OFF                 TO  FLG-FILE-OPEN-8
 21223       CLOSE  OUT-FILE-8
 21224*--------------------<DEBUG>--------------------------------------
 21225D    DISPLAY  CNS-PGM-ID":*** ファイル8をクローズ  ***"
 21226D    DISPLAY  CNS-PGM-ID":FILE-STATUS-8=[" WK-FILE-STATUS-8 "]"
 21227*-----------------------------------------------------------------
 21228     ELSE
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 367
* MUSR2651.cob                                                     cpy)cpy)y)y)
 21229*--------------------<DEBUG>--------------------------------------
 21230D    DISPLAY  CNS-PGM-ID":*** ファイル8をクローズしない  ***"
 21231*-----------------------------------------------------------------
 21232       CONTINUE
 21233     END-IF
 21234     IF  FLG-CR-OPEN = CNS-ON
 21235     THEN
 21236*      EXEC  SQL
 21237*          CLOSE CR
 21238*      END-EXEC
 21239       MOVE 1 TO SQL-ITERS
 21240       MOVE 754 TO SQL-OFFSET
 21241       MOVE 0 TO SQL-OCCURS
 21242       CALL "SQLADR" USING
 21243           SQLCUD
 21244           SQL-CUD
 21245       CALL "SQLADR" USING
 21246           SQLCA
 21247           SQL-SQLEST
 21248       MOVE 256 TO SQL-SQLETY
 21249
 21250       CALL "SQLBEX" USING
 21251           SQLCTX
 21252           SQLEXD
 21253           SQLFPN
 21254       MOVE  CNS-OFF                TO  FLG-CR-OPEN
 21255*--------------------<DEBUG>--------------------------------------
 21256D    DISPLAY  CNS-PGM-ID":*** カーソルクローズをクローズ  ***"
 21257D    DISPLAY  CNS-PGM-ID":FLG-CR-OPEN=[" FLG-CR-OPEN "]"
 21258*-----------------------------------------------------------------
 21259     ELSE
 21260*-------------------<DEBUG>---------------------------------------
 21261D    DISPLAY  CNS-PGM-ID":**** カーソルクローズ処理しない ****"
 21262*-----------------------------------------------------------------
 21263       CONTINUE
 21264     END-IF
 21265     IF  FLG-CR-OPEN2 = CNS-ON
 21266     THEN
 21267*      EXEC  SQL
 21268*          CLOSE CR2
 21269*      END-EXEC
 21270       MOVE 1 TO SQL-ITERS
 21271       MOVE 769 TO SQL-OFFSET
 21272       MOVE 0 TO SQL-OCCURS
 21273       CALL "SQLADR" USING
 21274           SQLCUD
 21275           SQL-CUD
 21276       CALL "SQLADR" USING
 21277           SQLCA
 21278           SQL-SQLEST
 21279       MOVE 256 TO SQL-SQLETY
 21280
 21281       CALL "SQLBEX" USING
 21282           SQLCTX
 21283           SQLEXD
 21284           SQLFPN
 21285       MOVE  CNS-OFF                TO  FLG-CR-OPEN2
 21286*--------------------<DEBUG>--------------------------------------
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 368
* MUSR2651.cob                                                     cpy)cpy)y)y)
 21287D    DISPLAY  CNS-PGM-ID":*** カーソルクローズ2をクローズ  ***"
 21288D    DISPLAY  CNS-PGM-ID":FLG-CR-OPEN2=[" FLG-CR-OPEN2 "]"
 21289*-----------------------------------------------------------------
 21290     ELSE
 21291*-------------------<DEBUG>---------------------------------------
 21292D    DISPLAY  CNS-PGM-ID":**** カーソルクローズ処理2しない ****"
 21293*-----------------------------------------------------------------
 21294       CONTINUE
 21295     END-IF
 21296*******         テーマ2693     20100404 修正  開始        ********
 21297     IF  FLG-CR-OPEN3 = CNS-ON
 21298     THEN
 21299*      EXEC  SQL
 21300*          CLOSE CR3
 21301*      END-EXEC
 21302       MOVE 1 TO SQL-ITERS
 21303       MOVE 784 TO SQL-OFFSET
 21304       MOVE 0 TO SQL-OCCURS
 21305       CALL "SQLADR" USING
 21306           SQLCUD
 21307           SQL-CUD
 21308       CALL "SQLADR" USING
 21309           SQLCA
 21310           SQL-SQLEST
 21311       MOVE 256 TO SQL-SQLETY
 21312
 21313       CALL "SQLBEX" USING
 21314           SQLCTX
 21315           SQLEXD
 21316           SQLFPN
 21317       MOVE  CNS-OFF                TO  FLG-CR-OPEN3
 21318*--------------------<DEBUG>--------------------------------------
 21319D    DISPLAY  CNS-PGM-ID":*** カーソルクローズ3をクローズ  ***"
 21320D    DISPLAY  CNS-PGM-ID":FLG-CR-OPEN3=[" FLG-CR-OPEN3 "]"
 21321*-----------------------------------------------------------------
 21322     ELSE
 21323*-------------------<DEBUG>---------------------------------------
 21324D    DISPLAY  CNS-PGM-ID":**** カーソルクローズ処理3しない ****"
 21325*-----------------------------------------------------------------
 21326       CONTINUE
 21327     END-IF
 21328*******         テーマ2693     20100404 修正  終了        ********
 21329*----------  3.4.3.エラー2情報追加処理
 21330*--------------------<DEBUG>--------------------------------------
 21331D    DISPLAY  CNS-PGM-ID":FLG-SYSTEM-ERR=["FLG-SYSTEM-ERR"]"
 21332*-----------------------------------------------------------------
 21333     IF  FLG-SYSTEM-ERR = CNS-OFF
 21334     THEN
 21335       PERFORM  ERR-MSG-OUT-RTN
 21336     ELSE
 21337       MOVE  CNS-OFF              TO  FLG-SYSTEM-ERR
 21338*-------------------<DEBUG>---------------------------------------
 21339D    DISPLAY  CNS-PGM-ID":**** エラー2情報追加処理しない ****"
 21340*-----------------------------------------------------------------
 21341     END-IF
 21342*----------  3.4.3.ＤＢロールバックリリース処理
 21343*--------------------<DEBUG>--------------------------------------
 21344D    DISPLAY  CNS-PGM-ID":FLG-ORA-CONNECT=["FLG-ORA-CONNECT"]"
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 369
* MUSR2651.cob                                                     cpy)cpy)y)y)
 21345*-----------------------------------------------------------------
 21346     IF  FLG-ORA-CONNECT         =  CNS-ON
 21347     THEN
 21348       PERFORM  ROLLBACK-ORA-REL-RTN
 21349     ELSE
 21350*-------------------<DEBUG>---------------------------------------
 21351D    DISPLAY  CNS-PGM-ID":**** ＤＢロールバックリリース処理"
 21352D            "しない****"
 21353*-----------------------------------------------------------------
 21354       CONTINUE
 21355     END-IF
 21356*----------  3.4.4.処理件数メッセージ出力処理
 21357     PERFORM  SYORI-CNT-MSG-RTN
 21358*----------  3.4.5.終了メッセージ出力処理
 21359     MOVE  CNS-S                  TO  WK-ERR-SYUBETU
 21360     PERFORM  END-MSG-OUT-RTN
 21361*----------  3.4.6.プログラム終了(リターンコード=16)
 21362     MOVE  CNS-RTN-BT16           TO  WK-RTN-CODE
 21363*--------------------<DEBUG>--------------------------------------
 21364D    DISPLAY  CNS-PGM-ID":ワークリターンコード=["WK-RTN-CODE "]"
 21365D    DISPLAY  CNS-PGM-ID":***  エラー処理  END  ***"
 21366*-----------------------------------------------------------------
 21367     CONTINUE.
 21368 ERR-EXT.
 21369     STOP RUN  WK-RTN-CODE.
 21370******************************************************************
 21371*    業務エラー2処理
 21372******************************************************************
 21373 GYOMU-ERR-2-RTN        SECTION.
 21374*--------------------<DEBUG>--------------------------------------
 21375D    DISPLAY  CNS-PGM-ID":***  業務エラー2処理 START  ***"
 21376*-----------------------------------------------------------------
 21377     INITIALIZE  PARM-SCZY7080-INOUT
 21378                 PARM-RTNPKG
 21379*----------  利用会社コード
 21380     MOVE  WK-RIYO-CMP-CD
 21381       TO  RIYO-CMP-CD            OF  PARM-SCZY7080-ARG1
 21382*----------  処理実行日
 21383     MOVE  WK-SHORI-YMD
 21384       TO  SYORI-YMD              OF  PARM-SCZY7080-ARG1
 21385*----------  起動ID
 21386     MOVE  WK-KIDOU-ID
 21387       TO  KIDOU-ID               OF  PARM-SCZY7080-ARG1
 21388*----------  業務タスクID
 21389     MOVE  WK-GYOMU-TASK-ID       OF  WK-ARGUMENT
 21390       TO  GYOMU-TASK-ID          OF  PARM-SCZY7080-ARG1
 21391*----------  メッセージエリア
 21392     MOVE  WK-GYOMU-ERR-INFO      TO  PARM-SCZY7080-ARG2
 21393*-------------------<DEBUG>---------------------------------------
 21394D    DISPLAY  CNS-PGM-ID":利用会社コード=["
 21395D             RIYO-CMP-CD         OF  PARM-SCZY7080-ARG1"]"
 21396D    DISPLAY  CNS-PGM-ID":処理実行日=["
 21397D             SYORI-YMD           OF  PARM-SCZY7080-ARG1"]"
 21398D    DISPLAY  CNS-PGM-ID":起動ID=["
 21399D             KIDOU-ID            OF  PARM-SCZY7080-ARG1"]"
 21400D    DISPLAY  CNS-PGM-ID":業務タスクID=["
 21401D             GYOMU-TASK-ID       OF  PARM-SCZY7080-ARG1"]"
 21402D    DISPLAY  CNS-PGM-ID":メッセージエリア=["
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 370
* MUSR2651.cob                                                     cpy)cpy)y)y)
 21403D             PARM-SCZY7080-ARG2"]"
 21404D    DISPLAY  CNS-PGM-ID": ***  CALL SCZY7080  START  ***"
 21405*-----------------------------------------------------------------
 21406     CALL  "SCZY7080"             USING  PARM-SCZY7080-INOUT
 21407                                         PARM-RTNPKG
 21408*-------------------<DEBUG>---------------------------------------
 21409D    DISPLAY  CNS-PGM-ID": ***  CALL SCZY7080  END  ***"
 21410D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY7080)        =["
 21411D             RTN-CD OF PARM-RTNPKG(COUNTER   OF PARM-RTNPKG) "]"
 21412D    DISPLAY  CNS-PGM-ID":COUNTER  OF  PARM-RTNPKG=["
 21413D             COUNTER              OF PARM-RTNPKG"]"
 21414*-----------------------------------------------------------------
 21415     IF  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
 21416      =  CNS-RTN-000
 21417     THEN
 21418       PERFORM  DB-COMMIT-RTN
 21419*--------------------<DEBUG>--------------------------------------
 21420D    DISPLAY  CNS-PGM-ID":***  業務エラー2処理  正常  ***"
 21421*-----------------------------------------------------------------
 21422     ELSE
 21423*--------------------<DEBUG>--------------------------------------
 21424D    DISPLAY  CNS-PGM-ID":***  業務エラー2処理  エラー  ***"
 21425*-----------------------------------------------------------------
 21426*----------  ワークリターンコード
 21427       MOVE  CNS-16            TO  WK-RTN-CODE
 21428*----------  ワークエラーパッケージを編集
 21429       MOVE  PARM-RTNPKG          TO  PARM-SCZY1170-RTNPKG
 21430       INITIALIZE  WK-SYS-ERR-INFO
 21431*----------  エラー検知プログラムID
 21432       MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
 21433*----------  ポジション
 21434       MOVE  CNS-POS-036          TO  WK-ERR-POS
 21435*----------  リターンコード
 21436       MOVE  CNS-RTN-901          TO  WK-RTN-CD
 21437*----------  詳細リターンコード
 21438       MOVE  RTN-CD               OF  PARM-RTNPKG
 21439                                      (COUNTER OF PARM-RTNPKG)
 21440                                  TO  WK-DETAIL-RTN-CD
 21441*----------  詳細リターンコードデコードフラグ
 21442       MOVE  CNS-DETAIL-0         TO  WK-DETAIL-RTN-CD-FLG
 21443*---------- フリーメッセージ
 21444       MOVE  SPACE                TO  WK-FREE-MSG
 21445*----------  エラー処理
 21446       PERFORM  ERR-RTN
 21447     END-IF
 21448*--------------------<DEBUG>--------------------------------------
 21449D    DISPLAY  CNS-PGM-ID":***  業務エラー2処理 END  ***"
 21450*-----------------------------------------------------------------
 21451     CONTINUE.
 21452 GYOMU-ERR-2-EXT.
 21453     EXIT.
 21454******************************************************************
 21455*    ＤＢコミットリリース処理
 21456******************************************************************
 21457 COMMIT-ORA-REL-RTN     SECTION.
 21458*--------------------<DEBUG>--------------------------------------
 21459D    DISPLAY  CNS-PGM-ID
 21460D             ":***  ＤＢコミットリリース処理  START  ***"
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 371
* MUSR2651.cob                                                     cpy)cpy)y)y)
 21461D    DISPLAY  CNS-PGM-ID":FLG-ORA-CONNECT=["FLG-ORA-CONNECT"]"
 21462*-----------------------------------------------------------------
 21463*----------  COMMIT
 21464*    EXEC SQL
 21465*        COMMIT RELEASE
 21466*    END-EXEC
 21467     MOVE 1 TO SQL-ITERS
 21468     MOVE 799 TO SQL-OFFSET
 21469     MOVE 0 TO SQL-OCCURS
 21470     CALL "SQLADR" USING
 21471         SQLCUD
 21472         SQL-CUD
 21473     CALL "SQLADR" USING
 21474         SQLCA
 21475         SQL-SQLEST
 21476     MOVE 256 TO SQL-SQLETY
 21477
 21478     CALL "SQLBEX" USING
 21479         SQLCTX
 21480         SQLEXD
 21481         SQLFPN
 21482*--------------------<DEBUG>--------------------------------------
 21483D    DISPLAY  CNS-PGM-ID":SQLCODE(COMMIT RELEASE)=["SQLCODE"]"
 21484*-----------------------------------------------------------------
 21485*----------  SQLCODEのチェック
 21486     IF  SQLCODE = CNS-SQL-NORMAL
 21487     THEN
 21488       MOVE  CNS-OFF                   TO  FLG-ORA-CONNECT
 21489*--------------------<DEBUG>--------------------------------------
 21490D    DISPLAY  CNS-PGM-ID":ＤＢコミットリリース処理 正常"
 21491D    DISPLAY  CNS-PGM-ID":FLG-ORA-CONNECT=["FLG-ORA-CONNECT"]"
 21492*-----------------------------------------------------------------
 21493     ELSE
 21494*--------------------<DEBUG>--------------------------------------
 21495D    DISPLAY  CNS-PGM-ID":ＤＢコミットリリース処理 システムエラー"
 21496*-----------------------------------------------------------------
 21497*----------  ワークリターンコード
 21498       MOVE  CNS-RTN-BT16              TO  WK-RTN-CODE
 21499*----------  ワークエラーパッケージを編集
 21500       INITIALIZE  WK-SYS-ERR-INFO
 21501*----------  エラー検知プログラムID
 21502       MOVE  CNS-PGM-ID                TO  WK-ERR-PGM-ID
 21503*----------  ポジション
 21504       MOVE  CNS-POS-037               TO  WK-ERR-POS
 21505*----------  リターンコード
 21506       MOVE  CNS-RTN-900               TO  WK-RTN-CD
 21507*----------  詳細リターンコード
 21508       MOVE  SQLCODE                   TO  WK-DETAIL-RTN-CD
 21509*----------  詳細リターンコードデコードフラグ
 21510       MOVE  CNS-DETAIL-1              TO  WK-DETAIL-RTN-CD-FLG
 21511*---------- フリーメッセージ
 21512       MOVE  CNS-COM-RELEASE-ERR       TO  WK-FREE-MSG
 21513*----------  エラー処理
 21514       PERFORM  ERR-RTN
 21515     END-IF
 21516*--------------------<DEBUG>--------------------------------------
 21517D    DISPLAY  CNS-PGM-ID
 21518D             ":***  ＤＢコミットリリース処理  END  ***"
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 372
* MUSR2651.cob                                                     cpy)cpy)y)y)
 21519*-----------------------------------------------------------------
 21520     CONTINUE.
 21521 COMMIT-ORA-REL-EXT.
 21522     EXIT.
 21523******************************************************************
 21524*    ＤＢロールバックリリース処理
 21525******************************************************************
 21526 ROLLBACK-ORA-REL-RTN   SECTION.
 21527*--------------------<DEBUG>--------------------------------------
 21528D    DISPLAY  CNS-PGM-ID
 21529D             ":***  ＤＢロールバックリリース処理  START  ***"
 21530*-----------------------------------------------------------------
 21531     MOVE  CNS-OFF                     TO  FLG-ORA-CONNECT
 21532*----------  ROLLBACK
 21533*    EXEC SQL
 21534*        ROLLBACK RELEASE
 21535*    END-EXEC
 21536     MOVE 1 TO SQL-ITERS
 21537     MOVE 814 TO SQL-OFFSET
 21538     MOVE 0 TO SQL-OCCURS
 21539     CALL "SQLADR" USING
 21540         SQLCUD
 21541         SQL-CUD
 21542     CALL "SQLADR" USING
 21543         SQLCA
 21544         SQL-SQLEST
 21545     MOVE 256 TO SQL-SQLETY
 21546
 21547     CALL "SQLBEX" USING
 21548         SQLCTX
 21549         SQLEXD
 21550         SQLFPN
 21551*--------------------<DEBUG>--------------------------------------
 21552D    DISPLAY  CNS-PGM-ID":SQLCODE(ROLLBACK RELEASE)=["SQLCODE"]"
 21553*-----------------------------------------------------------------
 21554*----------  SQLCODEのチェック
 21555     IF  SQLCODE = CNS-SQL-NORMAL
 21556     THEN
 21557       CONTINUE
 21558*--------------------<DEBUG>--------------------------------------
 21559D    DISPLAY  CNS-PGM-ID":ＤＢロールバックリリース処理 正常"
 21560*-----------------------------------------------------------------
 21561     ELSE
 21562*--------------------<DEBUG>--------------------------------------
 21563D    DISPLAY  CNS-PGM-ID":ＤＢロールバックリリース処理"
 21564D             " システムエラー"
 21565*-----------------------------------------------------------------
 21566*----------  ワークリターンコード
 21567       MOVE  CNS-RTN-BT16              TO  WK-RTN-CODE
 21568*----------  ワークエラーパッケージを編集
 21569       INITIALIZE  WK-SYS-ERR-INFO
 21570*----------  エラー検知プログラムID
 21571       MOVE  CNS-PGM-ID                TO  WK-ERR-PGM-ID
 21572*----------  ポジション
 21573       MOVE  CNS-POS-038               TO  WK-ERR-POS
 21574*----------  リターンコード
 21575       MOVE  CNS-RTN-900               TO  WK-RTN-CD
 21576*----------  詳細リターンコード
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 373
* MUSR2651.cob                                                     cpy)cpy)y)y)
 21577       MOVE  SQLCODE                   TO  WK-DETAIL-RTN-CD
 21578*----------  詳細リターンコードデコードフラグ
 21579       MOVE  CNS-DETAIL-1              TO  WK-DETAIL-RTN-CD-FLG
 21580*---------- フリーメッセージ
 21581       MOVE  CNS-ROLLBACK-ERR          TO  WK-FREE-MSG
 21582*----------  エラー処理
 21583       PERFORM  ERR-RTN
 21584     END-IF
 21585*--------------------<DEBUG>--------------------------------------
 21586D    DISPLAY  CNS-PGM-ID":FLG-ORA-CONNECT=["FLG-ORA-CONNECT"]"
 21587D    DISPLAY  CNS-PGM-ID
 21588D             ":***  ＤＢロールバックリリース処理  END  ***"
 21589*-----------------------------------------------------------------
 21590     CONTINUE.
 21591 ROLLBACK-ORA-REL-EXT.
 21592     EXIT.
 21593******************************************************************
 21594*    処理件数メッセージ出力処理
 21595******************************************************************
 21596 SYORI-CNT-MSG-RTN      SECTION.
 21597*--------------------<DEBUG>--------------------------------------
 21598D    DISPLAY  CNS-PGM-ID
 21599D             ":***  処理件数メッセージ出力処理  START  ***"
 21600*-----------------------------------------------------------------
 21601     INITIALIZE  PARM-SCZY7040-IN
 21602*----------  接続用パラメータの設定
 21603*----------  テーブル・ファイル数
 21604     MOVE  CNS-5
 21605       TO  TABLE-FILE-NUM         OF  PARM-SCZY7040-IN
 21606*----------  識別子(1)
 21607     MOVE  WK-TBL-TKUSZT01
 21608       TO  IDENT-ID               OF  PARM-SCZY7040-IN(1)
 21609*----------  対象処理(1)
 21610     MOVE  CNS-FETCH
 21611       TO  OBJECT-DISPOSAL        OF  PARM-SCZY7040-IN(1)
 21612*----------  取得件数(1)
 21613     MOVE  WK-FETCH-KENSUU
 21614       TO  DISPOSAL-NUM           OF  PARM-SCZY7040-IN(1)
 21615     IF  I-FLG-KEISAN OF WK-DENBUN-INFO  = CNS-0
 21616     THEN
 21617*----------  識別子(2)
 21618       MOVE  WK-PSACT-DAT-FILE
 21619         TO  IDENT-ID               OF  PARM-SCZY7040-IN(2)
 21620*----------  対象処理(2)
 21621       MOVE  CNS-WRITE
 21622         TO  OBJECT-DISPOSAL        OF  PARM-SCZY7040-IN(2)
 21623*----------  取得件数(2)
 21624       MOVE  WK-WRITE-KENSUU
 21625         TO  DISPOSAL-NUM           OF  PARM-SCZY7040-IN(2)
 21626*----------  識別子(3)
 21627       MOVE  WK-PSACT-DAT-FILE-2
 21628         TO  IDENT-ID               OF  PARM-SCZY7040-IN(3)
 21629*----------  対象処理(3)
 21630       MOVE  CNS-WRITE
 21631         TO  OBJECT-DISPOSAL        OF  PARM-SCZY7040-IN(3)
 21632*----------  取得件数(3)
 21633       MOVE  WK-WRITE-KENSUU2
 21634         TO  DISPOSAL-NUM           OF  PARM-SCZY7040-IN(3)
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 374
* MUSR2651.cob                                                     cpy)cpy)y)y)
 21635*----------  識別子(4)
 21636       MOVE  WK-PSACT-DAT-FILE-5
 21637         TO  IDENT-ID               OF  PARM-SCZY7040-IN(4)
 21638*----------  対象処理(4)
 21639       MOVE  CNS-WRITE
 21640         TO  OBJECT-DISPOSAL        OF  PARM-SCZY7040-IN(4)
 21641*----------  取得件数(4)
 21642       MOVE  WK-WRITE-KENSUU5
 21643         TO  DISPOSAL-NUM           OF  PARM-SCZY7040-IN(4)
 21644*----------  識別子(5)
 21645       MOVE  WK-PSACT-DAT-FILE-6
 21646         TO  IDENT-ID               OF  PARM-SCZY7040-IN(5)
 21647*----------  対象処理(5)
 21648       MOVE  CNS-WRITE
 21649         TO  OBJECT-DISPOSAL        OF  PARM-SCZY7040-IN(5)
 21650*----------  取得件数(5)
 21651       MOVE  WK-WRITE-KENSUU6
 21652         TO  DISPOSAL-NUM           OF  PARM-SCZY7040-IN(5)
 21653     ELSE
 21654*----------  識別子(2)
 21655       MOVE  WK-PSACT-DAT-FILE-3
 21656         TO  IDENT-ID               OF  PARM-SCZY7040-IN(2)
 21657*----------  対象処理(2)
 21658       MOVE  CNS-WRITE
 21659         TO  OBJECT-DISPOSAL        OF  PARM-SCZY7040-IN(2)
 21660*----------  取得件数(2)
 21661       MOVE  WK-WRITE-KENSUU3
 21662         TO  DISPOSAL-NUM           OF  PARM-SCZY7040-IN(2)
 21663*----------  識別子(3)
 21664       MOVE  WK-PSACT-DAT-FILE-4
 21665         TO  IDENT-ID               OF  PARM-SCZY7040-IN(3)
 21666*----------  対象処理(3)
 21667       MOVE  CNS-WRITE
 21668         TO  OBJECT-DISPOSAL        OF  PARM-SCZY7040-IN(3)
 21669*----------  取得件数(3)
 21670       MOVE  WK-WRITE-KENSUU4
 21671         TO  DISPOSAL-NUM           OF  PARM-SCZY7040-IN(3)
 21672*----------  識別子(4)
 21673       MOVE  WK-PSACT-DAT-FILE-7
 21674         TO  IDENT-ID               OF  PARM-SCZY7040-IN(4)
 21675*----------  対象処理(4)
 21676       MOVE  CNS-WRITE
 21677         TO  OBJECT-DISPOSAL        OF  PARM-SCZY7040-IN(4)
 21678*----------  取得件数(4)
 21679       MOVE  WK-WRITE-KENSUU7
 21680         TO  DISPOSAL-NUM           OF  PARM-SCZY7040-IN(4)
 21681*----------  識別子(5)
 21682       MOVE  WK-PSACT-DAT-FILE-8
 21683         TO  IDENT-ID               OF  PARM-SCZY7040-IN(5)
 21684*----------  対象処理(5)
 21685       MOVE  CNS-WRITE
 21686         TO  OBJECT-DISPOSAL        OF  PARM-SCZY7040-IN(5)
 21687*----------  取得件数(5)
 21688       MOVE  WK-WRITE-KENSUU8
 21689         TO  DISPOSAL-NUM           OF  PARM-SCZY7040-IN(5)
 21690     END-IF
 21691*--------------------<DEBUG>--------------------------------------
 21692D    DISPLAY  CNS-PGM-ID":SCZY7040-ARG:"
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 375
* MUSR2651.cob                                                     cpy)cpy)y)y)
 21693D    DISPLAY  CNS-PGM-ID":テーブル・ファイル数=["
 21694D             TABLE-FILE-NUM      OF  PARM-SCZY7040-IN   "]"
 21695D    DISPLAY  CNS-PGM-ID":識別子(1)           =["
 21696D             IDENT-ID            OF  PARM-SCZY7040-IN(1)"]"
 21697D    DISPLAY  CNS-PGM-ID":対象処理(1)         =["
 21698D             OBJECT-DISPOSAL     OF  PARM-SCZY7040-IN(1)"]"
 21699D    DISPLAY  CNS-PGM-ID":処理件数(1)         =["
 21700D             DISPOSAL-NUM        OF  PARM-SCZY7040-IN(1)"]"
 21701D    DISPLAY  CNS-PGM-ID":識別子(2)           =["
 21702D             IDENT-ID            OF  PARM-SCZY7040-IN(2)"]"
 21703D    DISPLAY  CNS-PGM-ID":対象処理(2)         =["
 21704D             OBJECT-DISPOSAL     OF  PARM-SCZY7040-IN(2)"]"
 21705D    DISPLAY  CNS-PGM-ID":処理件数(2)         =["
 21706D             DISPOSAL-NUM        OF  PARM-SCZY7040-IN(2)"]"
 21707D    DISPLAY  CNS-PGM-ID":識別子(3)           =["
 21708D             IDENT-ID            OF  PARM-SCZY7040-IN(3)"]"
 21709D    DISPLAY  CNS-PGM-ID":対象処理(3)         =["
 21710D             OBJECT-DISPOSAL     OF  PARM-SCZY7040-IN(3)"]"
 21711D    DISPLAY  CNS-PGM-ID":処理件数(3)         =["
 21712D             DISPOSAL-NUM        OF  PARM-SCZY7040-IN(3)"]"
 21713D    DISPLAY  CNS-PGM-ID":識別子(4)           =["
 21714D             IDENT-ID            OF  PARM-SCZY7040-IN(4)"]"
 21715D    DISPLAY  CNS-PGM-ID":対象処理(4)         =["
 21716D             OBJECT-DISPOSAL     OF  PARM-SCZY7040-IN(4)"]"
 21717D    DISPLAY  CNS-PGM-ID":処理件数(4)         =["
 21718D             DISPOSAL-NUM        OF  PARM-SCZY7040-IN(4)"]"
 21719D    DISPLAY  CNS-PGM-ID":識別子(5)           =["
 21720D             IDENT-ID            OF  PARM-SCZY7040-IN(5)"]"
 21721D    DISPLAY  CNS-PGM-ID":対象処理(5)         =["
 21722D             OBJECT-DISPOSAL     OF  PARM-SCZY7040-IN(5)"]"
 21723D    DISPLAY  CNS-PGM-ID":処理件数(5)         =["
 21724D             DISPOSAL-NUM        OF  PARM-SCZY7040-IN(5)"]"
 21725D    DISPLAY  CNS-PGM-ID":***  CALL SCZY7040 START  ***"
 21726*-----------------------------------------------------------------
 21727     CALL  "SCZY7040"             USING  PARM-SCZY7040-IN
 21728*--------------------<DEBUG>--------------------------------------
 21729D    DISPLAY  CNS-PGM-ID":***  CALL SCZY7040 END  ***"
 21730D    DISPLAY  CNS-PGM-ID
 21731D             ":***  処理件数メッセージ出力処理  END  ***"
 21732*-----------------------------------------------------------------
 21733     CONTINUE.
 21734 SYORI-CNT-MSG-EXT.
 21735     EXIT.
 21736******************************************************************
 21737*    エラー2情報追加処理
 21738******************************************************************
 21739 ERR-MSG-OUT-RTN        SECTION.
 21740*--------------------<DEBUG>--------------------------------------
 21741D    DISPLAY  CNS-PGM-ID":***  エラー2情報追加処理  START  ***"
 21742*-----------------------------------------------------------------
 21743*---------- エラーリターンパッケージ
 21744     INITIALIZE  PARM-SCZY1170-IN
 21745     MOVE  WK-SYS-ERR-INFO        TO  PARM-SCZY1170-ARG1
 21746*--------------------<DEBUG>--------------------------------------
 21747D    DISPLAY  CNS-PGM-ID":エラー検知プログラム名          =["
 21748D             ERR-PGM-ID          OF  PARM-SCZY1170-ARG1"]"
 21749D    DISPLAY  CNS-PGM-ID":ポジション                      =["
 21750D             ERR-POS             OF  PARM-SCZY1170-ARG1"]"
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 376
* MUSR2651.cob                                                     cpy)cpy)y)y)
 21751D    DISPLAY  CNS-PGM-ID":リターンコード                  =["
 21752D             RTN-CD              OF  PARM-SCZY1170-ARG1"]"
 21753D    DISPLAY  CNS-PGM-ID":詳細リターンコード              =["
 21754D             DETAIL-RTN-CD       OF  PARM-SCZY1170-ARG1"]"
 21755D    DISPLAY  CNS-PGM-ID":詳細リターンコードデコードフラグ=["
 21756D             DETAIL-RTN-CD-FLG   OF  PARM-SCZY1170-ARG1"]"
 21757D    DISPLAY  CNS-PGM-ID":フリーメッセージ                =["
 21758D             FREE-MSG            OF  PARM-SCZY1170-ARG1"]"
 21759D    DISPLAY  CNS-PGM-ID":PARM-SCZY1170-RTNPKG            =["
 21760D             PARM-SCZY1170-RTNPKG                      "]"
 21761D    DISPLAY  CNS-PGM-ID":***  CALL SCZY1170 START  ***"
 21762*-----------------------------------------------------------------
 21763*----------  リターンパッケージセットルーチンをコールする
 21764     CALL   "SCZY1170"            USING  PARM-SCZY1170-IN
 21765                                         PARM-SCZY1170-RTNPKG
 21766*-------------------<DEBUG>---------------------------------------
 21767D    DISPLAY  CNS-PGM-ID":***  CALL SCZY1170 END  ***"
 21768D    DISPLAY  CNS-PGM-ID":***  エラー2情報追加処理  END  ***"
 21769*-----------------------------------------------------------------
 21770     CONTINUE.
 21771 ERR-MSG-OUT-EXT.
 21772     EXIT.
 21773******************************************************************
 21774*    終了メッセージ出力処理
 21775******************************************************************
 21776 END-MSG-OUT-RTN        SECTION.
 21777*--------------------<DEBUG>--------------------------------------
 21778D    DISPLAY  CNS-PGM-ID":***  終了メッセージ出力処理  START  ***"
 21779D    DISPLAY  CNS-PGM-ID":WK-ERR-SYUBETU=["WK-ERR-SYUBETU"]"
 21780*-----------------------------------------------------------------
 21781     INITIALIZE  PARM-SCZY7020-INOUT
 21782                 PARM-RTNPKG
 21783*----------  エラー種別
 21784     MOVE  WK-ERR-SYUBETU
 21785       TO  ERR-SYUBETU            OF  PARM-SCZY7020-ARG1
 21786*----------  プログラムID
 21787     MOVE  CNS-PGM-ID
 21788       TO  PGM-ID                 OF  PARM-SCZY7020-ARG2
 21789*----------  利用会社コード
 21790     MOVE  WK-RIYO-CMP-CD
 21791       TO  RIYO-CMP-CD            OF  PARM-SCZY7020-ARG2
 21792*----------  基準日
 21793     MOVE  WK-SHORI-YMD
 21794       TO  KJN-YMD                OF  PARM-SCZY7020-ARG2
 21795*----------  実行処理ID
 21796     MOVE  WK-GYOMU-TASK-ID       OF  WK-ARGUMENT
 21797       TO  JIKOU-SYORI-ID         OF  PARM-SCZY7020-ARG2
 21798*----------  起動ID
 21799     MOVE  WK-KIDOU-ID
 21800       TO  KIDOU-ID               OF  PARM-SCZY7020-ARG2
 21801*---------- リターンパッケージをセットする
 21802     MOVE  PARM-SCZY1170-RTNPKG   TO  PARM-RTNPKG
 21803*--------------------<DEBUG>--------------------------------------
 21804D    DISPLAY  CNS-PGM-ID":SCZY7020-ARG:"
 21805D    DISPLAY  CNS-PGM-ID":エラー種別    =["
 21806D             ERR-SYUBETU         OF  PARM-SCZY7020-ARG1"]"
 21807D    DISPLAY  CNS-PGM-ID":プログラムID  =["
 21808D             PGM-ID              OF  PARM-SCZY7020-ARG2"]"
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 377
* MUSR2651.cob                                                     cpy)cpy)y)y)
 21809D    DISPLAY  CNS-PGM-ID":利用会社コード=["
 21810D             RIYO-CMP-CD         OF  PARM-SCZY7020-ARG2"]"
 21811D    DISPLAY  CNS-PGM-ID":実行処理ID    =["
 21812D             JIKOU-SYORI-ID      OF  PARM-SCZY7020-ARG2"]"
 21813D    DISPLAY  CNS-PGM-ID":基準日        =["
 21814D             KJN-YMD             OF  PARM-SCZY7020-ARG2"]"
 21815D    DISPLAY  CNS-PGM-ID":起動ID        =["
 21816D             KIDOU-ID            OF  PARM-SCZY7020-ARG2"]"
 21817D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG=["
 21818D             PARM-RTNPKG"]"
 21819D    DISPLAY  CNS-PGM-ID":***  CALL SCZY7020 START  ***"
 21820*-----------------------------------------------------------------
 21821     CALL  "SCZY7020"             USING  PARM-SCZY7020-INOUT
 21822                                         PARM-RTNPKG
 21823*--------------------<DEBUG>--------------------------------------
 21824D    DISPLAY  CNS-PGM-ID":***  CALL SCZY7020 END  ***"
 21825D    DISPLAY  CNS-PGM-ID":***  終了メッセージ出力処理  END  ***"
 21826*-----------------------------------------------------------------
 21827     CONTINUE.
 21828 END-MSG-OUT-EXT.
 21829     EXIT.
 21830******************************************************************
 21831*    DATファイルクローズ処理
 21832******************************************************************
 21833 CLOSE-FILE-RTN         SECTION.
 21834*--------------------<DEBUG>--------------------------------------
 21835D    DISPLAY  CNS-PGM-ID":*****DATファイルクローズ処理  "
 21836D             "START  *****"
 21837*--------------------<DEBUG>--------------------------------------
 21838     MOVE  CNS-OFF                 TO  FLG-FILE-OPEN
 21839     CLOSE  OUT-FILE
 21840*-------------------<DEBUG>---------------------------------------
 21841D    DISPLAY   CNS-PGM-ID":FILE-STATUS=[" WK-FILE-STATUS "]"
 21842*-----------------------------------------------------------------
 21843     EVALUATE  WK-FILE-STATUS
 21844       WHEN  CNS-FILE-NORMAL
 21845*--------------------<DEBUG>--------------------------------------
 21846D    DISPLAY  CNS-PGM-ID":DATファイルクローズ処理正常"
 21847*-----------------------------------------------------------------
 21848         CONTINUE
 21849       WHEN  OTHER
 21850*--------------------<DEBUG>--------------------------------------
 21851D    DISPLAY  CNS-PGM-ID":DATファイルクローズ処理エラー"
 21852*-----------------------------------------------------------------
 21853*----------  ワークリターンコード
 21854         MOVE  CNS-16                  TO  WK-RTN-CODE
 21855*----------  ワークエラーパッケージを編集
 21856         INITIALIZE  WK-SYS-ERR-INFO
 21857*----------  エラー検知プログラムID
 21858         MOVE  CNS-PGM-ID              TO  WK-ERR-PGM-ID
 21859*----------  ポジション
 21860         MOVE  CNS-POS-039             TO  WK-ERR-POS
 21861*----------  リターンコード
 21862         MOVE  CNS-RTN-230             TO  WK-RTN-CD
 21863*----------  詳細リターンコード
 21864         MOVE  FUNCTION NUMVAL(WK-FILE-STATUS)
 21865                                       TO  WK-DETAIL-RTN-CD
 21866*----------  詳細リターンコードデコードフラグ
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 378
* MUSR2651.cob                                                     cpy)cpy)y)y)
 21867         MOVE  CNS-DETAIL-0            TO  WK-DETAIL-RTN-CD-FLG
 21868*---------- フリーメッセージ
 21869         STRING  "ファイル:["
 21870                 WK-PSACT-DAT-FILE
 21871                 "]クローズエラー"
 21872         DELIMITED BY SPACE           INTO  WK-FREE-MSG
 21873         END-STRING
 21874*----------  エラー処理
 21875       PERFORM  ERR-RTN
 21876     END-EVALUATE
 21877*--------------------<DEBUG>--------------------------------------
 21878D    DISPLAY CNS-PGM-ID":ファイルオープンフラグ=["FLG-FILE-OPEN"]"
 21879D    DISPLAY CNS-PGM-ID":*****DATファイルクローズ処理 END  *****"
 21880*-----------------------------------------------------------------
 21881     CONTINUE.
 21882 CLOSE-FILE-EXT.
 21883     EXIT.
 21884******************************************************************
 21885*    DATファイル2クローズ処理
 21886******************************************************************
 21887 CLOSE-FILE-2-RTN       SECTION.
 21888*--------------------<DEBUG>--------------------------------------
 21889D    DISPLAY  CNS-PGM-ID":*****DATファイル2クローズ処理  "
 21890D             "START  *****"
 21891*--------------------<DEBUG>--------------------------------------
 21892     MOVE  CNS-OFF                 TO  FLG-FILE-OPEN-2
 21893     CLOSE  OUT-FILE-2
 21894*-------------------<DEBUG>---------------------------------------
 21895D    DISPLAY   CNS-PGM-ID":FILE-STATUS-2=[" WK-FILE-STATUS-2 "]"
 21896*-----------------------------------------------------------------
 21897     EVALUATE  WK-FILE-STATUS-2
 21898       WHEN  CNS-FILE-NORMAL
 21899*--------------------<DEBUG>--------------------------------------
 21900D    DISPLAY  CNS-PGM-ID":DATファイル2クローズ処理正常"
 21901*-----------------------------------------------------------------
 21902         CONTINUE
 21903       WHEN  OTHER
 21904*--------------------<DEBUG>--------------------------------------
 21905D    DISPLAY  CNS-PGM-ID":DATファイル2クローズ処理エラー"
 21906*-----------------------------------------------------------------
 21907*----------  ワークリターンコード
 21908         MOVE  CNS-16                  TO  WK-RTN-CODE
 21909*----------  ワークエラーパッケージを編集
 21910         INITIALIZE  WK-SYS-ERR-INFO
 21911*----------  エラー検知プログラムID
 21912         MOVE  CNS-PGM-ID              TO  WK-ERR-PGM-ID
 21913*----------  ポジション
 21914         MOVE  CNS-POS-040             TO  WK-ERR-POS
 21915*----------  リターンコード
 21916         MOVE  CNS-RTN-230             TO  WK-RTN-CD
 21917*----------  詳細リターンコード
 21918         MOVE  FUNCTION NUMVAL(WK-FILE-STATUS-2)
 21919                                       TO  WK-DETAIL-RTN-CD
 21920*----------  詳細リターンコードデコードフラグ
 21921         MOVE  CNS-DETAIL-0            TO  WK-DETAIL-RTN-CD-FLG
 21922*---------- フリーメッセージ
 21923         STRING  "ファイル:["
 21924                 WK-PSACT-DAT-FILE-2
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 379
* MUSR2651.cob                                                     cpy)cpy)y)y)
 21925                 "]クローズエラー"
 21926         DELIMITED BY SPACE           INTO  WK-FREE-MSG
 21927         END-STRING
 21928*----------  エラー処理
 21929       PERFORM  ERR-RTN
 21930     END-EVALUATE
 21931*--------------------<DEBUG>--------------------------------------
 21932D    DISPLAY CNS-PGM-ID":ファイル2オープンフラグ=["
 21933D            FLG-FILE-OPEN-2"]"
 21934D    DISPLAY CNS-PGM-ID":*****DATファイル2クローズ処理 END  *****"
 21935*-----------------------------------------------------------------
 21936     CONTINUE.
 21937 CLOSE-FILE-2-EXT.
 21938     EXIT.
 21939******************************************************************
 21940*    ＤＢコミット処理
 21941******************************************************************
 21942 DB-COMMIT-RTN          SECTION.
 21943*--------------------<DEBUG>--------------------------------------
 21944D    DISPLAY  CNS-PGM-ID
 21945D             ":***  ＤＢコミット処理  START  ***"
 21946*-----------------------------------------------------------------
 21947*----------  COMMIT
 21948*    EXEC SQL
 21949*        COMMIT
 21950*    END-EXEC
 21951     MOVE 1 TO SQL-ITERS
 21952     MOVE 829 TO SQL-OFFSET
 21953     MOVE 0 TO SQL-OCCURS
 21954     CALL "SQLADR" USING
 21955         SQLCUD
 21956         SQL-CUD
 21957     CALL "SQLADR" USING
 21958         SQLCA
 21959         SQL-SQLEST
 21960     MOVE 256 TO SQL-SQLETY
 21961
 21962     CALL "SQLBEX" USING
 21963         SQLCTX
 21964         SQLEXD
 21965         SQLFPN
 21966*--------------------<DEBUG>--------------------------------------
 21967D    DISPLAY  CNS-PGM-ID":SQLCODE(COMMIT)=["SQLCODE"]"
 21968*-----------------------------------------------------------------
 21969*----------  SQLCODEのチェック
 21970     IF  SQLCODE = CNS-SQL-NORMAL
 21971     THEN
 21972       CONTINUE
 21973*--------------------<DEBUG>--------------------------------------
 21974D    DISPLAY  CNS-PGM-ID":ＤＢコミット処理 正常"
 21975*-----------------------------------------------------------------
 21976     ELSE
 21977*--------------------<DEBUG>--------------------------------------
 21978D    DISPLAY  CNS-PGM-ID":ＤＢコミット処理 システムエラー"
 21979*-----------------------------------------------------------------
 21980*----------  ワークリターンコード
 21981       MOVE  CNS-16               TO  WK-RTN-CODE
 21982*----------  ワークエラーパッケージを編集
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 380
* MUSR2651.cob                                                     cpy)cpy)y)y)
 21983       INITIALIZE  WK-SYS-ERR-INFO
 21984*----------  エラー検知プログラムID
 21985       MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
 21986*----------  ポジション
 21987       MOVE  CNS-POS-041          TO  WK-ERR-POS
 21988*----------  リターンコード
 21989       MOVE  CNS-RTN-900          TO  WK-RTN-CD
 21990*----------  詳細リターンコード
 21991       MOVE  SQLCODE              TO  WK-DETAIL-RTN-CD
 21992*----------  詳細リターンコードデコードフラグ
 21993       MOVE  CNS-DETAIL-1         TO  WK-DETAIL-RTN-CD-FLG
 21994*---------- フリーメッセージ
 21995       MOVE  CNS-COMMIT-ERR       TO  WK-FREE-MSG
 21996       MOVE  CNS-OFF              TO  FLG-SYSTEM-ERR
 21997*----------  エラー処理
 21998       PERFORM  ERR-RTN
 21999     END-IF
 22000*--------------------<DEBUG>--------------------------------------
 22001D    DISPLAY  CNS-PGM-ID":***  ＤＢコミット処理  END  ***"
 22002*-----------------------------------------------------------------
 22003     CONTINUE.
 22004 DB-COMMIT-EXT.
 22005     EXIT.
 22006******************************************************************
 22007*    ポートフォリオ明細2取得処理
 22008******************************************************************
 22009 SCZY7200-RTN           SECTION.
 22010*--------------------<DEBUG>--------------------------------------
 22011D    DISPLAY  CNS-PGM-ID
 22012D             ":***  ポートフォリオ明細2取得処理  START  ***"
 22013*-----------------------------------------------------------------
 22014     INITIALIZE  PARM-SCZY7200-INOUT
 22015                 PARM-RTNPKG
 22016*----------  利用会社コード
 22017     MOVE  WK-RIYO-CMP-CD
 22018       TO  RIYO-CMP-CD            OF  PARM-SCZY7200-ARG1
 22019*----------  処理実行日
 22020     MOVE  WK-SHORI-YMD
 22021       TO  SYORI-YMD              OF  PARM-SCZY7200-ARG1
 22022*----------  起動ID
 22023     MOVE  WK-KIDOU-ID
 22024       TO  KIDOU-ID               OF  PARM-SCZY7200-ARG1
 22025*----------  帳票ID
 22026     MOVE  SPACE
 22027       TO  REP-ID                 OF  PARM-SCZY7200-ARG1
 22028*-------------------<DEBUG>---------------------------------------
 22029D    DISPLAY  CNS-PGM-ID":SCZY7200-ARG1:"
 22030D    DISPLAY  CNS-PGM-ID":利用会社コード=["
 22031D             RIYO-CMP-CD         OF  PARM-SCZY7200-ARG1"]"
 22032D    DISPLAY  CNS-PGM-ID":処理実行日=["
 22033D             SYORI-YMD           OF  PARM-SCZY7200-ARG1"]"
 22034D    DISPLAY  CNS-PGM-ID":起動ID=["
 22035D             KIDOU-ID            OF  PARM-SCZY7200-ARG1"]"
 22036D    DISPLAY  CNS-PGM-ID":帳票ID=["
 22037D             REP-ID              OF  PARM-SCZY7200-ARG1"]"
 22038D    DISPLAY  CNS-PGM-ID":***  CALL SCZY7200 START  ***"
 22039*-----------------------------------------------------------------
 22040     CALL   "SCZY7200"            USING  PARM-SCZY7200-INOUT
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 381
* MUSR2651.cob                                                     cpy)cpy)y)y)
 22041                                         PARM-RTNPKG
 22042*-------------------<DEBUG>---------------------------------------
 22043D    DISPLAY  CNS-PGM-ID":***  CALL SCZY7200 END  ***"
 22044D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY7200)=["
 22045D             RTN-CD  OF  PARM-RTNPKG(COUNTER OF PARM-RTNPKG)"]"
 22046D    DISPLAY  CNS-PGM-ID":COUNTER OF PARM-RTNPKG=["
 22047D             COUNTER             OF PARM-RTNPKG"]"
 22048*-----------------------------------------------------------------
 22049     IF  RTN-CD  OF  PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
 22050      =  CNS-RTN-000
 22051     THEN
 22052*-------------------<DEBUG>---------------------------------------
 22053D    DISPLAY  CNS-PGM-ID
 22054D                    ":***  ポートフォリオ明細2取得処理 正常  ***"
 22055D    DISPLAY  CNS-PGM-ID":ワーク取得件数=["
 22056D                               GET-KENSU OF PARM-SCZY7200-ARG2"]"
 22057*-----------------------------------------------------------------
 22058       IF  GET-KENSU OF PARM-SCZY7200-ARG2 = ZERO
 22059       THEN
 22060*----------  ワークリターンコード
 22061         MOVE  CNS-RTN-BT8          TO  WK-RTN-CODE
 22062*----------  ワーク業務エラーパッケージを編集
 22063         INITIALIZE  WK-GYOMU-ERR-INFO
 22064*---------- 基準日From
 22065         MOVE  WK-KIKAN-FR
 22066           TO  WK-GYOMU-KJN-YMD-FROM OF  WK-GYOMU-ERR-INFO(CNS-1)
 22067*---------- 基準日To
 22068         MOVE  WK-KIKAN-TO
 22069           TO  WK-GYOMU-KJN-YMD-TO  OF  WK-GYOMU-ERR-INFO(CNS-1)
 22070*---------- メッセージID
 22071         MOVE  CNS-MSG-E000217
 22072           TO  WK-GYOMU-MSG-ID      OF  WK-GYOMU-ERR-INFO(CNS-1)
 22073*---------- 置換文字(1)
 22074         MOVE  CNS-TEXT-1
 22075           TO  WK-GYOMU-TK-MOJI
 22076           OF  WK-GYOMU-ERR-INFO(CNS-1,CNS-1)
 22077*--------------------<DEBUG>--------------------------------------
 22078D    DISPLAY  CNS-PGM-ID":メッセージID(1)=["
 22079D    WK-GYOMU-MSG-ID    OF  WK-GYOMU-ERR-INFO(CNS-1)"]"
 22080D    DISPLAY  CNS-PGM-ID":置換文字(1)=["
 22081D    WK-GYOMU-TK-MOJI OF  WK-GYOMU-ERR-INFO(CNS-1,CNS-1)"]"
 22082*-----------------------------------------------------------------
 22083*----------  後処理業務エラーフラグ
 22084         MOVE  CNS-ON               TO  FLG-GYOMU-ERR
 22085         PERFORM  END-RTN
 22086       ELSE
 22087         CONTINUE
 22088       END-IF
 22089     ELSE
 22090*-------------------<DEBUG>---------------------------------------
 22091D    DISPLAY  CNS-PGM-ID
 22092D                    ":***  ポートフォリオ明細2取得処理 異常  ***"
 22093*-----------------------------------------------------------------
 22094*----------  ワークリターンコード
 22095       MOVE  CNS-RTN-BT16         TO  WK-RTN-CODE
 22096*----------  ワークエラーパッケージを編集
 22097       MOVE  PARM-RTNPKG          TO  PARM-SCZY1170-RTNPKG
 22098       INITIALIZE  WK-SYS-ERR-INFO
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 382
* MUSR2651.cob                                                     cpy)cpy)y)y)
 22099*----------  エラー検知プログラムID
 22100       MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
 22101*----------  ポジション
 22102       MOVE  CNS-POS-042          TO  WK-ERR-POS
 22103*----------  リターンコード
 22104       MOVE  CNS-RTN-901          TO  WK-RTN-CD
 22105*----------  詳細リターンコード
 22106       MOVE  RTN-CD               OF  PARM-RTNPKG
 22107                                      (COUNTER OF PARM-RTNPKG)
 22108                                  TO  WK-DETAIL-RTN-CD
 22109*----------  詳細リターンコードデコードフラグ
 22110       MOVE  CNS-DETAIL-0         TO  WK-DETAIL-RTN-CD-FLG
 22111*---------- フリーメッセージ
 22112       MOVE  SPACE                TO  WK-FREE-MSG
 22113*----------  エラー処理
 22114       PERFORM  ERR-RTN
 22115     END-IF
 22116*--------------------<DEBUG>--------------------------------------
 22117D    DISPLAY  CNS-PGM-ID
 22118D             ":***  ポートフォリオ明細2取得処理  END  ***"
 22119*-----------------------------------------------------------------
 22120     CONTINUE.
 22121 SCZY7200-EXT.
 22122     EXIT.
 22123******************************************************************
 22124*    ＤＢコミット処理
 22125******************************************************************
 22126 DB-COMMIT1-RTN         SECTION.
 22127*--------------------<DEBUG>--------------------------------------
 22128D    DISPLAY  CNS-PGM-ID
 22129D             ":***  ＤＢコミット処理  START  ***"
 22130*-----------------------------------------------------------------
 22131*----------  COMMIT
 22132*    EXEC SQL
 22133*        COMMIT
 22134*    END-EXEC
 22135     MOVE 1 TO SQL-ITERS
 22136     MOVE 844 TO SQL-OFFSET
 22137     MOVE 0 TO SQL-OCCURS
 22138     CALL "SQLADR" USING
 22139         SQLCUD
 22140         SQL-CUD
 22141     CALL "SQLADR" USING
 22142         SQLCA
 22143         SQL-SQLEST
 22144     MOVE 256 TO SQL-SQLETY
 22145
 22146     CALL "SQLBEX" USING
 22147         SQLCTX
 22148         SQLEXD
 22149         SQLFPN
 22150*--------------------<DEBUG>--------------------------------------
 22151D    DISPLAY  CNS-PGM-ID":SQLCODE(COMMIT)=["SQLCODE"]"
 22152*-----------------------------------------------------------------
 22153*----------  SQLCODEのチェック
 22154     IF  SQLCODE = CNS-SQL-NORMAL
 22155     THEN
 22156       CONTINUE
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 383
* MUSR2651.cob                                                     cpy)cpy)y)y)
 22157*--------------------<DEBUG>--------------------------------------
 22158D    DISPLAY  CNS-PGM-ID":ＤＢコミット処理 正常"
 22159*-----------------------------------------------------------------
 22160     ELSE
 22161*--------------------<DEBUG>--------------------------------------
 22162D    DISPLAY  CNS-PGM-ID":ＤＢコミット処理 システムエラー"
 22163*-----------------------------------------------------------------
 22164*----------  ワーク実行ステータス
 22165       MOVE  CNS-16               TO  WK-STATUS
 22166       MOVE  CNS-16               TO  WK-1190-STATUS
 22167*----------  ワークリターンコード
 22168       MOVE  WK-STATUS            TO  WK-RTN-CODE
 22169*----------  ワークエラーパッケージを編集
 22170       INITIALIZE  WK-SYS-ERR-INFO
 22171*----------  エラー検知プログラムID
 22172       MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
 22173*----------  ポジション
 22174       MOVE  CNS-POS-043          TO  WK-ERR-POS
 22175*----------  リターンコード
 22176       MOVE  CNS-RTN-900          TO  WK-RTN-CD
 22177*----------  詳細リターンコード
 22178       MOVE  SQLCODE              TO  WK-DETAIL-RTN-CD
 22179*----------  詳細リターンコードデコードフラグ
 22180       MOVE  CNS-DETAIL-1         TO  WK-DETAIL-RTN-CD-FLG
 22181*---------- フリーメッセージ
 22182       MOVE  CNS-COMMIT-ERR       TO  WK-FREE-MSG
 22183*----------  エラー情報追加処理
 22184       PERFORM  ERR-INFO-ADD-RTN
 22185     END-IF
 22186*--------------------<DEBUG>--------------------------------------
 22187D    DISPLAY  CNS-PGM-ID":***  ＤＢコミット処理  END  ***"
 22188*-----------------------------------------------------------------
 22189     CONTINUE.
 22190 DB-COMMIT1-EXT.
 22191     EXIT.
 22192******************************************************************
 22193*    サブエラーメッセージ出力処理
 22194******************************************************************
 22195 SUB-ERR-MSG-RTN        SECTION.
 22196*--------------------<DEBUG>--------------------------------------
 22197D    DISPLAY  CNS-PGM-ID":***  サブエラーメッセージ出力処理"
 22198D             "  START  ***"
 22199D    DISPLAY  CNS-PGM-ID":COUNTER OF PARM-RTNPKG=["
 22200D             COUNTER OF PARM-RTNPKG"]"
 22201*-----------------------------------------------------------------
 22202     INITIALIZE  WK-ERR-CNT
 22203     MOVE FUNCTION CURRENT-DATE(1:14) TO WK-RUN-SDATETIME
 22204*-------------------<DEBUG>---------------------------------------
 22205     DISPLAY "プログラムID:        ["CNS-PGM-ID"]"                GUT2013
 22206     DISPLAY "セクション:          [SUB-ERR-MSG-RTN]"             GUT2013
 22207     DISPLAY "セクションの開始時間:["WK-RUN-SDATETIME"]"          GUT2013
 22208*-----------------------------------------------------------------
 22209     PERFORM                  VARYING  WK-ERR-CNT
 22210       FROM  CNS-1 BY CNS-1
 22211       UNTIL WK-ERR-CNT > COUNTER OF PARM-RTNPKG
 22212*-------------------<DEBUG>---------------------------------------
 22213D    DISPLAY  CNS-PGM-ID":WK-ERR-CNT=["WK-ERR-CNT"]"
 22214*-----------------------------------------------------------------
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 384
* MUSR2651.cob                                                     cpy)cpy)y)y)
 22215*----------  ワークエラーパッケージを編集
 22216       INITIALIZE  WK-SYS-ERR-INFO
 22217*----------  エラー検知プログラムID
 22218       MOVE  ERR-PGM-ID           OF  PARM-RTNPKG(WK-ERR-CNT)
 22219         TO  WK-ERR-PGM-ID
 22220*----------  ポジション
 22221       MOVE  ERR-POS              OF  PARM-RTNPKG(WK-ERR-CNT)
 22222         TO  WK-ERR-POS
 22223*----------  リターンコード
 22224       MOVE  RTN-CD               OF  PARM-RTNPKG(WK-ERR-CNT)
 22225         TO  WK-RTN-CD
 22226*----------  詳細リターンコード
 22227       MOVE  DETAIL-RTN-CD        OF  PARM-RTNPKG(WK-ERR-CNT)
 22228         TO  WK-DETAIL-RTN-CD
 22229*----------  詳細リターンコードデコードフラグ
 22230       MOVE  DETAIL-RTN-CD-FLG    OF  PARM-RTNPKG(WK-ERR-CNT)
 22231         TO  WK-DETAIL-RTN-CD-FLG
 22232*---------- フリーメッセージ
 22233       MOVE  FREE-MSG             OF  PARM-RTNPKG(WK-ERR-CNT)
 22234         TO  WK-FREE-MSG
 22235*----------  エラー情報追加処理
 22236       PERFORM  ERR-INFO-ADD-RTN
 22237     END-PERFORM
 22238     MOVE FUNCTION CURRENT-DATE(1:14) TO WK-RUN-EDATETIME
 22239*--------------------<DEBUG>--------------------------------------
 22240     DISPLAY "プログラムID:        ["CNS-PGM-ID"]"                GUT2013
 22241     DISPLAY "セクション:          [SUB-ERR-MSG-RTN]"             GUT2013
 22242     DISPLAY "セクションの終了時間:["WK-RUN-EDATETIME"]"          GUT2013
 22243*-----------------------------------------------------------------
 22244*--------------------<DEBUG>--------------------------------------
 22245D    DISPLAY  CNS-PGM-ID":***  サブエラーメッセージ出力処理"
 22246D             "  END  ***"
 22247*-----------------------------------------------------------------
 22248     CONTINUE.
 22249 SUB-ERR-MSG-EXT.
 22250     EXIT.
 22251******************************************************************
 22252*    数値去0処理
 22253******************************************************************
 22254 ZERO-COMPUTE-RTN       SECTION.
 22255*-------------------<DEBUG>---------------------------------------
 22256D    DISPLAY  CNS-PGM-ID":数値去0処理（18-18）START"
 22257D    DISPLAY  CNS-PGM-ID":処理前=["WK-18-18-X"]"
 22258*-----------------------------------------------------------------
 22259     INITIALIZE  WK-NUM-1
 22260                 WK-NUM-FROM
 22261                 WK-NUM-LENGTH
 22262     INSPECT  WK-18-18-X
 22263              TALLYING WK-NUM-1 FOR LEADING SPACE
 22264     COMPUTE  WK-NUM-FROM   = WK-NUM-1 + CNS-1
 22265*-------------------<DEBUG>---------------------------------------
 22266D    DISPLAY  CNS-PGM-ID":数値去0処理（18-18）END"
 22267*-----------------------------------------------------------------
 22268     CONTINUE.
 22269 ZERO-COMPUTE-EXT.
 22270     EXIT.
 22271******************************************************************
 22272*    3.1.13.約定ファイル03名作成処理
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 385
* MUSR2651.cob                                                     cpy)cpy)y)y)
 22273******************************************************************
 22274 GET-FILE-3-NAME-RTN    SECTION.
 22275*--------------------<DEBUG>--------------------------------------
 22276D    DISPLAY  CNS-PGM-ID":約定ファイル03名作成処理  START "
 22277*-----------------------------------------------------------------
 22278     STRING  CNS-RX-TEXT               DELIMITED BY SPACE
 22279             WK-RIYO-CMP-CD            DELIMITED BY SPACE
 22280             "_"                       DELIMITED BY SPACE
 22281             WK-SHORI-YMD              DELIMITED BY SPACE
 22282             "_"                       DELIMITED BY SPACE
 22283             WK-KIDOU-ID               DELIMITED BY SPACE
 22284             "_"                       DELIMITED BY SPACE
 22285             WK-GYOMU-TASK-ID          DELIMITED BY SPACE
 22286             "_03"                     DELIMITED BY SPACE
 22287                                       INTO  WK-FILE-3-NAME
 22288     END-STRING
 22289     STRING  WK-FILE-PASS              DELIMITED BY SPACE
 22290             "/"                       DELIMITED BY SPACE
 22291             WK-FILE-3-NAME            DELIMITED BY SPACE
 22292                                       INTO  WK-PSACT-DAT-FILE-3
 22293     END-STRING
 22294*--------------------<DEBUG>--------------------------------------
 22295D    DISPLAY  CNS-PGM-ID":W.約定ファイル名03=["WK-FILE-3-NAME"]"
 22296D    DISPLAY  CNS-PGM-ID":ファイルパス=["WK-FILE-PASS"]"
 22297D    DISPLAY  CNS-PGM-ID":パス付けDAT約定ファイル03=["
 22298D             WK-PSACT-DAT-FILE-3"]"
 22299D    DISPLAY  CNS-PGM-ID":約定ファイル03名作成処理  END  *****"
 22300*-----------------------------------------------------------------
 22301     CONTINUE.
 22302 GET-FILE-3-NAME-EXT.
 22303     EXIT.
 22304******************************************************************
 22305*    3.1.14.約定ファイル03オープン
 22306******************************************************************
 22307 OPEN-FILE-3-RTN        SECTION.
 22308     MOVE FUNCTION CURRENT-DATE(1:14) TO WK-RUN-SDATETIME
 22309*-------------------<DEBUG>---------------------------------------
 22310     DISPLAY "プログラムID:        ["CNS-PGM-ID"]"                GUT2013
 22311     DISPLAY "セクション:          [OPEN-FILE-3-RTN]"             GUT2013
 22312     DISPLAY "セクションの開始時間:["WK-RUN-SDATETIME"]"          GUT2013
 22313*-----------------------------------------------------------------
 22314*--------------------<DEBUG>--------------------------------------
 22315D    DISPLAY   CNS-PGM-ID":約定ファイル03オープン処理  START "
 22316*-----------------------------------------------------------------
 22317     MOVE  CNS-OFF                     TO  FLG-FILE-OPEN-3
 22318     MOVE  WK-PSACT-DAT-FILE-3         TO  OUTFILE-3
 22319     OPEN  OUTPUT OUT-FILE-3
 22320*-------------------<DEBUG>---------------------------------------
 22321D    DISPLAY  CNS-PGM-ID":FILE-STATUS-3=[" WK-FILE-STATUS-3 "]"
 22322*-----------------------------------------------------------------
 22323     EVALUATE  WK-FILE-STATUS-3
 22324       WHEN  CNS-FILE-NORMAL
 22325         MOVE  CNS-ON                  TO  FLG-FILE-OPEN-3
 22326*--------------------<DEBUG>--------------------------------------
 22327D    DISPLAY  CNS-PGM-ID":DAT約定ファイル03オープン正常"
 22328*-----------------------------------------------------------------
 22329       WHEN  OTHER
 22330*--------------------<DEBUG>--------------------------------------
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 386
* MUSR2651.cob                                                     cpy)cpy)y)y)
 22331D    DISPLAY  CNS-PGM-ID":DAT約定ファイル03オープンエラー"
 22332*-----------------------------------------------------------------
 22333*----------  メッセージ出力用 RTNパッケージの設定
 22334*----------  ワークリターンコード
 22335       MOVE  CNS-RTN-BT16         TO  WK-RTN-CODE
 22336       INITIALIZE  WK-SYS-ERR-INFO
 22337*----------  エラー検知プログラムID
 22338       MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
 22339*----------  ポジション
 22340       MOVE  CNS-POS-044          TO  WK-ERR-POS
 22341*----------  リターンコード
 22342       MOVE  CNS-RTN-200          TO  WK-RTN-CD
 22343*----------  詳細リターンコード
 22344       MOVE  FUNCTION NUMVAL(WK-FILE-STATUS-3)
 22345         TO  WK-DETAIL-RTN-CD
 22346*----------  詳細リターンコードデコードフラグ
 22347       MOVE  CNS-DETAIL-0         TO  WK-DETAIL-RTN-CD-FLG
 22348       MOVE  SPACE                TO  WK-FREE-MSG
 22349       STRING  "ファイル:["
 22350               WK-PSACT-DAT-FILE-3
 22351               "]オープンエラー"
 22352         DELIMITED BY SIZE         INTO  WK-FREE-MSG
 22353       END-STRING
 22354       PERFORM  ERR-RTN
 22355     END-EVALUATE
 22356*--------------------<DEBUG>--------------------------------------
 22357D    DISPLAY  CNS-PGM-ID":DAT約定ファイル03オープンフラグ=["
 22358D             FLG-FILE-OPEN-3 "]"
 22359D    DISPLAY  CNS-PGM-ID":DAT約定ファイル03オープン処理  END "
 22360*-----------------------------------------------------------------
 22361     MOVE FUNCTION CURRENT-DATE(1:14) TO WK-RUN-EDATETIME
 22362*--------------------<DEBUG>--------------------------------------
 22363     DISPLAY "プログラムID:        ["CNS-PGM-ID"]"                GUT2013
 22364     DISPLAY "セクション:          [OPEN-FILE-3-RTN]"             GUT2013
 22365     DISPLAY "セクションの終了時間:["WK-RUN-EDATETIME"]"          GUT2013
 22366*-----------------------------------------------------------------
 22367     CONTINUE.
 22368 OPEN-FILE-3-EXT.
 22369     EXIT.
 22370******************************************************************
 22371*    3.1.15.受渡ファイル04名作成処理
 22372******************************************************************
 22373 GET-FILE-4-NAME-RTN    SECTION.
 22374*--------------------<DEBUG>--------------------------------------
 22375D    DISPLAY  CNS-PGM-ID":受渡ファイル04名作成処理  START "
 22376*-----------------------------------------------------------------
 22377     STRING  CNS-RX-TEXT               DELIMITED BY SPACE
 22378             WK-RIYO-CMP-CD            DELIMITED BY SPACE
 22379             "_"                       DELIMITED BY SPACE
 22380             WK-SHORI-YMD              DELIMITED BY SPACE
 22381             "_"                       DELIMITED BY SPACE
 22382             WK-KIDOU-ID               DELIMITED BY SPACE
 22383             "_"                       DELIMITED BY SPACE
 22384             WK-GYOMU-TASK-ID          DELIMITED BY SPACE
 22385             "_04"                     DELIMITED BY SPACE
 22386                                       INTO  WK-FILE-4-NAME
 22387     END-STRING
 22388     STRING  WK-FILE-PASS              DELIMITED BY SPACE
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 387
* MUSR2651.cob                                                     cpy)cpy)y)y)
 22389             "/"                       DELIMITED BY SPACE
 22390             WK-FILE-4-NAME            DELIMITED BY SPACE
 22391                                       INTO  WK-PSACT-DAT-FILE-4
 22392     END-STRING
 22393*--------------------<DEBUG>--------------------------------------
 22394D    DISPLAY  CNS-PGM-ID":W.受渡ファイル04名=["WK-FILE-4-NAME"]"
 22395D    DISPLAY  CNS-PGM-ID":受渡ファイルパス=["WK-FILE-PASS"]"
 22396D    DISPLAY  CNS-PGM-ID":パス付けDAT受渡ファイル04=["
 22397D             WK-PSACT-DAT-FILE-4"]"
 22398D    DISPLAY  CNS-PGM-ID": 受渡ファイル名04作成処理  END  *****"
 22399*-----------------------------------------------------------------
 22400     CONTINUE.
 22401 GET-FILE-4-NAME-EXT.
 22402     EXIT.
 22403******************************************************************
 22404*    3.1.16.受渡ファイル04オープン
 22405******************************************************************
 22406 OPEN-FILE-4-RTN        SECTION.
 22407     MOVE FUNCTION CURRENT-DATE(1:14) TO WK-RUN-SDATETIME
 22408*-------------------<DEBUG>---------------------------------------
 22409     DISPLAY "プログラムID:        ["CNS-PGM-ID"]"                GUT2013
 22410     DISPLAY "セクション:          [OPEN-FILE-4-RTN]"             GUT2013
 22411     DISPLAY "セクションの開始時間:["WK-RUN-SDATETIME"]"          GUT2013
 22412*-----------------------------------------------------------------
 22413*--------------------<DEBUG>--------------------------------------
 22414D    DISPLAY   CNS-PGM-ID":受渡ファイル04オープン処理  START "
 22415*-----------------------------------------------------------------
 22416     MOVE  CNS-OFF                     TO  FLG-FILE-OPEN-4
 22417     MOVE  WK-PSACT-DAT-FILE-4         TO  OUTFILE-4
 22418     OPEN  OUTPUT OUT-FILE-4
 22419*-------------------<DEBUG>---------------------------------------
 22420D    DISPLAY  CNS-PGM-ID":FILE-STATUS-4=[" WK-FILE-STATUS-4 "]"
 22421*-----------------------------------------------------------------
 22422     EVALUATE  WK-FILE-STATUS-4
 22423       WHEN  CNS-FILE-NORMAL
 22424         MOVE  CNS-ON                  TO  FLG-FILE-OPEN-4
 22425*--------------------<DEBUG>--------------------------------------
 22426D    DISPLAY  CNS-PGM-ID":DAT受渡ファイル04オープン正常"
 22427*-----------------------------------------------------------------
 22428       WHEN  OTHER
 22429*--------------------<DEBUG>--------------------------------------
 22430D    DISPLAY  CNS-PGM-ID":DAT受渡ファイル04オープンエラー"
 22431*-----------------------------------------------------------------
 22432*----------  メッセージ出力用 RTNパッケージの設定
 22433*----------  ワークリターンコード
 22434       MOVE  CNS-RTN-BT16         TO  WK-RTN-CODE
 22435       INITIALIZE  WK-SYS-ERR-INFO
 22436*----------  エラー検知プログラムID
 22437       MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
 22438*----------  ポジション
 22439       MOVE  CNS-POS-045          TO  WK-ERR-POS
 22440*----------  リターンコード
 22441       MOVE  CNS-RTN-200          TO  WK-RTN-CD
 22442*----------  詳細リターンコード
 22443       MOVE  FUNCTION NUMVAL(WK-FILE-STATUS-4)
 22444         TO  WK-DETAIL-RTN-CD
 22445*----------  詳細リターンコードデコードフラグ
 22446       MOVE  CNS-DETAIL-0         TO  WK-DETAIL-RTN-CD-FLG
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 388
* MUSR2651.cob                                                     cpy)cpy)y)y)
 22447       MOVE  SPACE                TO  WK-FREE-MSG
 22448       STRING  "ファイル:["
 22449               WK-PSACT-DAT-FILE-4
 22450               "]オープンエラー"
 22451         DELIMITED BY SIZE         INTO  WK-FREE-MSG
 22452       END-STRING
 22453       PERFORM  ERR-RTN
 22454     END-EVALUATE
 22455*--------------------<DEBUG>--------------------------------------
 22456D    DISPLAY  CNS-PGM-ID":受渡ファイル04オープンフラグ=["
 22457D             FLG-FILE-OPEN-4 "]"
 22458D    DISPLAY  CNS-PGM-ID":受渡ファイル04オープン処理  END "
 22459*-----------------------------------------------------------------
 22460     MOVE FUNCTION CURRENT-DATE(1:14) TO WK-RUN-EDATETIME
 22461*--------------------<DEBUG>--------------------------------------
 22462     DISPLAY "プログラムID:        ["CNS-PGM-ID"]"                GUT2013
 22463     DISPLAY "セクション:          [OPEN-FILE-4-RTN]"             GUT2013
 22464     DISPLAY "セクションの終了時間:["WK-RUN-EDATETIME"]"          GUT2013
 22465*-----------------------------------------------------------------
 22466     CONTINUE.
 22467 OPEN-FILE-4-EXT.
 22468     EXIT.
 22469******************************************************************
 22470*    ポートフォリオ属性テーブルからデータを取得
 22471******************************************************************
 22472 SCZY4007-RTN           SECTION.
 22473*-------------------<DEBUG>---------------------------------------
 22474D    DISPLAY  CNS-PGM-ID ":*** 、ポートフォリオ属性テーブ"
 22475D             "ルからデータを取得  START ***"
 22476*-----------------------------------------------------------------
 22477     INITIALIZE  PARM-SCZY4007-INOUT
 22478                 PARM-RTNPKG
 22479                 WK-CAPITAL-TUKA-CD
 22480                 WK-YKJ-SYUGI-KAIKEI
 22481                 WK-SWK-KJN-PTN-CD
 22482                 FLG-FETCH-END2
 22483                 WK-CASH-FLOW-KBN
 22484*----------  利用会社コード
 22485     MOVE  WK-RIYO-CMP-CD         OF  WK-ARGUMENT
 22486       TO  RIYO-CMP-CD            OF  PARM-SCZY4007-ARG1
 22487*----------  ファンドコード
 22488     MOVE  WK-FUND-CD-DETAIL      OF  WK-PTF-ATT-DATA(WK-IDX-J)
 22489       TO  FUND-CD                OF  PARM-SCZY4007-ARG1
 22490*----------  ポートフォリオコード
 22491     MOVE  WK-PTF-CD-DETAIL       OF  WK-PTF-ATT-DATA(WK-IDX-J)
 22492       TO  PTF-CD                 OF  PARM-SCZY4007-ARG1
 22493*----------  適用開始日
 22494     MOVE  H-ZANTK-YMD            OF  HST-TBL-SELECT-2
 22495       TO  TEKIYO-FROM            OF  PARM-SCZY4007-ARG1
 22496*-------------------<DEBUG>---------------------------------------
 22497D    DISPLAY  CNS-PGM-ID ":PARM-SCZY4007-ARG1:"
 22498D    DISPLAY  CNS-PGM-ID ":利用会社コード=["
 22499D             RIYO-CMP-CD         OF  PARM-SCZY4007-ARG1"]"
 22500D    DISPLAY  CNS-PGM-ID ":ファンドコード=["
 22501D             FUND-CD             OF  PARM-SCZY4007-ARG1"]"
 22502D    DISPLAY  CNS-PGM-ID ":ポートフォリオコード=["
 22503D             PTF-CD              OF  PARM-SCZY4007-ARG1"]"
 22504D    DISPLAY  CNS-PGM-ID ":適用開始日=["
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 389
* MUSR2651.cob                                                     cpy)cpy)y)y)
 22505D             TEKIYO-FROM         OF  PARM-SCZY4007-ARG1"]"
 22506D    DISPLAY  CNS-PGM-ID ":***  CALL SCZY4007  START  ***"
 22507*-----------------------------------------------------------------
 22508     CALL  "SCZY4007"             USING  PARM-SCZY4007-INOUT
 22509                                         PARM-RTNPKG
 22510*-------------------<DEBUG>---------------------------------------
 22511D    DISPLAY  CNS-PGM-ID ":***  CALL SCZY4007  END  ***"
 22512D    DISPLAY  CNS-PGM-ID ":RTN-CD OF SCZY4007 =["
 22513D             RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)"]"
 22514D    DISPLAY  CNS-PGM-ID":COUNTER  OF  PARM-RTNPKG=["
 22515D             COUNTER              OF PARM-RTNPKG"]"
 22516*-----------------------------------------------------------------
 22517     EVALUATE  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
 22518       WHEN  CNS-RTN-000
 22519*--------------------<DEBUG>--------------------------------------
 22520D    DISPLAY  CNS-PGM-ID ":*****   ポートフォリオ属性テーブ"
 22521D             "ルからデータを取得正常   *****"
 22522*--------------------<DEBUG>--------------------------------------
 22523*----------  運用通貨コード
 22524         MOVE  CAPITAL-TUKA-CD    OF  PARM-SCZY4007-ARG2
 22525           TO  WK-CAPITAL-TUKA-CD
 22526*----------  約定主義会計フラグ
 22527         MOVE  YKJ-SYUGI-KAIKEI   OF  PARM-SCZY4007-ARG2
 22528           TO  WK-YKJ-SYUGI-KAIKEI
 22529*----------  仕訳基準パタンコード
 22530         MOVE  SWK-KJN-PTN-CD     OF  PARM-SCZY4007-ARG2
 22531           TO  WK-SWK-KJN-PTN-CD
 22532*----------  ＧＸ債券キャッシュフロー
 22533         MOVE  CASH-FLOW-KBN      OF  PARM-SCZY4007-ARG2
 22534           TO  WK-CASH-FLOW-KBN
 22535       WHEN  CNS-RTN-110
 22536         MOVE  CNS-ON           TO  FLG-FETCH-END2
 22537         IF  WK-1190-STATUS < CNS-4
 22538         THEN
 22539           MOVE  CNS-4          TO  WK-1190-STATUS
 22540         ELSE
 22541           CONTINUE
 22542         END-IF
 22543*
 22544         IF  WK-STATUS < CNS-4
 22545         THEN
 22546           MOVE  CNS-4          TO  WK-STATUS
 22547         ELSE
 22548           CONTINUE
 22549         END-IF
 22550*----------  ワークリターンコード
 22551         IF  WK-RTN-CODE < CNS-4
 22552         THEN
 22553           MOVE  CNS-4          TO  WK-RTN-CODE
 22554         ELSE
 22555           CONTINUE
 22556         END-IF
 22557*----------  ワーク業務エラーパッケージを編集
 22558*-------------------<DEBUG>---------------------------------------
 22559D    DISPLAY  CNS-PGM-ID":WK-J =[" WK-J"]"
 22560*-----------------------------------------------------------------
 22561         COMPUTE  WK-J = WK-J + 1
 22562*-------------------<DEBUG>---------------------------------------
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 390
* MUSR2651.cob                                                     cpy)cpy)y)y)
 22563D    DISPLAY  CNS-PGM-ID":WK-J =[" WK-J"]"
 22564*-----------------------------------------------------------------
 22565*---------- ファンドコード
 22566         MOVE  WK-FUND-CD-DETAIL     OF  WK-PTF-ATT-DATA(WK-IDX-J)
 22567           TO  WK-GYOMU-FUND-CD      OF  WK-GYOMU-ERR-INFO(WK-J)
 22568*---------- ポートフォリオコード
 22569         MOVE  WK-PTF-CD-DETAIL      OF  WK-PTF-ATT-DATA(WK-IDX-J)
 22570           TO  WK-GYOMU-PTF-CD       OF  WK-GYOMU-ERR-INFO(WK-J)
 22571*---------- 評価系列コード
 22572         MOVE  WK-DEFAUL-THYK-CD     OF  WK-PTF-ATT-DATA(WK-IDX-J)
 22573           TO  WK-GYOMU-HYK-KRTU-CD  OF  WK-GYOMU-ERR-INFO(WK-J)
 22574*---------- 帳票ID
 22575         MOVE  SPACE
 22576           TO  WK-GYOMU-REP-ID        OF  WK-GYOMU-ERR-INFO(WK-J)
 22577*---------- 帳票任意コード
 22578         MOVE  SPACE
 22579           TO  WK-GYOMU-REP-ANY-CD    OF  WK-GYOMU-ERR-INFO(WK-J)
 22580*---------- 基準日From
 22581         MOVE  WK-KIKAN-FR
 22582           TO  WK-GYOMU-KJN-YMD-FROM  OF  WK-GYOMU-ERR-INFO(WK-J)
 22583*---------- 基準日To
 22584         MOVE  WK-KIKAN-TO
 22585           TO  WK-GYOMU-KJN-YMD-TO    OF  WK-GYOMU-ERR-INFO(WK-J)
 22586*---------- メッセージID
 22587         MOVE  CNS-MSG-E000090
 22588           TO  WK-GYOMU-MSG-ID        OF  WK-GYOMU-ERR-INFO(WK-J)
 22589*---------- 置換文字
 22590         MOVE  CNS-TEXT-TK1
 22591           TO  WK-GYOMU-TK-MOJI(WK-J,CNS-1)
 22592*---------- フリーメッセージ
 22593         MOVE  WK-TEMP-MSG
 22594           TO  WK-GYOMU-FREE-MSG      OF  WK-GYOMU-ERR-INFO(WK-J)
 22595*----------  後処理業務エラーフラグ
 22596         MOVE  CNS-ON                 TO  FLG-MEISAI-GYOMU-ERR
 22597       WHEN  CNS-RTN-800
 22598         MOVE  CNS-ON           TO  FLG-FETCH-END2
 22599         IF  WK-1190-STATUS < CNS-4
 22600         THEN
 22601           MOVE  CNS-4          TO  WK-1190-STATUS
 22602         ELSE
 22603           CONTINUE
 22604         END-IF
 22605*
 22606         IF  WK-STATUS < CNS-4
 22607         THEN
 22608           MOVE  CNS-4          TO  WK-STATUS
 22609         ELSE
 22610           CONTINUE
 22611         END-IF
 22612*----------  ワークリターンコード
 22613         IF  WK-RTN-CODE < CNS-4
 22614         THEN
 22615           MOVE  CNS-4          TO  WK-RTN-CODE
 22616         ELSE
 22617           CONTINUE
 22618         END-IF
 22619*----------  ワーク業務エラーパッケージを編集
 22620*-------------------<DEBUG>---------------------------------------
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 391
* MUSR2651.cob                                                     cpy)cpy)y)y)
 22621D    DISPLAY  CNS-PGM-ID":WK-J =[" WK-J"]"
 22622*-----------------------------------------------------------------
 22623         COMPUTE  WK-J = WK-J + 1
 22624*-------------------<DEBUG>---------------------------------------
 22625D    DISPLAY  CNS-PGM-ID":WK-J =[" WK-J"]"
 22626*-----------------------------------------------------------------
 22627*---------- ファンドコード
 22628         MOVE  WK-FUND-CD-DETAIL     OF  WK-PTF-ATT-DATA(WK-IDX-J)
 22629           TO  WK-GYOMU-FUND-CD      OF  WK-GYOMU-ERR-INFO(WK-J)
 22630*---------- ポートフォリオコード
 22631         MOVE  WK-PTF-CD-DETAIL      OF  WK-PTF-ATT-DATA(WK-IDX-J)
 22632           TO  WK-GYOMU-PTF-CD       OF  WK-GYOMU-ERR-INFO(WK-J)
 22633*---------- 評価系列コード
 22634         MOVE  WK-DEFAUL-THYK-CD     OF  WK-PTF-ATT-DATA(WK-IDX-J)
 22635           TO  WK-GYOMU-HYK-KRTU-CD  OF  WK-GYOMU-ERR-INFO(WK-J)
 22636*---------- 帳票ID
 22637         MOVE  SPACE
 22638           TO  WK-GYOMU-REP-ID        OF  WK-GYOMU-ERR-INFO(WK-J)
 22639*---------- 帳票任意コード
 22640         MOVE  SPACE
 22641           TO  WK-GYOMU-REP-ANY-CD    OF  WK-GYOMU-ERR-INFO(WK-J)
 22642*---------- 基準日From
 22643         MOVE  WK-KIKAN-FR
 22644           TO  WK-GYOMU-KJN-YMD-FROM  OF  WK-GYOMU-ERR-INFO(WK-J)
 22645*---------- 基準日To
 22646         MOVE  WK-KIKAN-TO
 22647           TO  WK-GYOMU-KJN-YMD-TO    OF  WK-GYOMU-ERR-INFO(WK-J)
 22648*---------- メッセージID
 22649         MOVE  CNS-MSG-E000189
 22650           TO  WK-GYOMU-MSG-ID        OF  WK-GYOMU-ERR-INFO(WK-J)
 22651*---------- 置換文字
 22652         MOVE  SPACE
 22653           TO  WK-GYOMU-TK-MOJI(WK-J,CNS-1)
 22654*---------- フリーメッセージ
 22655         MOVE  WK-TEMP-MSG
 22656           TO  WK-GYOMU-FREE-MSG      OF  WK-GYOMU-ERR-INFO(WK-J)
 22657*----------  後処理業務エラーフラグ
 22658         MOVE  CNS-ON                 TO  FLG-MEISAI-GYOMU-ERR
 22659       WHEN  OTHER
 22660*--------------------<DEBUG>--------------------------------------
 22661D    DISPLAY  CNS-PGM-ID ":*****   ポートフォリオ属性を"
 22662D             "取得エラー  *****"
 22663*--------------------<DEBUG>--------------------------------------
 22664*----------  進捗管理フラグ
 22665         MOVE  CNS-16               TO  WK-1190-STATUS
 22666*----------  ワーク実行ステータス
 22667         MOVE  CNS-16               TO  WK-STATUS
 22668*----------  ワークリターンコード
 22669         MOVE  CNS-16               TO  WK-RTN-CODE
 22670*----------  サブエラーメッセージ出力処理
 22671         PERFORM  SUB-ERR-MSG-RTN
 22672*----------  ワークエラーパッケージを編集
 22673         INITIALIZE  WK-SYS-ERR-INFO
 22674*----------  エラー検知プログラムID
 22675         MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
 22676*----------  ポジション
 22677         MOVE  CNS-POS-046          TO  WK-ERR-POS
 22678*----------  リターンコード
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 392
* MUSR2651.cob                                                     cpy)cpy)y)y)
 22679         MOVE  CNS-RTN-901          TO  WK-RTN-CD
 22680*----------  詳細リターンコード
 22681         MOVE  RTN-CD
 22682           OF  PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
 22683                                    TO  WK-DETAIL-RTN-CD
 22684*----------  詳細リターンコードデコードフラグ
 22685         MOVE  CNS-DETAIL-0         TO  WK-DETAIL-RTN-CD-FLG
 22686*---------- フリーメッセージ
 22687         MOVE  SPACE                TO  WK-FREE-MSG
 22688*----------  エラー情報追加処理
 22689         PERFORM  ERR-INFO-ADD-RTN
 22690     END-EVALUATE
 22691*-------------------<DEBUG>---------------------------------------
 22692D    DISPLAY  CNS-PGM-ID":WK-CAPITAL-TUKA-CD =["
 22693D              WK-CAPITAL-TUKA-CD"]"
 22694D    DISPLAY  CNS-PGM-ID":約定主義会計フラグ =["
 22695D              WK-YKJ-SYUGI-KAIKEI"]"
 22696D    DISPLAY  CNS-PGM-ID":WK-SWK-KJN-PTN-CD =["
 22697D              WK-SWK-KJN-PTN-CD"]"
 22698D    DISPLAY  CNS-PGM-ID ":*** 、ポートフォリオ属性テーブ"
 22699D             "ルからデータを取得  END ***"
 22700*-----------------------------------------------------------------
 22701     CONTINUE.
 22702 SCZY4007-EXT.
 22703     EXIT.
 22704******************************************************************
 22705*    為替換算情報を取得  評価為替レート用の場合
 22706******************************************************************
 22707 SCZY3017-RTN           SECTION.
 22708*-------------------<DEBUG>---------------------------------------
 22709D    DISPLAY  CNS-PGM-ID ":***   為替換算情報を取得   START ***"
 22710*-----------------------------------------------------------------
 22711     INITIALIZE  PARM-SCZY3017-INOUT
 22712                 PARM-RTNPKG
 22713                 WK-KWS-ZYOUHO-JZS
 22714                 WK-KWS-ZYOUHO-FLG
 22715                 WK-PRIO-3017
 22716                 WK-TRHK-TUKA-3017
 22717                 WK-CAPITAL-TUKA-3017
 22718                 WK-RTN-3017
 22719*----------  利用会社コード
 22720     MOVE  WK-RIYO-CMP-CD       OF  WK-ARGUMENT
 22721       TO  RIYO-CMP-CD          OF  PARM-SCZY3017-ARG1
 22722*----------  為替系列コード
 22723     MOVE  WK-PRIO-1-EX-KRTU
 22724       TO  KWS-KRTU-CD          OF  PARM-SCZY3017-ARG1
 22725*---------- ベース通貨コード
 22726     MOVE  H-TRHK-TUKA
 22727       TO  BASE-TUKA-CD         OF  PARM-SCZY3017-ARG1
 22728*---------- 目的通貨コード
 22729     MOVE  WK-CAPITAL-TUKA-CD
 22730       TO  MOKUTEKI-TUKA-CD     OF  PARM-SCZY3017-ARG1
 22731*-------------------<DEBUG>---------------------------------------
 22732D    DISPLAY  CNS-PGM-ID ":ワーク利用会社コード=["
 22733D             WK-RIYO-CMP-CD       OF  WK-ARGUMENT"]"
 22734D    DISPLAY  CNS-PGM-ID ":ワーク為替系列コード=["
 22735D             WK-PRIO-1-EX-KRTU"]"
 22736D    DISPLAY  CNS-PGM-ID ":DBから取得した取引通貨=["
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 393
* MUSR2651.cob                                                     cpy)cpy)y)y)
 22737D             H-TRHK-TUKA"]"
 22738D    DISPLAY  CNS-PGM-ID ":ワーク運用通貨=["
 22739D             WK-CAPITAL-TUKA-CD"]"
 22740D    DISPLAY  CNS-PGM-ID ":PARM-SCZY3017-ARG1:"
 22741D    DISPLAY  CNS-PGM-ID":利用会社コード=["
 22742D             RIYO-CMP-CD          OF  PARM-SCZY3017-ARG1"]"
 22743D    DISPLAY  CNS-PGM-ID":為替系列コード=["
 22744D             KWS-KRTU-CD          OF  PARM-SCZY3017-ARG1"]"
 22745D    DISPLAY  CNS-PGM-ID":ベース通貨コード=["
 22746D             BASE-TUKA-CD         OF  PARM-SCZY3017-ARG1"]"
 22747D    DISPLAY  CNS-PGM-ID":目的通貨コード=["
 22748D             MOKUTEKI-TUKA-CD     OF  PARM-SCZY3017-ARG1"]"
 22749D    DISPLAY  CNS-PGM-ID ":***  CALL SCZY3017  START  ***"
 22750*-----------------------------------------------------------------
 22751     CALL  "SCZY3017"             USING  PARM-SCZY3017-INOUT
 22752                                         PARM-RTNPKG
 22753*-------------------<DEBUG>---------------------------------------
 22754D    DISPLAY  CNS-PGM-ID ":***  CALL SCZY3017  END  ***"
 22755D    DISPLAY  CNS-PGM-ID ":RTN-CD OF SCZY3017 =["
 22756D             RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)"]"
 22757D    DISPLAY  CNS-PGM-ID":COUNTER  OF  PARM-RTNPKG=["
 22758D             COUNTER              OF PARM-RTNPKG"]"
 22759D    DISPLAY  CNS-PGM-ID ":DBから取得した取引通貨=["
 22760D             H-TRHK-TUKA"]"
 22761D    DISPLAY  CNS-PGM-ID ":ワークベース通貨コード_3017=["
 22762D             WK-TRHK-TUKA-3017"]"
 22763*-----------------------------------------------------------------
 22764     MOVE  CNS-ON
 22765       TO  WK-KWS-ZYOUHO-FLG
 22766     MOVE  WK-PRIO-1-EX-KRTU
 22767       TO  WK-PRIO-3017
 22768     MOVE  H-TRHK-TUKA
 22769       TO  WK-TRHK-TUKA-3017
 22770     MOVE  WK-CAPITAL-TUKA-CD
 22771       TO  WK-CAPITAL-TUKA-3017
 22772     MOVE  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
 22773       TO  WK-RTN-3017
 22774*-------------------<DEBUG>---------------------------------------
 22775D    DISPLAY  CNS-PGM-ID ":ワークベース通貨コード_3017=["
 22776D             WK-TRHK-TUKA-3017"]"
 22777*-----------------------------------------------------------------
 22778     EVALUATE  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
 22779       WHEN  CNS-RTN-000
 22780*--------------------<DEBUG>--------------------------------------
 22781D    DISPLAY  CNS-PGM-ID ":*****   為替換算情報を取得正常   *****"
 22782D    DISPLAY  CNS-PGM-ID ":【SUSC3017】.ARG2.為替乗算／除算区分=["
 22783D             JZ-JS-KBN         OF  PARM-SCZY3017-ARG2"]"
 22784D    DISPLAY  CNS-PGM-ID ":ワーク乗除区分１（評価為替レート用）=["
 22785D             WK-KWS-ZYOUHO-JZS"]"
 22786*-----------------------------------------------------------------
 22787*----------  為替乗算/除算区分
 22788         MOVE  JZ-JS-KBN        OF  PARM-SCZY3017-ARG2
 22789           TO  WK-KWS-ZYOUHO-JZS
 22790*--------------------<DEBUG>--------------------------------------
 22791D    DISPLAY  CNS-PGM-ID ":ワーク乗除区分１（評価為替レート用）=["
 22792D             WK-KWS-ZYOUHO-JZS"]"
 22793*-----------------------------------------------------------------
 22794       WHEN  CNS-RTN-110
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 394
* MUSR2651.cob                                                     cpy)cpy)y)y)
 22795*----------
 22796         IF  WK-1190-STATUS < CNS-4
 22797         THEN
 22798           MOVE  CNS-4          TO  WK-1190-STATUS
 22799         ELSE
 22800           CONTINUE
 22801         END-IF
 22802*
 22803         IF  WK-STATUS < CNS-4
 22804         THEN
 22805           MOVE  CNS-4          TO  WK-STATUS
 22806         ELSE
 22807           CONTINUE
 22808         END-IF
 22809*----------  ワークリターンコード
 22810         IF  WK-RTN-CODE < CNS-4
 22811         THEN
 22812           MOVE  CNS-4          TO  WK-RTN-CODE
 22813         ELSE
 22814           CONTINUE
 22815         END-IF
 22816*----------  ワーク業務エラーパッケージを編集
 22817*-------------------<DEBUG>---------------------------------------
 22818D    DISPLAY  CNS-PGM-ID":WK-J =[" WK-J"]"
 22819*-----------------------------------------------------------------
 22820         COMPUTE  WK-J = WK-J + 1
 22821*-------------------<DEBUG>---------------------------------------
 22822D    DISPLAY  CNS-PGM-ID":WK-J =[" WK-J"]"
 22823*-----------------------------------------------------------------
 22824*---------- ファンドコード
 22825         MOVE  WK-FUND-CD-DETAIL     OF  WK-PTF-ATT-DATA(WK-IDX-J)
 22826           TO  WK-GYOMU-FUND-CD      OF  WK-GYOMU-ERR-INFO(WK-J)
 22827*---------- ポートフォリオコード
 22828         MOVE  WK-PTF-CD-DETAIL      OF  WK-PTF-ATT-DATA(WK-IDX-J)
 22829           TO  WK-GYOMU-PTF-CD       OF  WK-GYOMU-ERR-INFO(WK-J)
 22830*---------- 評価系列コード
 22831         MOVE  WK-DEFAUL-THYK-CD     OF  WK-PTF-ATT-DATA(WK-IDX-J)
 22832           TO  WK-GYOMU-HYK-KRTU-CD  OF  WK-GYOMU-ERR-INFO(WK-J)
 22833*---------- 帳票ID
 22834         MOVE  SPACE
 22835           TO  WK-GYOMU-REP-ID        OF  WK-GYOMU-ERR-INFO(WK-J)
 22836*---------- 帳票任意コード
 22837         MOVE  SPACE
 22838           TO  WK-GYOMU-REP-ANY-CD    OF  WK-GYOMU-ERR-INFO(WK-J)
 22839*---------- 基準日From
 22840         MOVE  WK-KIKAN-FR
 22841           TO  WK-GYOMU-KJN-YMD-FROM  OF  WK-GYOMU-ERR-INFO(WK-J)
 22842*---------- 基準日To
 22843         MOVE  WK-KIKAN-TO
 22844           TO  WK-GYOMU-KJN-YMD-TO    OF  WK-GYOMU-ERR-INFO(WK-J)
 22845*---------- メッセージID
 22846         MOVE  CNS-MSG-E000090
 22847           TO  WK-GYOMU-MSG-ID        OF  WK-GYOMU-ERR-INFO(WK-J)
 22848*---------- 置換文字
 22849         MOVE  CNS-TR-UN
 22850           TO  WK-GYOMU-TK-MOJI(WK-J,CNS-1)
 22851*---------- フリーメッセージ
 22852         MOVE  WK-TEMP-MSG
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 395
* MUSR2651.cob                                                     cpy)cpy)y)y)
 22853           TO  WK-GYOMU-FREE-MSG      OF  WK-GYOMU-ERR-INFO(WK-J)
 22854*----------  後処理業務エラーフラグ
 22855         MOVE  CNS-ON                 TO  FLG-MEISAI-GYOMU-ERR
 22856       WHEN  CNS-RTN-800
 22857         IF  WK-1190-STATUS < CNS-4
 22858         THEN
 22859           MOVE  CNS-4          TO  WK-1190-STATUS
 22860         ELSE
 22861           CONTINUE
 22862         END-IF
 22863*
 22864         IF  WK-STATUS < CNS-4
 22865         THEN
 22866           MOVE  CNS-4          TO  WK-STATUS
 22867         ELSE
 22868           CONTINUE
 22869         END-IF
 22870*----------  ワークリターンコード
 22871         IF  WK-RTN-CODE < CNS-4
 22872         THEN
 22873           MOVE  CNS-4          TO  WK-RTN-CODE
 22874         ELSE
 22875           CONTINUE
 22876         END-IF
 22877*----------  ワーク業務エラーパッケージを編集
 22878*-------------------<DEBUG>---------------------------------------
 22879D    DISPLAY  CNS-PGM-ID":WK-J =[" WK-J"]"
 22880*-----------------------------------------------------------------
 22881         COMPUTE  WK-J = WK-J + 1
 22882*-------------------<DEBUG>---------------------------------------
 22883D    DISPLAY  CNS-PGM-ID":WK-J =[" WK-J"]"
 22884*-----------------------------------------------------------------
 22885*---------- ファンドコード
 22886         MOVE  WK-FUND-CD-DETAIL     OF  WK-PTF-ATT-DATA(WK-IDX-J)
 22887           TO  WK-GYOMU-FUND-CD      OF  WK-GYOMU-ERR-INFO(WK-J)
 22888*---------- ポートフォリオコード
 22889         MOVE  WK-PTF-CD-DETAIL      OF  WK-PTF-ATT-DATA(WK-IDX-J)
 22890           TO  WK-GYOMU-PTF-CD       OF  WK-GYOMU-ERR-INFO(WK-J)
 22891*---------- 評価系列コード
 22892         MOVE  WK-DEFAUL-THYK-CD     OF  WK-PTF-ATT-DATA(WK-IDX-J)
 22893           TO  WK-GYOMU-HYK-KRTU-CD  OF  WK-GYOMU-ERR-INFO(WK-J)
 22894*---------- 帳票ID
 22895         MOVE  SPACE
 22896           TO  WK-GYOMU-REP-ID        OF  WK-GYOMU-ERR-INFO(WK-J)
 22897*---------- 帳票任意コード
 22898         MOVE  SPACE
 22899           TO  WK-GYOMU-REP-ANY-CD    OF  WK-GYOMU-ERR-INFO(WK-J)
 22900*---------- 基準日From
 22901         MOVE  WK-KIKAN-FR
 22902           TO  WK-GYOMU-KJN-YMD-FROM  OF  WK-GYOMU-ERR-INFO(WK-J)
 22903*---------- 基準日To
 22904         MOVE  WK-KIKAN-TO
 22905           TO  WK-GYOMU-KJN-YMD-TO    OF  WK-GYOMU-ERR-INFO(WK-J)
 22906*---------- メッセージID
 22907         MOVE  CNS-MSG-E000189
 22908           TO  WK-GYOMU-MSG-ID        OF  WK-GYOMU-ERR-INFO(WK-J)
 22909*---------- 置換文字
 22910         MOVE  SPACE
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 396
* MUSR2651.cob                                                     cpy)cpy)y)y)
 22911           TO  WK-GYOMU-TK-MOJI(WK-J,CNS-1)
 22912*---------- フリーメッセージ
 22913         MOVE  WK-TEMP-MSG
 22914           TO  WK-GYOMU-FREE-MSG      OF  WK-GYOMU-ERR-INFO(WK-J)
 22915*----------  後処理業務エラーフラグ
 22916         MOVE  CNS-ON                 TO  FLG-MEISAI-GYOMU-ERR
 22917       WHEN  OTHER
 22918*--------------------<DEBUG>--------------------------------------
 22919D    DISPLAY  CNS-PGM-ID ":*****   為替換算情報を取得"
 22920D             " エラー  *****"
 22921*--------------------<DEBUG>--------------------------------------
 22922*----------  進捗管理フラグ
 22923         MOVE  CNS-16               TO  WK-1190-STATUS
 22924*----------  ワーク実行ステータス
 22925         MOVE  CNS-16               TO  WK-STATUS
 22926*----------  ワークリターンコード
 22927         MOVE  CNS-16               TO  WK-RTN-CODE
 22928*----------  サブエラーメッセージ出力処理
 22929         PERFORM  SUB-ERR-MSG-RTN
 22930*----------  ワークエラーパッケージを編集
 22931         INITIALIZE  WK-SYS-ERR-INFO
 22932*----------  エラー検知プログラムID
 22933         MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
 22934*----------  ポジション
 22935         MOVE  CNS-POS-047          TO  WK-ERR-POS
 22936*----------  リターンコード
 22937         MOVE  CNS-RTN-901          TO  WK-RTN-CD
 22938*----------  詳細リターンコード
 22939         MOVE  RTN-CD
 22940           OF  PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
 22941                                    TO  WK-DETAIL-RTN-CD
 22942*----------  詳細リターンコードデコードフラグ
 22943         MOVE  CNS-DETAIL-0         TO  WK-DETAIL-RTN-CD-FLG
 22944*---------- フリーメッセージ
 22945         MOVE  SPACE                TO  WK-FREE-MSG
 22946*----------  エラー情報追加処理
 22947         PERFORM  ERR-INFO-ADD-RTN
 22948     END-EVALUATE
 22949*-------------------<DEBUG>---------------------------------------
 22950D    DISPLAY  CNS-PGM-ID":為替乗算/除算区分=["WK-KWS-ZYOUHO-JZS"]"
 22951D    DISPLAY  CNS-PGM-ID ":*** 為替換算情報を取得   END ***"
 22952*-----------------------------------------------------------------
 22953     CONTINUE.
 22954 SCZY3017-EXT.
 22955     EXIT.
 22956*******              テーマ3422         修正  開始        ********
 22957******************************************************************
 22958*    為替換算情報を取得    時価(取引通貨)用の場合
 22959******************************************************************
 22960 SCZY3017-2-RTN         SECTION.
 22961*-------------------<DEBUG>---------------------------------------
 22962D    DISPLAY  CNS-PGM-ID ":***   為替換算情報を取得2   START ***"
 22963*-----------------------------------------------------------------
 22964     INITIALIZE  PARM-SCZY3017-INOUT
 22965                 PARM-RTNPKG
 22966                 WK-KWS-ZYOUHO-JZS-2
 22967                 WK-TH-ZYOUHO-FLG
 22968                 WK-PRIO-CP
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 397
* MUSR2651.cob                                                     cpy)cpy)y)y)
 22969                 WK-BASE-TUKA-CP
 22970                 WK-MOKU-TUKA-CP
 22971                 WK-RTN-3017-2
 22972*----------  利用会社コード
 22973     MOVE  WK-RIYO-CMP-CD       OF  WK-ARGUMENT
 22974       TO  RIYO-CMP-CD          OF  PARM-SCZY3017-ARG1
 22975*----------  為替系列コード
 22976     MOVE  WK-PRIO-1-EX-KRTU
 22977       TO  KWS-KRTU-CD          OF  PARM-SCZY3017-ARG1
 22978*---------- ベース通貨コード
 22979     MOVE  H-KWS-TH-TUKA-CD
 22980       TO  BASE-TUKA-CD         OF  PARM-SCZY3017-ARG1
 22981*---------- 目的通貨コード
 22982     MOVE  H-TRHK-TUKA
 22983       TO  MOKUTEKI-TUKA-CD     OF  PARM-SCZY3017-ARG1
 22984*-------------------<DEBUG>---------------------------------------
 22985D    DISPLAY  CNS-PGM-ID ":ワーク利用会社コード=["
 22986D             WK-RIYO-CMP-CD       OF  WK-ARGUMENT"]"
 22987D    DISPLAY  CNS-PGM-ID ":ワーク為替系列コード=["
 22988D             WK-PRIO-1-EX-KRTU"]"
 22989D    DISPLAY  CNS-PGM-ID ":DBから取得した為替決済通貨=["
 22990D             H-KWS-TH-TUKA-CD"]"
 22991D    DISPLAY  CNS-PGM-ID ":DBから取得した取引通貨=["
 22992D             H-TRHK-TUKA"]"
 22993D    DISPLAY  CNS-PGM-ID ":PARM-SCZY3017-ARG1:"
 22994D    DISPLAY  CNS-PGM-ID":利用会社コード=["
 22995D             RIYO-CMP-CD          OF  PARM-SCZY3017-ARG1"]"
 22996D    DISPLAY  CNS-PGM-ID":為替系列コード=["
 22997D             KWS-KRTU-CD          OF  PARM-SCZY3017-ARG1"]"
 22998D    DISPLAY  CNS-PGM-ID":ベース通貨コード=["
 22999D             BASE-TUKA-CD         OF  PARM-SCZY3017-ARG1"]"
 23000D    DISPLAY  CNS-PGM-ID":目的通貨コード=["
 23001D             MOKUTEKI-TUKA-CD     OF  PARM-SCZY3017-ARG1"]"
 23002D    DISPLAY  CNS-PGM-ID ":***  CALL SCZY3017  START  ***"
 23003*-----------------------------------------------------------------
 23004     CALL  "SCZY3017"             USING  PARM-SCZY3017-INOUT
 23005                                         PARM-RTNPKG
 23006*-------------------<DEBUG>---------------------------------------
 23007D    DISPLAY  CNS-PGM-ID ":***  CALL SCZY3017  END  ***"
 23008D    DISPLAY  CNS-PGM-ID ":ワーク約定為替換算時採用系列=["
 23009D             WK-PRIO-1-EX-KRTU"]"
 23010D    DISPLAY  CNS-PGM-ID ":DBから取得した為替決済通貨=["
 23011D             H-KWS-TH-TUKA-CD"]"
 23012D    DISPLAY  CNS-PGM-ID ":DBから取得した取引通貨=["
 23013D             H-TRHK-TUKA"]"
 23014*-----------------------------------------------------------------
 23015     MOVE  CNS-ON
 23016       TO  WK-TH-ZYOUHO-FLG
 23017     MOVE  WK-PRIO-1-EX-KRTU
 23018       TO  WK-PRIO-CP
 23019     MOVE  H-KWS-TH-TUKA-CD
 23020       TO  WK-BASE-TUKA-CP
 23021     MOVE  H-TRHK-TUKA
 23022       TO  WK-MOKU-TUKA-CP
 23023     MOVE  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
 23024       TO  WK-RTN-3017-2
 23025*-------------------<DEBUG>---------------------------------------
 23026D    DISPLAY  CNS-PGM-ID ":ワーク取引決済乗除区分フラグ=["
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 398
* MUSR2651.cob                                                     cpy)cpy)y)y)
 23027D             WK-TH-ZYOUHO-FLG"]"
 23028D    DISPLAY  CNS-PGM-ID ":ワーク約定為替換算時採用系列_時価"
 23029D             "(取引通貨)用=["WK-PRIO-CP"]"
 23030D    DISPLAY  CNS-PGM-ID ":ワークベース通貨コード_時価(取引通貨)"
 23031D             "用=["WK-BASE-TUKA-CP"]"
 23032D    DISPLAY  CNS-PGM-ID ":ワーク目的通貨コード_時価(取引通貨)用"
 23033D             "=["WK-MOKU-TUKA-CP"]"
 23034D    DISPLAY  CNS-PGM-ID ":ワークリターンコード_時価(取引通貨)用"
 23035D             "=["WK-RTN-3017-2"]"
 23036D    DISPLAY  CNS-PGM-ID ":RTN-CD OF SCZY3017 =["
 23037D             RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)"]"
 23038D    DISPLAY  CNS-PGM-ID":COUNTER  OF  PARM-RTNPKG=["
 23039D             COUNTER              OF PARM-RTNPKG"]"
 23040*-----------------------------------------------------------------
 23041     EVALUATE  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
 23042       WHEN  CNS-RTN-000
 23043*--------------------<DEBUG>--------------------------------------
 23044D    DISPLAY  CNS-PGM-ID ":*****   為替換算情報を取得2正常  *****"
 23045D    DISPLAY  CNS-PGM-ID ":【SUSC3017】.ARG2.為替乗算／除算区分=["
 23046D             JZ-JS-KBN         OF  PARM-SCZY3017-ARG2"]"
 23047D    DISPLAY  CNS-PGM-ID ":ワーク乗除区分2（時価（取引通貨）用）"
 23048D             "=["WK-KWS-ZYOUHO-JZS-2"]"
 23049*-----------------------------------------------------------------
 23050*----------  為替乗算/除算区分
 23051         MOVE  JZ-JS-KBN        OF  PARM-SCZY3017-ARG2
 23052           TO  WK-KWS-ZYOUHO-JZS-2
 23053*--------------------<DEBUG>--------------------------------------
 23054D    DISPLAY  CNS-PGM-ID ":ワーク乗除区分2（時価（取引通貨）用）"
 23055D             "=["WK-KWS-ZYOUHO-JZS-2"]"
 23056*-----------------------------------------------------------------
 23057       WHEN  CNS-RTN-110
 23058*----------
 23059         IF  WK-1190-STATUS < CNS-4
 23060         THEN
 23061           MOVE  CNS-4          TO  WK-1190-STATUS
 23062         ELSE
 23063           CONTINUE
 23064         END-IF
 23065*
 23066         IF  WK-STATUS < CNS-4
 23067         THEN
 23068           MOVE  CNS-4          TO  WK-STATUS
 23069         ELSE
 23070           CONTINUE
 23071         END-IF
 23072*----------  ワークリターンコード
 23073         IF  WK-RTN-CODE < CNS-4
 23074         THEN
 23075           MOVE  CNS-4          TO  WK-RTN-CODE
 23076         ELSE
 23077           CONTINUE
 23078         END-IF
 23079*----------  ワーク業務エラーパッケージを編集
 23080*-------------------<DEBUG>---------------------------------------
 23081D    DISPLAY  CNS-PGM-ID":WK-J =[" WK-J"]"
 23082*-----------------------------------------------------------------
 23083         COMPUTE  WK-J = WK-J + 1
 23084*-------------------<DEBUG>---------------------------------------
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 399
* MUSR2651.cob                                                     cpy)cpy)y)y)
 23085D    DISPLAY  CNS-PGM-ID":WK-J =[" WK-J"]"
 23086*-----------------------------------------------------------------
 23087*---------- ファンドコード
 23088         MOVE  WK-FUND-CD-DETAIL     OF  WK-PTF-ATT-DATA(WK-IDX-J)
 23089           TO  WK-GYOMU-FUND-CD      OF  WK-GYOMU-ERR-INFO(WK-J)
 23090*---------- ポートフォリオコード
 23091         MOVE  WK-PTF-CD-DETAIL      OF  WK-PTF-ATT-DATA(WK-IDX-J)
 23092           TO  WK-GYOMU-PTF-CD       OF  WK-GYOMU-ERR-INFO(WK-J)
 23093*---------- 評価系列コード
 23094         MOVE  WK-DEFAUL-THYK-CD     OF  WK-PTF-ATT-DATA(WK-IDX-J)
 23095           TO  WK-GYOMU-HYK-KRTU-CD  OF  WK-GYOMU-ERR-INFO(WK-J)
 23096*---------- 帳票ID
 23097         MOVE  SPACE
 23098           TO  WK-GYOMU-REP-ID        OF  WK-GYOMU-ERR-INFO(WK-J)
 23099*---------- 帳票任意コード
 23100         MOVE  SPACE
 23101           TO  WK-GYOMU-REP-ANY-CD    OF  WK-GYOMU-ERR-INFO(WK-J)
 23102*---------- 基準日From
 23103         MOVE  WK-KIKAN-FR
 23104           TO  WK-GYOMU-KJN-YMD-FROM  OF  WK-GYOMU-ERR-INFO(WK-J)
 23105*---------- 基準日To
 23106         MOVE  WK-KIKAN-TO
 23107           TO  WK-GYOMU-KJN-YMD-TO    OF  WK-GYOMU-ERR-INFO(WK-J)
 23108*---------- メッセージID
 23109         MOVE  CNS-MSG-E000090
 23110           TO  WK-GYOMU-MSG-ID        OF  WK-GYOMU-ERR-INFO(WK-J)
 23111*---------- 置換文字
 23112         MOVE  CNS-KS-UN
 23113           TO  WK-GYOMU-TK-MOJI(WK-J,CNS-1)
 23114*---------- フリーメッセージ
 23115         MOVE  WK-TEMP-MSG
 23116           TO  WK-GYOMU-FREE-MSG      OF  WK-GYOMU-ERR-INFO(WK-J)
 23117*----------  後処理業務エラーフラグ
 23118         MOVE  CNS-ON                 TO  FLG-MEISAI-GYOMU-ERR
 23119*--------------------<DEBUG>--------------------------------------
 23120D    DISPLAY  CNS-PGM-ID ":1190実行ステータス=["WK-1190-STATUS"]"
 23121D    DISPLAY  CNS-PGM-ID ":ワーク実行ステータス=["WK-STATUS"]"
 23122D    DISPLAY  CNS-PGM-ID ":ワークリターンコード=["WK-RTN-CODE"]"
 23123D    DISPLAY  CNS-PGM-ID ":ファンドコード=["
 23124D             WK-GYOMU-FUND-CD      OF  WK-GYOMU-ERR-INFO(WK-J)"]"
 23125D    DISPLAY  CNS-PGM-ID ":ポートフォリオコード=["
 23126D             WK-GYOMU-PTF-CD       OF  WK-GYOMU-ERR-INFO(WK-J)"]"
 23127D    DISPLAY  CNS-PGM-ID ":評価系列コード=["
 23128D             WK-GYOMU-HYK-KRTU-CD  OF  WK-GYOMU-ERR-INFO(WK-J)"]"
 23129D    DISPLAY  CNS-PGM-ID ":帳票ID=["
 23130D             WK-GYOMU-REP-ID       OF  WK-GYOMU-ERR-INFO(WK-J)"]"
 23131D    DISPLAY  CNS-PGM-ID ":帳票任意コード=["
 23132D             WK-GYOMU-REP-ANY-CD   OF  WK-GYOMU-ERR-INFO(WK-J)"]"
 23133D    DISPLAY  CNS-PGM-ID ":基準日From=["
 23134D             WK-GYOMU-KJN-YMD-FROM OF  WK-GYOMU-ERR-INFO(WK-J)"]"
 23135D    DISPLAY  CNS-PGM-ID ":基準日To=["
 23136D             WK-GYOMU-KJN-YMD-TO   OF  WK-GYOMU-ERR-INFO(WK-J)"]"
 23137D    DISPLAY  CNS-PGM-ID ":メッセージID=["
 23138D             WK-GYOMU-MSG-ID       OF  WK-GYOMU-ERR-INFO(WK-J)"]"
 23139D    DISPLAY  CNS-PGM-ID ":置換文字=["
 23140D             WK-GYOMU-TK-MOJI(WK-J,CNS-1)"]"
 23141D    DISPLAY  CNS-PGM-ID ":フリーメッセージ=["
 23142D             WK-GYOMU-FREE-MSG     OF  WK-GYOMU-ERR-INFO(WK-J)"]"
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 400
* MUSR2651.cob                                                     cpy)cpy)y)y)
 23143*-----------------------------------------------------------------
 23144       WHEN  CNS-RTN-800
 23145         IF  WK-1190-STATUS < CNS-4
 23146         THEN
 23147           MOVE  CNS-4          TO  WK-1190-STATUS
 23148         ELSE
 23149           CONTINUE
 23150         END-IF
 23151         IF  WK-STATUS < CNS-4
 23152         THEN
 23153           MOVE  CNS-4          TO  WK-STATUS
 23154         ELSE
 23155           CONTINUE
 23156         END-IF
 23157*----------  ワークリターンコード
 23158         IF  WK-RTN-CODE < CNS-4
 23159         THEN
 23160           MOVE  CNS-4          TO  WK-RTN-CODE
 23161         ELSE
 23162           CONTINUE
 23163         END-IF
 23164*----------  ワーク業務エラーパッケージを編集
 23165*-------------------<DEBUG>---------------------------------------
 23166D    DISPLAY  CNS-PGM-ID":WK-J =[" WK-J"]"
 23167*-----------------------------------------------------------------
 23168         COMPUTE  WK-J = WK-J + 1
 23169*-------------------<DEBUG>---------------------------------------
 23170D    DISPLAY  CNS-PGM-ID":WK-J =[" WK-J"]"
 23171*-----------------------------------------------------------------
 23172*---------- ファンドコード
 23173         MOVE  WK-FUND-CD-DETAIL     OF  WK-PTF-ATT-DATA(WK-IDX-J)
 23174           TO  WK-GYOMU-FUND-CD      OF  WK-GYOMU-ERR-INFO(WK-J)
 23175*---------- ポートフォリオコード
 23176         MOVE  WK-PTF-CD-DETAIL      OF  WK-PTF-ATT-DATA(WK-IDX-J)
 23177           TO  WK-GYOMU-PTF-CD       OF  WK-GYOMU-ERR-INFO(WK-J)
 23178*---------- 評価系列コード
 23179         MOVE  WK-DEFAUL-THYK-CD     OF  WK-PTF-ATT-DATA(WK-IDX-J)
 23180           TO  WK-GYOMU-HYK-KRTU-CD  OF  WK-GYOMU-ERR-INFO(WK-J)
 23181*---------- 帳票ID
 23182         MOVE  SPACE
 23183           TO  WK-GYOMU-REP-ID        OF  WK-GYOMU-ERR-INFO(WK-J)
 23184*---------- 帳票任意コード
 23185         MOVE  SPACE
 23186           TO  WK-GYOMU-REP-ANY-CD    OF  WK-GYOMU-ERR-INFO(WK-J)
 23187*---------- 基準日From
 23188         MOVE  WK-KIKAN-FR
 23189           TO  WK-GYOMU-KJN-YMD-FROM  OF  WK-GYOMU-ERR-INFO(WK-J)
 23190*---------- 基準日To
 23191         MOVE  WK-KIKAN-TO
 23192           TO  WK-GYOMU-KJN-YMD-TO    OF  WK-GYOMU-ERR-INFO(WK-J)
 23193*---------- メッセージID
 23194         MOVE  CNS-MSG-E000189
 23195           TO  WK-GYOMU-MSG-ID        OF  WK-GYOMU-ERR-INFO(WK-J)
 23196*---------- 置換文字
 23197         MOVE  SPACE
 23198           TO  WK-GYOMU-TK-MOJI(WK-J,CNS-1)
 23199*---------- フリーメッセージ
 23200         MOVE  WK-TEMP-MSG
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 401
* MUSR2651.cob                                                     cpy)cpy)y)y)
 23201           TO  WK-GYOMU-FREE-MSG      OF  WK-GYOMU-ERR-INFO(WK-J)
 23202*----------  後処理業務エラーフラグ
 23203         MOVE  CNS-ON                 TO  FLG-MEISAI-GYOMU-ERR
 23204*--------------------<DEBUG>--------------------------------------
 23205D    DISPLAY  CNS-PGM-ID ":1190実行ステータス=["WK-1190-STATUS"]"
 23206D    DISPLAY  CNS-PGM-ID ":ワーク実行ステータス=["WK-STATUS"]"
 23207D    DISPLAY  CNS-PGM-ID ":ワークリターンコード=["WK-RTN-CODE"]"
 23208D    DISPLAY  CNS-PGM-ID ":ファンドコード=["
 23209D             WK-GYOMU-FUND-CD      OF  WK-GYOMU-ERR-INFO(WK-J)"]"
 23210D    DISPLAY  CNS-PGM-ID ":ポートフォリオコード=["
 23211D             WK-GYOMU-PTF-CD       OF  WK-GYOMU-ERR-INFO(WK-J)"]"
 23212D    DISPLAY  CNS-PGM-ID ":評価系列コード=["
 23213D             WK-GYOMU-HYK-KRTU-CD  OF  WK-GYOMU-ERR-INFO(WK-J)"]"
 23214D    DISPLAY  CNS-PGM-ID ":帳票ID=["
 23215D             WK-GYOMU-REP-ID       OF  WK-GYOMU-ERR-INFO(WK-J)"]"
 23216D    DISPLAY  CNS-PGM-ID ":帳票任意コード=["
 23217D             WK-GYOMU-REP-ANY-CD   OF  WK-GYOMU-ERR-INFO(WK-J)"]"
 23218D    DISPLAY  CNS-PGM-ID ":基準日From=["
 23219D             WK-GYOMU-KJN-YMD-FROM OF  WK-GYOMU-ERR-INFO(WK-J)"]"
 23220D    DISPLAY  CNS-PGM-ID ":基準日To=["
 23221D             WK-GYOMU-KJN-YMD-TO   OF  WK-GYOMU-ERR-INFO(WK-J)"]"
 23222D    DISPLAY  CNS-PGM-ID ":メッセージID=["
 23223D             WK-GYOMU-MSG-ID       OF  WK-GYOMU-ERR-INFO(WK-J)"]"
 23224D    DISPLAY  CNS-PGM-ID ":置換文字=["
 23225D             WK-GYOMU-TK-MOJI(WK-J,CNS-1)"]"
 23226D    DISPLAY  CNS-PGM-ID ":フリーメッセージ=["
 23227D             WK-GYOMU-FREE-MSG     OF  WK-GYOMU-ERR-INFO(WK-J)"]"
 23228*-----------------------------------------------------------------
 23229       WHEN  OTHER
 23230*--------------------<DEBUG>--------------------------------------
 23231D    DISPLAY  CNS-PGM-ID ":*****   為替換算情報を取得2"
 23232D             " エラー  *****"
 23233*-----------------------------------------------------------------
 23234*----------  進捗管理フラグ
 23235         MOVE  CNS-16               TO  WK-1190-STATUS
 23236*----------  ワーク実行ステータス
 23237         MOVE  CNS-16               TO  WK-STATUS
 23238*----------  ワークリターンコード
 23239         MOVE  CNS-16               TO  WK-RTN-CODE
 23240*----------  サブエラーメッセージ出力処理
 23241         PERFORM  SUB-ERR-MSG-RTN
 23242*----------  ワークエラーパッケージを編集
 23243         INITIALIZE  WK-SYS-ERR-INFO
 23244*----------  エラー検知プログラムID
 23245         MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
 23246*----------  ポジション
 23247         MOVE  CNS-POS-084          TO  WK-ERR-POS
 23248*----------  リターンコード
 23249         MOVE  CNS-RTN-901          TO  WK-RTN-CD
 23250*----------  詳細リターンコード
 23251         MOVE  RTN-CD
 23252           OF  PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
 23253                                    TO  WK-DETAIL-RTN-CD
 23254*----------  詳細リターンコードデコードフラグ
 23255         MOVE  CNS-DETAIL-0         TO  WK-DETAIL-RTN-CD-FLG
 23256*---------- フリーメッセージ
 23257         MOVE  SPACE                TO  WK-FREE-MSG
 23258*----------  エラー情報追加処理
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 402
* MUSR2651.cob                                                     cpy)cpy)y)y)
 23259         PERFORM  ERR-INFO-ADD-RTN
 23260     END-EVALUATE
 23261*-------------------<DEBUG>---------------------------------------
 23262D    DISPLAY  CNS-PGM-ID":為替乗算/除算区分=["
 23263D             WK-KWS-ZYOUHO-JZS-2"]"
 23264D    DISPLAY  CNS-PGM-ID ":*** 為替換算情報を取得2   END ***"
 23265*-----------------------------------------------------------------
 23266     CONTINUE.
 23267 SCZY3017-2-EXT.
 23268     EXIT.
 23269*******              テーマ3422         修正  終了        ********
 23270******************************************************************
 23271*    カウンターパーティ名取得処理
 23272******************************************************************
 23273 SCZY4116-RTN           SECTION.
 23274*--------------------<DEBUG>--------------------------------------
 23275D    DISPLAY  CNS-PGM-ID
 23276D             ":***  カウンターパーティ名取得処理  START  ***"
 23277D    DISPLAY  CNS-PGM-ID":利用会社コード=["WK-RIYO-CMP-CD"]"
 23278*-----------------------------------------------------------------
 23279     INITIALIZE  PARM-SCZY4116-INOUT
 23280                 PARM-RTNPKG
 23281                 WK-BIKOU-FLG
 23282                 WK-BIKOU-4116
 23283                 WK-RTN-4116
 23284*----------  利用会社コード
 23285     MOVE  WK-RIYO-CMP-CD
 23286       TO  RIYO-CMP-CD            OF  PARM-SCZY4116-ARG1
 23287*----------  カウンターパーティ分類
 23288     MOVE  CNS-X-1
 23289       TO  COUNTER-PARTY-BUNRUI   OF  PARM-SCZY4116-ARG1
 23290*----------  適用開始日
 23291     MOVE  H-ZANTK-YMD            OF  HST-TBL-SELECT
 23292       TO  TEKIYO-FROM            OF  PARM-SCZY4116-ARG1
 23293*----------  カウンターパーティコード
 23294     MOVE  H-BIKOU-1
 23295       TO  COUNTER-PARTY-CD       OF  PARM-SCZY4116-ARG1
 23296*-------------------<DEBUG>---------------------------------------
 23297D    DISPLAY  CNS-PGM-ID":PARM-SCZY4116-ARG1:"
 23298D    DISPLAY  CNS-PGM-ID":利用会社コード=["
 23299D             RIYO-CMP-CD         OF  PARM-SCZY4116-ARG1"]"
 23300D    DISPLAY  CNS-PGM-ID":カウンターパーティ分類=["
 23301D             COUNTER-PARTY-BUNRUI
 23302D                                 OF  PARM-SCZY4116-ARG1"]"
 23303D    DISPLAY  CNS-PGM-ID":適用開始日=["
 23304D             TEKIYO-FROM         OF  PARM-SCZY4116-ARG1"]"
 23305D    DISPLAY  CNS-PGM-ID":カウンターパーティコード=["
 23306D             COUNTER-PARTY-CD    OF  PARM-SCZY4116-ARG1"]"
 23307D    DISPLAY  CNS-PGM-ID": ***  CALL SCZY4116  START  ***"
 23308*-----------------------------------------------------------------
 23309     CALL  "SCZY4116"             USING  PARM-SCZY4116-INOUT
 23310                                         PARM-RTNPKG
 23311*-------------------<DEBUG>---------------------------------------
 23312D    DISPLAY  CNS-PGM-ID": ***  CALL SCZY4116  END  ***"
 23313D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY4116)=["
 23314D             RTN-CD  OF  PARM-RTNPKG(COUNTER OF PARM-RTNPKG)"]"
 23315D    DISPLAY  CNS-PGM-ID":COUNTER OF  PARM-RTNPKG=["
 23316D                         COUNTER OF  PARM-RTNPKG"]"
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 403
* MUSR2651.cob                                                     cpy)cpy)y)y)
 23317D    DISPLAY  CNS-PGM-ID":PARM-RTNPKG=["PARM-RTNPKG"]"
 23318*-----------------------------------------------------------------
 23319     MOVE  CNS-ON
 23320       TO  WK-BIKOU-FLG
 23321     MOVE  H-BIKOU-1
 23322       TO  WK-BIKOU-4116
 23323     MOVE  RTN-CD  OF  PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
 23324       TO  WK-RTN-4116
 23325     EVALUATE  RTN-CD  OF  PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
 23326*----------  正常
 23327       WHEN  CNS-RTN-000
 23328*----------  証券会社
 23329         MOVE  COUNT-PTY-AB-NAME-J   OF  PARM-SCZY4116-ARG2
 23330           TO  WK-BIKOU-1
 23331*----------  データなし
 23332       WHEN  CNS-RTN-110
 23333*----------
 23334         IF  WK-1190-STATUS < CNS-4
 23335         THEN
 23336           MOVE  CNS-4          TO  WK-1190-STATUS
 23337         ELSE
 23338           CONTINUE
 23339         END-IF
 23340*
 23341         IF  WK-STATUS < CNS-4
 23342         THEN
 23343           MOVE  CNS-4          TO  WK-STATUS
 23344         ELSE
 23345           CONTINUE
 23346         END-IF
 23347*----------  ワークリターンコード
 23348         IF  WK-RTN-CODE < CNS-4
 23349         THEN
 23350           MOVE  CNS-4          TO  WK-RTN-CODE
 23351         ELSE
 23352           CONTINUE
 23353         END-IF
 23354*----------  ワーク業務エラーパッケージを編集
 23355*-------------------<DEBUG>---------------------------------------
 23356D    DISPLAY  CNS-PGM-ID":WK-J =[" WK-J"]"
 23357*-----------------------------------------------------------------
 23358         COMPUTE  WK-J = WK-J + 1
 23359*-------------------<DEBUG>---------------------------------------
 23360D    DISPLAY  CNS-PGM-ID":WK-J =[" WK-J"]"
 23361*-----------------------------------------------------------------
 23362*---------- ファンドコード
 23363         MOVE  WK-FUND-CD-DETAIL     OF  WK-PTF-ATT-DATA(WK-IDX-J)
 23364           TO  WK-GYOMU-FUND-CD      OF  WK-GYOMU-ERR-INFO(WK-J)
 23365*---------- ポートフォリオコード
 23366         MOVE  WK-PTF-CD-DETAIL      OF  WK-PTF-ATT-DATA(WK-IDX-J)
 23367           TO  WK-GYOMU-PTF-CD       OF  WK-GYOMU-ERR-INFO(WK-J)
 23368*---------- 評価系列コード
 23369         MOVE  WK-DEFAUL-THYK-CD     OF  WK-PTF-ATT-DATA(WK-IDX-J)
 23370           TO  WK-GYOMU-HYK-KRTU-CD  OF  WK-GYOMU-ERR-INFO(WK-J)
 23371*---------- 帳票ID
 23372         MOVE  SPACE
 23373           TO  WK-GYOMU-REP-ID        OF  WK-GYOMU-ERR-INFO(WK-J)
 23374*---------- 帳票任意コード
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 404
* MUSR2651.cob                                                     cpy)cpy)y)y)
 23375         MOVE  SPACE
 23376           TO  WK-GYOMU-REP-ANY-CD    OF  WK-GYOMU-ERR-INFO(WK-J)
 23377*---------- 基準日From
 23378         MOVE  WK-KIKAN-FR
 23379           TO  WK-GYOMU-KJN-YMD-FROM  OF  WK-GYOMU-ERR-INFO(WK-J)
 23380*---------- 基準日To
 23381         MOVE  WK-KIKAN-TO
 23382           TO  WK-GYOMU-KJN-YMD-TO    OF  WK-GYOMU-ERR-INFO(WK-J)
 23383*---------- メッセージID
 23384         MOVE  CNS-MSG-E000090
 23385           TO  WK-GYOMU-MSG-ID        OF  WK-GYOMU-ERR-INFO(WK-J)
 23386*---------- 置換文字
 23387         MOVE  CNS-BIKKOU-1
 23388           TO  WK-GYOMU-TK-MOJI(WK-J,CNS-1)
 23389*---------- フリーメッセージ
 23390         MOVE  WK-TEMP-MSG
 23391           TO  WK-GYOMU-FREE-MSG      OF  WK-GYOMU-ERR-INFO(WK-J)
 23392*----------  後処理業務エラーフラグ
 23393         MOVE  CNS-ON                 TO  FLG-MEISAI-GYOMU-ERR
 23394       WHEN  CNS-RTN-800
 23395*----------
 23396         IF  WK-1190-STATUS < CNS-4
 23397         THEN
 23398           MOVE  CNS-4          TO  WK-1190-STATUS
 23399         ELSE
 23400           CONTINUE
 23401         END-IF
 23402*
 23403         IF  WK-STATUS < CNS-4
 23404         THEN
 23405           MOVE  CNS-4          TO  WK-STATUS
 23406         ELSE
 23407           CONTINUE
 23408         END-IF
 23409*----------  ワークリターンコード
 23410         IF  WK-RTN-CODE < CNS-4
 23411         THEN
 23412           MOVE  CNS-4          TO  WK-RTN-CODE
 23413         ELSE
 23414           CONTINUE
 23415         END-IF
 23416*----------  ワーク業務エラーパッケージを編集
 23417*-------------------<DEBUG>---------------------------------------
 23418D    DISPLAY  CNS-PGM-ID":WK-J =[" WK-J"]"
 23419*-----------------------------------------------------------------
 23420         COMPUTE  WK-J = WK-J + 1
 23421*-------------------<DEBUG>---------------------------------------
 23422D    DISPLAY  CNS-PGM-ID":WK-J =[" WK-J"]"
 23423*-----------------------------------------------------------------
 23424*---------- ファンドコード
 23425         MOVE  WK-FUND-CD-DETAIL     OF  WK-PTF-ATT-DATA(WK-IDX-J)
 23426           TO  WK-GYOMU-FUND-CD      OF  WK-GYOMU-ERR-INFO(WK-J)
 23427*---------- ポートフォリオコード
 23428         MOVE  WK-PTF-CD-DETAIL      OF  WK-PTF-ATT-DATA(WK-IDX-J)
 23429           TO  WK-GYOMU-PTF-CD       OF  WK-GYOMU-ERR-INFO(WK-J)
 23430*---------- 評価系列コード
 23431         MOVE  WK-DEFAUL-THYK-CD     OF  WK-PTF-ATT-DATA(WK-IDX-J)
 23432           TO  WK-GYOMU-HYK-KRTU-CD  OF  WK-GYOMU-ERR-INFO(WK-J)
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 405
* MUSR2651.cob                                                     cpy)cpy)y)y)
 23433*---------- 帳票ID
 23434         MOVE  SPACE
 23435           TO  WK-GYOMU-REP-ID        OF  WK-GYOMU-ERR-INFO(WK-J)
 23436*---------- 帳票任意コード
 23437         MOVE  SPACE
 23438           TO  WK-GYOMU-REP-ANY-CD    OF  WK-GYOMU-ERR-INFO(WK-J)
 23439*---------- 基準日From
 23440         MOVE  WK-KIKAN-FR
 23441           TO  WK-GYOMU-KJN-YMD-FROM  OF  WK-GYOMU-ERR-INFO(WK-J)
 23442*---------- 基準日To
 23443         MOVE  WK-KIKAN-TO
 23444           TO  WK-GYOMU-KJN-YMD-TO    OF  WK-GYOMU-ERR-INFO(WK-J)
 23445*---------- メッセージID
 23446         MOVE  CNS-MSG-E000189
 23447           TO  WK-GYOMU-MSG-ID        OF  WK-GYOMU-ERR-INFO(WK-J)
 23448*---------- 置換文字
 23449         MOVE  SPACE
 23450           TO  WK-GYOMU-TK-MOJI(WK-J,CNS-1)
 23451*---------- フリーメッセージ
 23452         MOVE  WK-TEMP-MSG
 23453           TO  WK-GYOMU-FREE-MSG      OF  WK-GYOMU-ERR-INFO(WK-J)
 23454*----------  後処理業務エラーフラグ
 23455         MOVE  CNS-ON                 TO  FLG-MEISAI-GYOMU-ERR
 23456*----------  上記以外
 23457       WHEN  OTHER
 23458*----------  進捗管理フラグ
 23459         MOVE  CNS-16               TO  WK-1190-STATUS
 23460*----------  ワーク実行ステータス
 23461         MOVE  CNS-16               TO  WK-STATUS
 23462*----------  ワークリターンコード
 23463         MOVE  CNS-16               TO  WK-RTN-CODE
 23464*----------  サブエラーメッセージ出力処理
 23465         PERFORM  SUB-ERR-MSG-RTN
 23466*----------  ワークエラーパッケージを編集
 23467         INITIALIZE  WK-SYS-ERR-INFO
 23468*----------  エラー検知プログラムID
 23469         MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
 23470*----------  ポジション
 23471         MOVE  CNS-POS-048          TO  WK-ERR-POS
 23472*----------  リターンコード
 23473         MOVE  CNS-RTN-901          TO  WK-RTN-CD
 23474*----------  詳細リターンコード
 23475         MOVE  RTN-CD
 23476           OF  PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
 23477                                    TO  WK-DETAIL-RTN-CD
 23478*----------  詳細リターンコードデコードフラグ
 23479         MOVE  CNS-DETAIL-0         TO  WK-DETAIL-RTN-CD-FLG
 23480*---------- フリーメッセージ
 23481         MOVE  SPACE                TO  WK-FREE-MSG
 23482*----------  エラー情報追加処理
 23483         PERFORM  ERR-INFO-ADD-RTN
 23484     END-EVALUATE
 23485*--------------------<DEBUG>--------------------------------------
 23486D    DISPLAY  CNS-PGM-ID":備考_１=["WK-BIKOU-1"]"
 23487D    DISPLAY  CNS-PGM-ID
 23488D             ":***  カウンターパーティ名取得処理  END  ***"
 23489*-----------------------------------------------------------------
 23490     CONTINUE.
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 406
* MUSR2651.cob                                                     cpy)cpy)y)y)
 23491 SCZY4116-EXT.
 23492     EXIT.
 23493******************************************************************
 23494*    内部⇒外部銘柄コード変換処理2
 23495******************************************************************
 23496 SCZY3002-CHAN-2-RTN    SECTION.
 23497*--------------------<DEBUG>--------------------------------------
 23498D    DISPLAY  CNS-PGM-ID":***  内部⇒外部銘柄コード変換処理2"
 23499D             " START  ***"
 23500*-----------------------------------------------------------------
 23501     INITIALIZE  PARM-SCZY3002-INOUT
 23502                 PARM-RTNPKG
 23503                 FLG-DEFAULT-KRTU-CD
 23504                 WK-DEFAULT-KRTU-CD
 23505                 WK-MEG-CD-3002-3
 23506                 WK-SEC-SBT-3002-3
 23507                 WK-RTN-3002-3
 23508*----------  利用会社コード
 23509     MOVE  WK-RIYO-CMP-CD         OF  WK-ARGUMENT
 23510       TO  RIYO-CMP-CD            OF  PARM-SCZY3002-ARG1
 23511*----------  内部銘柄コード
 23512     MOVE  H-MEG-CD               OF  HST-TBL-SELECT
 23513       TO  NAIBU-MEG-CD           OF  PARM-SCZY3002-ARG1
 23514*---------- 商品分類コード
 23515     MOVE  SPACE
 23516       TO  SYOHIN-BUNRUI-CD       OF  PARM-SCZY3002-ARG1
 23517*---------- 証券種別コード
 23518     IF  H-DATA-KBN  =  CNS-X-1
 23519     THEN
 23520       MOVE  SPACE
 23521         TO  SEC-SBT-CD           OF  PARM-SCZY3002-ARG1
 23522     ELSE
 23523       MOVE  H-SEC-SBT-CD
 23524         TO  SEC-SBT-CD           OF  PARM-SCZY3002-ARG1
 23525     END-IF
 23526*---------- 元証券種別コード
 23527     MOVE  SPACE
 23528       TO  MOTO-SEC-SBT-CD        OF  PARM-SCZY3002-ARG1
 23529*----------  銘柄リファレンス系列コード
 23530     MOVE  SPACE
 23531       TO  CD-REF-KRTU-CD         OF  PARM-SCZY3002-ARG1
 23532*----------  業務タスクID
 23533     MOVE  WK-GYOMU-TASK-ID       OF  WK-ARGUMENT
 23534       TO  GYOMU-TASK-ID          OF  PARM-SCZY3002-ARG1
 23535*----------  基準日
 23536     MOVE  H-ZANTK-YMD            OF  HST-TBL-SELECT
 23537       TO  KJN-YMD                OF  PARM-SCZY3002-ARG1
 23538*--------------------<DEBUG>--------------------------------------
 23539D    DISPLAY  CNS-PGM-ID":RIYO-CMP-CD=["
 23540D             RIYO-CMP-CD         OF  PARM-SCZY3002-ARG1"]"
 23541D    DISPLAY  CNS-PGM-ID":NAIBU-MEG-CD=["
 23542D             NAIBU-MEG-CD        OF  PARM-SCZY3002-ARG1"]"
 23543D    DISPLAY  CNS-PGM-ID":SYOHIN-BUNRUI-CD=["
 23544D             SYOHIN-BUNRUI-CD    OF  PARM-SCZY3002-ARG1"]"
 23545D    DISPLAY  CNS-PGM-ID":テータ区分=["
 23546D             H-DATA-KBN "]"
 23547D    DISPLAY  CNS-PGM-ID":SEC-SBT-CD=["
 23548D             SEC-SBT-CD          OF  PARM-SCZY3002-ARG1"]"
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 407
* MUSR2651.cob                                                     cpy)cpy)y)y)
 23549D    DISPLAY  CNS-PGM-ID":MOTO-SEC-SBT-CD=["
 23550D             MOTO-SEC-SBT-CD     OF  PARM-SCZY3002-ARG1"]"
 23551D    DISPLAY  CNS-PGM-ID":MEG-TUKA-CD=["
 23552D             MEG-TUKA-CD         OF  PARM-SCZY3002-ARG1"]"
 23553D    DISPLAY  CNS-PGM-ID":CD-REF-KRTU-CD=["
 23554D             CD-REF-KRTU-CD      OF  PARM-SCZY3002-ARG1"]"
 23555D    DISPLAY  CNS-PGM-ID":KJN-YMD=["
 23556D             KJN-YMD             OF  PARM-SCZY3002-ARG1"]"
 23557D    DISPLAY  CNS-PGM-ID":GYOMU-TASK-ID=["
 23558D             GYOMU-TASK-ID       OF  PARM-SCZY3002-ARG1"]"
 23559D    DISPLAY  CNS-PGM-ID":***  CALL SCZY3002 START  ***"
 23560*-----------------------------------------------------------------
 23561     CALL  "SCZY3002"             USING  PARM-SCZY3002-INOUT
 23562                                         PARM-RTNPKG
 23563*--------------------<DEBUG>--------------------------------------
 23564D    DISPLAY  CNS-PGM-ID":***  CALL SCZY3002 END  ***"
 23565D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY3002)       =["
 23566D             RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)"]"
 23567D    DISPLAY  CNS-PGM-ID":COUNTER OF PARM-RTNPKG =["
 23568D             COUNTER             OF PARM-RTNPKG "]"
 23569*-----------------------------------------------------------------
 23570     MOVE  H-MEG-CD               OF  HST-TBL-SELECT
 23571       TO  WK-MEG-CD-3002-3
 23572     MOVE  H-SEC-SBT-CD
 23573       TO  WK-SEC-SBT-3002-3
 23574     MOVE  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
 23575       TO  WK-RTN-3002-3
 23576     EVALUATE  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
 23577*----------  正常
 23578       WHEN  CNS-RTN-000
 23579*---------- デフォルトリファレンスコード
 23580         MOVE  CD-REF-KRTU-CD        OF  PARM-SCZY3002-ARG2
 23581           TO  WK-DEFAULT-KRTU-CD
 23582         IF  WK-DEFAULT-KRTU-CD =  WK-CD-REF-KRTU-CD
 23583         THEN
 23584           MOVE  CNS-1               TO  FLG-DEFAULT-KRTU-CD
 23585         ELSE
 23586           MOVE  ZERO                TO  FLG-DEFAULT-KRTU-CD
 23587         END-IF
 23588*--------------------<DEBSUG>-------------------------------------
 23589D    DISPLAY  CNS-PGM-ID":デフォルトリファレンスコード=["
 23590D             WK-DEFAULT-KRTU-CD"]"
 23591D    DISPLAY  CNS-PGM-ID":ワークコードリファレンス系列コード=["
 23592D             WK-CD-REF-KRTU-CD"]"
 23593D    DISPLAY  CNS-PGM-ID":デフォルトリファレンスコードフラグ=["
 23594D             FLG-DEFAULT-KRTU-CD"]"
 23595*-----------------------------------------------------------------
 23596*----------  異常
 23597       WHEN  CNS-RTN-110
 23598       WHEN  CNS-RTN-002
 23599*----------  ワーク実行ステータス
 23600         MOVE  ZERO               TO  FLG-DEFAULT-KRTU-CD
 23601         MOVE  SPACE              TO  WK-DEFAULT-KRTU-CD
 23602       WHEN  CNS-RTN-800
 23603*--------------------<DEBUG>--------------------------------------
 23604D    DISPLAY  CNS-PGM-ID":外部コード取得処理2  業務エラー"
 23605*-----------------------------------------------------------------
 23606*----------  ワーク実行ステータス
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 408
* MUSR2651.cob                                                     cpy)cpy)y)y)
 23607         IF  WK-STATUS < CNS-4
 23608         THEN
 23609           MOVE  CNS-4                 TO  WK-STATUS
 23610         ELSE
 23611           CONTINUE
 23612         END-IF
 23613*----------  ワークリターンコード
 23614         IF  WK-STATUS > WK-RTN-CODE
 23615         THEN
 23616           MOVE  WK-STATUS           TO  WK-RTN-CODE
 23617         ELSE
 23618           CONTINUE
 23619         END-IF
 23620*----------  1190実行ステータス
 23621         IF  WK-STATUS > WK-1190-STATUS
 23622         THEN
 23623           MOVE  WK-STATUS      TO  WK-1190-STATUS
 23624         ELSE
 23625           CONTINUE
 23626         END-IF
 23627*-------------------<DEBUG>---------------------------------------
 23628D    DISPLAY  CNS-PGM-ID":WK-J=["WK-J"]"
 23629*-----------------------------------------------------------------
 23630         COMPUTE  WK-J = WK-J + CNS-1
 23631*-------------------<DEBUG>---------------------------------------
 23632D    DISPLAY  CNS-PGM-ID":WK-J=["WK-J"]"
 23633*-----------------------------------------------------------------
 23634*----------  基準日実行ステータス
 23635*---------- ファンドコード
 23636         MOVE  WK-FUND-CD-DETAIL  OF  WK-FUND-PTF-DETAIL(WK-IDX-J)
 23637           TO  WK-GYOMU-FUND-CD
 23638                   OF  WK-GYOMU-ERR-INFO(WK-J)
 23639*---------- ポートフォリオコード
 23640         MOVE  WK-PTF-CD-DETAIL   OF  WK-FUND-PTF-DETAIL(WK-IDX-J)
 23641           TO  WK-GYOMU-PTF-CD
 23642                   OF  WK-GYOMU-ERR-INFO(WK-J)
 23643*---------- 評価系列コード
 23644         MOVE  WK-DEFAUL-THYK-CD  OF  WK-FUND-PTF-DETAIL(WK-IDX-J)
 23645            TO  WK-GYOMU-HYK-KRTU-CD
 23646                   OF  WK-GYOMU-ERR-INFO(WK-J)
 23647*---------- 基準日From
 23648         MOVE  WK-KIKAN-FR
 23649           TO  WK-GYOMU-KJN-YMD-FROM
 23650                   OF  WK-GYOMU-ERR-INFO(WK-J)
 23651*---------- 基準日To
 23652         MOVE  WK-KIKAN-TO
 23653           TO  WK-GYOMU-KJN-YMD-TO
 23654                   OF  WK-GYOMU-ERR-INFO(WK-J)
 23655*---------- メッセージID
 23656         MOVE  CNS-MSG-E000189
 23657           TO  WK-GYOMU-MSG-ID
 23658                   OF  WK-GYOMU-ERR-INFO(WK-J)
 23659*---------- 置換文字
 23660         MOVE  SPACE
 23661           TO  WK-GYOMU-TK-MOJI(WK-J,CNS-1)
 23662*---------- フリーメッセージ
 23663         MOVE  WK-TEMP-MSG
 23664           TO  WK-GYOMU-FREE-MSG
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 409
* MUSR2651.cob                                                     cpy)cpy)y)y)
 23665                   OF  WK-GYOMU-ERR-INFO(WK-J)
 23666*----------  明細業務エラーフラグ
 23667         MOVE  CNS-ON             TO  FLG-MEISAI-GYOMU-ERR
 23668*----------  上記以外
 23669       WHEN  OTHER
 23670*--------------------<DEBUG>--------------------------------------
 23671D    DISPLAY  CNS-PGM-ID":内部⇒外部銘柄コード変換処理2  エラー"
 23672*-----------------------------------------------------------------
 23673*----------  WK-STATUS
 23674         MOVE  CNS-16              TO  WK-STATUS
 23675*----------  1190実行ステータス
 23676         MOVE  CNS-16              TO  WK-1190-STATUS
 23677*----------  ワークリターンコード
 23678         MOVE  CNS-16              TO  WK-RTN-CODE
 23679*----------  ワークエラーパッケージを編集
 23680         PERFORM  SUB-ERR-MSG-RTN
 23681         INITIALIZE  WK-SYS-ERR-INFO
 23682*----------  エラー検知プログラムID
 23683         MOVE  CNS-PGM-ID         TO  WK-ERR-PGM-ID
 23684*----------  ポジション
 23685         MOVE  CNS-POS-049        TO  WK-ERR-POS
 23686*----------  リターンコード
 23687         MOVE  CNS-RTN-901        TO  WK-RTN-CD
 23688*----------  詳細リターンコード
 23689         MOVE  RTN-CD             OF  PARM-RTNPKG
 23690                                  (COUNTER OF PARM-RTNPKG)
 23691                                  TO  WK-DETAIL-RTN-CD
 23692*----------  詳細リターンコードデコードフラグ
 23693         MOVE  CNS-DETAIL-0       TO  WK-DETAIL-RTN-CD-FLG
 23694*---------- フリーメッセージ
 23695         MOVE  SPACE              TO  WK-FREE-MSG
 23696*----------  エラー情報追加処理
 23697         PERFORM  ERR-INFO-ADD-RTN
 23698     END-EVALUATE
 23699*--------------------<DEBUG>--------------------------------------
 23700D    DISPLAY  CNS-PGM-ID":***  内部⇒外部銘柄コード変換処理2"
 23701D             " END  ***"
 23702*-----------------------------------------------------------------
 23703     CONTINUE.
 23704 SCZY3002-CHAN-2-EXT.
 23705     EXIT.
 23706******************************************************************
 23707*    合計レコードを編集1
 23708******************************************************************
 23709 GENKIN-GOUKEI-RTN      SECTION.
 23710*--------------------<DEBUG>--------------------------------------
 23711D    DISPLAY  CNS-PGM-ID":合計レコードを編集1  START "
 23712D    DISPLAY  CNS-PGM-ID":H-KB-KANRI-ID=["H-KB-KANRI-ID"]"
 23713*-----------------------------------------------------------------
 23714*----------  保有数量
 23715     IF ( H-KB-KANRI-ID = CNS-MEG-PAYLC
 23716        OR H-KB-KANRI-ID = CNS-MEG-PAYBC
 23717        OR H-KB-KANRI-ID = CNS-MEG-ACPAYLC
 23718        OR H-KB-KANRI-ID = CNS-MEG-MAPAYLC
 23719        OR H-KB-KANRI-ID = CNS-MEG-MAPAYBC )
 23720     THEN
 23721       COMPUTE  WK-HOU-SURYO-SUM
 23722             =  WK-HOU-SURYO-SUM
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 410
* MUSR2651.cob                                                     cpy)cpy)y)y)
 23723             -  H-HOU-SURYO
 23724     ELSE
 23725       COMPUTE  WK-HOU-SURYO-SUM
 23726             =  WK-HOU-SURYO-SUM
 23727             +  H-HOU-SURYO
 23728     END-IF
 23729*----------  取得金額(取引通貨)
 23730     COMPUTE  WK-THTK-ST-KNG-SUM
 23731           =  WK-THTK-ST-KNG-SUM
 23732           +  H-THTK-ST-KNG
 23733*----------  評価金額(取引通貨)
 23734     COMPUTE  WK-THTK-HYK-KN-SUM
 23735           =  WK-THTK-HYK-KN-SUM
 23736           +  H-THTK-HYK-KN
 23737*----------  評価損益(取引通貨)
 23738       COMPUTE  WK-THTK-HYK-SNEKI-SUM
 23739             =  WK-THTK-HYK-SNEKI-SUM
 23740             +  H-THTK-HYK-SNEKI
 23741*----------  取得金額(運用通貨為替換算額)
 23742     COMPUTE  WK-UYTK-KWS-BOKAZN-SUM
 23743           =  WK-UYTK-KWS-BOKAZN-SUM
 23744           +  H-SHTK-KN-LC
 23745*----------  取得金額(運用通貨)
 23746     COMPUTE  WK-SHTK-KN-LC-SUM
 23747           =  WK-SHTK-KN-LC-SUM
 23748           +  H-SHTK-KN-LC
 23749*----------  評価金額(運用通貨)
 23750     COMPUTE  WK-HYK-KN-LC-SUM
 23751           =  WK-HYK-KN-LC-SUM
 23752           +  H-HYK-KN-LC
 23753*----------  評価損益(運用通貨)
 23754     COMPUTE  WK-HYK-SNEKI-LC-SUM
 23755           =  WK-HYK-SNEKI-LC-SUM
 23756           +  H-HYK-SNEKI-LC
 23757*--------------------<DEBUG>--------------------------------------
 23758D    DISPLAY  CNS-PGM-ID":保有数量=["WK-HOU-SURYO-SUM "]"
 23759D    DISPLAY  CNS-PGM-ID":取得金額(取引通貨)=["
 23760D             WK-THTK-ST-KNG-SUM"]"
 23761D    DISPLAY  CNS-PGM-ID":評価金額(取引通貨)=["
 23762D             WK-THTK-HYK-KN-SUM"]"
 23763D    DISPLAY  CNS-PGM-ID":評価損益(取引通貨)=["
 23764D             WK-THTK-HYK-SNEKI-SUM"]"
 23765D    DISPLAY  CNS-PGM-ID":取得金額(運用通貨為替換算額)=["
 23766D             WK-UYTK-KWS-BOKAZN-SUM"]"
 23767D    DISPLAY  CNS-PGM-ID":取得金額(運用通貨)=["
 23768D             WK-SHTK-KN-LC-SUM"]"
 23769D    DISPLAY  CNS-PGM-ID":評価金額(運用通貨)=["
 23770D             WK-HYK-KN-LC-SUM"]"
 23771D    DISPLAY  CNS-PGM-ID":評価損益(運用通貨)=["
 23772D             WK-HYK-SNEKI-LC-SUM"]"
 23773*-----------------------------------------------------------------
 23774*--------------------<DEBUG>--------------------------------------
 23775D    DISPLAY  CNS-PGM-ID":WK-GENKIN-OUT=["WK-GENKIN-OUT"]"
 23776D    DISPLAY  CNS-PGM-ID":H-SEC-SBT-CD=["H-SEC-SBT-CD"]"
 23777D    DISPLAY  CNS-PGM-ID":WK-TRHK-TUKA=["WK-TRHK-TUKA"]"
 23778D    DISPLAY  CNS-PGM-ID":WK-CAPITAL-TUKA-CD=["
 23779D             WK-CAPITAL-TUKA-CD"]"
 23780*-----------------------------------------------------------------
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 411
* MUSR2651.cob                                                     cpy)cpy)y)y)
 23781     IF  WK-GENKIN-OUT  =  SPACE
 23782     THEN
 23783       MOVE  CNS-X-1         TO  WK-GENKIN-OUT
 23784       MOVE  WK-REC          TO  WK-REC2
 23785       IF  H-SEC-SBT-CD = CNS-SKSBT-CASH
 23786       THEN
 23787         IF  WK-TRHK-TUKA  =  WK-CAPITAL-TUKA-CD
 23788         THEN
 23789           MOVE  CNS-SKSBT-CASH
 23790             TO  SEC-SBT-CD  OF  WK-REC2
 23791         ELSE
 23792           MOVE  CNS-SKSBT-EX
 23793             TO  SEC-SBT-CD  OF  WK-REC2
 23794         END-IF
 23795       ELSE
 23796         CONTINUE
 23797       END-IF
 23798     ELSE
 23799       CONTINUE
 23800     END-IF
 23801     MOVE  CNS-ON            TO  FLG-DATA-OUT
 23802*--------------------<DEBUG>--------------------------------------
 23803D    DISPLAY  CNS-PGM-ID":SEC-SBT-CD=["SEC-SBT-CD  OF  WK-REC2"]"
 23804D    DISPLAY  CNS-PGM-ID":WK-GENKIN-OUT=["WK-GENKIN-OUT"]"
 23805D    DISPLAY  CNS-PGM-ID":FLG-DATA-OUT=["FLG-DATA-OUT"]"
 23806D    DISPLAY  CNS-PGM-ID":合計レコードを編集1  END "
 23807*-----------------------------------------------------------------
 23808     CONTINUE.
 23809 GENKIN-GOUKEI-EXT.
 23810     EXIT.
 23811******************************************************************
 23812*    データ合計編輯3する
 23813******************************************************************
 23814 DATA-3-RTN             SECTION.
 23815*--------------------<DEBUG>--------------------------------------
 23816D    DISPLAY  CNS-PGM-ID":***  データ合計編輯3 START  ***"
 23817*-----------------------------------------------------------------
 23818*----------  証券発行元の所属する国
 23819     MOVE  WK-HAKO-CD-CD-2(WK-IDX-M)
 23820       TO  HAKO-CD           OF  WK-REC-REC(WK-IDX-M)
 23821*----------  銘柄コード
 23822     MOVE  WK-MEG-CD-2(WK-IDX-M)
 23823       TO  MEG-CD            OF  WK-REC-REC(WK-IDX-M)
 23824*----------  送付側銘柄コード
 23825     MOVE  WK-MEG-CD-2(WK-IDX-M)
 23826       TO  SEND-MEG-CD       OF  WK-REC-REC(WK-IDX-M)
 23827*----------  保有数量
 23828     MOVE  WK-HOU-SURYO-SUM-2(WK-IDX-M)
 23829       TO  WK-18-18-X
 23830     PERFORM  ZERO-COMPUTE-RTN
 23831     COMPUTE  WK-NUM-LENGTH = 25 - WK-NUM-1
 23832     MOVE  WK-18-18-X(WK-NUM-FROM:WK-NUM-LENGTH)
 23833       TO  HOU-SURYO         OF  WK-REC-REC(WK-IDX-M)
 23834*----------  取得金額(取引通貨)
 23835     MOVE  WK-THTK-ST-KNG-SUM-2(WK-IDX-M)
 23836       TO  WK-18-18-X
 23837     PERFORM  ZERO-COMPUTE-RTN
 23838     COMPUTE  WK-NUM-LENGTH = 22 - WK-NUM-1
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 412
* MUSR2651.cob                                                     cpy)cpy)y)y)
 23839     MOVE  WK-18-18-X(WK-NUM-FROM:WK-NUM-LENGTH)
 23840       TO  THTK-ST-KNG       OF  WK-REC-REC(WK-IDX-M)
 23841*----------  評価金額(取引通貨)
 23842     MOVE  WK-THTK-HYK-KN-SUM-2(WK-IDX-M)
 23843       TO  WK-18-18-X
 23844     PERFORM  ZERO-COMPUTE-RTN
 23845     COMPUTE  WK-NUM-LENGTH = 22 - WK-NUM-1
 23846     MOVE  WK-18-18-X(WK-NUM-FROM:WK-NUM-LENGTH)
 23847       TO  THTK-HYK-KN       OF  WK-REC-REC(WK-IDX-M)
 23848*----------  評価損益(取引通貨)
 23849     MOVE  WK-THTK-HYK-SNEKI-SUM-2(WK-IDX-M)
 23850       TO  WK-18-18-X
 23851     PERFORM  ZERO-COMPUTE-RTN
 23852     COMPUTE  WK-NUM-LENGTH = 22 - WK-NUM-1
 23853     MOVE  WK-18-18-X(WK-NUM-FROM:WK-NUM-LENGTH)
 23854       TO  THTK-HYK-SNEKI    OF  WK-REC-REC(WK-IDX-M)
 23855*----------  取得金額(運用通貨為替換算額)
 23856     MOVE  WK-UYTK-KWS-BOKAZN-SUM-2(WK-IDX-M)
 23857       TO  WK-18-18-X
 23858     PERFORM  ZERO-COMPUTE-RTN
 23859     COMPUTE  WK-NUM-LENGTH = 22 - WK-NUM-1
 23860     MOVE  WK-18-18-X(WK-NUM-FROM:WK-NUM-LENGTH)
 23861       TO  UYTK-KWS-BOKAZN   OF  WK-REC-REC(WK-IDX-M)
 23862*----------  取得金額(運用通貨)
 23863     MOVE  WK-SHTK-KN-LC-SUM-2(WK-IDX-M)
 23864       TO  WK-18-18-X
 23865     PERFORM  ZERO-COMPUTE-RTN
 23866     COMPUTE  WK-NUM-LENGTH = 22 - WK-NUM-1
 23867     MOVE  WK-18-18-X(WK-NUM-FROM:WK-NUM-LENGTH)
 23868       TO  SHTK-KN-LC        OF  WK-REC-REC(WK-IDX-M)
 23869*----------  評価金額(運用通貨)
 23870     MOVE  WK-HYK-KN-LC-SUM-2(WK-IDX-M)
 23871       TO  WK-18-18-X
 23872     PERFORM  ZERO-COMPUTE-RTN
 23873     COMPUTE  WK-NUM-LENGTH = 22 - WK-NUM-1
 23874     MOVE  WK-18-18-X(WK-NUM-FROM:WK-NUM-LENGTH)
 23875       TO  HYK-KN-LC         OF  WK-REC-REC(WK-IDX-M)
 23876*----------  評価損益(運用通貨)
 23877     MOVE  WK-HYK-SNEKI-LC-SUM-2(WK-IDX-M)
 23878       TO  WK-18-18-X
 23879     PERFORM  ZERO-COMPUTE-RTN
 23880     COMPUTE  WK-NUM-LENGTH = 22 - WK-NUM-1
 23881     MOVE  WK-18-18-X(WK-NUM-FROM:WK-NUM-LENGTH)
 23882       TO  HYK-SNEKI-LC      OF  WK-REC-REC(WK-IDX-M)
 23883*----------  銘柄名称(日本語)
 23884     MOVE  WK-MEG-MEI-JP-2(WK-IDX-M)
 23885       TO  MEG-MEI-JP        OF  WK-REC-REC(WK-IDX-M)
 23886*----------  銘柄名称(英語)
 23887     MOVE  WK-MEG-MEI-EN-2(WK-IDX-M)
 23888       TO  MEG-MEI-EN        OF  WK-REC-REC(WK-IDX-M)
 23889*----------  債券ｸｰﾎﾟﾝ
 23890     MOVE  ZERO
 23891       TO  WK-18-18-X
 23892     PERFORM  ZERO-COMPUTE-RTN
 23893     COMPUTE  WK-NUM-LENGTH = 25 - WK-NUM-1
 23894     MOVE  WK-18-18-X(WK-NUM-FROM:WK-NUM-LENGTH)
 23895       TO  SK-KP             OF  WK-REC-REC(WK-IDX-M)
 23896*----------  債券償還日
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 413
* MUSR2651.cob                                                     cpy)cpy)y)y)
 23897     MOVE  ZERO
 23898       TO  SHOKAN-YMD        OF  WK-REC-REC(WK-IDX-M)
 23899*----------  建玉/約定番号
 23900     MOVE  ZERO
 23901       TO  KB-KANRI-ID       OF  WK-REC-REC(WK-IDX-M)
 23902*--------------------<DEBUG>--------------------------------------
 23903D    DISPLAY  CNS-PGM-ID":証券発行元の所属する国=["HAKO-CD
 23904D                                  OF  WK-REC-REC(WK-IDX-M) "]"
 23905D    DISPLAY  CNS-PGM-ID":銘柄コード=["MEG-CD
 23906D                                  OF  WK-REC-REC(WK-IDX-M) "]"
 23907D    DISPLAY  CNS-PGM-ID":銘柄名称(日本語)=["MEG-MEI-JP
 23908D                                  OF  WK-REC-REC(WK-IDX-M) "]"
 23909D    DISPLAY  CNS-PGM-ID":銘柄名称(英語)=["MEG-MEI-EN
 23910D                                  OF  WK-REC-REC(WK-IDX-M) "]"
 23911D    DISPLAY  CNS-PGM-ID":債券ｸｰﾎﾟﾝ=[" SK-KP
 23912D                                  OF  WK-REC-REC(WK-IDX-M) "]"
 23913D    DISPLAY  CNS-PGM-ID":債券償還日=["SHOKAN-YMD
 23914D                                  OF  WK-REC-REC(WK-IDX-M) "]"
 23915D    DISPLAY  CNS-PGM-ID":建玉/約定番号=["KB-KANRI-ID
 23916D                                  OF  WK-REC-REC(WK-IDX-M) "]"
 23917*-----------------------------------------------------------------
 23918*--------------------<DEBUG>--------------------------------------
 23919D    DISPLAY  CNS-PGM-ID":*** データ合計編輯3 END  ***"
 23920*-----------------------------------------------------------------
 23921     CONTINUE.
 23922 DATA-3-EXT.
 23923     EXIT.
 23924******************************************************************
 23925*    DATファイル3クローズ処理
 23926******************************************************************
 23927 CLOSE-FILE-3-RTN       SECTION.
 23928*--------------------<DEBUG>--------------------------------------
 23929D    DISPLAY  CNS-PGM-ID":*****DATファイル3クローズ処理  "
 23930D             "START  *****"
 23931*--------------------<DEBUG>--------------------------------------
 23932     MOVE  CNS-OFF                 TO  FLG-FILE-OPEN-3
 23933     CLOSE  OUT-FILE-3
 23934*-------------------<DEBUG>---------------------------------------
 23935D    DISPLAY   CNS-PGM-ID":FILE-STATUS-3=[" WK-FILE-STATUS-3 "]"
 23936*-----------------------------------------------------------------
 23937     EVALUATE  WK-FILE-STATUS-3
 23938       WHEN  CNS-FILE-NORMAL
 23939*--------------------<DEBUG>--------------------------------------
 23940D    DISPLAY  CNS-PGM-ID":DATファイル3クローズ処理正常"
 23941*-----------------------------------------------------------------
 23942         CONTINUE
 23943       WHEN  OTHER
 23944*--------------------<DEBUG>--------------------------------------
 23945D    DISPLAY  CNS-PGM-ID":DATファイル3クローズ処理エラー"
 23946*-----------------------------------------------------------------
 23947*----------  ワークリターンコード
 23948         MOVE  CNS-16                  TO  WK-RTN-CODE
 23949*----------  ワークエラーパッケージを編集
 23950         INITIALIZE  WK-SYS-ERR-INFO
 23951*----------  エラー検知プログラムID
 23952         MOVE  CNS-PGM-ID              TO  WK-ERR-PGM-ID
 23953*----------  ポジション
 23954         MOVE  CNS-POS-050             TO  WK-ERR-POS
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 414
* MUSR2651.cob                                                     cpy)cpy)y)y)
 23955*----------  リターンコード
 23956         MOVE  CNS-RTN-230             TO  WK-RTN-CD
 23957*----------  詳細リターンコード
 23958         MOVE  FUNCTION NUMVAL(WK-FILE-STATUS-3)
 23959                                       TO  WK-DETAIL-RTN-CD
 23960*----------  詳細リターンコードデコードフラグ
 23961         MOVE  CNS-DETAIL-0            TO  WK-DETAIL-RTN-CD-FLG
 23962*---------- フリーメッセージ
 23963         STRING  "ファイル:["
 23964                 WK-PSACT-DAT-FILE-3
 23965                 "]クローズエラー"
 23966         DELIMITED BY SPACE           INTO  WK-FREE-MSG
 23967         END-STRING
 23968*----------  エラー処理
 23969       PERFORM  ERR-RTN
 23970     END-EVALUATE
 23971*--------------------<DEBUG>--------------------------------------
 23972D    DISPLAY CNS-PGM-ID":ファイル3オープンフラグ=["
 23973D            FLG-FILE-OPEN-3"]"
 23974D    DISPLAY CNS-PGM-ID":*****DATファイル3クローズ処理 END  *****"
 23975*-----------------------------------------------------------------
 23976     CONTINUE.
 23977 CLOSE-FILE-3-EXT.
 23978     EXIT.
 23979******************************************************************
 23980*    DATファイル4クローズ処理
 23981******************************************************************
 23982 CLOSE-FILE-4-RTN       SECTION.
 23983*--------------------<DEBUG>--------------------------------------
 23984D    DISPLAY  CNS-PGM-ID":*****DATファイル4クローズ処理  "
 23985D             "START  *****"
 23986*--------------------<DEBUG>--------------------------------------
 23987     MOVE  CNS-OFF                 TO  FLG-FILE-OPEN-4
 23988     CLOSE  OUT-FILE-4
 23989*-------------------<DEBUG>---------------------------------------
 23990D    DISPLAY   CNS-PGM-ID":FILE-STATUS-4=[" WK-FILE-STATUS-4 "]"
 23991*-----------------------------------------------------------------
 23992     EVALUATE  WK-FILE-STATUS-4
 23993       WHEN  CNS-FILE-NORMAL
 23994*--------------------<DEBUG>--------------------------------------
 23995D    DISPLAY  CNS-PGM-ID":DATファイル4クローズ処理正常"
 23996*-----------------------------------------------------------------
 23997         CONTINUE
 23998       WHEN  OTHER
 23999*--------------------<DEBUG>--------------------------------------
 24000D    DISPLAY  CNS-PGM-ID":DATファイル4クローズ処理エラー"
 24001*-----------------------------------------------------------------
 24002*----------  ワークリターンコード
 24003         MOVE  CNS-16                  TO  WK-RTN-CODE
 24004*----------  ワークエラーパッケージを編集
 24005         INITIALIZE  WK-SYS-ERR-INFO
 24006*----------  エラー検知プログラムID
 24007         MOVE  CNS-PGM-ID              TO  WK-ERR-PGM-ID
 24008*----------  ポジション
 24009         MOVE  CNS-POS-051             TO  WK-ERR-POS
 24010*----------  リターンコード
 24011         MOVE  CNS-RTN-230             TO  WK-RTN-CD
 24012*----------  詳細リターンコード
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 415
* MUSR2651.cob                                                     cpy)cpy)y)y)
 24013         MOVE  FUNCTION NUMVAL(WK-FILE-STATUS-4)
 24014                                       TO  WK-DETAIL-RTN-CD
 24015*----------  詳細リターンコードデコードフラグ
 24016         MOVE  CNS-DETAIL-0            TO  WK-DETAIL-RTN-CD-FLG
 24017*---------- フリーメッセージ
 24018         STRING  "ファイル:["
 24019                 WK-PSACT-DAT-FILE-4
 24020                 "]クローズエラー"
 24021         DELIMITED BY SPACE           INTO  WK-FREE-MSG
 24022         END-STRING
 24023*----------  エラー処理
 24024       PERFORM  ERR-RTN
 24025     END-EVALUATE
 24026*--------------------<DEBUG>--------------------------------------
 24027D    DISPLAY CNS-PGM-ID":ファイル4オープンフラグ=["
 24028D            FLG-FILE-OPEN-4"]"
 24029D    DISPLAY CNS-PGM-ID":*****DATファイル4クローズ処理 END  *****"
 24030*-----------------------------------------------------------------
 24031     CONTINUE.
 24032 CLOSE-FILE-4-EXT.
 24033     EXIT.
 24034******************************************************************
 24035*    データ合計編輯2する
 24036******************************************************************
 24037 DATA-2-RTN             SECTION.
 24038*--------------------<DEBUG>--------------------------------------
 24039D    DISPLAY  CNS-PGM-ID":***  データ合計編輯2 START  ***"
 24040D    DISPLAY  CNS-PGM-ID":保有数量=["WK-HOU-SURYO-SUM"]"
 24041D    DISPLAY  CNS-PGM-ID":取得金額(取引通貨)=["
 24042D             WK-THTK-ST-KNG-SUM"]"
 24043D    DISPLAY  CNS-PGM-ID":評価金額(取引通貨)=["
 24044D             WK-THTK-HYK-KN-SUM"]"
 24045D    DISPLAY  CNS-PGM-ID":評価損益(取引通貨)=["
 24046D             WK-THTK-HYK-SNEKI-SUM"]"
 24047D    DISPLAY  CNS-PGM-ID":取得金額(運用通貨為替換算額)=["
 24048D             WK-UYTK-KWS-BOKAZN-SUM"]"
 24049D    DISPLAY  CNS-PGM-ID":取得金額(運用通貨)=["
 24050D             WK-SHTK-KN-LC-SUM"]"
 24051D    DISPLAY  CNS-PGM-ID":評価金額(運用通貨)=["
 24052D             WK-HYK-KN-LC-SUM"]"
 24053D    DISPLAY  CNS-PGM-ID":評価損益(運用通貨)=["
 24054D             WK-HYK-SNEKI-LC-SUM"]"
 24055*-----------------------------------------------------------------
 24056*----------  保有数量
 24057     MOVE  WK-HOU-SURYO-SUM
 24058       TO  WK-18-18-X
 24059     PERFORM  ZERO-COMPUTE-RTN
 24060     COMPUTE  WK-NUM-LENGTH = 25 - WK-NUM-1
 24061     MOVE  WK-18-18-X(WK-NUM-FROM:WK-NUM-LENGTH)
 24062       TO  HOU-SURYO         OF  WK-REC2
 24063*----------  取得金額(取引通貨)
 24064     MOVE  WK-THTK-ST-KNG-SUM
 24065       TO  WK-18-18-X
 24066     PERFORM  ZERO-COMPUTE-RTN
 24067     COMPUTE  WK-NUM-LENGTH = 22 - WK-NUM-1
 24068     MOVE  WK-18-18-X(WK-NUM-FROM:WK-NUM-LENGTH)
 24069       TO  THTK-ST-KNG       OF  WK-REC2
 24070*----------  評価金額(取引通貨)
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 416
* MUSR2651.cob                                                     cpy)cpy)y)y)
 24071     MOVE  WK-THTK-HYK-KN-SUM
 24072       TO  WK-18-18-X
 24073     PERFORM  ZERO-COMPUTE-RTN
 24074     COMPUTE  WK-NUM-LENGTH = 22 - WK-NUM-1
 24075     MOVE  WK-18-18-X(WK-NUM-FROM:WK-NUM-LENGTH)
 24076       TO  THTK-HYK-KN       OF  WK-REC2
 24077*----------  評価損益(取引通貨)
 24078     MOVE  WK-THTK-HYK-SNEKI-SUM
 24079       TO  WK-18-18-X
 24080     PERFORM  ZERO-COMPUTE-RTN
 24081     COMPUTE  WK-NUM-LENGTH = 22 - WK-NUM-1
 24082     MOVE  WK-18-18-X(WK-NUM-FROM:WK-NUM-LENGTH)
 24083       TO  THTK-HYK-SNEKI    OF  WK-REC2
 24084*----------  取得金額(運用通貨為替換算額)
 24085     MOVE  WK-UYTK-KWS-BOKAZN-SUM
 24086       TO  WK-18-18-X
 24087     PERFORM  ZERO-COMPUTE-RTN
 24088     COMPUTE  WK-NUM-LENGTH = 22 - WK-NUM-1
 24089     MOVE  WK-18-18-X(WK-NUM-FROM:WK-NUM-LENGTH)
 24090       TO  UYTK-KWS-BOKAZN   OF  WK-REC2
 24091*----------  取得金額(運用通貨)
 24092     MOVE  WK-SHTK-KN-LC-SUM
 24093       TO  WK-18-18-X
 24094     PERFORM  ZERO-COMPUTE-RTN
 24095     COMPUTE  WK-NUM-LENGTH = 22 - WK-NUM-1
 24096     MOVE  WK-18-18-X(WK-NUM-FROM:WK-NUM-LENGTH)
 24097       TO  SHTK-KN-LC        OF  WK-REC2
 24098*----------  評価金額(運用通貨)
 24099     MOVE  WK-HYK-KN-LC-SUM
 24100       TO  WK-18-18-X
 24101     PERFORM  ZERO-COMPUTE-RTN
 24102     COMPUTE  WK-NUM-LENGTH = 22 - WK-NUM-1
 24103     MOVE  WK-18-18-X(WK-NUM-FROM:WK-NUM-LENGTH)
 24104       TO  HYK-KN-LC         OF  WK-REC2
 24105*----------  評価損益(運用通貨)
 24106     MOVE  WK-HYK-SNEKI-LC-SUM
 24107       TO  WK-18-18-X
 24108     PERFORM  ZERO-COMPUTE-RTN
 24109     COMPUTE  WK-NUM-LENGTH = 22 - WK-NUM-1
 24110     MOVE  WK-18-18-X(WK-NUM-FROM:WK-NUM-LENGTH)
 24111       TO  HYK-SNEKI-LC      OF  WK-REC2
 24112*--------------------<DEBUG>--------------------------------------
 24113D    DISPLAY  CNS-PGM-ID":保有数量=["
 24114D             HOU-SURYO         OF  WK-REC2 "]"
 24115D    DISPLAY  CNS-PGM-ID":取得金額(取引通貨)=["
 24116D             THTK-ST-KNG       OF  WK-REC2"]"
 24117D    DISPLAY  CNS-PGM-ID":評価金額(取引通貨)=["
 24118D             THTK-HYK-KN       OF  WK-REC2"]"
 24119D    DISPLAY  CNS-PGM-ID":評価損益(取引通貨)=["
 24120D             THTK-HYK-SNEKI    OF  WK-REC2"]"
 24121D    DISPLAY  CNS-PGM-ID":取得金額(運用通貨為替換算額)=["
 24122D             UYTK-KWS-BOKAZN   OF  WK-REC2"]"
 24123D    DISPLAY  CNS-PGM-ID":取得金額(運用通貨)=["
 24124D             SHTK-KN-LC        OF  WK-REC2"]"
 24125D    DISPLAY  CNS-PGM-ID":評価金額(運用通貨)=["
 24126D             HYK-KN-LC         OF  WK-REC2"]"
 24127D    DISPLAY  CNS-PGM-ID":評価損益(運用通貨)=["
 24128D             HYK-SNEKI-LC      OF  WK-REC2"]"
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 417
* MUSR2651.cob                                                     cpy)cpy)y)y)
 24129D    DISPLAY  CNS-PGM-ID":*** データ合計編輯2 END  ***"
 24130*-----------------------------------------------------------------
 24131     CONTINUE.
 24132 DATA-2-EXT.
 24133     EXIT.
 24134******************************************************************
 24135*    ブレイク処理3
 24136******************************************************************
 24137 BREAK3-RTN             SECTION.
 24138*-------------------<DEBUG>---------------------------------------
 24139D    DISPLAY  CNS-PGM-ID":***  ブレイク処理3  START  ***"
 24140D    DISPLAY  CNS-PGM-ID":現金集計出力フラグ=["WK-GENKIN-OUT "]"
 24141*-----------------------------------------------------------------
 24142     IF  WK-GENKIN-OUT = CNS-X-1
 24143     THEN
 24144       PERFORM  DATA-2-RTN
 24145*--------------------<DEBUG>--------------------------------------
 24146D    DISPLAY  CNS-PGM-ID":約定受渡区分:["WK-YJ-UW-KBN-OLD"]"
 24147D    DISPLAY  CNS-PGM-ID":WK-CASH-FLOW-KBN=["WK-CASH-FLOW-KBN"]"
 24148D    DISPLAY  CNS-PGM-ID":I-FLG-KEISAN=["
 24149D             I-FLG-KEISAN          OF WK-DENBUN-INFO"]"
 24150*-----------------------------------------------------------------
 24151       EVALUATE  WK-YJ-UW-KBN-OLD
 24152         WHEN  CNS-X-1
 24153           IF  WK-CASH-FLOW-KBN  =  CNS-X-2
 24154           THEN
 24155             IF  I-FLG-KEISAN OF WK-DENBUN-INFO  = CNS-0
 24156             THEN
 24157               INITIALIZE  DAT-REC
 24158               MOVE  WK-REC2             TO  DAT-REC
 24159               PERFORM  DATA-WRITE-RTN
 24160             ELSE
 24161               INITIALIZE  DAT-REC3
 24162               MOVE  WK-REC2             TO  DAT-REC3
 24163               PERFORM  DATA-WRITE-3-RTN
 24164             END-IF
 24165           ELSE
 24166             IF  I-FLG-KEISAN OF WK-DENBUN-INFO  = CNS-0
 24167             THEN
 24168               INITIALIZE  DAT-REC5
 24169               MOVE  WK-REC2             TO  DAT-REC5
 24170               PERFORM  DATA-WRITE-5-RTN
 24171             ELSE
 24172               INITIALIZE  DAT-REC7
 24173               MOVE  WK-REC2             TO  DAT-REC7
 24174               PERFORM  DATA-WRITE-7-RTN
 24175             END-IF
 24176           END-IF
 24177         WHEN  CNS-X-2
 24178           IF  WK-CASH-FLOW-KBN  =  CNS-X-2
 24179           THEN
 24180             IF  I-FLG-KEISAN OF WK-DENBUN-INFO = CNS-0
 24181             THEN
 24182               INITIALIZE  DAT-REC2
 24183               MOVE  WK-REC2             TO  DAT-REC2
 24184               PERFORM  DATA-WRITE-2-RTN
 24185             ELSE
 24186               INITIALIZE  DAT-REC4
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 418
* MUSR2651.cob                                                     cpy)cpy)y)y)
 24187               MOVE  WK-REC2             TO  DAT-REC4
 24188               PERFORM  DATA-WRITE-4-RTN
 24189             END-IF
 24190           ELSE
 24191             IF  I-FLG-KEISAN OF WK-DENBUN-INFO = CNS-0
 24192             THEN
 24193               INITIALIZE  DAT-REC6
 24194               MOVE  WK-REC2             TO  DAT-REC6
 24195               PERFORM  DATA-WRITE-6-RTN
 24196             ELSE
 24197               INITIALIZE  DAT-REC8
 24198               MOVE  WK-REC2             TO  DAT-REC8
 24199               PERFORM  DATA-WRITE-8-RTN
 24200             END-IF
 24201           END-IF
 24202         WHEN  OTHER
 24203           CONTINUE
 24204       END-EVALUATE
 24205     ELSE
 24206       CONTINUE
 24207*--------------------<DEBUG>--------------------------------------
 24208D    DISPLAY  CNS-PGM-ID":DATA出力しない"
 24209*-----------------------------------------------------------------
 24210     END-IF
 24211*
 24212     INITIALIZE        WK-SUM-DATA
 24213                       WK-REC2
 24214*-------------------<DEBUG>---------------------------------------
 24215D    DISPLAY  CNS-PGM-ID":***  ブレイク処理3  END  ***"
 24216*-----------------------------------------------------------------
 24217     CONTINUE.
 24218 BREAK3-EXT.
 24219     EXIT.
 24220******************************************************************
 24221*    GXファイルをオープンする
 24222******************************************************************
 24223 GX-FILE-OPEN-RTN       SECTION.
 24224     MOVE FUNCTION CURRENT-DATE(1:14) TO WK-RUN-SDATETIME
 24225*-------------------<DEBUG>---------------------------------------
 24226     DISPLAY "プログラムID:        ["CNS-PGM-ID"]"                GUT2013
 24227     DISPLAY "セクション:          [GX-FILE-OPEN-RTN]"            GUT2013
 24228     DISPLAY "セクションの開始時間:["WK-RUN-SDATETIME"]"          GUT2013
 24229*-----------------------------------------------------------------
 24230*--------------------<DEBUG>--------------------------------------
 24231D    DISPLAY  CNS-PGM-ID":GXファイルをオープンする START ***"
 24232D    DISPLAY  CNS-PGM-ID":I-FLG-KEISAN=["
 24233D             I-FLG-KEISAN OF WK-DENBUN-INFO"]"
 24234*-----------------------------------------------------------------
 24235     IF  I-FLG-KEISAN OF WK-DENBUN-INFO  = CNS-0
 24236     THEN
 24237*----------  3.1.9.ファイル名作成処理
 24238       PERFORM  GET-FILE-NAME-RTN
 24239*----------  3.1.10.ファイルオープン
 24240       PERFORM  OPEN-FILE-RTN
 24241*----------  3.1.11.受渡ファイル名作成処理
 24242       PERFORM  GET-FILE-2-NAME-RTN
 24243*----------  3.1.12.受渡ファイルオープン
 24244       PERFORM  OPEN-FILE-2-RTN
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 419
* MUSR2651.cob                                                     cpy)cpy)y)y)
 24245*----------  約定ファイル05名作成処理
 24246       PERFORM  GET-FILE-5-NAME-RTN
 24247*----------  約定ファイル05オープン
 24248       PERFORM  OPEN-FILE-5-RTN
 24249*----------  受渡ファイル06名作成処理
 24250       PERFORM  GET-FILE-6-NAME-RTN
 24251*----------  受渡ファイル06オープン
 24252       PERFORM  OPEN-FILE-6-RTN
 24253*----------  3.2.3.１行目にヘッダーの出力処理
 24254       PERFORM  HEADER-OUT-RTN
 24255     ELSE
 24256*----------  3.1.13.ファイル名作成処理
 24257       PERFORM  GET-FILE-3-NAME-RTN
 24258*----------  3.1.14.ファイルオープン
 24259       PERFORM  OPEN-FILE-3-RTN
 24260*----------  3.1.15.ファイル名作成処理
 24261       PERFORM  GET-FILE-4-NAME-RTN
 24262*----------  3.1.16.ファイルオープン
 24263       PERFORM  OPEN-FILE-4-RTN
 24264*----------  約定ファイル07名作成処理
 24265       PERFORM  GET-FILE-7-NAME-RTN
 24266*----------  約定ファイル07オープン
 24267       PERFORM  OPEN-FILE-7-RTN
 24268*----------  受渡ファイル08名作成処理
 24269       PERFORM  GET-FILE-8-NAME-RTN
 24270*----------  受渡ファイル08オープン
 24271       PERFORM  OPEN-FILE-8-RTN
 24272*----------  3.2.3.１行目にヘッダーの出力処理
 24273       PERFORM  HEADER-OUT-RTN
 24274     END-IF
 24275*--------------------<DEBUG>--------------------------------------
 24276D    DISPLAY  CNS-PGM-ID":GXファイルをオープンする END  ***"
 24277*-----------------------------------------------------------------
 24278     MOVE FUNCTION CURRENT-DATE(1:14) TO WK-RUN-EDATETIME
 24279*--------------------<DEBUG>--------------------------------------
 24280     DISPLAY "プログラムID:        ["CNS-PGM-ID"]"                GUT2013
 24281     DISPLAY "セクション:          [GX-FILE-OPEN-RTN]"            GUT2013
 24282     DISPLAY "セクションの終了時間:["WK-RUN-EDATETIME"]"          GUT2013
 24283*-----------------------------------------------------------------
 24284     CONTINUE.
 24285 GX-FILE-OPEN-EXT.
 24286     EXIT.
 24287******************************************************************
 24288*    未収金、未払金の処理
 24289******************************************************************
 24290 UYTK-SJTK-RTN          SECTION.
 24291*--------------------<DEBUG>--------------------------------------
 24292D    DISPLAY  CNS-PGM-ID":*** 未収金、未払金の処理 START ***"
 24293D    DISPLAY  CNS-PGM-ID":WK-SWK-KJN-PTN-CD=["WK-SWK-KJN-PTN-CD"]"
 24294D    DISPLAY  CNS-PGM-ID":WK-YKJ-SYUGI-KAIKEI=["
 24295D             WK-YKJ-SYUGI-KAIKEI"]"
 24296D    DISPLAY  CNS-PGM-ID":H-SEC-SBT-CD=["
 24297D             H-SEC-SBT-CD"]"
 24298D    DISPLAY  CNS-PGM-ID":H-KB-KANRI-ID=["H-KB-KANRI-ID"]"
 24299D    DISPLAY  CNS-PGM-ID":WK-SYOHIN-KBN=["WK-SYOHIN-KBN"]"
 24300*-----------------------------------------------------------------
 24301     IF  WK-SWK-KJN-PTN-CD(CNS-1:CNS-1) = CNS-TEXT-T
 24302       AND  WK-YKJ-SYUGI-KAIKEI NOT = CNS-X-1
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 420
* MUSR2651.cob                                                     cpy)cpy)y)y)
 24303       AND  ( H-SEC-SBT-CD = CNS-SKSBT-CASH
 24304           OR  WK-SYOHIN-KBN = CNS-SYOHIN-KBN-17 )
 24305     THEN
 24306       PERFORM  GENKIN-GOUKEI-RTN
 24307     ELSE
 24308       CONTINUE
 24309     END-IF
 24310     IF  WK-SWK-KJN-PTN-CD(CNS-1:CNS-1) = CNS-TEXT-T
 24311       AND  WK-YKJ-SYUGI-KAIKEI = CNS-X-1
 24312       AND  ( H-SEC-SBT-CD = CNS-SKSBT-CASH
 24313           AND  ( H-KB-KANRI-ID = CNS-MEG-RECVLC
 24314             OR  H-KB-KANRI-ID = CNS-MEG-RECVBC
 24315             OR  H-KB-KANRI-ID = CNS-MEG-PAYLC
 24316             OR  H-KB-KANRI-ID = CNS-MEG-PAYBC
 24317             OR  H-KB-KANRI-ID = CNS-MEG-ACRECVLC
 24318             OR  H-KB-KANRI-ID = CNS-MEG-ACPAYLC ))
 24319       OR  ( WK-SYOHIN-KBN = CNS-SYOHIN-KBN-17
 24320         AND  ( H-KB-KANRI-ID = CNS-MEG-MARECVLC
 24321           OR  H-KB-KANRI-ID = CNS-MEG-MARECVBC
 24322           OR  H-KB-KANRI-ID = CNS-MEG-MAPAYLC
 24323           OR  H-KB-KANRI-ID = CNS-MEG-MAPAYBC ))
 24324     THEN
 24325       PERFORM  GENKIN-GOUKEI-2-RTN
 24326     ELSE
 24327       CONTINUE
 24328     END-IF
 24329*--------------------<DEBUG>--------------------------------------
 24330D    DISPLAY  CNS-PGM-ID":*** 未収金、未払金の処理  END  ***"
 24331*-----------------------------------------------------------------
 24332     CONTINUE.
 24333 UYTK-SJTK-EXT.
 24334     EXIT.
 24335******************************************************************
 24336*    合計レコードを編集2
 24337******************************************************************
 24338 GENKIN-GOUKEI-2-RTN    SECTION.
 24339*--------------------<DEBUG>--------------------------------------
 24340D    DISPLAY  CNS-PGM-ID":合計レコードを編集2  START "
 24341D    DISPLAY  CNS-PGM-ID":H-KB-KANRI-ID=["H-KB-KANRI-ID"]"
 24342*-----------------------------------------------------------------
 24343     INITIALIZE  WK-IDX-I
 24344     EVALUATE  H-KB-KANRI-ID
 24345       WHEN  CNS-MEG-RECVLC
 24346         MOVE  CNS-1    TO  WK-IDX-I
 24347       WHEN  CNS-MEG-RECVBC
 24348         MOVE  CNS-2    TO  WK-IDX-I
 24349       WHEN  CNS-MEG-ACRECVLC
 24350         MOVE  CNS-3    TO  WK-IDX-I
 24351       WHEN  CNS-MEG-PAYLC
 24352         MOVE  CNS-4    TO  WK-IDX-I
 24353       WHEN  CNS-MEG-PAYBC
 24354         MOVE  CNS-5    TO  WK-IDX-I
 24355       WHEN  CNS-MEG-ACPAYLC
 24356         MOVE  CNS-6    TO  WK-IDX-I
 24357       WHEN  CNS-MEG-MARECVLC
 24358         MOVE  CNS-7    TO  WK-IDX-I
 24359       WHEN  CNS-MEG-MARECVBC
 24360         MOVE  CNS-8    TO  WK-IDX-I
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 421
* MUSR2651.cob                                                     cpy)cpy)y)y)
 24361       WHEN  CNS-MEG-MAPAYLC
 24362         MOVE  CNS-9    TO  WK-IDX-I
 24363       WHEN  CNS-MEG-MAPAYBC
 24364         MOVE  CNS-10   TO  WK-IDX-I
 24365       WHEN  OTHER
 24366         CONTINUE
 24367     END-EVALUATE
 24368*--------------------<DEBUG>--------------------------------------
 24369D    DISPLAY  CNS-PGM-ID":WK-IDX-I=["WK-IDX-I"]"
 24370*-----------------------------------------------------------------
 24371*----------  保有数量
 24372     IF ( H-KB-KANRI-ID = CNS-MEG-RECVLC
 24373        OR H-KB-KANRI-ID = CNS-MEG-RECVBC
 24374        OR H-KB-KANRI-ID = CNS-MEG-ACRECVLC
 24375        OR H-KB-KANRI-ID = CNS-MEG-MARECVLC
 24376        OR H-KB-KANRI-ID = CNS-MEG-MARECVBC)
 24377     THEN
 24378       COMPUTE  WK-HOU-SURYO-SUM-2(WK-IDX-I)
 24379             =  WK-HOU-SURYO-SUM-2(WK-IDX-I)
 24380             +  H-HOU-SURYO
 24381     ELSE
 24382       CONTINUE
 24383     END-IF
 24384     IF ( H-KB-KANRI-ID = CNS-MEG-PAYLC
 24385        OR H-KB-KANRI-ID = CNS-MEG-PAYBC
 24386        OR H-KB-KANRI-ID = CNS-MEG-ACPAYLC
 24387        OR H-KB-KANRI-ID = CNS-MEG-MAPAYLC
 24388        OR H-KB-KANRI-ID = CNS-MEG-MAPAYBC)
 24389     THEN
 24390       COMPUTE  WK-HOU-SURYO-SUM-2(WK-IDX-I)
 24391             =  WK-HOU-SURYO-SUM-2(WK-IDX-I)
 24392             -  H-HOU-SURYO
 24393     ELSE
 24394       CONTINUE
 24395     END-IF
 24396*----------  取得金額(取引通貨)
 24397     COMPUTE  WK-THTK-ST-KNG-SUM-2(WK-IDX-I)
 24398           =  WK-THTK-ST-KNG-SUM-2(WK-IDX-I)
 24399           +  H-THTK-ST-KNG
 24400*----------  評価金額(取引通貨)
 24401     COMPUTE  WK-THTK-HYK-KN-SUM-2(WK-IDX-I)
 24402           =  WK-THTK-HYK-KN-SUM-2(WK-IDX-I)
 24403           +  H-THTK-HYK-KN
 24404*----------  評価損益(取引通貨)
 24405     COMPUTE  WK-THTK-HYK-SNEKI-SUM-2(WK-IDX-I)
 24406           =  WK-THTK-HYK-SNEKI-SUM-2(WK-IDX-I)
 24407           +  H-THTK-HYK-SNEKI
 24408*----------  取得金額(運用通貨為替換算額)
 24409     COMPUTE  WK-UYTK-KWS-BOKAZN-SUM-2(WK-IDX-I)
 24410           =  WK-UYTK-KWS-BOKAZN-SUM-2(WK-IDX-I)
 24411           +  H-SHTK-KN-LC
 24412*----------  取得金額(運用通貨)
 24413     COMPUTE  WK-SHTK-KN-LC-SUM-2(WK-IDX-I)
 24414           =  WK-SHTK-KN-LC-SUM-2(WK-IDX-I)
 24415           +  H-SHTK-KN-LC
 24416*----------  評価金額(運用通貨)
 24417     COMPUTE  WK-HYK-KN-LC-SUM-2(WK-IDX-I)
 24418           =  WK-HYK-KN-LC-SUM-2(WK-IDX-I)
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 422
* MUSR2651.cob                                                     cpy)cpy)y)y)
 24419           +  H-HYK-KN-LC
 24420*----------  評価損益(運用通貨)
 24421     COMPUTE  WK-HYK-SNEKI-LC-SUM-2(WK-IDX-I)
 24422           =  WK-HYK-SNEKI-LC-SUM-2(WK-IDX-I)
 24423           +  H-HYK-SNEKI-LC
 24424*--------------------<DEBUG>--------------------------------------
 24425D    DISPLAY  CNS-PGM-ID":保有数量("WK-IDX-I")=["
 24426D             WK-HOU-SURYO-SUM-2(WK-IDX-I)"]"
 24427D    DISPLAY  CNS-PGM-ID":取得金額(取引通貨)("WK-IDX-I")=["
 24428D             WK-THTK-ST-KNG-SUM-2(WK-IDX-I)"]"
 24429D    DISPLAY  CNS-PGM-ID":評価金額(取引通貨)("WK-IDX-I")=["
 24430D             WK-THTK-HYK-KN-SUM-2(WK-IDX-I)"]"
 24431D    DISPLAY  CNS-PGM-ID":評価損益(取引通貨)("WK-IDX-I")=["
 24432D             WK-THTK-HYK-SNEKI-SUM-2(WK-IDX-I)"]"
 24433D    DISPLAY  CNS-PGM-ID":取得金額(運用通貨為替換算額)("WK-IDX-I
 24434D             ")=["WK-UYTK-KWS-BOKAZN-SUM-2(WK-IDX-I)"]"
 24435D    DISPLAY  CNS-PGM-ID":取得金額(運用通貨)("WK-IDX-I")=["
 24436D             WK-SHTK-KN-LC-SUM-2(WK-IDX-I)"]"
 24437D    DISPLAY  CNS-PGM-ID":評価金額(運用通貨)("WK-IDX-I")=["
 24438D             WK-HYK-KN-LC-SUM-2(WK-IDX-I)"]"
 24439D    DISPLAY  CNS-PGM-ID":評価損益(運用通貨)("WK-IDX-I")=["
 24440D             WK-HYK-SNEKI-LC-SUM-2(WK-IDX-I)"]"
 24441*-----------------------------------------------------------------
 24442     IF  WK-HOU-SURYO-SUM-2(WK-IDX-I)  NOT =  ZERO
 24443       OR  WK-THTK-ST-KNG-SUM-2(WK-IDX-I)  NOT =  ZERO
 24444       OR  WK-THTK-HYK-KN-SUM-2(WK-IDX-I)  NOT =  ZERO
 24445       OR  WK-THTK-HYK-SNEKI-SUM-2(WK-IDX-I)  NOT =  ZERO
 24446       OR  WK-UYTK-KWS-BOKAZN-SUM-2(WK-IDX-I)  NOT =  ZERO
 24447       OR  WK-SHTK-KN-LC-SUM-2(WK-IDX-I)  NOT =  ZERO
 24448       OR  WK-HYK-KN-LC-SUM-2(WK-IDX-I)  NOT =  ZERO
 24449       OR  WK-HYK-SNEKI-LC-SUM-2(WK-IDX-I)  NOT =  ZERO
 24450     THEN
 24451*--------------------<DEBUG>--------------------------------------
 24452D    DISPLAY  CNS-PGM-ID":WK-GENKIN-OUT-2("WK-IDX-I")=["
 24453D             WK-GENKIN-OUT-2(WK-IDX-I)"]"
 24454D    DISPLAY  CNS-PGM-ID":H-SEC-SBT-CD=["H-SEC-SBT-CD"]"
 24455D    DISPLAY  CNS-PGM-ID":WK-TRHK-TUKA=["WK-TRHK-TUKA"]"
 24456D    DISPLAY  CNS-PGM-ID":WK-CAPITAL-TUKA-CD=["
 24457D             WK-CAPITAL-TUKA-CD"]"
 24458*-----------------------------------------------------------------
 24459       IF  WK-GENKIN-OUT-2(WK-IDX-I)  =  SPACE
 24460       THEN
 24461         MOVE  WK-REC          TO  WK-REC-REC(WK-IDX-I)
 24462         IF  H-SEC-SBT-CD = CNS-SKSBT-CASH
 24463         THEN
 24464           IF  WK-TRHK-TUKA  =  WK-CAPITAL-TUKA-CD
 24465           THEN
 24466             MOVE  CNS-SKSBT-CASH
 24467               TO  SEC-SBT-CD  OF  WK-REC-REC(WK-IDX-I)
 24468           ELSE
 24469             MOVE  CNS-SKSBT-EX
 24470               TO  SEC-SBT-CD  OF  WK-REC-REC(WK-IDX-I)
 24471           END-IF
 24472         ELSE
 24473           CONTINUE
 24474         END-IF
 24475         MOVE  H-KB-KANRI-ID
 24476           TO  WK-MEG-CD-2(WK-IDX-I)
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 423
* MUSR2651.cob                                                     cpy)cpy)y)y)
 24477         IF  WK-KUNI-FLG = CNS-OFF
 24478          OR WK-TRHK-TUKA-0604 NOT = WK-TRHK-TUKA
 24479         THEN
 24480           PERFORM  SUSC0604-RTN
 24481         ELSE
 24482           IF  WK-RTN-0604 = CNS-RTN-110
 24483           THEN
 24484             IF  WK-1190-STATUS < CNS-4
 24485             THEN
 24486               MOVE  CNS-4          TO  WK-1190-STATUS
 24487             ELSE
 24488               CONTINUE
 24489             END-IF
 24490             IF  WK-STATUS < CNS-4
 24491             THEN
 24492               MOVE  CNS-4          TO  WK-STATUS
 24493             ELSE
 24494               CONTINUE
 24495             END-IF
 24496             IF  WK-RTN-CODE < CNS-4
 24497             THEN
 24498               MOVE  CNS-4          TO  WK-RTN-CODE
 24499             ELSE
 24500               CONTINUE
 24501             END-IF
 24502           ELSE
 24503             CONTINUE
 24504           END-IF
 24505         END-IF
 24506         MOVE  WK-KUNI-CD-RYAKU
 24507           TO  WK-HAKO-CD-CD-2(WK-IDX-I)
 24508         IF    H-KB-KANRI-ID  =  CNS-MEG-RECVLC
 24509           OR  H-KB-KANRI-ID  =  CNS-MEG-ACRECVLC
 24510           OR  H-KB-KANRI-ID  =  CNS-MEG-MARECVLC
 24511         THEN
 24512           MOVE  CNS-MISYU-GAIKA-J
 24513             TO  WK-MEG-MEI-JP-2(WK-IDX-I)
 24514           MOVE  CNS-MISYU-GAIKA-E
 24515             TO  WK-MEG-MEI-EN-2(WK-IDX-I)
 24516         ELSE
 24517           CONTINUE
 24518         END-IF
 24519         IF    H-KB-KANRI-ID  =  CNS-MEG-RECVBC
 24520           OR  H-KB-KANRI-ID  =  CNS-MEG-MARECVBC
 24521         THEN
 24522           MOVE  CNS-MISYU-UNYO-J
 24523             TO  WK-MEG-MEI-JP-2(WK-IDX-I)
 24524           MOVE  CNS-MISYU-UNYO-E
 24525             TO  WK-MEG-MEI-EN-2(WK-IDX-I)
 24526         ELSE
 24527           CONTINUE
 24528         END-IF
 24529         IF    H-KB-KANRI-ID  =  CNS-MEG-PAYLC
 24530           OR  H-KB-KANRI-ID  =  CNS-MEG-ACPAYLC
 24531           OR  H-KB-KANRI-ID  =  CNS-MEG-MAPAYLC
 24532         THEN
 24533           MOVE  CNS-MIBARAI-GAIKA-J
 24534             TO  WK-MEG-MEI-JP-2(WK-IDX-I)
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 424
* MUSR2651.cob                                                     cpy)cpy)y)y)
 24535           MOVE  CNS-MIBARAI-GAIKA-E
 24536             TO  WK-MEG-MEI-EN-2(WK-IDX-I)
 24537         ELSE
 24538           CONTINUE
 24539         END-IF
 24540         IF    H-KB-KANRI-ID  =  CNS-MEG-PAYBC
 24541           OR  H-KB-KANRI-ID  =  CNS-MEG-MAPAYBC
 24542         THEN
 24543           MOVE  CNS-MIBARAI-UNYO-J
 24544             TO  WK-MEG-MEI-JP-2(WK-IDX-I)
 24545           MOVE  CNS-MIBARAI-UNYO-E
 24546             TO  WK-MEG-MEI-EN-2(WK-IDX-I)
 24547         ELSE
 24548           CONTINUE
 24549         END-IF
 24550         MOVE  CNS-X-1
 24551           TO  WK-GENKIN-OUT-2(WK-IDX-I)
 24552*--------------------<DEBUG>--------------------------------------
 24553D    DISPLAY  CNS-PGM-ID":WK-MEG-CD-2("WK-IDX-I")=["
 24554D             WK-MEG-CD-2(WK-IDX-I)"]"
 24555D    DISPLAY  CNS-PGM-ID":WK-HAKO-CD-CD-2("WK-IDX-I")=["
 24556D             WK-HAKO-CD-CD-2(WK-IDX-I)"]"
 24557D    DISPLAY  CNS-PGM-ID":WK-MEG-MEI-JP-2("WK-IDX-I")=["
 24558D             WK-MEG-MEI-JP-2(WK-IDX-I)"]"
 24559D    DISPLAY  CNS-PGM-ID":WK-MEG-MEI-EN-2("WK-IDX-I")=["
 24560D             WK-MEG-MEI-EN-2(WK-IDX-I)"]"
 24561D    DISPLAY  CNS-PGM-ID":WK-GENKIN-OUT-2("WK-IDX-I")=["
 24562D             WK-GENKIN-OUT-2(WK-IDX-I)"]"
 24563*-----------------------------------------------------------------
 24564       ELSE
 24565         CONTINUE
 24566       END-IF
 24567*--------------------<DEBUG>--------------------------------------
 24568D    DISPLAY  CNS-PGM-ID":SEC-SBT-CD=["
 24569D             SEC-SBT-CD  OF  WK-REC-REC(WK-IDX-I)"]"
 24570*-----------------------------------------------------------------
 24571     ELSE
 24572       CONTINUE
 24573     END-IF
 24574     MOVE  CNS-ON            TO  FLG-DATA-OUT
 24575*--------------------<DEBUG>--------------------------------------
 24576D    DISPLAY  CNS-PGM-ID":FLG-DATA-OUT=["FLG-DATA-OUT"]"
 24577D    DISPLAY  CNS-PGM-ID":合計レコードを編集2  END "
 24578*-----------------------------------------------------------------
 24579     CONTINUE.
 24580 GENKIN-GOUKEI-2-EXT.
 24581     EXIT.
 24582******************************************************************
 24583*    未払費用の処理
 24584******************************************************************
 24585 SJTK-MBHY-RTN          SECTION.
 24586*--------------------<DEBUG>--------------------------------------
 24587D    DISPLAY  CNS-PGM-ID":*** 未払費用の処理 START ***"
 24588D    DISPLAY  CNS-PGM-ID":WK-SWK-KJN-PTN-CD=["WK-SWK-KJN-PTN-CD"]"
 24589D    DISPLAY  CNS-PGM-ID":WK-YKJ-SYUGI-KAIKEI=["
 24590D             WK-YKJ-SYUGI-KAIKEI"]"
 24591D    DISPLAY  CNS-PGM-ID":WK-SEC-SBT-CD=["WK-SEC-SBT-CD"]"
 24592D    DISPLAY  CNS-PGM-ID":H-MEG-CD=["H-MEG-CD"]"
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 425
* MUSR2651.cob                                                     cpy)cpy)y)y)
 24593D    DISPLAY  CNS-PGM-ID":WK-CAPITAL-TUKA-CD=["
 24594D             WK-CAPITAL-TUKA-CD"]"
 24595*-----------------------------------------------------------------
 24596     IF  WK-SWK-KJN-PTN-CD(CNS-1:CNS-1) = CNS-TEXT-T
 24597       AND  WK-YKJ-SYUGI-KAIKEI = CNS-X-1
 24598       AND  H-SEC-SBT-CD = CNS-SKSBT-FDAL
 24599       AND  ((H-MEG-CD(CNS-1:CNS-4)  =  CNS-ACSU
 24600         OR  H-MEG-CD(CNS-1:CNS-4)  =  CNS-CFEU
 24601         OR  H-MEG-CD(CNS-1:CNS-4)  =  CNS-CSOU
 24602         OR  H-MEG-CD(CNS-1:CNS-4)  =  CNS-CSTU
 24603         OR  H-MEG-CD(CNS-1:CNS-4)  =  CNS-STXU
 24604         OR  H-MEG-CD(CNS-1:CNS-4)  =  CNS-TSTU)
 24605         AND  H-MEG-CD(CNS-5:CNS-11)  =  WK-TRHK-TUKA)
 24606     THEN
 24607       IF  H-MEG-CD(CNS-1:CNS-4)  NOT =  CNS-CSTU
 24608         AND  H-MEG-CD(CNS-1:CNS-4)  NOT =  CNS-CFEU
 24609       THEN
 24610         MOVE  CNS-1         TO  WK-IDX-P
 24611       ELSE
 24612*--------------------<DEBUG>--------------------------------------
 24613D    DISPLAY  CNS-PGM-ID":取引通貨=["
 24614D             WK-TRHK-TUKA    "]"
 24615*-----------------------------------------------------------------
 24616         IF  WK-TRHK-TUKA
 24617           =  WK-CAPITAL-TUKA-CD
 24618         THEN
 24619           MOVE  CNS-2       TO  WK-IDX-P
 24620         ELSE
 24621           MOVE  CNS-3       TO  WK-IDX-P
 24622         END-IF
 24623       END-IF
 24624*--------------------<DEBUG>--------------------------------------
 24625D    DISPLAY  CNS-PGM-ID":WK-IDX-P=["WK-IDX-P"]"
 24626*-----------------------------------------------------------------
 24627       PERFORM  GENKIN-GOUKEI-3-RTN
 24628     ELSE
 24629       CONTINUE
 24630     END-IF
 24631     IF  WK-SWK-KJN-PTN-CD(CNS-1:CNS-1) = CNS-TEXT-T
 24632      AND H-SEC-SBT-CD NOT = CNS-SKSBT-FDAL
 24633     THEN
 24634*--------------------<DEBUG>--------------------------------------
 24635D    DISPLAY  CNS-PGM-ID":取引通貨=["
 24636D             WK-TRHK-TUKA    "]"
 24637*-----------------------------------------------------------------
 24638       IF  WK-TRHK-TUKA  =  WK-CAPITAL-TUKA-CD
 24639       THEN
 24640         MOVE  CNS-1         TO  WK-IDX-Q
 24641       ELSE
 24642         MOVE  CNS-2         TO  WK-IDX-Q
 24643       END-IF
 24644*--------------------<DEBUG>--------------------------------------
 24645D    DISPLAY  CNS-PGM-ID":WK-IDX-Q=["WK-IDX-Q"]"
 24646*-----------------------------------------------------------------
 24647       PERFORM  GENKIN-GOUKEI-4-RTN
 24648     ELSE
 24649       CONTINUE
 24650     END-IF
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 426
* MUSR2651.cob                                                     cpy)cpy)y)y)
 24651*--------------------<DEBUG>--------------------------------------
 24652D    DISPLAY  CNS-PGM-ID":*** 未払費用の処理  END  ***"
 24653*-----------------------------------------------------------------
 24654     CONTINUE.
 24655 SJTK-MBHY-EXT.
 24656     EXIT.
 24657******************************************************************
 24658*    合計レコードを編集3
 24659******************************************************************
 24660 GENKIN-GOUKEI-3-RTN    SECTION.
 24661*--------------------<DEBUG>--------------------------------------
 24662D    DISPLAY  CNS-PGM-ID":合計レコードを編集3  START "
 24663*-----------------------------------------------------------------
 24664*----------  保有数量
 24665     COMPUTE  WK-HOU-SURYO-SUM-3(WK-IDX-P)
 24666           =  WK-HOU-SURYO-SUM-3(WK-IDX-P)
 24667           -  H-SJTK-MBHY-ZN
 24668*----------  取得金額(取引通貨)
 24669     COMPUTE  WK-THTK-ST-KNG-SUM-3(WK-IDX-P)
 24670           =  WK-THTK-ST-KNG-SUM-3(WK-IDX-P)
 24671           -  H-SJTK-MBHY-ZN
 24672*----------  評価金額(取引通貨)
 24673     COMPUTE  WK-THTK-HYK-KN-SUM-3(WK-IDX-P)
 24674           =  WK-THTK-HYK-KN-SUM-3(WK-IDX-P)
 24675           -  H-SJTK-MBHY-ZN
 24676*----------  評価損益(取引通貨)
 24677     MOVE  ZERO              TO  WK-THTK-HYK-SNEKI-SUM-3(WK-IDX-P)
 24678*----------  取得金額(運用通貨為替換算額)
 24679     COMPUTE  WK-UYTK-KWS-BOKAZN-SUM-3(WK-IDX-P)
 24680           =  WK-UYTK-KWS-BOKAZN-SUM-3(WK-IDX-P)
 24681           -  H-UYTK-MBHY-ZN
 24682*----------  取得金額(運用通貨)
 24683     COMPUTE  WK-SHTK-KN-LC-SUM-3(WK-IDX-P)
 24684           =  WK-SHTK-KN-LC-SUM-3(WK-IDX-P)
 24685           -  H-UYTK-MBHY-ZN
 24686*----------  評価金額(運用通貨)
 24687     COMPUTE  WK-HYK-KN-LC-SUM-3(WK-IDX-P)
 24688           =  WK-HYK-KN-LC-SUM-3(WK-IDX-P)
 24689           -  H-SUJI-12
 24690*----------  評価損益(運用通貨)
 24691     COMPUTE  WK-HYK-SNEKI-LC-SUM-3(WK-IDX-P)
 24692           =  WK-HYK-SNEKI-LC-SUM-3(WK-IDX-P)
 24693           +  H-UYTK-MBHY-ZN
 24694           -  H-SUJI-12
 24695*--------------------<DEBUG>--------------------------------------
 24696D    DISPLAY  CNS-PGM-ID":保有数量=["
 24697D             WK-HOU-SURYO-SUM-3(WK-IDX-P)"]"
 24698D    DISPLAY  CNS-PGM-ID":取得金額(取引通貨)=["
 24699D             WK-THTK-ST-KNG-SUM-3(WK-IDX-P)"]"
 24700D    DISPLAY  CNS-PGM-ID":評価金額(取引通貨)=["
 24701D             WK-THTK-HYK-KN-SUM-3(WK-IDX-P)"]"
 24702D    DISPLAY  CNS-PGM-ID":評価損益(取引通貨)=["
 24703D             WK-THTK-HYK-SNEKI-SUM-3(WK-IDX-P)"]"
 24704D    DISPLAY  CNS-PGM-ID":取得金額(運用通貨為替換算額)=["
 24705D             WK-UYTK-KWS-BOKAZN-SUM-3(WK-IDX-P)"]"
 24706D    DISPLAY  CNS-PGM-ID":取得金額(運用通貨)=["
 24707D             WK-SHTK-KN-LC-SUM-3(WK-IDX-P)"]"
 24708D    DISPLAY  CNS-PGM-ID":評価金額(運用通貨)=["
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 427
* MUSR2651.cob                                                     cpy)cpy)y)y)
 24709D             WK-HYK-KN-LC-SUM-3(WK-IDX-P)"]"
 24710D    DISPLAY  CNS-PGM-ID":評価損益(運用通貨)=["
 24711D             WK-HYK-SNEKI-LC-SUM-3(WK-IDX-P)"]"
 24712*-----------------------------------------------------------------
 24713     IF  WK-HOU-SURYO-SUM-3(WK-IDX-P)  NOT =  ZERO
 24714       OR  WK-THTK-ST-KNG-SUM-3(WK-IDX-P)  NOT =  ZERO
 24715       OR  WK-THTK-HYK-KN-SUM-3(WK-IDX-P)  NOT =  ZERO
 24716       OR  WK-THTK-HYK-SNEKI-SUM-3(WK-IDX-P)  NOT =  ZERO
 24717       OR  WK-UYTK-KWS-BOKAZN-SUM-3(WK-IDX-P)  NOT =  ZERO
 24718       OR  WK-SHTK-KN-LC-SUM-3(WK-IDX-P)  NOT =  ZERO
 24719       OR  WK-HYK-KN-LC-SUM-3(WK-IDX-P)  NOT =  ZERO
 24720       OR  WK-HYK-SNEKI-LC-SUM-3(WK-IDX-P)  NOT =  ZERO
 24721     THEN
 24722*--------------------<DEBUG>--------------------------------------
 24723D    DISPLAY  CNS-PGM-ID":WK-GENKIN-OUT-3("WK-IDX-P")=["
 24724D             WK-GENKIN-OUT-3(WK-IDX-P)"]"
 24725*-----------------------------------------------------------------
 24726*--------------------<DEBUG>--------------------------------------
 24727D    DISPLAY  CNS-PGM-ID":WK-TRHK-TUKA=["WK-TRHK-TUKA"]"
 24728D    DISPLAY  CNS-PGM-ID":WK-CAPITAL-TUKA-CD=["
 24729D             WK-CAPITAL-TUKA-CD"]"
 24730*-----------------------------------------------------------------
 24731       IF  WK-GENKIN-OUT-3(WK-IDX-P)  =  SPACE
 24732       THEN
 24733         MOVE  WK-REC          TO  WK-REC-REC4(WK-IDX-P)
 24734         IF  WK-TRHK-TUKA  =  WK-CAPITAL-TUKA-CD
 24735         THEN
 24736           MOVE  CNS-SKSBT-CASH
 24737             TO  SEC-SBT-CD  OF  WK-REC-REC4(WK-IDX-P)
 24738         ELSE
 24739           MOVE  CNS-SKSBT-EX
 24740             TO  SEC-SBT-CD  OF  WK-REC-REC4(WK-IDX-P)
 24741         END-IF
 24742         EVALUATE  WK-IDX-P
 24743           WHEN  CNS-1
 24744             MOVE  CNS-UNPAIDCOST
 24745               TO  WK-MEG-CD-3(WK-IDX-P)
 24746             MOVE  CNS-MEG-SJTK-J
 24747               TO  WK-MEG-MEI-JP-3(WK-IDX-P)
 24748             MOVE  CNS-SJTK
 24749               TO  WK-MEG-MEI-EN-3(WK-IDX-P)
 24750           WHEN  CNS-2
 24751             MOVE  CNS-MEG-PAYBC3
 24752               TO  WK-MEG-CD-3(WK-IDX-P)
 24753             MOVE  CNS-MIBARAI-UNYO-J
 24754               TO  WK-MEG-MEI-JP-3(WK-IDX-P)
 24755             MOVE  CNS-MIBARAI-UNYO-E
 24756               TO  WK-MEG-MEI-EN-3(WK-IDX-P)
 24757           WHEN  CNS-3
 24758             MOVE  CNS-MEG-PAYLC3
 24759               TO  WK-MEG-CD-3(WK-IDX-P)
 24760             MOVE  CNS-MIBARAI-GAIKA-J
 24761               TO  WK-MEG-MEI-JP-3(WK-IDX-P)
 24762             MOVE  CNS-MIBARAI-GAIKA-E
 24763               TO  WK-MEG-MEI-EN-3(WK-IDX-P)
 24764           WHEN  OTHER
 24765             CONTINUE
 24766         END-EVALUATE
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 428
* MUSR2651.cob                                                     cpy)cpy)y)y)
 24767         IF  WK-KUNI-FLG = CNS-OFF
 24768          OR WK-TRHK-TUKA-0604 NOT = WK-TRHK-TUKA
 24769         THEN
 24770           PERFORM  SUSC0604-RTN
 24771         ELSE
 24772           IF  WK-RTN-0604 = CNS-RTN-110
 24773           THEN
 24774             IF  WK-1190-STATUS < CNS-4
 24775             THEN
 24776               MOVE  CNS-4          TO  WK-1190-STATUS
 24777             ELSE
 24778               CONTINUE
 24779             END-IF
 24780             IF  WK-STATUS < CNS-4
 24781             THEN
 24782               MOVE  CNS-4          TO  WK-STATUS
 24783             ELSE
 24784               CONTINUE
 24785             END-IF
 24786             IF  WK-RTN-CODE < CNS-4
 24787             THEN
 24788               MOVE  CNS-4          TO  WK-RTN-CODE
 24789             ELSE
 24790               CONTINUE
 24791             END-IF
 24792           ELSE
 24793             CONTINUE
 24794           END-IF
 24795         END-IF
 24796         MOVE  WK-KUNI-CD-RYAKU
 24797           TO  WK-HAKO-CD-3(WK-IDX-P)
 24798         MOVE  CNS-X-1
 24799           TO  WK-GENKIN-OUT-3(WK-IDX-P)
 24800*--------------------<DEBUG>--------------------------------------
 24801D    DISPLAY  CNS-PGM-ID":WK-MEG-CD-3("WK-IDX-P")=["
 24802D             WK-MEG-CD-3(WK-IDX-P)"]"
 24803D    DISPLAY  CNS-PGM-ID":WK-HAKO-CD-3("WK-IDX-P")=["
 24804D             WK-HAKO-CD-3(WK-IDX-P)"]"
 24805D    DISPLAY  CNS-PGM-ID":WK-MEG-MEI-JP-3("WK-IDX-P")=["
 24806D             WK-MEG-MEI-JP-3(WK-IDX-P)"]"
 24807D    DISPLAY  CNS-PGM-ID":WK-MEG-MEI-EN-3("WK-IDX-P")=["
 24808D             WK-MEG-MEI-EN-3(WK-IDX-P)"]"
 24809D    DISPLAY  CNS-PGM-ID":WK-GENKIN-OUT-3("WK-IDX-P")=["
 24810D             WK-GENKIN-OUT-3(WK-IDX-P)"]"
 24811*-----------------------------------------------------------------
 24812       ELSE
 24813         CONTINUE
 24814       END-IF
 24815*--------------------<DEBUG>--------------------------------------
 24816D    DISPLAY  CNS-PGM-ID":SEC-SBT-CD=["
 24817D             SEC-SBT-CD  OF  WK-REC-REC4(WK-IDX-P)"]"
 24818*-----------------------------------------------------------------
 24819     ELSE
 24820       CONTINUE
 24821     END-IF
 24822*--------------------<DEBUG>--------------------------------------
 24823D    DISPLAY  CNS-PGM-ID":合計レコードを編集3  END "
 24824*-----------------------------------------------------------------
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 429
* MUSR2651.cob                                                     cpy)cpy)y)y)
 24825     CONTINUE.
 24826 GENKIN-GOUKEI-3-EXT.
 24827     EXIT.
 24828******************************************************************
 24829*    合計レコードを編集4
 24830******************************************************************
 24831 GENKIN-GOUKEI-4-RTN    SECTION.
 24832*--------------------<DEBUG>--------------------------------------
 24833D    DISPLAY  CNS-PGM-ID":合計レコードを編集4  START "
 24834*-----------------------------------------------------------------
 24835*----------  保有数量
 24836     COMPUTE  WK-HOU-SURYO-SUM-4(WK-IDX-Q)
 24837           =  WK-HOU-SURYO-SUM-4(WK-IDX-Q)
 24838           -  H-SJTK-MBHY-ZN
 24839*----------  取得金額(取引通貨)
 24840     COMPUTE  WK-THTK-ST-KNG-SUM-4(WK-IDX-Q)
 24841           =  WK-THTK-ST-KNG-SUM-4(WK-IDX-Q)
 24842           -  H-SJTK-MBHY-ZN
 24843*----------  評価金額(取引通貨)
 24844     COMPUTE  WK-THTK-HYK-KN-SUM-4(WK-IDX-Q)
 24845           =  WK-THTK-HYK-KN-SUM-4(WK-IDX-Q)
 24846           -  H-SJTK-MBHY-ZN
 24847*----------  評価損益(取引通貨)
 24848     MOVE  ZERO              TO  WK-THTK-HYK-SNEKI-SUM-4(WK-IDX-Q)
 24849*----------  取得金額(運用通貨為替換算額)
 24850     COMPUTE  WK-UYTK-KWS-BOKAZN-SUM-4(WK-IDX-Q)
 24851           =  WK-UYTK-KWS-BOKAZN-SUM-4(WK-IDX-Q)
 24852           -  H-UYTK-MBHY-ZN
 24853*----------  取得金額(運用通貨)
 24854     COMPUTE  WK-SHTK-KN-LC-SUM-4(WK-IDX-Q)
 24855           =  WK-SHTK-KN-LC-SUM-4(WK-IDX-Q)
 24856           -  H-UYTK-MBHY-ZN
 24857*----------  評価金額(運用通貨)
 24858     COMPUTE  WK-HYK-KN-LC-SUM-4(WK-IDX-Q)
 24859           =  WK-HYK-KN-LC-SUM-4(WK-IDX-Q)
 24860           -  H-SUJI-12
 24861*----------  評価損益(運用通貨)
 24862     COMPUTE  WK-HYK-SNEKI-LC-SUM-4(WK-IDX-Q)
 24863           =  WK-HYK-SNEKI-LC-SUM-4(WK-IDX-Q)
 24864           +  H-UYTK-MBHY-ZN
 24865           -  H-SUJI-12
 24866*--------------------<DEBUG>--------------------------------------
 24867D    DISPLAY  CNS-PGM-ID":保有数量("WK-IDX-Q")=["
 24868D             WK-HOU-SURYO-SUM-4(WK-IDX-Q)"]"
 24869D    DISPLAY  CNS-PGM-ID":取得金額(取引通貨)("WK-IDX-Q")=["
 24870D             WK-THTK-ST-KNG-SUM-4(WK-IDX-Q)"]"
 24871D    DISPLAY  CNS-PGM-ID":評価金額(取引通貨)("WK-IDX-Q")=["
 24872D             WK-THTK-HYK-KN-SUM-4(WK-IDX-Q)"]"
 24873D    DISPLAY  CNS-PGM-ID":評価損益(取引通貨)("WK-IDX-Q")=["
 24874D             WK-THTK-HYK-SNEKI-SUM-4(WK-IDX-Q)"]"
 24875D    DISPLAY  CNS-PGM-ID":取得金額(運用通貨為替換算額)("WK-IDX-Q
 24876D             ")=["WK-UYTK-KWS-BOKAZN-SUM-4(WK-IDX-Q)"]"
 24877D    DISPLAY  CNS-PGM-ID":取得金額(運用通貨)("WK-IDX-Q")=["
 24878D             WK-SHTK-KN-LC-SUM-4(WK-IDX-Q)"]"
 24879D    DISPLAY  CNS-PGM-ID":評価金額(運用通貨)("WK-IDX-Q")=["
 24880D             WK-HYK-KN-LC-SUM-4(WK-IDX-Q)"]"
 24881D    DISPLAY  CNS-PGM-ID":評価損益(運用通貨)("WK-IDX-Q")=["
 24882D             WK-HYK-SNEKI-LC-SUM-4(WK-IDX-Q)"]"
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 430
* MUSR2651.cob                                                     cpy)cpy)y)y)
 24883*-----------------------------------------------------------------
 24884     IF  WK-HOU-SURYO-SUM-4(WK-IDX-Q)  NOT =  ZERO
 24885       OR  WK-THTK-ST-KNG-SUM-4(WK-IDX-Q)  NOT =  ZERO
 24886       OR  WK-THTK-HYK-KN-SUM-4(WK-IDX-Q)  NOT =  ZERO
 24887       OR  WK-THTK-HYK-SNEKI-SUM-4(WK-IDX-Q)  NOT =  ZERO
 24888       OR  WK-UYTK-KWS-BOKAZN-SUM-4(WK-IDX-Q)  NOT =  ZERO
 24889       OR  WK-SHTK-KN-LC-SUM-4(WK-IDX-Q)  NOT =  ZERO
 24890       OR  WK-HYK-KN-LC-SUM-4(WK-IDX-Q)  NOT =  ZERO
 24891       OR  WK-HYK-SNEKI-LC-SUM-4(WK-IDX-Q)  NOT =  ZERO
 24892     THEN
 24893*--------------------<DEBUG>--------------------------------------
 24894D    DISPLAY  CNS-PGM-ID":WK-GENKIN-OUT-4("WK-IDX-Q")=["
 24895D             WK-GENKIN-OUT-4(WK-IDX-Q)"]"
 24896*-----------------------------------------------------------------
 24897       IF  WK-GENKIN-OUT-4(WK-IDX-Q)  =  SPACE
 24898       THEN
 24899         MOVE  WK-REC          TO  WK-REC-REC5(WK-IDX-Q)
 24900         IF  WK-IDX-Q  =  CNS-1
 24901         THEN
 24902           MOVE  CNS-CASH
 24903             TO  WK-SEC-SBT-CD-4(WK-IDX-Q)
 24904           MOVE  CNS-MEG-PAYBC2
 24905             TO  WK-MEG-CD-4(WK-IDX-Q)
 24906           MOVE  CNS-MIBARAI-UNYO-J
 24907             TO  WK-MEG-MEI-JP-4(WK-IDX-Q)
 24908           MOVE  CNS-MIBARAI-UNYO-E
 24909             TO  WK-MEG-MEI-EN-4(WK-IDX-Q)
 24910         ELSE
 24911           MOVE  CNS-EX
 24912             TO  WK-SEC-SBT-CD-4(WK-IDX-Q)
 24913           MOVE  CNS-MEG-PAYLC2
 24914             TO  WK-MEG-CD-4(WK-IDX-Q)
 24915           MOVE  CNS-MIBARAI-GAIKA-J
 24916             TO  WK-MEG-MEI-JP-4(WK-IDX-Q)
 24917           MOVE  CNS-MIBARAI-GAIKA-E
 24918             TO  WK-MEG-MEI-EN-4(WK-IDX-Q)
 24919         END-IF
 24920         IF  WK-KUNI-FLG = CNS-OFF
 24921          OR WK-TRHK-TUKA-0604 NOT = WK-TRHK-TUKA
 24922         THEN
 24923           PERFORM  SUSC0604-RTN
 24924         ELSE
 24925           IF  WK-RTN-0604 = CNS-RTN-110
 24926           THEN
 24927             IF  WK-1190-STATUS < CNS-4
 24928             THEN
 24929               MOVE  CNS-4          TO  WK-1190-STATUS
 24930             ELSE
 24931               CONTINUE
 24932             END-IF
 24933             IF  WK-STATUS < CNS-4
 24934             THEN
 24935               MOVE  CNS-4          TO  WK-STATUS
 24936             ELSE
 24937               CONTINUE
 24938             END-IF
 24939             IF  WK-RTN-CODE < CNS-4
 24940             THEN
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 431
* MUSR2651.cob                                                     cpy)cpy)y)y)
 24941               MOVE  CNS-4          TO  WK-RTN-CODE
 24942             ELSE
 24943               CONTINUE
 24944             END-IF
 24945           ELSE
 24946             CONTINUE
 24947           END-IF
 24948         END-IF
 24949         MOVE  WK-KUNI-CD-RYAKU
 24950           TO  WK-HAKO-CD-4(WK-IDX-Q)
 24951         MOVE  CNS-X-1
 24952           TO  WK-GENKIN-OUT-4(WK-IDX-Q)
 24953*--------------------<DEBUG>--------------------------------------
 24954D    DISPLAY  CNS-PGM-ID":WK-SEC-SBT-CD-4("WK-IDX-Q")=["
 24955D             WK-SEC-SBT-CD-4(WK-IDX-Q)"]"
 24956D    DISPLAY  CNS-PGM-ID":WK-MEG-CD-4("WK-IDX-Q")=["
 24957D             WK-MEG-CD-4(WK-IDX-Q)"]"
 24958D    DISPLAY  CNS-PGM-ID":WK-HAKO-CD-4("WK-IDX-Q")=["
 24959D             WK-HAKO-CD-4(WK-IDX-Q)"]"
 24960D    DISPLAY  CNS-PGM-ID":WK-MEG-MEI-JP-4("WK-IDX-Q")=["
 24961D             WK-MEG-MEI-JP-4(WK-IDX-Q)"]"
 24962D    DISPLAY  CNS-PGM-ID":WK-MEG-MEI-EN-4("WK-IDX-Q")=["
 24963D             WK-MEG-MEI-EN-4(WK-IDX-Q)"]"
 24964D    DISPLAY  CNS-PGM-ID":WK-GENKIN-OUT-4("WK-IDX-Q")=["
 24965D             WK-GENKIN-OUT-4(WK-IDX-Q)"]"
 24966*-----------------------------------------------------------------
 24967       ELSE
 24968         CONTINUE
 24969       END-IF
 24970     ELSE
 24971       CONTINUE
 24972     END-IF
 24973*--------------------<DEBUG>--------------------------------------
 24974D    DISPLAY  CNS-PGM-ID":合計レコードを編集4  END "
 24975*-----------------------------------------------------------------
 24976     CONTINUE.
 24977 GENKIN-GOUKEI-4-EXT.
 24978     EXIT.
 24979******************************************************************
 24980*    ブレイク処理2
 24981******************************************************************
 24982 BREAK2-RTN             SECTION.
 24983*-------------------<DEBUG>---------------------------------------
 24984D    DISPLAY  CNS-PGM-ID":***  ブレイク処理2  START  ***"
 24985*-----------------------------------------------------------------
 24986     INITIALIZE  WK-IDX-M
 24987     MOVE FUNCTION CURRENT-DATE(1:14) TO WK-RUN-SDATETIME
 24988*-------------------<DEBUG>---------------------------------------
 24989     DISPLAY "プログラムID:        ["CNS-PGM-ID"]"                GUT2013
 24990     DISPLAY "セクション:          [BREAK2-RTN_1]"                GUT2013
 24991     DISPLAY "セクションの開始時間:["WK-RUN-SDATETIME"]"          GUT2013
 24992*-----------------------------------------------------------------
 24993     PERFORM  VARYING  WK-IDX-M  FROM  CNS-1  BY  CNS-1
 24994       UNTIL  WK-IDX-M > CNS-10
 24995*--------------------<DEBUG>--------------------------------------
 24996D    DISPLAY  CNS-PGM-ID":WK-GENKIN-OUT-2("WK-IDX-M")=["
 24997D             WK-GENKIN-OUT-2(WK-IDX-M)"]"
 24998*-----------------------------------------------------------------
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 432
* MUSR2651.cob                                                     cpy)cpy)y)y)
 24999       IF  WK-GENKIN-OUT-2(WK-IDX-M) = CNS-X-1
 25000       THEN
 25001         PERFORM  DATA-3-RTN
 25002*--------------------<DEBUG>--------------------------------------
 25003D    DISPLAY  CNS-PGM-ID":約定受渡区分=["WK-YJ-UW-KBN-OLD"]"
 25004D    DISPLAY  CNS-PGM-ID":WK-CASH-FLOW-KBN=["WK-CASH-FLOW-KBN"]"
 25005D    DISPLAY  CNS-PGM-ID":I-FLG-KEISAN=["
 25006D             I-FLG-KEISAN          OF WK-DENBUN-INFO"]"
 25007*-----------------------------------------------------------------
 25008         EVALUATE  WK-YJ-UW-KBN-OLD
 25009           WHEN  CNS-X-1
 25010             IF  WK-CASH-FLOW-KBN  =  CNS-X-2
 25011             THEN
 25012               IF  I-FLG-KEISAN OF WK-DENBUN-INFO  = CNS-0
 25013               THEN
 25014                 INITIALIZE  DAT-REC
 25015                 MOVE  WK-REC-REC(WK-IDX-M)   TO  DAT-REC
 25016                 PERFORM  DATA-WRITE-RTN
 25017               ELSE
 25018                 INITIALIZE  DAT-REC3
 25019                 MOVE  WK-REC-REC(WK-IDX-M)   TO  DAT-REC3
 25020                 PERFORM  DATA-WRITE-3-RTN
 25021               END-IF
 25022             ELSE
 25023               IF  I-FLG-KEISAN OF WK-DENBUN-INFO  = CNS-0
 25024               THEN
 25025                 INITIALIZE  DAT-REC5
 25026                 MOVE  WK-REC-REC(WK-IDX-M)   TO  DAT-REC5
 25027                 PERFORM  DATA-WRITE-5-RTN
 25028               ELSE
 25029                 INITIALIZE  DAT-REC7
 25030                 MOVE  WK-REC-REC(WK-IDX-M)   TO  DAT-REC7
 25031                 PERFORM  DATA-WRITE-7-RTN
 25032               END-IF
 25033             END-IF
 25034           WHEN  CNS-X-2
 25035             IF  WK-CASH-FLOW-KBN  =  CNS-X-2
 25036             THEN
 25037               IF  I-FLG-KEISAN OF WK-DENBUN-INFO = CNS-0
 25038               THEN
 25039                 INITIALIZE  DAT-REC2
 25040                 MOVE  WK-REC-REC(WK-IDX-M)   TO  DAT-REC2
 25041                 PERFORM  DATA-WRITE-2-RTN
 25042               ELSE
 25043                 INITIALIZE  DAT-REC4
 25044                 MOVE  WK-REC-REC(WK-IDX-M)   TO  DAT-REC4
 25045                 PERFORM  DATA-WRITE-4-RTN
 25046               END-IF
 25047             ELSE
 25048               IF  I-FLG-KEISAN OF WK-DENBUN-INFO = CNS-0
 25049               THEN
 25050                 INITIALIZE  DAT-REC6
 25051                 MOVE  WK-REC-REC(WK-IDX-M)   TO  DAT-REC6
 25052                 PERFORM  DATA-WRITE-6-RTN
 25053               ELSE
 25054                 INITIALIZE  DAT-REC8
 25055                 MOVE  WK-REC-REC(WK-IDX-M)   TO  DAT-REC8
 25056                 PERFORM  DATA-WRITE-8-RTN
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 433
* MUSR2651.cob                                                     cpy)cpy)y)y)
 25057               END-IF
 25058             END-IF
 25059           WHEN  OTHER
 25060             CONTINUE
 25061         END-EVALUATE
 25062       ELSE
 25063         CONTINUE
 25064*--------------------<DEBUG>--------------------------------------
 25065D    DISPLAY  CNS-PGM-ID":DATA出力しない"
 25066*-----------------------------------------------------------------
 25067       END-IF
 25068     END-PERFORM
 25069     MOVE FUNCTION CURRENT-DATE(1:14) TO WK-RUN-EDATETIME
 25070*--------------------<DEBUG>--------------------------------------
 25071     DISPLAY "プログラムID:        ["CNS-PGM-ID"]"                GUT2013
 25072     DISPLAY "セクション:          [BREAK2-RTN_1]"                GUT2013
 25073     DISPLAY "セクションの終了時間:["WK-RUN-EDATETIME"]"          GUT2013
 25074*-----------------------------------------------------------------
 25075     MOVE FUNCTION CURRENT-DATE(1:14) TO WK-RUN-SDATETIME
 25076*-------------------<DEBUG>---------------------------------------
 25077     DISPLAY "プログラムID:        ["CNS-PGM-ID"]"                GUT2013
 25078     DISPLAY "セクション:          [BREAK2-RTN_2]"                GUT2013
 25079     DISPLAY "セクションの開始時間:["WK-RUN-SDATETIME"]"          GUT2013
 25080*-----------------------------------------------------------------
 25081     PERFORM  VARYING  WK-IDX-X  FROM  CNS-1  BY  CNS-1
 25082       UNTIL  WK-IDX-X > CNS-3
 25083*--------------------<DEBUG>--------------------------------------
 25084D    DISPLAY  CNS-PGM-ID":WK-GENKIN-OUT-3("WK-IDX-X")=["
 25085D             WK-GENKIN-OUT-3(WK-IDX-X)"]"
 25086*-----------------------------------------------------------------
 25087       IF  WK-GENKIN-OUT-3(WK-IDX-X) = CNS-X-1
 25088       THEN
 25089         PERFORM  DATA-4-RTN
 25090*--------------------<DEBUG>--------------------------------------
 25091D    DISPLAY  CNS-PGM-ID":約定受渡区分=["WK-YJ-UW-KBN-OLD"]"
 25092D    DISPLAY  CNS-PGM-ID":WK-CASH-FLOW-KBN=["WK-CASH-FLOW-KBN"]"
 25093D    DISPLAY  CNS-PGM-ID":I-FLG-KEISAN=["
 25094D             I-FLG-KEISAN          OF WK-DENBUN-INFO"]"
 25095*-----------------------------------------------------------------
 25096         EVALUATE  WK-YJ-UW-KBN-OLD
 25097           WHEN  CNS-X-1
 25098             IF  WK-CASH-FLOW-KBN  =  CNS-X-2
 25099             THEN
 25100               IF  I-FLG-KEISAN OF WK-DENBUN-INFO  = CNS-0
 25101               THEN
 25102                 INITIALIZE  DAT-REC
 25103                 MOVE  WK-REC-REC4(WK-IDX-X)
 25104                   TO  DAT-REC
 25105                 PERFORM  DATA-WRITE-RTN
 25106               ELSE
 25107                 INITIALIZE  DAT-REC3
 25108                 MOVE  WK-REC-REC4(WK-IDX-X)
 25109                   TO  DAT-REC3
 25110                 PERFORM  DATA-WRITE-3-RTN
 25111               END-IF
 25112             ELSE
 25113               IF  I-FLG-KEISAN OF WK-DENBUN-INFO  = CNS-0
 25114               THEN
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 434
* MUSR2651.cob                                                     cpy)cpy)y)y)
 25115                 INITIALIZE  DAT-REC5
 25116                 MOVE  WK-REC-REC4(WK-IDX-X)
 25117                   TO  DAT-REC5
 25118                 PERFORM  DATA-WRITE-5-RTN
 25119               ELSE
 25120                 INITIALIZE  DAT-REC7
 25121                 MOVE  WK-REC-REC4(WK-IDX-X)
 25122                   TO  DAT-REC7
 25123                 PERFORM  DATA-WRITE-7-RTN
 25124               END-IF
 25125             END-IF
 25126           WHEN  CNS-X-2
 25127             IF  WK-CASH-FLOW-KBN  =  CNS-X-2
 25128             THEN
 25129               IF  I-FLG-KEISAN OF WK-DENBUN-INFO = CNS-0
 25130               THEN
 25131                 INITIALIZE  DAT-REC2
 25132                 MOVE  WK-REC-REC4(WK-IDX-X)
 25133                   TO  DAT-REC2
 25134                 PERFORM  DATA-WRITE-2-RTN
 25135               ELSE
 25136                 INITIALIZE  DAT-REC4
 25137                 MOVE  WK-REC-REC4(WK-IDX-X)
 25138                   TO  DAT-REC4
 25139                 PERFORM  DATA-WRITE-4-RTN
 25140               END-IF
 25141             ELSE
 25142               IF  I-FLG-KEISAN OF WK-DENBUN-INFO = CNS-0
 25143               THEN
 25144                 INITIALIZE  DAT-REC6
 25145                 MOVE  WK-REC-REC4(WK-IDX-X)
 25146                   TO  DAT-REC6
 25147                 PERFORM  DATA-WRITE-6-RTN
 25148               ELSE
 25149                 INITIALIZE  DAT-REC8
 25150                 MOVE  WK-REC-REC4(WK-IDX-X)
 25151                   TO  DAT-REC8
 25152                 PERFORM  DATA-WRITE-8-RTN
 25153               END-IF
 25154             END-IF
 25155           WHEN  OTHER
 25156             CONTINUE
 25157         END-EVALUATE
 25158       ELSE
 25159         CONTINUE
 25160*--------------------<DEBUG>--------------------------------------
 25161D    DISPLAY  CNS-PGM-ID":DATA出力しない"
 25162*-----------------------------------------------------------------
 25163       END-IF
 25164     END-PERFORM
 25165     MOVE FUNCTION CURRENT-DATE(1:14) TO WK-RUN-EDATETIME
 25166*--------------------<DEBUG>--------------------------------------
 25167     DISPLAY "プログラムID:        ["CNS-PGM-ID"]"                GUT2013
 25168     DISPLAY "セクション:          [BREAK2-RTN_2]"                GUT2013
 25169     DISPLAY "セクションの終了時間:["WK-RUN-EDATETIME"]"          GUT2013
 25170*-----------------------------------------------------------------
 25171*
 25172     INITIALIZE        WK-SUM-DATA-2
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 435
* MUSR2651.cob                                                     cpy)cpy)y)y)
 25173                       WK-SUM-DATA-3
 25174                       WK-REC3
 25175                       WK-REC4
 25176*-------------------<DEBUG>---------------------------------------
 25177D    DISPLAY  CNS-PGM-ID":***  ブレイク処理2  END  ***"
 25178*-----------------------------------------------------------------
 25179     CONTINUE.
 25180 BREAK2-EXT.
 25181     EXIT.
 25182******************************************************************
 25183*    ブレイク処理2
 25184******************************************************************
 25185 BREAK2-2-RTN           SECTION.
 25186*-------------------<DEBUG>---------------------------------------
 25187D    DISPLAY  CNS-PGM-ID":***  ブレイク処理2-2  START  ***"
 25188*-----------------------------------------------------------------
 25189     MOVE FUNCTION CURRENT-DATE(1:14) TO WK-RUN-SDATETIME
 25190*-------------------<DEBUG>---------------------------------------
 25191     DISPLAY "プログラムID:        ["CNS-PGM-ID"]"                GUT2013
 25192     DISPLAY "セクション:          [BREAK2-2-RTN]"                GUT2013
 25193     DISPLAY "セクションの開始時間:["WK-RUN-SDATETIME"]"          GUT2013
 25194*-----------------------------------------------------------------
 25195     PERFORM  VARYING  WK-IDX-Y  FROM  CNS-1  BY  CNS-1
 25196       UNTIL  WK-IDX-Y > CNS-2
 25197*--------------------<DEBUG>--------------------------------------
 25198D    DISPLAY  CNS-PGM-ID":WK-GENKIN-OUT-4("WK-IDX-Y")=["
 25199D             WK-GENKIN-OUT-4(WK-IDX-Y)"]"
 25200*-----------------------------------------------------------------
 25201       IF  WK-GENKIN-OUT-4(WK-IDX-Y) = CNS-X-1
 25202       THEN
 25203         PERFORM  DATA-5-RTN
 25204*--------------------<DEBUG>--------------------------------------
 25205D    DISPLAY  CNS-PGM-ID":約定受渡区分=["WK-YJ-UW-KBN-OLD"]"
 25206D    DISPLAY  CNS-PGM-ID":WK-CASH-FLOW-KBN=["WK-CASH-FLOW-KBN"]"
 25207D    DISPLAY  CNS-PGM-ID":I-FLG-KEISAN=["
 25208D             I-FLG-KEISAN          OF WK-DENBUN-INFO"]"
 25209*-----------------------------------------------------------------
 25210         EVALUATE  WK-YJ-UW-KBN-OLD
 25211           WHEN  CNS-X-1
 25212             IF  WK-CASH-FLOW-KBN  =  CNS-X-2
 25213             THEN
 25214               IF  I-FLG-KEISAN OF WK-DENBUN-INFO  = CNS-0
 25215               THEN
 25216                 INITIALIZE  DAT-REC
 25217                 MOVE  WK-REC-REC5(WK-IDX-Y)
 25218                   TO  DAT-REC
 25219                 PERFORM  DATA-WRITE-RTN
 25220               ELSE
 25221                 INITIALIZE  DAT-REC3
 25222                 MOVE  WK-REC-REC5(WK-IDX-Y)
 25223                   TO  DAT-REC3
 25224                 PERFORM  DATA-WRITE-3-RTN
 25225               END-IF
 25226             ELSE
 25227               IF  I-FLG-KEISAN OF WK-DENBUN-INFO  = CNS-0
 25228               THEN
 25229                 INITIALIZE  DAT-REC5
 25230                 MOVE  WK-REC-REC5(WK-IDX-Y)
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 436
* MUSR2651.cob                                                     cpy)cpy)y)y)
 25231                   TO  DAT-REC5
 25232                 PERFORM  DATA-WRITE-5-RTN
 25233               ELSE
 25234                 INITIALIZE  DAT-REC7
 25235                 MOVE  WK-REC-REC5(WK-IDX-Y)
 25236                   TO  DAT-REC7
 25237                 PERFORM  DATA-WRITE-7-RTN
 25238               END-IF
 25239             END-IF
 25240           WHEN  CNS-X-2
 25241             IF  WK-CASH-FLOW-KBN  =  CNS-X-2
 25242             THEN
 25243               IF  I-FLG-KEISAN OF WK-DENBUN-INFO = CNS-0
 25244               THEN
 25245                 INITIALIZE  DAT-REC2
 25246                 MOVE  WK-REC-REC5(WK-IDX-Y)
 25247                   TO  DAT-REC2
 25248                 PERFORM  DATA-WRITE-2-RTN
 25249               ELSE
 25250                 INITIALIZE  DAT-REC4
 25251                 MOVE  WK-REC-REC5(WK-IDX-Y)
 25252                   TO  DAT-REC4
 25253                 PERFORM  DATA-WRITE-4-RTN
 25254               END-IF
 25255             ELSE
 25256               IF  I-FLG-KEISAN OF WK-DENBUN-INFO = CNS-0
 25257               THEN
 25258                 INITIALIZE  DAT-REC6
 25259                 MOVE  WK-REC-REC5(WK-IDX-Y)
 25260                   TO  DAT-REC6
 25261                 PERFORM  DATA-WRITE-6-RTN
 25262               ELSE
 25263                 INITIALIZE  DAT-REC8
 25264                 MOVE  WK-REC-REC5(WK-IDX-Y)
 25265                   TO  DAT-REC8
 25266                 PERFORM  DATA-WRITE-8-RTN
 25267               END-IF
 25268             END-IF
 25269           WHEN  OTHER
 25270             CONTINUE
 25271         END-EVALUATE
 25272       ELSE
 25273         CONTINUE
 25274*--------------------<DEBUG>--------------------------------------
 25275D    DISPLAY  CNS-PGM-ID":DATA出力しない"
 25276*-----------------------------------------------------------------
 25277       END-IF
 25278     END-PERFORM
 25279     MOVE FUNCTION CURRENT-DATE(1:14) TO WK-RUN-EDATETIME
 25280*--------------------<DEBUG>--------------------------------------
 25281     DISPLAY "プログラムID:        ["CNS-PGM-ID"]"                GUT2013
 25282     DISPLAY "セクション:          [BREAK2-2-RTN]"                GUT2013
 25283     DISPLAY "セクションの終了時間:["WK-RUN-EDATETIME"]"          GUT2013
 25284*-----------------------------------------------------------------
 25285*
 25286     INITIALIZE        WK-SUM-DATA-4
 25287                       WK-REC5
 25288*-------------------<DEBUG>---------------------------------------
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 437
* MUSR2651.cob                                                     cpy)cpy)y)y)
 25289D    DISPLAY  CNS-PGM-ID":***  ブレイク処理2-2  END  ***"
 25290*-----------------------------------------------------------------
 25291     CONTINUE.
 25292 BREAK2-2-EXT.
 25293     EXIT.
 25294******************************************************************
 25295*    データ合計編輯4する
 25296******************************************************************
 25297 DATA-4-RTN             SECTION.
 25298*--------------------<DEBUG>--------------------------------------
 25299D    DISPLAY  CNS-PGM-ID":***  データ合計編輯4 START  ***"
 25300*-----------------------------------------------------------------
 25301*----------  証券発行元の所属する国
 25302     MOVE  WK-HAKO-CD-3(WK-IDX-X)
 25303       TO  HAKO-CD           OF  WK-REC-REC4(WK-IDX-X)
 25304*----------  銘柄コード
 25305     MOVE  WK-MEG-CD-3(WK-IDX-X)
 25306       TO  MEG-CD            OF  WK-REC-REC4(WK-IDX-X)
 25307*----------  送付側銘柄コード
 25308     MOVE  WK-MEG-CD-3(WK-IDX-X)
 25309       TO  SEND-MEG-CD       OF  WK-REC-REC4(WK-IDX-X)
 25310*----------  保有数量
 25311     MOVE  WK-HOU-SURYO-SUM-3(WK-IDX-X)
 25312       TO  WK-18-18-X
 25313     PERFORM  ZERO-COMPUTE-RTN
 25314     COMPUTE  WK-NUM-LENGTH = 25 - WK-NUM-1
 25315     MOVE  WK-18-18-X(WK-NUM-FROM:WK-NUM-LENGTH)
 25316       TO  HOU-SURYO         OF  WK-REC-REC4(WK-IDX-X)
 25317*----------  取得金額(取引通貨)
 25318     MOVE  WK-THTK-ST-KNG-SUM-3(WK-IDX-X)
 25319       TO  WK-18-18-X
 25320     PERFORM  ZERO-COMPUTE-RTN
 25321     COMPUTE  WK-NUM-LENGTH = 22 - WK-NUM-1
 25322     MOVE  WK-18-18-X(WK-NUM-FROM:WK-NUM-LENGTH)
 25323       TO  THTK-ST-KNG       OF  WK-REC-REC4(WK-IDX-X)
 25324*----------  評価金額(取引通貨)
 25325     MOVE  WK-THTK-HYK-KN-SUM-3(WK-IDX-X)
 25326       TO  WK-18-18-X
 25327     PERFORM  ZERO-COMPUTE-RTN
 25328     COMPUTE  WK-NUM-LENGTH = 22 - WK-NUM-1
 25329     MOVE  WK-18-18-X(WK-NUM-FROM:WK-NUM-LENGTH)
 25330       TO  THTK-HYK-KN       OF  WK-REC-REC4(WK-IDX-X)
 25331*----------  評価損益(取引通貨)
 25332     MOVE  WK-THTK-HYK-SNEKI-SUM-3(WK-IDX-X)
 25333       TO  WK-18-18-X
 25334     PERFORM  ZERO-COMPUTE-RTN
 25335     COMPUTE  WK-NUM-LENGTH = 22 - WK-NUM-1
 25336     MOVE  WK-18-18-X(WK-NUM-FROM:WK-NUM-LENGTH)
 25337       TO  THTK-HYK-SNEKI    OF  WK-REC-REC4(WK-IDX-X)
 25338*----------  取得金額(運用通貨為替換算額)
 25339     MOVE  WK-UYTK-KWS-BOKAZN-SUM-3(WK-IDX-X)
 25340       TO  WK-18-18-X
 25341     PERFORM  ZERO-COMPUTE-RTN
 25342     COMPUTE  WK-NUM-LENGTH = 22 - WK-NUM-1
 25343     MOVE  WK-18-18-X(WK-NUM-FROM:WK-NUM-LENGTH)
 25344       TO  UYTK-KWS-BOKAZN   OF  WK-REC-REC4(WK-IDX-X)
 25345*----------  取得金額(運用通貨)
 25346     MOVE  WK-SHTK-KN-LC-SUM-3(WK-IDX-X)
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 438
* MUSR2651.cob                                                     cpy)cpy)y)y)
 25347       TO  WK-18-18-X
 25348     PERFORM  ZERO-COMPUTE-RTN
 25349     COMPUTE  WK-NUM-LENGTH = 22 - WK-NUM-1
 25350     MOVE  WK-18-18-X(WK-NUM-FROM:WK-NUM-LENGTH)
 25351       TO  SHTK-KN-LC        OF  WK-REC-REC4(WK-IDX-X)
 25352*----------  評価金額(運用通貨)
 25353     MOVE  WK-HYK-KN-LC-SUM-3(WK-IDX-X)
 25354       TO  WK-18-18-X
 25355     PERFORM  ZERO-COMPUTE-RTN
 25356     COMPUTE  WK-NUM-LENGTH = 22 - WK-NUM-1
 25357     MOVE  WK-18-18-X(WK-NUM-FROM:WK-NUM-LENGTH)
 25358       TO  HYK-KN-LC         OF  WK-REC-REC4(WK-IDX-X)
 25359*----------  評価損益(運用通貨)
 25360     MOVE  WK-HYK-SNEKI-LC-SUM-3(WK-IDX-X)
 25361       TO  WK-18-18-X
 25362     PERFORM  ZERO-COMPUTE-RTN
 25363     COMPUTE  WK-NUM-LENGTH = 22 - WK-NUM-1
 25364     MOVE  WK-18-18-X(WK-NUM-FROM:WK-NUM-LENGTH)
 25365       TO  HYK-SNEKI-LC      OF  WK-REC-REC4(WK-IDX-X)
 25366*----------  銘柄名称(日本語)
 25367     MOVE  WK-MEG-MEI-JP-3(WK-IDX-X)
 25368       TO  MEG-MEI-JP        OF  WK-REC-REC4(WK-IDX-X)
 25369*----------  銘柄名称(英語)
 25370     MOVE  WK-MEG-MEI-EN-3(WK-IDX-X)
 25371       TO  MEG-MEI-EN        OF  WK-REC-REC4(WK-IDX-X)
 25372*----------  債券ｸｰﾎﾟﾝ
 25373     MOVE  ZERO
 25374       TO  WK-18-18-X
 25375     PERFORM  ZERO-COMPUTE-RTN
 25376     COMPUTE  WK-NUM-LENGTH = 25 - WK-NUM-1
 25377     MOVE  WK-18-18-X(WK-NUM-FROM:WK-NUM-LENGTH)
 25378       TO  SK-KP             OF  WK-REC-REC4(WK-IDX-X)
 25379*----------  債券償還日
 25380     MOVE  ZERO
 25381       TO  SHOKAN-YMD        OF  WK-REC-REC4(WK-IDX-X)
 25382*----------  建玉/約定番号
 25383     MOVE  ZERO
 25384       TO  KB-KANRI-ID       OF  WK-REC-REC4(WK-IDX-X)
 25385*--------------------<DEBUG>--------------------------------------
 25386D    DISPLAY  CNS-PGM-ID":証券発行元の所属する国=["HAKO-CD
 25387D                                  OF  WK-REC-REC4(WK-IDX-X) "]"
 25388D    DISPLAY  CNS-PGM-ID":銘柄コード=["MEG-CD
 25389D                                  OF  WK-REC-REC4(WK-IDX-X) "]"
 25390D    DISPLAY  CNS-PGM-ID":銘柄名称(日本語)=["MEG-MEI-JP
 25391D                                  OF  WK-REC-REC4(WK-IDX-X) "]"
 25392D    DISPLAY  CNS-PGM-ID":銘柄名称(英語)=["MEG-MEI-EN
 25393D                                  OF  WK-REC-REC4(WK-IDX-X) "]"
 25394D    DISPLAY  CNS-PGM-ID":債券ｸｰﾎﾟﾝ=[" SK-KP
 25395D                                  OF  WK-REC-REC4(WK-IDX-X) "]"
 25396D    DISPLAY  CNS-PGM-ID":債券償還日=["SHOKAN-YMD
 25397D                                  OF  WK-REC-REC4(WK-IDX-X) "]"
 25398D    DISPLAY  CNS-PGM-ID":建玉/約定番号=["KB-KANRI-ID
 25399D                                  OF  WK-REC-REC4(WK-IDX-X) "]"
 25400*-----------------------------------------------------------------
 25401*--------------------<DEBUG>--------------------------------------
 25402D    DISPLAY  CNS-PGM-ID":*** データ合計編輯4 END  ***"
 25403*-----------------------------------------------------------------
 25404     CONTINUE.
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 439
* MUSR2651.cob                                                     cpy)cpy)y)y)
 25405 DATA-4-EXT.
 25406     EXIT.
 25407******************************************************************
 25408*    データ合計編輯5する
 25409******************************************************************
 25410 DATA-5-RTN             SECTION.
 25411*--------------------<DEBUG>--------------------------------------
 25412D    DISPLAY  CNS-PGM-ID":***  データ合計編輯5 START  ***"
 25413*-----------------------------------------------------------------
 25414*----------  証券種別
 25415     MOVE  WK-SEC-SBT-CD-4(WK-IDX-Y)
 25416       TO  SEC-SBT-CD        OF  WK-REC-REC5(WK-IDX-Y)
 25417*----------  証券発行元の所属する国
 25418     MOVE  WK-HAKO-CD-4(WK-IDX-Y)
 25419       TO  HAKO-CD           OF  WK-REC-REC5(WK-IDX-Y)
 25420*----------  銘柄コード
 25421     MOVE  WK-MEG-CD-4(WK-IDX-Y)
 25422       TO  MEG-CD            OF  WK-REC-REC5(WK-IDX-Y)
 25423*----------  送付側銘柄コード
 25424     MOVE  WK-MEG-CD-4(WK-IDX-Y)
 25425       TO  SEND-MEG-CD       OF  WK-REC-REC5(WK-IDX-Y)
 25426*----------  保有数量
 25427     MOVE  WK-HOU-SURYO-SUM-4(WK-IDX-Y)
 25428       TO  WK-18-18-X
 25429     PERFORM  ZERO-COMPUTE-RTN
 25430     COMPUTE  WK-NUM-LENGTH = 25 - WK-NUM-1
 25431     MOVE  WK-18-18-X(WK-NUM-FROM:WK-NUM-LENGTH)
 25432       TO  HOU-SURYO         OF  WK-REC-REC5(WK-IDX-Y)
 25433*----------  取得金額(取引通貨)
 25434     MOVE  WK-THTK-ST-KNG-SUM-4(WK-IDX-Y)
 25435       TO  WK-18-18-X
 25436     PERFORM  ZERO-COMPUTE-RTN
 25437     COMPUTE  WK-NUM-LENGTH = 22 - WK-NUM-1
 25438     MOVE  WK-18-18-X(WK-NUM-FROM:WK-NUM-LENGTH)
 25439       TO  THTK-ST-KNG       OF  WK-REC-REC5(WK-IDX-Y)
 25440*----------  評価金額(取引通貨)
 25441     MOVE  WK-THTK-HYK-KN-SUM-4(WK-IDX-Y)
 25442       TO  WK-18-18-X
 25443     PERFORM  ZERO-COMPUTE-RTN
 25444     COMPUTE  WK-NUM-LENGTH = 22 - WK-NUM-1
 25445     MOVE  WK-18-18-X(WK-NUM-FROM:WK-NUM-LENGTH)
 25446       TO  THTK-HYK-KN       OF  WK-REC-REC5(WK-IDX-Y)
 25447*----------  評価損益(取引通貨)
 25448     MOVE  WK-THTK-HYK-SNEKI-SUM-4(WK-IDX-Y)
 25449       TO  WK-18-18-X
 25450     PERFORM  ZERO-COMPUTE-RTN
 25451     COMPUTE  WK-NUM-LENGTH = 22 - WK-NUM-1
 25452     MOVE  WK-18-18-X(WK-NUM-FROM:WK-NUM-LENGTH)
 25453       TO  THTK-HYK-SNEKI    OF  WK-REC-REC5(WK-IDX-Y)
 25454*----------  取得金額(運用通貨為替換算額)
 25455     MOVE  WK-UYTK-KWS-BOKAZN-SUM-4(WK-IDX-Y)
 25456       TO  WK-18-18-X
 25457     PERFORM  ZERO-COMPUTE-RTN
 25458     COMPUTE  WK-NUM-LENGTH = 22 - WK-NUM-1
 25459     MOVE  WK-18-18-X(WK-NUM-FROM:WK-NUM-LENGTH)
 25460       TO  UYTK-KWS-BOKAZN   OF  WK-REC-REC5(WK-IDX-Y)
 25461*----------  取得金額(運用通貨)
 25462     MOVE  WK-SHTK-KN-LC-SUM-4(WK-IDX-Y)
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 440
* MUSR2651.cob                                                     cpy)cpy)y)y)
 25463       TO  WK-18-18-X
 25464     PERFORM  ZERO-COMPUTE-RTN
 25465     COMPUTE  WK-NUM-LENGTH = 22 - WK-NUM-1
 25466     MOVE  WK-18-18-X(WK-NUM-FROM:WK-NUM-LENGTH)
 25467       TO  SHTK-KN-LC        OF  WK-REC-REC5(WK-IDX-Y)
 25468*----------  評価金額(運用通貨)
 25469     MOVE  WK-HYK-KN-LC-SUM-4(WK-IDX-Y)
 25470       TO  WK-18-18-X
 25471     PERFORM  ZERO-COMPUTE-RTN
 25472     COMPUTE  WK-NUM-LENGTH = 22 - WK-NUM-1
 25473     MOVE  WK-18-18-X(WK-NUM-FROM:WK-NUM-LENGTH)
 25474       TO  HYK-KN-LC         OF  WK-REC-REC5(WK-IDX-Y)
 25475*----------  評価損益(運用通貨)
 25476     MOVE  WK-HYK-SNEKI-LC-SUM-4(WK-IDX-Y)
 25477       TO  WK-18-18-X
 25478     PERFORM  ZERO-COMPUTE-RTN
 25479     COMPUTE  WK-NUM-LENGTH = 22 - WK-NUM-1
 25480     MOVE  WK-18-18-X(WK-NUM-FROM:WK-NUM-LENGTH)
 25481       TO  HYK-SNEKI-LC      OF  WK-REC-REC5(WK-IDX-Y)
 25482*----------  銘柄名称(日本語)
 25483     MOVE  WK-MEG-MEI-JP-4(WK-IDX-Y)
 25484       TO  MEG-MEI-JP        OF  WK-REC-REC5(WK-IDX-Y)
 25485*----------  銘柄名称(英語)
 25486     MOVE  WK-MEG-MEI-EN-4(WK-IDX-Y)
 25487       TO  MEG-MEI-EN        OF  WK-REC-REC5(WK-IDX-Y)
 25488*----------  債券ｸｰﾎﾟﾝ
 25489     MOVE  ZERO
 25490       TO  WK-18-18-X
 25491     PERFORM  ZERO-COMPUTE-RTN
 25492     COMPUTE  WK-NUM-LENGTH = 25 - WK-NUM-1
 25493     MOVE  WK-18-18-X(WK-NUM-FROM:WK-NUM-LENGTH)
 25494       TO  SK-KP             OF  WK-REC-REC5(WK-IDX-Y)
 25495*----------  債券償還日
 25496     MOVE  ZERO
 25497       TO  SHOKAN-YMD        OF  WK-REC-REC5(WK-IDX-Y)
 25498*----------  建玉/約定番号
 25499     MOVE  ZERO
 25500       TO  KB-KANRI-ID       OF  WK-REC-REC5(WK-IDX-Y)
 25501*--------------------<DEBUG>--------------------------------------
 25502D    DISPLAY  CNS-PGM-ID":証券発行元の所属する国=["HAKO-CD
 25503D                                  OF  WK-REC-REC5(WK-IDX-Y) "]"
 25504D    DISPLAY  CNS-PGM-ID":銘柄コード=["MEG-CD
 25505D                                  OF  WK-REC-REC5(WK-IDX-Y) "]"
 25506D    DISPLAY  CNS-PGM-ID":銘柄名称(日本語)=["MEG-MEI-JP
 25507D                                  OF  WK-REC-REC5(WK-IDX-Y) "]"
 25508D    DISPLAY  CNS-PGM-ID":銘柄名称(英語)=["MEG-MEI-EN
 25509D                                  OF  WK-REC-REC5(WK-IDX-Y) "]"
 25510D    DISPLAY  CNS-PGM-ID":債券ｸｰﾎﾟﾝ=[" SK-KP
 25511D                                  OF  WK-REC-REC5(WK-IDX-Y) "]"
 25512D    DISPLAY  CNS-PGM-ID":債券償還日=["SHOKAN-YMD
 25513D                                  OF  WK-REC-REC5(WK-IDX-Y) "]"
 25514D    DISPLAY  CNS-PGM-ID":建玉/約定番号=["KB-KANRI-ID
 25515D                                  OF  WK-REC-REC5(WK-IDX-Y) "]"
 25516*-----------------------------------------------------------------
 25517*--------------------<DEBUG>--------------------------------------
 25518D    DISPLAY  CNS-PGM-ID":*** データ合計編輯5 END  ***"
 25519*-----------------------------------------------------------------
 25520     CONTINUE.
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 441
* MUSR2651.cob                                                     cpy)cpy)y)y)
 25521 DATA-5-EXT.
 25522     EXIT.
 25523******************************************************************
 25524*    評価系列取得ルーチン
 25525******************************************************************
 25526 SCZY4009-RTN           SECTION.
 25527*-------------------<DEBUG>---------------------------------------
 25528D    DISPLAY  CNS-PGM-ID ":***   評価系列取得ルーチン   START ***"
 25529*-----------------------------------------------------------------
 25530     INITIALIZE  PARM-SCZY4009-INOUT
 25531                 PARM-RTNPKG
 25532                 WK-HYK-EX-SHTK-PTN-CD
 25533                 WK-HYK-EX-FLG
 25534                 WK-RTN-4009
 25535*----------  利用会社コード
 25536     MOVE  WK-RIYO-CMP-CD
 25537       TO  RIYO-CMP-CD            OF  PARM-SCZY4009-ARG1
 25538*----------  評価系列コード
 25539     MOVE  WK-DEFAUL-THYK-CD      OF  WK-PTF-ATT-DATA(WK-IDX-J)
 25540       TO  HYK-KRTU-CD            OF  PARM-SCZY4009-ARG1
 25541*--------------------<DEBUG>--------------------------------------
 25542D    DISPLAY  CNS-PGM-ID":PARM-SCZY4009-ARG1:"
 25543D    DISPLAY  CNS-PGM-ID":利用会社コード      =["
 25544D             RIYO-CMP-CD              OF  PARM-SCZY4009-ARG1"]"
 25545D    DISPLAY  CNS-PGM-ID":評価系列コード      =["
 25546D             HYK-KRTU-CD              OF  PARM-SCZY4009-ARG1"]"
 25547*-----------------------------------------------------------------
 25548     CALL   "SCZY4009"              USING  PARM-SCZY4009-INOUT
 25549                                           PARM-RTNPKG
 25550*-------------------<DEBUG>---------------------------------------
 25551D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY4009) =["
 25552D             RTN-CD  OF  PARM-RTNPKG(COUNTER  OF  PARM-RTNPKG)"]"
 25553*-----------------------------------------------------------------
 25554     MOVE  CNS-ON
 25555       TO  WK-HYK-EX-FLG
 25556     MOVE  RTN-CD  OF  PARM-RTNPKG(COUNTER  OF  PARM-RTNPKG)
 25557       TO  WK-RTN-4009
 25558     EVALUATE  RTN-CD  OF  PARM-RTNPKG(COUNTER  OF  PARM-RTNPKG)
 25559       WHEN  CNS-RTN-000
 25560*----------  取得した評価為替取得方法コード
 25561         MOVE  HYK-EX-SHTK-PTN-CD  OF  PARM-SCZY4009-INOUT
 25562           TO  WK-HYK-EX-SHTK-PTN-CD
 25563       WHEN  CNS-RTN-110
 25564*----------
 25565         IF  WK-1190-STATUS < CNS-4
 25566         THEN
 25567           MOVE  CNS-4          TO  WK-1190-STATUS
 25568         ELSE
 25569           CONTINUE
 25570         END-IF
 25571*
 25572         IF  WK-STATUS < CNS-4
 25573         THEN
 25574           MOVE  CNS-4          TO  WK-STATUS
 25575         ELSE
 25576           CONTINUE
 25577         END-IF
 25578*----------  ワークリターンコード
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 442
* MUSR2651.cob                                                     cpy)cpy)y)y)
 25579         IF  WK-RTN-CODE < CNS-4
 25580         THEN
 25581           MOVE  CNS-4          TO  WK-RTN-CODE
 25582         ELSE
 25583           CONTINUE
 25584         END-IF
 25585*----------  ワーク業務エラーパッケージを編集
 25586*-------------------<DEBUG>---------------------------------------
 25587D    DISPLAY  CNS-PGM-ID":WK-J =[" WK-J"]"
 25588*-----------------------------------------------------------------
 25589         COMPUTE  WK-J = WK-J + 1
 25590*-------------------<DEBUG>---------------------------------------
 25591D    DISPLAY  CNS-PGM-ID":WK-J =[" WK-J"]"
 25592*-----------------------------------------------------------------
 25593*---------- ファンドコード
 25594         MOVE  WK-FUND-CD-DETAIL     OF  WK-PTF-ATT-DATA(WK-IDX-J)
 25595           TO  WK-GYOMU-FUND-CD      OF  WK-GYOMU-ERR-INFO(WK-J)
 25596*---------- ポートフォリオコード
 25597         MOVE  WK-PTF-CD-DETAIL      OF  WK-PTF-ATT-DATA(WK-IDX-J)
 25598           TO  WK-GYOMU-PTF-CD       OF  WK-GYOMU-ERR-INFO(WK-J)
 25599*---------- 評価系列コード
 25600         MOVE  WK-DEFAUL-THYK-CD     OF  WK-PTF-ATT-DATA(WK-IDX-J)
 25601           TO  WK-GYOMU-HYK-KRTU-CD  OF  WK-GYOMU-ERR-INFO(WK-J)
 25602*---------- 帳票ID
 25603         MOVE  SPACE
 25604           TO  WK-GYOMU-REP-ID        OF  WK-GYOMU-ERR-INFO(WK-J)
 25605*---------- 帳票任意コード
 25606         MOVE  SPACE
 25607           TO  WK-GYOMU-REP-ANY-CD    OF  WK-GYOMU-ERR-INFO(WK-J)
 25608*---------- 基準日From
 25609         MOVE  WK-KIKAN-FR
 25610           TO  WK-GYOMU-KJN-YMD-FROM  OF  WK-GYOMU-ERR-INFO(WK-J)
 25611*---------- 基準日To
 25612         MOVE  WK-KIKAN-TO
 25613           TO  WK-GYOMU-KJN-YMD-TO    OF  WK-GYOMU-ERR-INFO(WK-J)
 25614*---------- メッセージID
 25615         MOVE  CNS-MSG-E000090
 25616           TO  WK-GYOMU-MSG-ID        OF  WK-GYOMU-ERR-INFO(WK-J)
 25617*---------- 置換文字
 25618         MOVE  CNS-HYK-EX
 25619           TO  WK-GYOMU-TK-MOJI(WK-J,CNS-1)
 25620*---------- フリーメッセージ
 25621         MOVE  WK-TEMP-MSG
 25622           TO  WK-GYOMU-FREE-MSG      OF  WK-GYOMU-ERR-INFO(WK-J)
 25623*----------  後処理業務エラーフラグ
 25624         MOVE  CNS-ON                 TO  FLG-MEISAI-GYOMU-ERR
 25625       WHEN  OTHER
 25626*----------  進捗管理フラグ
 25627         MOVE  CNS-16               TO  WK-1190-STATUS
 25628*----------  ワーク実行ステータス
 25629         MOVE  CNS-16               TO  WK-STATUS
 25630*----------  ワークリターンコード
 25631         MOVE  CNS-16               TO  WK-RTN-CODE
 25632*----------  サブエラーメッセージ出力処理
 25633         PERFORM  SUB-ERR-MSG-RTN
 25634*----------  ワークエラーパッケージを編集
 25635         INITIALIZE  WK-SYS-ERR-INFO
 25636*----------  エラー検知プログラムID
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 443
* MUSR2651.cob                                                     cpy)cpy)y)y)
 25637         MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
 25638*----------  ポジション
 25639         MOVE  CNS-POS-052          TO  WK-ERR-POS
 25640*----------  リターンコード
 25641         MOVE  CNS-RTN-901          TO  WK-RTN-CD
 25642*----------  詳細リターンコード
 25643         MOVE  RTN-CD
 25644           OF  PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
 25645                                    TO  WK-DETAIL-RTN-CD
 25646*----------  詳細リターンコードデコードフラグ
 25647         MOVE  CNS-DETAIL-0         TO  WK-DETAIL-RTN-CD-FLG
 25648*---------- フリーメッセージ
 25649         MOVE  SPACE                TO  WK-FREE-MSG
 25650*----------  エラー情報追加処理
 25651         PERFORM  ERR-INFO-ADD-RTN
 25652     END-EVALUATE
 25653*-------------------<DEBUG>---------------------------------------
 25654D    DISPLAY  CNS-PGM-ID":WK-HYK-EX-SHTK-PTN-CD=["
 25655D             WK-HYK-EX-SHTK-PTN-CD"]"
 25656D    DISPLAY  CNS-PGM-ID ":*** 評価系列取得ルーチン   END ***"
 25657*-----------------------------------------------------------------
 25658     CONTINUE.
 25659 SCZY4009-EXT.
 25660     EXIT.
 25661******************************************************************
 25662*    評価為替取得方法パターン取得ルーチン
 25663******************************************************************
 25664 SCZY4012-RTN           SECTION.
 25665*-------------------<DEBUG>---------------------------------------
 25666D    DISPLAY  CNS-PGM-ID ":***   評価為替取得方法パターン取得"
 25667D             "ルーチン   START ***"
 25668*-----------------------------------------------------------------
 25669     INITIALIZE  PARM-SCZY4012-INOUT
 25670                 PARM-RTNPKG
 25671                 WK-PRIO-1-EX-KRTU
 25672                 WK-PRIO-1-FLG
 25673                 WK-TRHK-TUKA-4012
 25674                 WK-RTN-4012
 25675*----------  利用会社コード
 25676     MOVE  WK-RIYO-CMP-CD
 25677       TO  RIYO-CMP-CD                 OF  PARM-SCZY4012-ARG1
 25678*----------  評価為替取得方法コード
 25679     MOVE  WK-HYK-EX-SHTK-PTN-CD
 25680       TO  HYK-EX-SHTK-PTN-CD          OF  PARM-SCZY4012-ARG1
 25681*----------  取引通貨コード
 25682     MOVE  H-TRHK-TUKA                 OF  HST-TBL-SELECT
 25683       TO  SIJO-TUKA-CD                OF  PARM-SCZY4012-ARG1
 25684*--------------------<DEBUG>--------------------------------------
 25685D    DISPLAY  CNS-PGM-ID":PARM-SCZY4012-ARG1:"
 25686D    DISPLAY  CNS-PGM-ID":利用会社コード      =["
 25687D             RIYO-CMP-CD              OF  PARM-SCZY4012-ARG1"]"
 25688D    DISPLAY  CNS-PGM-ID":評価為替取得方法コード  =["
 25689D             HYK-EX-SHTK-PTN-CD       OF  PARM-SCZY4012-ARG1"]"
 25690D    DISPLAY  CNS-PGM-ID":取引通貨コード      =["
 25691D             SIJO-TUKA-CD             OF  PARM-SCZY4012-ARG1"]"
 25692*-----------------------------------------------------------------
 25693     CALL   "SCZY4012"              USING  PARM-SCZY4012-INOUT
 25694                                           PARM-RTNPKG
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 444
* MUSR2651.cob                                                     cpy)cpy)y)y)
 25695*-------------------<DEBUG>---------------------------------------
 25696D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY4012) =["
 25697D             RTN-CD  OF  PARM-RTNPKG(COUNTER  OF  PARM-RTNPKG)"]"
 25698*-----------------------------------------------------------------
 25699     MOVE  CNS-ON
 25700       TO  WK-PRIO-1-FLG
 25701     MOVE  H-TRHK-TUKA                 OF  HST-TBL-SELECT
 25702       TO  WK-TRHK-TUKA-4012
 25703     MOVE  RTN-CD  OF  PARM-RTNPKG(COUNTER  OF  PARM-RTNPKG)
 25704       TO  WK-RTN-4012
 25705     EVALUATE  RTN-CD  OF  PARM-RTNPKG(COUNTER  OF  PARM-RTNPKG)
 25706       WHEN  CNS-RTN-000
 25707*----------  取得した優先順位１為替系列
 25708         MOVE  PRIO-1-EX-KRTU           OF  PARM-SCZY4012-INOUT
 25709           TO  WK-PRIO-1-EX-KRTU
 25710       WHEN  CNS-RTN-110
 25711*----------
 25712         IF  WK-1190-STATUS < CNS-4
 25713         THEN
 25714           MOVE  CNS-4          TO  WK-1190-STATUS
 25715         ELSE
 25716           CONTINUE
 25717         END-IF
 25718*
 25719         IF  WK-STATUS < CNS-4
 25720         THEN
 25721           MOVE  CNS-4          TO  WK-STATUS
 25722         ELSE
 25723           CONTINUE
 25724         END-IF
 25725*----------  ワークリターンコード
 25726         IF  WK-RTN-CODE < CNS-4
 25727         THEN
 25728           MOVE  CNS-4          TO  WK-RTN-CODE
 25729         ELSE
 25730           CONTINUE
 25731         END-IF
 25732*----------  ワーク業務エラーパッケージを編集
 25733*-------------------<DEBUG>---------------------------------------
 25734D    DISPLAY  CNS-PGM-ID":WK-J =[" WK-J"]"
 25735*-----------------------------------------------------------------
 25736         COMPUTE  WK-J = WK-J + 1
 25737*-------------------<DEBUG>---------------------------------------
 25738D    DISPLAY  CNS-PGM-ID":WK-J =[" WK-J"]"
 25739*-----------------------------------------------------------------
 25740*---------- ファンドコード
 25741         MOVE  WK-FUND-CD-DETAIL     OF  WK-PTF-ATT-DATA(WK-IDX-J)
 25742           TO  WK-GYOMU-FUND-CD      OF  WK-GYOMU-ERR-INFO(WK-J)
 25743*---------- ポートフォリオコード
 25744         MOVE  WK-PTF-CD-DETAIL      OF  WK-PTF-ATT-DATA(WK-IDX-J)
 25745           TO  WK-GYOMU-PTF-CD       OF  WK-GYOMU-ERR-INFO(WK-J)
 25746*---------- 評価系列コード
 25747         MOVE  WK-DEFAUL-THYK-CD     OF  WK-PTF-ATT-DATA(WK-IDX-J)
 25748           TO  WK-GYOMU-HYK-KRTU-CD  OF  WK-GYOMU-ERR-INFO(WK-J)
 25749*---------- 帳票ID
 25750         MOVE  SPACE
 25751           TO  WK-GYOMU-REP-ID        OF  WK-GYOMU-ERR-INFO(WK-J)
 25752*---------- 帳票任意コード
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 445
* MUSR2651.cob                                                     cpy)cpy)y)y)
 25753         MOVE  SPACE
 25754           TO  WK-GYOMU-REP-ANY-CD    OF  WK-GYOMU-ERR-INFO(WK-J)
 25755*---------- 基準日From
 25756         MOVE  WK-KIKAN-FR
 25757           TO  WK-GYOMU-KJN-YMD-FROM  OF  WK-GYOMU-ERR-INFO(WK-J)
 25758*---------- 基準日To
 25759         MOVE  WK-KIKAN-TO
 25760           TO  WK-GYOMU-KJN-YMD-TO    OF  WK-GYOMU-ERR-INFO(WK-J)
 25761*---------- メッセージID
 25762         MOVE  CNS-MSG-E000090
 25763           TO  WK-GYOMU-MSG-ID        OF  WK-GYOMU-ERR-INFO(WK-J)
 25764*---------- 置換文字
 25765         MOVE  CNS-EX-KRTU
 25766           TO  WK-GYOMU-TK-MOJI(WK-J,CNS-1)
 25767*---------- フリーメッセージ
 25768         MOVE  WK-TEMP-MSG
 25769           TO  WK-GYOMU-FREE-MSG      OF  WK-GYOMU-ERR-INFO(WK-J)
 25770*----------  後処理業務エラーフラグ
 25771         MOVE  CNS-ON                 TO  FLG-MEISAI-GYOMU-ERR
 25772       WHEN  OTHER
 25773*----------  進捗管理フラグ
 25774         MOVE  CNS-16               TO  WK-1190-STATUS
 25775*----------  ワーク実行ステータス
 25776         MOVE  CNS-16               TO  WK-STATUS
 25777*----------  ワークリターンコード
 25778         MOVE  CNS-16               TO  WK-RTN-CODE
 25779*----------  サブエラーメッセージ出力処理
 25780         PERFORM  SUB-ERR-MSG-RTN
 25781*----------  ワークエラーパッケージを編集
 25782         INITIALIZE  WK-SYS-ERR-INFO
 25783*----------  エラー検知プログラムID
 25784         MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
 25785*----------  ポジション
 25786         MOVE  CNS-POS-053          TO  WK-ERR-POS
 25787*----------  リターンコード
 25788         MOVE  CNS-RTN-901          TO  WK-RTN-CD
 25789*----------  詳細リターンコード
 25790         MOVE  RTN-CD
 25791           OF  PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
 25792                                    TO  WK-DETAIL-RTN-CD
 25793*----------  詳細リターンコードデコードフラグ
 25794         MOVE  CNS-DETAIL-0         TO  WK-DETAIL-RTN-CD-FLG
 25795*---------- フリーメッセージ
 25796         MOVE  SPACE                TO  WK-FREE-MSG
 25797*----------  エラー情報追加処理
 25798         PERFORM  ERR-INFO-ADD-RTN
 25799     END-EVALUATE
 25800*-------------------<DEBUG>---------------------------------------
 25801D    DISPLAY  CNS-PGM-ID":WK-PRIO-1-EX-KRTU=["
 25802D             WK-PRIO-1-EX-KRTU"]"
 25803D    DISPLAY  CNS-PGM-ID ":***  評価為替取得方法パターン取得"
 25804D             "ルーチン   END ***"
 25805*-----------------------------------------------------------------
 25806     CONTINUE.
 25807 SCZY4012-EXT.
 25808     EXIT.
 25809*****************************************************************
 25810*   ＧＸ用証券種別コード変換
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 446
* MUSR2651.cob                                                     cpy)cpy)y)y)
 25811*****************************************************************
 25812 SUSC0603-RTN           SECTION.
 25813*--------------------<DEBUG>--------------------------------------
 25814D    DISPLAY  CNS-PGM-ID":***  ＧＸ用証券種別コード変換  START***"
 25815*-----------------------------------------------------------------
 25816     INITIALIZE  PARM-SUSC0603-INOUT
 25817                 PARM-RTNPKG
 25818                 WK-SEC-SBT-CD-3
 25819*----------  証券種別コード
 25820     MOVE  WK-SEC-SBT-CD-2
 25821       TO  SEC-SBT-CD             OF  PARM-SUSC0603-ARG1
 25822*----------  資産分類コード
 25823     MOVE  WK-SISAN-BUNRUI-CD
 25824       TO  ASSETS-KBN-CD          OF  PARM-SUSC0603-ARG1
 25825*----------  コールプット区分
 25826     MOVE  WK-CALL-PUT-KBN
 25827       TO  CP-KBN                 OF  PARM-SUSC0603-ARG1
 25828*--------------------<DEBUG>--------------------------------------
 25829D    DISPLAY  CNS-PGM-ID":SUSC0603-ARG:"
 25830D    DISPLAY  CNS-PGM-ID":証券種別コード=["
 25831D             SEC-SBT-CD          OF  PARM-SUSC0603-ARG1"]"
 25832D    DISPLAY  CNS-PGM-ID":資産分類コード=["
 25833D             ASSETS-KBN-CD       OF  PARM-SUSC0603-ARG1"]"
 25834D    DISPLAY  CNS-PGM-ID":コールプット区分=["
 25835D             CP-KBN              OF  PARM-SUSC0603-ARG1"]"
 25836D    DISPLAY  CNS-PGM-ID":***  CALL SUSC0603 START  ***"
 25837*-----------------------------------------------------------------
 25838     CALL  "SUSC0603"             USING  PARM-SUSC0603-INOUT
 25839                                         PARM-RTNPKG
 25840*--------------------<DEBUG>--------------------------------------
 25841D    DISPLAY  CNS-PGM-ID":***  CALL SUSC0603 END  ***"
 25842D    DISPLAY  CNS-PGM-ID":RTN-CD(SUSC0603)       =["
 25843D             RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)"]"
 25844D    DISPLAY  CNS-PGM-ID":COUNTER OF PARM-RTNPKG =["
 25845D             COUNTER             OF PARM-RTNPKG "]"
 25846*-----------------------------------------------------------------
 25847     EVALUATE  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
 25848       WHEN  CNS-RTN-000
 25849         MOVE  GX-SEC-SBT-CD      OF  PARM-SUSC0603-ARG2
 25850           TO  WK-SEC-SBT-CD-3
 25851       WHEN  CNS-RTN-100
 25852         IF   WK-STATUS < CNS-4
 25853         THEN
 25854           MOVE  CNS-4              TO  WK-STATUS
 25855         ELSE
 25856           CONTINUE
 25857         END-IF
 25858*----------  1190実行ステータス
 25859         IF   WK-STATUS > WK-1190-STATUS
 25860         THEN
 25861           MOVE  WK-STATUS      TO  WK-1190-STATUS
 25862         ELSE
 25863           CONTINUE
 25864         END-IF
 25865*----------  ワークリターンコード
 25866         IF  WK-STATUS > WK-RTN-CODE
 25867         THEN
 25868           MOVE  WK-STATUS        TO  WK-RTN-CODE
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 447
* MUSR2651.cob                                                     cpy)cpy)y)y)
 25869         ELSE
 25870           CONTINUE
 25871         END-IF
 25872*-------------------<DEBUG>---------------------------------------
 25873D    DISPLAY  CNS-PGM-ID":WK-J=["WK-J"]"
 25874*-----------------------------------------------------------------
 25875         COMPUTE  WK-J = WK-J + CNS-1
 25876*-------------------<DEBUG>---------------------------------------
 25877D    DISPLAY  CNS-PGM-ID":WK-J=["WK-J"]"
 25878*-----------------------------------------------------------------
 25879*---------- ファンドコード
 25880         MOVE  WK-FUND-CD-DETAIL  OF  WK-FUND-PTF-DETAIL(WK-IDX-J)
 25881           TO  WK-GYOMU-FUND-CD   OF
 25882                                  WK-GYOMU-ERR-INFO(WK-J)
 25883*---------- ポートフォリオコード
 25884         MOVE  WK-PTF-CD-DETAIL   OF  WK-FUND-PTF-DETAIL(WK-IDX-J)
 25885           TO  WK-GYOMU-PTF-CD    OF
 25886                                  WK-GYOMU-ERR-INFO(WK-J)
 25887*---------- 評価系列コード
 25888         MOVE  WK-DEFAUL-THYK-CD  OF  WK-FUND-PTF-DETAIL(WK-IDX-J)
 25889            TO  WK-GYOMU-HYK-KRTU-CD
 25890                   OF  WK-GYOMU-ERR-INFO(WK-J)
 25891*---------- 基準日From
 25892         MOVE  WK-KIKAN-FR
 25893           TO  WK-GYOMU-KJN-YMD-FROM
 25894                                  OF WK-GYOMU-ERR-INFO(WK-J)
 25895*---------- 基準日To
 25896         MOVE  WK-KIKAN-TO
 25897           TO  WK-GYOMU-KJN-YMD-TO
 25898                                  OF WK-GYOMU-ERR-INFO(WK-J)
 25899*---------- メッセージID
 25900*------------------ <残タスク157の対応 START>---------------------
 25901         MOVE  CNS-MSG-E000564
 25902           TO  WK-GYOMU-MSG-ID    OF WK-GYOMU-ERR-INFO(WK-J)
 25903*------------------ <残タスク157の対応 END>-----------------------
 25904*---------- 置換文字
 25905         STRING  CNS-SEC-SBT-GAIBU-CD
 25906                 WK-SEC-SBT-CD-2
 25907                 DELIMITED BY SPACE
 25908                 INTO  WK-GYOMU-TK-MOJI(WK-J,CNS-1)
 25909*---------- フリーメッセージ
 25910         MOVE  WK-TEMP-MSG
 25911           TO  WK-GYOMU-FREE-MSG  OF WK-GYOMU-ERR-INFO(WK-J)
 25912*----------  明細業務エラーフラグ
 25913         MOVE  CNS-ON             TO  FLG-MEISAI-GYOMU-ERR
 25914       WHEN  CNS-RTN-110
 25915*--------------------<DEBUG>--------------------------------------
 25916D    DISPLAY  CNS-PGM-ID":外部コード取得処理  業務エラー"
 25917*-----------------------------------------------------------------
 25918*----------  ワーク実行ステータス
 25919         IF  WK-STATUS < CNS-4
 25920         THEN
 25921           MOVE  CNS-4                 TO  WK-STATUS
 25922         ELSE
 25923           CONTINUE
 25924         END-IF
 25925*----------  ワークリターンコード
 25926         IF  WK-STATUS > WK-RTN-CODE
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 448
* MUSR2651.cob                                                     cpy)cpy)y)y)
 25927         THEN
 25928           MOVE  WK-STATUS           TO  WK-RTN-CODE
 25929         ELSE
 25930           CONTINUE
 25931         END-IF
 25932*----------  1190実行ステータス
 25933         IF  WK-STATUS > WK-1190-STATUS
 25934         THEN
 25935           MOVE  WK-STATUS      TO  WK-1190-STATUS
 25936         ELSE
 25937           CONTINUE
 25938         END-IF
 25939*-------------------<DEBUG>---------------------------------------
 25940D    DISPLAY  CNS-PGM-ID":WK-J=["WK-J"]"
 25941*-----------------------------------------------------------------
 25942         COMPUTE  WK-J = WK-J + CNS-1
 25943*-------------------<DEBUG>---------------------------------------
 25944D    DISPLAY  CNS-PGM-ID":WK-J=["WK-J"]"
 25945*-----------------------------------------------------------------
 25946*----------  基準日実行ステータス
 25947*---------- ファンドコード
 25948         MOVE  WK-FUND-CD-DETAIL  OF  WK-FUND-PTF-DETAIL(WK-IDX-J)
 25949           TO  WK-GYOMU-FUND-CD
 25950                   OF  WK-GYOMU-ERR-INFO(WK-J)
 25951*---------- ポートフォリオコード
 25952         MOVE  WK-PTF-CD-DETAIL   OF  WK-FUND-PTF-DETAIL(WK-IDX-J)
 25953           TO  WK-GYOMU-PTF-CD
 25954                   OF  WK-GYOMU-ERR-INFO(WK-J)
 25955*---------- 評価系列コード
 25956         MOVE  WK-DEFAUL-THYK-CD  OF  WK-FUND-PTF-DETAIL(WK-IDX-J)
 25957            TO  WK-GYOMU-HYK-KRTU-CD
 25958                   OF  WK-GYOMU-ERR-INFO(WK-J)
 25959*---------- 基準日From
 25960         MOVE  WK-KIKAN-FR
 25961           TO  WK-GYOMU-KJN-YMD-FROM
 25962                   OF  WK-GYOMU-ERR-INFO(WK-J)
 25963*---------- 基準日To
 25964         MOVE  WK-KIKAN-TO
 25965           TO  WK-GYOMU-KJN-YMD-TO
 25966                   OF  WK-GYOMU-ERR-INFO(WK-J)
 25967*---------- メッセージID
 25968         MOVE  CNS-MSG-E000090
 25969           TO  WK-GYOMU-MSG-ID
 25970                   OF  WK-GYOMU-ERR-INFO(WK-J)
 25971*---------- 置換文字
 25972         STRING  CNS-SEC-SBT-GAIBU-CD
 25973                 WK-SEC-SBT-CD-2
 25974                 DELIMITED BY SPACE
 25975                 INTO  WK-GYOMU-TK-MOJI(WK-J,CNS-1)
 25976         END-STRING
 25977*---------- フリーメッセージ
 25978         MOVE  WK-TEMP-MSG
 25979           TO  WK-GYOMU-FREE-MSG
 25980                   OF  WK-GYOMU-ERR-INFO(WK-J)
 25981*----------  明細業務エラーフラグ
 25982         MOVE  CNS-ON             TO  FLG-MEISAI-GYOMU-ERR
 25983       WHEN  OTHER
 25984         CONTINUE
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 449
* MUSR2651.cob                                                     cpy)cpy)y)y)
 25985     END-EVALUATE
 25986*--------------------<DEBUG>--------------------------------------
 25987D    DISPLAY  CNS-PGM-ID":WK-SEC-SBT-CD-3=["WK-SEC-SBT-CD-3"]"
 25988D    DISPLAY  CNS-PGM-ID":***  ＧＸ用証券種別コード変換 END  ***"
 25989*-----------------------------------------------------------------
 25990     CONTINUE.
 25991 SUSC0603-EXT.
 25992     EXIT.
 25993******************************************************************
 25994*    ＧＸ用通貨コード→国コード変換ルーチン
 25995******************************************************************
 25996 SUSC0604-RTN           SECTION.
 25997*-------------------<DEBUG>---------------------------------------
 25998D    DISPLAY  CNS-PGM-ID ":***   ＧＸ用通貨コード→国コード変換"
 25999D             "ルーチン   START ***"
 26000*-----------------------------------------------------------------
 26001     INITIALIZE  PARM-SUSC0604-INOUT
 26002                 PARM-RTNPKG
 26003                 WK-KUNI-CD-RYAKU
 26004                 WK-KUNI-FLG
 26005                 WK-TRHK-TUKA-0604
 26006                 WK-RTN-0604
 26007*----------  利用会社コード
 26008     MOVE  WK-RIYO-CMP-CD
 26009       TO  RIYO-CMP-CD                 OF  PARM-SUSC0604-ARG1
 26010*----------  適用開始日
 26011     MOVE  H-ZANTK-YMD                 OF  HST-TBL-SELECT
 26012       TO  TEKIYO-FROM                 OF  PARM-SUSC0604-ARG1
 26013*----------  通貨コード
 26014     MOVE  WK-TRHK-TUKA
 26015       TO  TUKA-CD                     OF  PARM-SUSC0604-ARG1
 26016*--------------------<DEBUG>--------------------------------------
 26017D    DISPLAY  CNS-PGM-ID":PARM-SUSC0604-ARG1:"
 26018D    DISPLAY  CNS-PGM-ID":利用会社コード      =["
 26019D             RIYO-CMP-CD              OF  PARM-SUSC0604-ARG1"]"
 26020D    DISPLAY  CNS-PGM-ID":適用開始日  =["
 26021D             TEKIYO-FROM              OF  PARM-SUSC0604-ARG1"]"
 26022D    DISPLAY  CNS-PGM-ID":通貨コード      =["
 26023D             TUKA-CD                  OF  PARM-SUSC0604-ARG1"]"
 26024*-----------------------------------------------------------------
 26025     CALL   "SUSC0604"              USING  PARM-SUSC0604-INOUT
 26026                                           PARM-RTNPKG
 26027*-------------------<DEBUG>---------------------------------------
 26028D    DISPLAY  CNS-PGM-ID":RTN-CD(SUSC0604) =["
 26029D             RTN-CD  OF  PARM-RTNPKG(COUNTER  OF  PARM-RTNPKG)"]"
 26030*-----------------------------------------------------------------
 26031     MOVE  CNS-ON
 26032       TO  WK-KUNI-FLG
 26033     MOVE  WK-TRHK-TUKA
 26034       TO  WK-TRHK-TUKA-0604
 26035     MOVE  RTN-CD  OF  PARM-RTNPKG(COUNTER  OF  PARM-RTNPKG)
 26036       TO  WK-RTN-0604
 26037     EVALUATE  RTN-CD  OF  PARM-RTNPKG(COUNTER  OF  PARM-RTNPKG)
 26038       WHEN  CNS-RTN-000
 26039*----------  国コード-略式
 26040         MOVE  KUNI-CD-RYAKU           OF  PARM-SUSC0604-ARG2
 26041           TO  WK-KUNI-CD-RYAKU
 26042       WHEN  CNS-RTN-110
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 450
* MUSR2651.cob                                                     cpy)cpy)y)y)
 26043*----------
 26044         IF  WK-1190-STATUS < CNS-4
 26045         THEN
 26046           MOVE  CNS-4          TO  WK-1190-STATUS
 26047         ELSE
 26048           CONTINUE
 26049         END-IF
 26050*
 26051         IF  WK-STATUS < CNS-4
 26052         THEN
 26053           MOVE  CNS-4          TO  WK-STATUS
 26054         ELSE
 26055           CONTINUE
 26056         END-IF
 26057*----------  ワークリターンコード
 26058         IF  WK-RTN-CODE < CNS-4
 26059         THEN
 26060           MOVE  CNS-4          TO  WK-RTN-CODE
 26061         ELSE
 26062           CONTINUE
 26063         END-IF
 26064*----------  ワーク業務エラーパッケージを編集
 26065*-------------------<DEBUG>---------------------------------------
 26066D    DISPLAY  CNS-PGM-ID":WK-J =[" WK-J"]"
 26067*-----------------------------------------------------------------
 26068         COMPUTE  WK-J = WK-J + 1
 26069*-------------------<DEBUG>---------------------------------------
 26070D    DISPLAY  CNS-PGM-ID":WK-J =[" WK-J"]"
 26071*-----------------------------------------------------------------
 26072*---------- ファンドコード
 26073         MOVE  WK-FUND-CD-DETAIL     OF  WK-PTF-ATT-DATA(WK-IDX-J)
 26074           TO  WK-GYOMU-FUND-CD      OF  WK-GYOMU-ERR-INFO(WK-J)
 26075*---------- ポートフォリオコード
 26076         MOVE  WK-PTF-CD-DETAIL      OF  WK-PTF-ATT-DATA(WK-IDX-J)
 26077           TO  WK-GYOMU-PTF-CD       OF  WK-GYOMU-ERR-INFO(WK-J)
 26078*---------- 評価系列コード
 26079         MOVE  WK-DEFAUL-THYK-CD     OF  WK-PTF-ATT-DATA(WK-IDX-J)
 26080           TO  WK-GYOMU-HYK-KRTU-CD  OF  WK-GYOMU-ERR-INFO(WK-J)
 26081*---------- 帳票ID
 26082         MOVE  SPACE
 26083           TO  WK-GYOMU-REP-ID        OF  WK-GYOMU-ERR-INFO(WK-J)
 26084*---------- 帳票任意コード
 26085         MOVE  SPACE
 26086           TO  WK-GYOMU-REP-ANY-CD    OF  WK-GYOMU-ERR-INFO(WK-J)
 26087*---------- 基準日From
 26088         MOVE  WK-KIKAN-FR
 26089           TO  WK-GYOMU-KJN-YMD-FROM  OF  WK-GYOMU-ERR-INFO(WK-J)
 26090*---------- 基準日To
 26091         MOVE  WK-KIKAN-TO
 26092           TO  WK-GYOMU-KJN-YMD-TO    OF  WK-GYOMU-ERR-INFO(WK-J)
 26093*---------- メッセージID
 26094         MOVE  CNS-MSG-E000090
 26095           TO  WK-GYOMU-MSG-ID        OF  WK-GYOMU-ERR-INFO(WK-J)
 26096*---------- 置換文字
 26097         MOVE  CNS-KUNI-CD-RYAKU
 26098           TO  WK-GYOMU-TK-MOJI(WK-J,CNS-1)
 26099*---------- フリーメッセージ
 26100         STRING  CNS-TRHK-TUKA-CD
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 451
* MUSR2651.cob                                                     cpy)cpy)y)y)
 26101                 WK-TRHK-TUKA
 26102                 CNS-KZYN-YMD
 26103                 H-ZANTK-YMD          OF  HST-TBL-SELECT
 26104                 DELIMITED BY SPACE
 26105                 INTO WK-GYOMU-FREE-MSG OF WK-GYOMU-ERR-INFO(WK-J)
 26106         END-STRING
 26107*----------  後処理業務エラーフラグ
 26108         MOVE  CNS-ON                 TO  FLG-MEISAI-GYOMU-ERR
 26109       WHEN  OTHER
 26110*----------  進捗管理フラグ
 26111         MOVE  CNS-16               TO  WK-1190-STATUS
 26112*----------  ワーク実行ステータス
 26113         MOVE  CNS-16               TO  WK-STATUS
 26114*----------  ワークリターンコード
 26115         MOVE  CNS-16               TO  WK-RTN-CODE
 26116*----------  サブエラーメッセージ出力処理
 26117         PERFORM  SUB-ERR-MSG-RTN
 26118*----------  ワークエラーパッケージを編集
 26119         INITIALIZE  WK-SYS-ERR-INFO
 26120*----------  エラー検知プログラムID
 26121         MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
 26122*----------  ポジション
 26123         MOVE  CNS-POS-054          TO  WK-ERR-POS
 26124*----------  リターンコード
 26125         MOVE  CNS-RTN-901          TO  WK-RTN-CD
 26126*----------  詳細リターンコード
 26127         MOVE  RTN-CD
 26128           OF  PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
 26129                                    TO  WK-DETAIL-RTN-CD
 26130*----------  詳細リターンコードデコードフラグ
 26131         MOVE  CNS-DETAIL-0         TO  WK-DETAIL-RTN-CD-FLG
 26132*---------- フリーメッセージ
 26133         MOVE  SPACE                TO  WK-FREE-MSG
 26134*----------  エラー情報追加処理
 26135         PERFORM  ERR-INFO-ADD-RTN
 26136     END-EVALUATE
 26137*-------------------<DEBUG>---------------------------------------
 26138D    DISPLAY  CNS-PGM-ID":WK-KUNI-CD-RYAKU=["
 26139D             WK-KUNI-CD-RYAKU"]"
 26140D    DISPLAY  CNS-PGM-ID ":***  ＧＸ用通貨コード→国コード変換"
 26141D             "ルーチン   END ***"
 26142*-----------------------------------------------------------------
 26143     CONTINUE.
 26144 SUSC0604-EXT.
 26145     EXIT.
 26146******************************************************************
 26147*    外部銘柄コード変換ルーチン
 26148******************************************************************
 26149 SCZY3002-CHAN-3-RTN    SECTION.
 26150*--------------------<DEBUG>--------------------------------------
 26151D    DISPLAY  CNS-PGM-ID":***  外部銘柄コード変換ルーチン"
 26152D             " START  ***"
 26153*-----------------------------------------------------------------
 26154     INITIALIZE  PARM-SCZY3002-INOUT
 26155                 PARM-RTNPKG
 26156                 WK-RTN-3002-2
 26157*----------  利用会社コード
 26158     MOVE  WK-RIYO-CMP-CD         OF  WK-ARGUMENT
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 452
* MUSR2651.cob                                                     cpy)cpy)y)y)
 26159       TO  RIYO-CMP-CD            OF  PARM-SCZY3002-ARG1
 26160*----------  内部銘柄コード
 26161     MOVE  H-MEG-CD               OF  HST-TBL-SELECT
 26162       TO  NAIBU-MEG-CD           OF  PARM-SCZY3002-ARG1
 26163*---------- 商品分類コード
 26164     MOVE  SPACE
 26165       TO  SYOHIN-BUNRUI-CD       OF  PARM-SCZY3002-ARG1
 26166*---------- 証券種別コード
 26167     IF  H-DATA-KBN  =  CNS-X-1
 26168     THEN
 26169       MOVE  SPACE
 26170         TO  SEC-SBT-CD           OF  PARM-SCZY3002-ARG1
 26171     ELSE
 26172       MOVE  H-SEC-SBT-CD
 26173         TO  SEC-SBT-CD           OF  PARM-SCZY3002-ARG1
 26174     END-IF
 26175*---------- 元証券種別コード
 26176     MOVE  SPACE
 26177       TO  MOTO-SEC-SBT-CD        OF  PARM-SCZY3002-ARG1
 26178*----------  基準日
 26179     MOVE  H-ZANTK-YMD            OF  HST-TBL-SELECT
 26180       TO  KJN-YMD                OF  PARM-SCZY3002-ARG1
 26181*--------------------<DEBUG>--------------------------------------
 26182D    DISPLAY  CNS-PGM-ID":RIYO-CMP-CD=["
 26183D             RIYO-CMP-CD         OF  PARM-SCZY3002-ARG1"]"
 26184D    DISPLAY  CNS-PGM-ID":NAIBU-MEG-CD=["
 26185D             NAIBU-MEG-CD        OF  PARM-SCZY3002-ARG1"]"
 26186D    DISPLAY  CNS-PGM-ID":SYOHIN-BUNRUI-CD=["
 26187D             SYOHIN-BUNRUI-CD    OF  PARM-SCZY3002-ARG1"]"
 26188D    DISPLAY  CNS-PGM-ID":テータ区分=["
 26189D             H-DATA-KBN "]"
 26190D    DISPLAY  CNS-PGM-ID":SEC-SBT-CD=["
 26191D             SEC-SBT-CD          OF  PARM-SCZY3002-ARG1"]"
 26192D    DISPLAY  CNS-PGM-ID":MOTO-SEC-SBT-CD=["
 26193D             MOTO-SEC-SBT-CD     OF  PARM-SCZY3002-ARG1"]"
 26194D    DISPLAY  CNS-PGM-ID":MEG-TUKA-CD=["
 26195D             MEG-TUKA-CD         OF  PARM-SCZY3002-ARG1"]"
 26196D    DISPLAY  CNS-PGM-ID":CD-REF-KRTU-CD=["
 26197D             CD-REF-KRTU-CD      OF  PARM-SCZY3002-ARG1"]"
 26198D    DISPLAY  CNS-PGM-ID":KJN-YMD=["
 26199D             KJN-YMD             OF  PARM-SCZY3002-ARG1"]"
 26200D    DISPLAY  CNS-PGM-ID":GYOMU-TASK-ID=["
 26201D             GYOMU-TASK-ID       OF  PARM-SCZY3002-ARG1"]"
 26202D    DISPLAY  CNS-PGM-ID":***  CALL SCZY3002 START  ***"
 26203*-----------------------------------------------------------------
 26204     CALL  "SCZY3002"             USING  PARM-SCZY3002-INOUT
 26205                                         PARM-RTNPKG
 26206*--------------------<DEBUG>--------------------------------------
 26207D    DISPLAY  CNS-PGM-ID":***  CALL SCZY3002 END  ***"
 26208D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY3002)       =["
 26209D             RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)"]"
 26210D    DISPLAY  CNS-PGM-ID":COUNTER OF PARM-RTNPKG =["
 26211D             COUNTER             OF PARM-RTNPKG "]"
 26212*-----------------------------------------------------------------
 26213     MOVE  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
 26214       TO  WK-RTN-3002-2
 26215     EVALUATE  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
 26216*----------  正常
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 453
* MUSR2651.cob                                                     cpy)cpy)y)y)
 26217       WHEN  CNS-RTN-000
 26218*----------  ワーク実行ステータス
 26219         IF   WK-STATUS < CNS-4
 26220         THEN
 26221           MOVE  CNS-4              TO  WK-STATUS
 26222         ELSE
 26223           CONTINUE
 26224         END-IF
 26225*----------  1190実行ステータス
 26226         IF   WK-STATUS > WK-1190-STATUS
 26227         THEN
 26228           MOVE  WK-STATUS      TO  WK-1190-STATUS
 26229         ELSE
 26230           CONTINUE
 26231         END-IF
 26232*----------  ワークリターンコード
 26233         IF  WK-STATUS > WK-RTN-CODE
 26234         THEN
 26235           MOVE  WK-STATUS        TO  WK-RTN-CODE
 26236         ELSE
 26237           CONTINUE
 26238         END-IF
 26239*-------------------<DEBUG>---------------------------------------
 26240D    DISPLAY  CNS-PGM-ID":WK-J=["WK-J"]"
 26241*-----------------------------------------------------------------
 26242         COMPUTE  WK-J = WK-J + CNS-1
 26243*-------------------<DEBUG>---------------------------------------
 26244D    DISPLAY  CNS-PGM-ID":WK-J=["WK-J"]"
 26245*-----------------------------------------------------------------
 26246*---------- ファンドコード
 26247         MOVE  WK-FUND-CD-DETAIL  OF  WK-FUND-PTF-DETAIL(WK-IDX-J)
 26248           TO  WK-GYOMU-FUND-CD   OF
 26249                                  WK-GYOMU-ERR-INFO(WK-J)
 26250*---------- ポートフォリオコード
 26251         MOVE  WK-PTF-CD-DETAIL   OF  WK-FUND-PTF-DETAIL(WK-IDX-J)
 26252           TO  WK-GYOMU-PTF-CD    OF
 26253                                  WK-GYOMU-ERR-INFO(WK-J)
 26254*---------- 評価系列コード
 26255         MOVE  WK-DEFAUL-THYK-CD  OF  WK-FUND-PTF-DETAIL(WK-IDX-J)
 26256            TO  WK-GYOMU-HYK-KRTU-CD
 26257                   OF  WK-GYOMU-ERR-INFO(WK-J)
 26258*---------- 基準日From
 26259         MOVE  WK-KIKAN-FR
 26260           TO  WK-GYOMU-KJN-YMD-FROM
 26261                                  OF WK-GYOMU-ERR-INFO(WK-J)
 26262*---------- 基準日To
 26263         MOVE  WK-KIKAN-TO
 26264           TO  WK-GYOMU-KJN-YMD-TO
 26265                                  OF WK-GYOMU-ERR-INFO(WK-J)
 26266*---------- メッセージID
 26267         MOVE  CNS-MSG-E000090
 26268           TO  WK-GYOMU-MSG-ID    OF WK-GYOMU-ERR-INFO(WK-J)
 26269*---------- 置換文字
 26270         MOVE  CNS-MEG-CD-AIFA
 26271           TO  WK-GYOMU-TK-MOJI(WK-J,CNS-1)
 26272*---------- フリーメッセージ
 26273         STRING  CNS-YKJ
 26274                 H-ZANTK-YMD      OF  HST-TBL-SELECT
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 454
* MUSR2651.cob                                                     cpy)cpy)y)y)
 26275                 CNS-GAIBU-CD
 26276                 GAIBU-MEG-CD     OF  PARM-SCZY3002-ARG2
 26277                 DELIMITED BY SIZE
 26278                 INTO WK-GYOMU-FREE-MSG OF WK-GYOMU-ERR-INFO(WK-J)
 26279         END-STRING
 26280*----------  明細業務エラーフラグ
 26281         MOVE  CNS-ON             TO  FLG-MEISAI-GYOMU-ERR
 26282*----------  異常
 26283       WHEN  CNS-RTN-110
 26284       WHEN  CNS-RTN-002
 26285*----------  ワーク実行ステータス
 26286         IF   WK-STATUS < CNS-4
 26287         THEN
 26288           MOVE  CNS-4              TO  WK-STATUS
 26289         ELSE
 26290           CONTINUE
 26291         END-IF
 26292*----------  1190実行ステータス
 26293         IF   WK-STATUS > WK-1190-STATUS
 26294         THEN
 26295           MOVE  WK-STATUS      TO  WK-1190-STATUS
 26296         ELSE
 26297           CONTINUE
 26298         END-IF
 26299*----------  ワークリターンコード
 26300         IF  WK-STATUS > WK-RTN-CODE
 26301         THEN
 26302           MOVE  WK-STATUS        TO  WK-RTN-CODE
 26303         ELSE
 26304           CONTINUE
 26305         END-IF
 26306*-------------------<DEBUG>---------------------------------------
 26307D    DISPLAY  CNS-PGM-ID":WK-J=["WK-J"]"
 26308*-----------------------------------------------------------------
 26309         COMPUTE  WK-J = WK-J + CNS-1
 26310*-------------------<DEBUG>---------------------------------------
 26311D    DISPLAY  CNS-PGM-ID":WK-J=["WK-J"]"
 26312*-----------------------------------------------------------------
 26313*---------- ファンドコード
 26314         MOVE  WK-FUND-CD-DETAIL  OF  WK-FUND-PTF-DETAIL(WK-IDX-J)
 26315           TO  WK-GYOMU-FUND-CD   OF
 26316                                  WK-GYOMU-ERR-INFO(WK-J)
 26317*---------- ポートフォリオコード
 26318         MOVE  WK-PTF-CD-DETAIL   OF  WK-FUND-PTF-DETAIL(WK-IDX-J)
 26319           TO  WK-GYOMU-PTF-CD    OF
 26320                                  WK-GYOMU-ERR-INFO(WK-J)
 26321*---------- 評価系列コード
 26322         MOVE  WK-DEFAUL-THYK-CD  OF  WK-FUND-PTF-DETAIL(WK-IDX-J)
 26323            TO  WK-GYOMU-HYK-KRTU-CD
 26324                   OF  WK-GYOMU-ERR-INFO(WK-J)
 26325*---------- 基準日From
 26326         MOVE  WK-KIKAN-FR
 26327           TO  WK-GYOMU-KJN-YMD-FROM
 26328                                  OF WK-GYOMU-ERR-INFO(WK-J)
 26329*---------- 基準日To
 26330         MOVE  WK-KIKAN-TO
 26331           TO  WK-GYOMU-KJN-YMD-TO
 26332                                  OF WK-GYOMU-ERR-INFO(WK-J)
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 455
* MUSR2651.cob                                                     cpy)cpy)y)y)
 26333*---------- メッセージID
 26334         MOVE  CNS-MSG-E000090
 26335           TO  WK-GYOMU-MSG-ID    OF WK-GYOMU-ERR-INFO(WK-J)
 26336*---------- 置換文字
 26337         MOVE  CNS-MEG-CD-AIFA
 26338           TO  WK-GYOMU-TK-MOJI(WK-J,CNS-1)
 26339*---------- フリーメッセージ
 26340         MOVE  WK-TEMP-MSG
 26341           TO  WK-GYOMU-FREE-MSG  OF WK-GYOMU-ERR-INFO(WK-J)
 26342*----------  明細業務エラーフラグ
 26343         MOVE  CNS-ON             TO  FLG-MEISAI-GYOMU-ERR
 26344       WHEN  CNS-RTN-800
 26345*----------  ワーク実行ステータス
 26346         IF  WK-STATUS < CNS-4
 26347         THEN
 26348           MOVE  CNS-4                 TO  WK-STATUS
 26349         ELSE
 26350           CONTINUE
 26351         END-IF
 26352*----------  ワークリターンコード
 26353         IF  WK-STATUS > WK-RTN-CODE
 26354         THEN
 26355           MOVE  WK-STATUS           TO  WK-RTN-CODE
 26356         ELSE
 26357           CONTINUE
 26358         END-IF
 26359*----------  1190実行ステータス
 26360         IF  WK-STATUS > WK-1190-STATUS
 26361         THEN
 26362           MOVE  WK-STATUS      TO  WK-1190-STATUS
 26363         ELSE
 26364           CONTINUE
 26365         END-IF
 26366*-------------------<DEBUG>---------------------------------------
 26367D    DISPLAY  CNS-PGM-ID":WK-J=["WK-J"]"
 26368*-----------------------------------------------------------------
 26369         COMPUTE  WK-J = WK-J + CNS-1
 26370*-------------------<DEBUG>---------------------------------------
 26371D    DISPLAY  CNS-PGM-ID":WK-J=["WK-J"]"
 26372*-----------------------------------------------------------------
 26373*----------  基準日実行ステータス
 26374*---------- ファンドコード
 26375         MOVE  WK-FUND-CD-DETAIL  OF  WK-FUND-PTF-DETAIL(WK-IDX-J)
 26376           TO  WK-GYOMU-FUND-CD
 26377                   OF  WK-GYOMU-ERR-INFO(WK-J)
 26378*---------- ポートフォリオコード
 26379         MOVE  WK-PTF-CD-DETAIL   OF  WK-FUND-PTF-DETAIL(WK-IDX-J)
 26380           TO  WK-GYOMU-PTF-CD
 26381                   OF  WK-GYOMU-ERR-INFO(WK-J)
 26382*---------- 評価系列コード
 26383         MOVE  WK-DEFAUL-THYK-CD  OF  WK-FUND-PTF-DETAIL(WK-IDX-J)
 26384            TO  WK-GYOMU-HYK-KRTU-CD
 26385                   OF  WK-GYOMU-ERR-INFO(WK-J)
 26386*---------- 基準日From
 26387         MOVE  WK-KIKAN-FR
 26388           TO  WK-GYOMU-KJN-YMD-FROM
 26389                   OF  WK-GYOMU-ERR-INFO(WK-J)
 26390*---------- 基準日To
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 456
* MUSR2651.cob                                                     cpy)cpy)y)y)
 26391         MOVE  WK-KIKAN-TO
 26392           TO  WK-GYOMU-KJN-YMD-TO
 26393                   OF  WK-GYOMU-ERR-INFO(WK-J)
 26394*---------- メッセージID
 26395         MOVE  CNS-MSG-E000189
 26396           TO  WK-GYOMU-MSG-ID
 26397                   OF  WK-GYOMU-ERR-INFO(WK-J)
 26398*---------- 置換文字
 26399         MOVE  SPACE
 26400           TO  WK-GYOMU-TK-MOJI(WK-J,CNS-1)
 26401*---------- フリーメッセージ
 26402         MOVE  WK-TEMP-MSG
 26403           TO  WK-GYOMU-FREE-MSG
 26404                   OF  WK-GYOMU-ERR-INFO(WK-J)
 26405*----------  明細業務エラーフラグ
 26406         MOVE  CNS-ON             TO  FLG-MEISAI-GYOMU-ERR
 26407*----------  上記以外
 26408       WHEN  OTHER
 26409*--------------------<DEBUG>--------------------------------------
 26410D    DISPLAY  CNS-PGM-ID":外部銘柄コード変換ルーチン  エラー"
 26411*-----------------------------------------------------------------
 26412*----------  WK-STATUS
 26413         MOVE  CNS-16              TO  WK-STATUS
 26414*----------  1190実行ステータス
 26415         MOVE  CNS-16              TO  WK-1190-STATUS
 26416*----------  ワークリターンコード
 26417         MOVE  CNS-16              TO  WK-RTN-CODE
 26418*----------  ワークエラーパッケージを編集
 26419         PERFORM  SUB-ERR-MSG-RTN
 26420         INITIALIZE  WK-SYS-ERR-INFO
 26421*----------  エラー検知プログラムID
 26422         MOVE  CNS-PGM-ID         TO  WK-ERR-PGM-ID
 26423*----------  ポジション
 26424         MOVE  CNS-POS-055        TO  WK-ERR-POS
 26425*----------  リターンコード
 26426         MOVE  CNS-RTN-901        TO  WK-RTN-CD
 26427*----------  詳細リターンコード
 26428         MOVE  RTN-CD             OF  PARM-RTNPKG
 26429                                  (COUNTER OF PARM-RTNPKG)
 26430                                  TO  WK-DETAIL-RTN-CD
 26431*----------  詳細リターンコードデコードフラグ
 26432         MOVE  CNS-DETAIL-0       TO  WK-DETAIL-RTN-CD-FLG
 26433*---------- フリーメッセージ
 26434         MOVE  SPACE              TO  WK-FREE-MSG
 26435*----------  エラー情報追加処理
 26436         PERFORM  ERR-INFO-ADD-RTN
 26437     END-EVALUATE
 26438*--------------------<DEBUG>--------------------------------------
 26439D    DISPLAY  CNS-PGM-ID":***  外部銘柄コード変換ルーチン"
 26440D             " END  ***"
 26441*-----------------------------------------------------------------
 26442     CONTINUE.
 26443 SCZY3002-CHAN-3-EXT.
 26444     EXIT.
 26445******************************************************************
 26446*    約定ファイル05名作成処理
 26447******************************************************************
 26448 GET-FILE-5-NAME-RTN    SECTION.
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 457
* MUSR2651.cob                                                     cpy)cpy)y)y)
 26449*--------------------<DEBUG>--------------------------------------
 26450D    DISPLAY  CNS-PGM-ID":約定ファイル05名作成処理  START "
 26451*-----------------------------------------------------------------
 26452     STRING  CNS-RX-TEXT               DELIMITED BY SPACE
 26453             WK-RIYO-CMP-CD            DELIMITED BY SPACE
 26454             "_"                       DELIMITED BY SPACE
 26455             WK-SHORI-YMD              DELIMITED BY SPACE
 26456             "_"                       DELIMITED BY SPACE
 26457             WK-KIDOU-ID               DELIMITED BY SPACE
 26458             "_"                       DELIMITED BY SPACE
 26459             WK-GYOMU-TASK-ID          DELIMITED BY SPACE
 26460             "_05"                     DELIMITED BY SPACE
 26461                                       INTO  WK-FILE-5-NAME
 26462     END-STRING
 26463     STRING  WK-FILE-PASS              DELIMITED BY SPACE
 26464             "/"                       DELIMITED BY SPACE
 26465             WK-FILE-5-NAME            DELIMITED BY SPACE
 26466                                       INTO  WK-PSACT-DAT-FILE-5
 26467     END-STRING
 26468*--------------------<DEBUG>--------------------------------------
 26469D    DISPLAY  CNS-PGM-ID":W.約定ファイル名=["WK-FILE-5-NAME"]"
 26470D    DISPLAY  CNS-PGM-ID":約定ファイルパス=["WK-FILE-PASS"]"
 26471D    DISPLAY  CNS-PGM-ID":パス付けDAT約定ファイル=["
 26472D             WK-PSACT-DAT-FILE-5"]"
 26473D    DISPLAY  CNS-PGM-ID": 約定ファイル名作成処理  END  *****"
 26474*-----------------------------------------------------------------
 26475     CONTINUE.
 26476 GET-FILE-5-NAME-EXT.
 26477     EXIT.
 26478******************************************************************
 26479*    約定ファイル05オープン
 26480******************************************************************
 26481 OPEN-FILE-5-RTN        SECTION.
 26482     MOVE FUNCTION CURRENT-DATE(1:14) TO WK-RUN-SDATETIME
 26483*-------------------<DEBUG>---------------------------------------
 26484     DISPLAY "プログラムID:        ["CNS-PGM-ID"]"                GUT2013
 26485     DISPLAY "セクション:          [OPEN-FILE-5-RTN]"             GUT2013
 26486     DISPLAY "セクションの開始時間:["WK-RUN-SDATETIME"]"          GUT2013
 26487*-----------------------------------------------------------------
 26488*--------------------<DEBUG>--------------------------------------
 26489D    DISPLAY   CNS-PGM-ID":約定ファイル05オープン  START "
 26490*-----------------------------------------------------------------
 26491     MOVE  CNS-OFF                     TO  FLG-FILE-OPEN-5
 26492     MOVE  WK-PSACT-DAT-FILE-5         TO  OUTFILE-5
 26493     OPEN  OUTPUT OUT-FILE-5
 26494*-------------------<DEBUG>---------------------------------------
 26495D    DISPLAY  CNS-PGM-ID":FILE-STATUS-5=[" WK-FILE-STATUS-5 "]"
 26496*-----------------------------------------------------------------
 26497     EVALUATE  WK-FILE-STATUS-5
 26498       WHEN  CNS-FILE-NORMAL
 26499         MOVE  CNS-ON                  TO  FLG-FILE-OPEN-5
 26500*--------------------<DEBUG>--------------------------------------
 26501D    DISPLAY  CNS-PGM-ID":DAT約定ファイル05オープン正常"
 26502*-----------------------------------------------------------------
 26503       WHEN  OTHER
 26504*--------------------<DEBUG>--------------------------------------
 26505D    DISPLAY  CNS-PGM-ID":DAT約定ファイル05オープンエラー"
 26506*-----------------------------------------------------------------
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 458
* MUSR2651.cob                                                     cpy)cpy)y)y)
 26507*----------  メッセージ出力用 RTNパッケージの設定
 26508*----------  ワークリターンコード
 26509       MOVE  CNS-RTN-BT16         TO  WK-RTN-CODE
 26510       INITIALIZE  WK-SYS-ERR-INFO
 26511*----------  エラー検知プログラムID
 26512       MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
 26513*----------  ポジション
 26514       MOVE  CNS-POS-056          TO  WK-ERR-POS
 26515*----------  リターンコード
 26516       MOVE  CNS-RTN-200          TO  WK-RTN-CD
 26517*----------  詳細リターンコード
 26518       MOVE  FUNCTION NUMVAL(WK-FILE-STATUS-5)
 26519         TO  WK-DETAIL-RTN-CD
 26520*----------  詳細リターンコードデコードフラグ
 26521       MOVE  CNS-DETAIL-0         TO  WK-DETAIL-RTN-CD-FLG
 26522       MOVE  SPACE                TO  WK-FREE-MSG
 26523       STRING  "ファイル:["
 26524               WK-PSACT-DAT-FILE-5
 26525               "]オープンエラー"
 26526         DELIMITED BY SIZE         INTO  WK-FREE-MSG
 26527       END-STRING
 26528       PERFORM  ERR-RTN
 26529     END-EVALUATE
 26530*--------------------<DEBUG>--------------------------------------
 26531D    DISPLAY  CNS-PGM-ID":約定ファイル05オープンフラグ=["
 26532D             FLG-FILE-OPEN-5 "]"
 26533D    DISPLAY  CNS-PGM-ID":約定ファイル05オープン処理  END "
 26534*-----------------------------------------------------------------
 26535     MOVE FUNCTION CURRENT-DATE(1:14) TO WK-RUN-EDATETIME
 26536*--------------------<DEBUG>--------------------------------------
 26537     DISPLAY "プログラムID:        ["CNS-PGM-ID"]"                GUT2013
 26538     DISPLAY "セクション:          [OPEN-FILE-5-RTN]"             GUT2013
 26539     DISPLAY "セクションの終了時間:["WK-RUN-EDATETIME"]"          GUT2013
 26540*-----------------------------------------------------------------
 26541     CONTINUE.
 26542 OPEN-FILE-5-EXT.
 26543     EXIT.
 26544******************************************************************
 26545*    受渡ファイル06名作成処理
 26546******************************************************************
 26547 GET-FILE-6-NAME-RTN    SECTION.
 26548*--------------------<DEBUG>--------------------------------------
 26549D    DISPLAY  CNS-PGM-ID":受渡ファイル06名作成処理  START "
 26550*-----------------------------------------------------------------
 26551     STRING  CNS-RX-TEXT               DELIMITED BY SPACE
 26552             WK-RIYO-CMP-CD            DELIMITED BY SPACE
 26553             "_"                       DELIMITED BY SPACE
 26554             WK-SHORI-YMD              DELIMITED BY SPACE
 26555             "_"                       DELIMITED BY SPACE
 26556             WK-KIDOU-ID               DELIMITED BY SPACE
 26557             "_"                       DELIMITED BY SPACE
 26558             WK-GYOMU-TASK-ID          DELIMITED BY SPACE
 26559             "_06"                     DELIMITED BY SPACE
 26560                                       INTO  WK-FILE-6-NAME
 26561     END-STRING
 26562     STRING  WK-FILE-PASS              DELIMITED BY SPACE
 26563             "/"                       DELIMITED BY SPACE
 26564             WK-FILE-6-NAME            DELIMITED BY SPACE
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 459
* MUSR2651.cob                                                     cpy)cpy)y)y)
 26565                                       INTO  WK-PSACT-DAT-FILE-6
 26566     END-STRING
 26567*--------------------<DEBUG>--------------------------------------
 26568D    DISPLAY  CNS-PGM-ID":W.受渡ファイル名=["WK-FILE-6-NAME"]"
 26569D    DISPLAY  CNS-PGM-ID":受渡ファイルパス=["WK-FILE-PASS"]"
 26570D    DISPLAY  CNS-PGM-ID":パス付けDAT受渡ファイル=["
 26571D             WK-PSACT-DAT-FILE-6"]"
 26572D    DISPLAY  CNS-PGM-ID": 受渡ファイル名作成処理  END  *****"
 26573*-----------------------------------------------------------------
 26574     CONTINUE.
 26575 GET-FILE-6-NAME-EXT.
 26576     EXIT.
 26577******************************************************************
 26578*    受渡ファイル06オープン
 26579******************************************************************
 26580 OPEN-FILE-6-RTN        SECTION.
 26581     MOVE FUNCTION CURRENT-DATE(1:14) TO WK-RUN-SDATETIME
 26582*-------------------<DEBUG>---------------------------------------
 26583     DISPLAY "プログラムID:        ["CNS-PGM-ID"]"                GUT2013
 26584     DISPLAY "セクション:          [OPEN-FILE-6-RTN]"             GUT2013
 26585     DISPLAY "セクションの開始時間:["WK-RUN-SDATETIME"]"          GUT2013
 26586*-----------------------------------------------------------------
 26587*--------------------<DEBUG>--------------------------------------
 26588D    DISPLAY   CNS-PGM-ID":受渡ファイル06オープン  START "
 26589*-----------------------------------------------------------------
 26590     MOVE  CNS-OFF                     TO  FLG-FILE-OPEN-6
 26591     MOVE  WK-PSACT-DAT-FILE-6         TO  OUTFILE-6
 26592     OPEN  OUTPUT OUT-FILE-6
 26593*-------------------<DEBUG>---------------------------------------
 26594D    DISPLAY  CNS-PGM-ID":FILE-STATUS-6=[" WK-FILE-STATUS-6 "]"
 26595*-----------------------------------------------------------------
 26596     EVALUATE  WK-FILE-STATUS-6
 26597       WHEN  CNS-FILE-NORMAL
 26598         MOVE  CNS-ON                  TO  FLG-FILE-OPEN-6
 26599*--------------------<DEBUG>--------------------------------------
 26600D    DISPLAY  CNS-PGM-ID":DAT受渡ファイル06オープン正常"
 26601*-----------------------------------------------------------------
 26602       WHEN  OTHER
 26603*--------------------<DEBUG>--------------------------------------
 26604D    DISPLAY  CNS-PGM-ID":DAT受渡ファイル06オープンエラー"
 26605*-----------------------------------------------------------------
 26606*----------  メッセージ出力用 RTNパッケージの設定
 26607*----------  ワークリターンコード
 26608       MOVE  CNS-RTN-BT16         TO  WK-RTN-CODE
 26609       INITIALIZE  WK-SYS-ERR-INFO
 26610*----------  エラー検知プログラムID
 26611       MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
 26612*----------  ポジション
 26613       MOVE  CNS-POS-057          TO  WK-ERR-POS
 26614*----------  リターンコード
 26615       MOVE  CNS-RTN-200          TO  WK-RTN-CD
 26616*----------  詳細リターンコード
 26617       MOVE  FUNCTION NUMVAL(WK-FILE-STATUS-6)
 26618         TO  WK-DETAIL-RTN-CD
 26619*----------  詳細リターンコードデコードフラグ
 26620       MOVE  CNS-DETAIL-0         TO  WK-DETAIL-RTN-CD-FLG
 26621       MOVE  SPACE                TO  WK-FREE-MSG
 26622       STRING  "ファイル:["
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 460
* MUSR2651.cob                                                     cpy)cpy)y)y)
 26623               WK-PSACT-DAT-FILE-6
 26624               "]オープンエラー"
 26625         DELIMITED BY SIZE         INTO  WK-FREE-MSG
 26626       END-STRING
 26627       PERFORM  ERR-RTN
 26628     END-EVALUATE
 26629*--------------------<DEBUG>--------------------------------------
 26630D    DISPLAY  CNS-PGM-ID":受渡ファイル06オープンフラグ=["
 26631D             FLG-FILE-OPEN-6 "]"
 26632D    DISPLAY  CNS-PGM-ID":受渡ファイル06オープン処理  END "
 26633*-----------------------------------------------------------------
 26634     MOVE FUNCTION CURRENT-DATE(1:14) TO WK-RUN-EDATETIME
 26635*--------------------<DEBUG>--------------------------------------
 26636     DISPLAY "プログラムID:        ["CNS-PGM-ID"]"                GUT2013
 26637     DISPLAY "セクション:          [OPEN-FILE-6-RTN]"             GUT2013
 26638     DISPLAY "セクションの終了時間:["WK-RUN-EDATETIME"]"          GUT2013
 26639*-----------------------------------------------------------------
 26640     CONTINUE.
 26641 OPEN-FILE-6-EXT.
 26642     EXIT.
 26643******************************************************************
 26644*    約定ファイル07名作成処理
 26645******************************************************************
 26646 GET-FILE-7-NAME-RTN    SECTION.
 26647*--------------------<DEBUG>--------------------------------------
 26648D    DISPLAY  CNS-PGM-ID":約定ファイル07名作成処理  START "
 26649*-----------------------------------------------------------------
 26650     STRING  CNS-RX-TEXT               DELIMITED BY SPACE
 26651             WK-RIYO-CMP-CD            DELIMITED BY SPACE
 26652             "_"                       DELIMITED BY SPACE
 26653             WK-SHORI-YMD              DELIMITED BY SPACE
 26654             "_"                       DELIMITED BY SPACE
 26655             WK-KIDOU-ID               DELIMITED BY SPACE
 26656             "_"                       DELIMITED BY SPACE
 26657             WK-GYOMU-TASK-ID          DELIMITED BY SPACE
 26658             "_07"                     DELIMITED BY SPACE
 26659                                       INTO  WK-FILE-7-NAME
 26660     END-STRING
 26661     STRING  WK-FILE-PASS              DELIMITED BY SPACE
 26662             "/"                       DELIMITED BY SPACE
 26663             WK-FILE-7-NAME            DELIMITED BY SPACE
 26664                                       INTO  WK-PSACT-DAT-FILE-7
 26665     END-STRING
 26666*--------------------<DEBUG>--------------------------------------
 26667D    DISPLAY  CNS-PGM-ID":W.約定ファイル名=["WK-FILE-7-NAME"]"
 26668D    DISPLAY  CNS-PGM-ID":約定ファイルパス=["WK-FILE-PASS"]"
 26669D    DISPLAY  CNS-PGM-ID":パス付けDAT約定ファイル=["
 26670D             WK-PSACT-DAT-FILE-7"]"
 26671D    DISPLAY  CNS-PGM-ID": 約定ファイル名作成処理  END  *****"
 26672*-----------------------------------------------------------------
 26673     CONTINUE.
 26674 GET-FILE-7-NAME-EXT.
 26675     EXIT.
 26676******************************************************************
 26677*    約定ファイル07オープン
 26678******************************************************************
 26679 OPEN-FILE-7-RTN        SECTION.
 26680     MOVE FUNCTION CURRENT-DATE(1:14) TO WK-RUN-SDATETIME
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 461
* MUSR2651.cob                                                     cpy)cpy)y)y)
 26681*-------------------<DEBUG>---------------------------------------
 26682     DISPLAY "プログラムID:        ["CNS-PGM-ID"]"                GUT2013
 26683     DISPLAY "セクション:          [OPEN-FILE-7-RTN]"             GUT2013
 26684     DISPLAY "セクションの開始時間:["WK-RUN-SDATETIME"]"          GUT2013
 26685*-----------------------------------------------------------------
 26686*--------------------<DEBUG>--------------------------------------
 26687D    DISPLAY   CNS-PGM-ID":約定ファイル07オープン  START "
 26688*-----------------------------------------------------------------
 26689     MOVE  CNS-OFF                     TO  FLG-FILE-OPEN-7
 26690     MOVE  WK-PSACT-DAT-FILE-7         TO  OUTFILE-7
 26691     OPEN  OUTPUT OUT-FILE-7
 26692*-------------------<DEBUG>---------------------------------------
 26693D    DISPLAY  CNS-PGM-ID":FILE-STATUS-7=[" WK-FILE-STATUS-7 "]"
 26694*-----------------------------------------------------------------
 26695     EVALUATE  WK-FILE-STATUS-7
 26696       WHEN  CNS-FILE-NORMAL
 26697         MOVE  CNS-ON                  TO  FLG-FILE-OPEN-7
 26698*--------------------<DEBUG>--------------------------------------
 26699D    DISPLAY  CNS-PGM-ID":DAT約定ファイル07オープン正常"
 26700*-----------------------------------------------------------------
 26701       WHEN  OTHER
 26702*--------------------<DEBUG>--------------------------------------
 26703D    DISPLAY  CNS-PGM-ID":DAT約定ファイル07オープンエラー"
 26704*-----------------------------------------------------------------
 26705*----------  メッセージ出力用 RTNパッケージの設定
 26706*----------  ワークリターンコード
 26707       MOVE  CNS-RTN-BT16         TO  WK-RTN-CODE
 26708       INITIALIZE  WK-SYS-ERR-INFO
 26709*----------  エラー検知プログラムID
 26710       MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
 26711*----------  ポジション
 26712       MOVE  CNS-POS-058          TO  WK-ERR-POS
 26713*----------  リターンコード
 26714       MOVE  CNS-RTN-200          TO  WK-RTN-CD
 26715*----------  詳細リターンコード
 26716       MOVE  FUNCTION NUMVAL(WK-FILE-STATUS-7)
 26717         TO  WK-DETAIL-RTN-CD
 26718*----------  詳細リターンコードデコードフラグ
 26719       MOVE  CNS-DETAIL-0         TO  WK-DETAIL-RTN-CD-FLG
 26720       MOVE  SPACE                TO  WK-FREE-MSG
 26721       STRING  "ファイル:["
 26722               WK-PSACT-DAT-FILE-7
 26723               "]オープンエラー"
 26724         DELIMITED BY SIZE         INTO  WK-FREE-MSG
 26725       END-STRING
 26726       PERFORM  ERR-RTN
 26727     END-EVALUATE
 26728*--------------------<DEBUG>--------------------------------------
 26729D    DISPLAY  CNS-PGM-ID":約定ファイル07オープンフラグ=["
 26730D             FLG-FILE-OPEN-7 "]"
 26731D    DISPLAY  CNS-PGM-ID":約定ファイル07オープン処理  END "
 26732*-----------------------------------------------------------------
 26733     MOVE FUNCTION CURRENT-DATE(1:14) TO WK-RUN-EDATETIME
 26734*--------------------<DEBUG>--------------------------------------
 26735     DISPLAY "プログラムID:        ["CNS-PGM-ID"]"                GUT2013
 26736     DISPLAY "セクション:          [OPEN-FILE-7-RTN]"             GUT2013
 26737     DISPLAY "セクションの終了時間:["WK-RUN-EDATETIME"]"          GUT2013
 26738*-----------------------------------------------------------------
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 462
* MUSR2651.cob                                                     cpy)cpy)y)y)
 26739     CONTINUE.
 26740 OPEN-FILE-7-EXT.
 26741     EXIT.
 26742******************************************************************
 26743*    受渡ファイル08名作成処理
 26744******************************************************************
 26745 GET-FILE-8-NAME-RTN    SECTION.
 26746*--------------------<DEBUG>--------------------------------------
 26747D    DISPLAY  CNS-PGM-ID":受渡ファイル08名作成処理  START "
 26748*-----------------------------------------------------------------
 26749     STRING  CNS-RX-TEXT               DELIMITED BY SPACE
 26750             WK-RIYO-CMP-CD            DELIMITED BY SPACE
 26751             "_"                       DELIMITED BY SPACE
 26752             WK-SHORI-YMD              DELIMITED BY SPACE
 26753             "_"                       DELIMITED BY SPACE
 26754             WK-KIDOU-ID               DELIMITED BY SPACE
 26755             "_"                       DELIMITED BY SPACE
 26756             WK-GYOMU-TASK-ID          DELIMITED BY SPACE
 26757             "_08"                     DELIMITED BY SPACE
 26758                                       INTO  WK-FILE-8-NAME
 26759     END-STRING
 26760     STRING  WK-FILE-PASS              DELIMITED BY SPACE
 26761             "/"                       DELIMITED BY SPACE
 26762             WK-FILE-8-NAME            DELIMITED BY SPACE
 26763                                       INTO  WK-PSACT-DAT-FILE-8
 26764     END-STRING
 26765*--------------------<DEBUG>--------------------------------------
 26766D    DISPLAY  CNS-PGM-ID":W.受渡ファイル名=["WK-FILE-8-NAME"]"
 26767D    DISPLAY  CNS-PGM-ID":受渡ファイルパス=["WK-FILE-PASS"]"
 26768D    DISPLAY  CNS-PGM-ID":パス付けDAT受渡ファイル=["
 26769D             WK-PSACT-DAT-FILE-8"]"
 26770D    DISPLAY  CNS-PGM-ID": 受渡ファイル名作成処理  END  *****"
 26771*-----------------------------------------------------------------
 26772     CONTINUE.
 26773 GET-FILE-8-NAME-EXT.
 26774     EXIT.
 26775******************************************************************
 26776*    受渡ファイル08オープン
 26777******************************************************************
 26778 OPEN-FILE-8-RTN        SECTION.
 26779     MOVE FUNCTION CURRENT-DATE(1:14) TO WK-RUN-SDATETIME
 26780*-------------------<DEBUG>---------------------------------------
 26781     DISPLAY "プログラムID:        ["CNS-PGM-ID"]"                GUT2013
 26782     DISPLAY "セクション:          [OPEN-FILE-8-RTN]"             GUT2013
 26783     DISPLAY "セクションの開始時間:["WK-RUN-SDATETIME"]"          GUT2013
 26784*-----------------------------------------------------------------
 26785*--------------------<DEBUG>--------------------------------------
 26786D    DISPLAY   CNS-PGM-ID":受渡ファイル08オープン  START "
 26787*-----------------------------------------------------------------
 26788     MOVE  CNS-OFF                     TO  FLG-FILE-OPEN-6
 26789     MOVE  WK-PSACT-DAT-FILE-8         TO  OUTFILE-8
 26790     OPEN  OUTPUT OUT-FILE-8
 26791*-------------------<DEBUG>---------------------------------------
 26792D    DISPLAY  CNS-PGM-ID":FILE-STATUS-8=[" WK-FILE-STATUS-8 "]"
 26793*-----------------------------------------------------------------
 26794     EVALUATE  WK-FILE-STATUS-8
 26795       WHEN  CNS-FILE-NORMAL
 26796         MOVE  CNS-ON                  TO  FLG-FILE-OPEN-8
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 463
* MUSR2651.cob                                                     cpy)cpy)y)y)
 26797*--------------------<DEBUG>--------------------------------------
 26798D    DISPLAY  CNS-PGM-ID":DAT受渡ファイル08オープン正常"
 26799*-----------------------------------------------------------------
 26800       WHEN  OTHER
 26801*--------------------<DEBUG>--------------------------------------
 26802D    DISPLAY  CNS-PGM-ID":DAT受渡ファイル08オープンエラー"
 26803*-----------------------------------------------------------------
 26804*----------  メッセージ出力用 RTNパッケージの設定
 26805*----------  ワークリターンコード
 26806       MOVE  CNS-RTN-BT16         TO  WK-RTN-CODE
 26807       INITIALIZE  WK-SYS-ERR-INFO
 26808*----------  エラー検知プログラムID
 26809       MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
 26810*----------  ポジション
 26811       MOVE  CNS-POS-059          TO  WK-ERR-POS
 26812*----------  リターンコード
 26813       MOVE  CNS-RTN-200          TO  WK-RTN-CD
 26814*----------  詳細リターンコード
 26815       MOVE  FUNCTION NUMVAL(WK-FILE-STATUS-8)
 26816         TO  WK-DETAIL-RTN-CD
 26817*----------  詳細リターンコードデコードフラグ
 26818       MOVE  CNS-DETAIL-0         TO  WK-DETAIL-RTN-CD-FLG
 26819       MOVE  SPACE                TO  WK-FREE-MSG
 26820       STRING  "ファイル:["
 26821               WK-PSACT-DAT-FILE-8
 26822               "]オープンエラー"
 26823         DELIMITED BY SIZE         INTO  WK-FREE-MSG
 26824       END-STRING
 26825       PERFORM  ERR-RTN
 26826     END-EVALUATE
 26827*--------------------<DEBUG>--------------------------------------
 26828D    DISPLAY  CNS-PGM-ID":受渡ファイル08オープンフラグ=["
 26829D             FLG-FILE-OPEN-8 "]"
 26830D    DISPLAY  CNS-PGM-ID":受渡ファイル08オープン処理  END "
 26831*-----------------------------------------------------------------
 26832     MOVE FUNCTION CURRENT-DATE(1:14) TO WK-RUN-EDATETIME
 26833*--------------------<DEBUG>--------------------------------------
 26834     DISPLAY "プログラムID:        ["CNS-PGM-ID"]"                GUT2013
 26835     DISPLAY "セクション:          [OPEN-FILE-8-RTN]"             GUT2013
 26836     DISPLAY "セクションの終了時間:["WK-RUN-EDATETIME"]"          GUT2013
 26837*-----------------------------------------------------------------
 26838     CONTINUE.
 26839 OPEN-FILE-8-EXT.
 26840     EXIT.
 26841******************************************************************
 26842*    データ出力処理5
 26843******************************************************************
 26844 DATA-WRITE-5-RTN       SECTION.
 26845*--------------------<DEBUG>--------------------------------------
 26846D    DISPLAY  CNS-PGM-ID":***** データ出力処理5 START  *****"
 26847*-----------------------------------------------------------------
 26848     WRITE  DAT-REC5
 26849*-------------------<DEBUG>---------------------------------------
 26850D    DISPLAY  CNS-PGM-ID":DAT-REC5=["DAT-REC5"]"
 26851D    DISPLAY  CNS-PGM-ID":WK-FILE-STATUS-5=[" WK-FILE-STATUS-5 "]"
 26852*-----------------------------------------------------------------
 26853     EVALUATE  WK-FILE-STATUS-5
 26854       WHEN  CNS-FILE-NORMAL
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 464
* MUSR2651.cob                                                     cpy)cpy)y)y)
 26855*--------------------<DEBUG>--------------------------------------
 26856D    DISPLAY  CNS-PGM-ID":WK-WRITE-KENSUU5=["WK-WRITE-KENSUU5"]"
 26857*-----------------------------------------------------------------
 26858         COMPUTE  WK-WRITE-KENSUU5 = WK-WRITE-KENSUU5 + 1
 26859*--------------------<DEBUG>--------------------------------------
 26860D    DISPLAY  CNS-PGM-ID":WK-WRITE-KENSUU5=["WK-WRITE-KENSUU5"]"
 26861D    DISPLAY  CNS-PGM-ID":データ出力処理5正常"
 26862*-----------------------------------------------------------------
 26863         CONTINUE
 26864       WHEN  OTHER
 26865*--------------------<DEBUG>--------------------------------------
 26866D    DISPLAY  CNS-PGM-ID":データ出力処理5エラー"
 26867*-----------------------------------------------------------------
 26868*----------  メッセージ出力用 RTNパッケージの設定
 26869*----------  ワーク実行ステータス
 26870         MOVE  CNS-16                   TO  WK-STATUS
 26871         MOVE  CNS-16                   TO  WK-1190-STATUS
 26872*----------  ワークリターンコード
 26873         MOVE  WK-STATUS                TO  WK-RTN-CODE
 26874*----------  ワークエラーパッケージを編集
 26875         INITIALIZE  WK-SYS-ERR-INFO
 26876*----------  エラー検知プログラムID
 26877         MOVE  CNS-PGM-ID               TO  WK-ERR-PGM-ID
 26878*----------  ポジション
 26879         MOVE  CNS-POS-060              TO  WK-ERR-POS
 26880*----------  リターンコード
 26881         MOVE  CNS-RTN-220              TO  WK-RTN-CD
 26882*----------  詳細リターンコードデコードフラグ
 26883         MOVE  FUNCTION NUMVAL(WK-FILE-STATUS-5)
 26884                                        TO  WK-DETAIL-RTN-CD
 26885*----------  詳細リターンコードデコードフラグ
 26886         MOVE  CNS-DETAIL-0             TO  WK-DETAIL-RTN-CD-FLG
 26887*---------- フリーメッセージ
 26888         STRING  "ファイル:["
 26889                 WK-PSACT-DAT-FILE-5
 26890                 "]書き込むエラー"
 26891          DELIMITED BY SPACE            INTO  WK-FREE-MSG
 26892         END-STRING
 26893*----------  エラー情報追加処理
 26894         PERFORM  ERR-INFO-ADD-RTN
 26895     END-EVALUATE
 26896*--------------------<DEBUG>--------------------------------------
 26897D    DISPLAY  CNS-PGM-ID":***** データ出力処理5  END  *****"
 26898*-----------------------------------------------------------------
 26899     CONTINUE.
 26900 DATA-WRITE-5-EXT.
 26901     EXIT.
 26902******************************************************************
 26903*    データ出力処理5
 26904******************************************************************
 26905 DATA-WRITE5-RTN        SECTION.
 26906*--------------------<DEBUG>--------------------------------------
 26907D    DISPLAY  CNS-PGM-ID":***** データ出力処理H5 START  *****"
 26908*-----------------------------------------------------------------
 26909     WRITE  DAT-REC5
 26910*-------------------<DEBUG>---------------------------------------
 26911D    DISPLAY  CNS-PGM-ID":DAT-REC5=["DAT-REC5"]"
 26912D    DISPLAY  CNS-PGM-ID":WK-FILE-STATUS-5=[" WK-FILE-STATUS-5 "]"
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 465
* MUSR2651.cob                                                     cpy)cpy)y)y)
 26913*-----------------------------------------------------------------
 26914     EVALUATE  WK-FILE-STATUS-5
 26915       WHEN  CNS-FILE-NORMAL
 26916*--------------------<DEBUG>--------------------------------------
 26917D    DISPLAY  CNS-PGM-ID":WK-WRITE-KENSUU5=["WK-WRITE-KENSUU5"]"
 26918*-----------------------------------------------------------------
 26919         COMPUTE  WK-WRITE-KENSUU5 = WK-WRITE-KENSUU5 + 1
 26920*--------------------<DEBUG>--------------------------------------
 26921D    DISPLAY  CNS-PGM-ID":WK-WRITE-KENSUU5=["WK-WRITE-KENSUU5"]"
 26922D    DISPLAY  CNS-PGM-ID":データ出力処理5正常"
 26923*-----------------------------------------------------------------
 26924         CONTINUE
 26925       WHEN  OTHER
 26926*--------------------<DEBUG>--------------------------------------
 26927D    DISPLAY  CNS-PGM-ID":データ出力処理5エラー"
 26928*-----------------------------------------------------------------
 26929*----------  メッセージ出力用 RTNパッケージの設定
 26930*----------  ワーク実行ステータス
 26931         MOVE  CNS-16                   TO  WK-RTN-CODE
 26932*----------  ワークエラーパッケージを編集
 26933         INITIALIZE  WK-SYS-ERR-INFO
 26934*----------  エラー検知プログラムID
 26935         MOVE  CNS-PGM-ID               TO  WK-ERR-PGM-ID
 26936*----------  ポジション
 26937         MOVE  CNS-POS-075              TO  WK-ERR-POS
 26938*----------  リターンコード
 26939         MOVE  CNS-RTN-220              TO  WK-RTN-CD
 26940*----------  詳細リターンコードデコードフラグ
 26941         MOVE  FUNCTION NUMVAL(WK-FILE-STATUS-5)
 26942                                        TO  WK-DETAIL-RTN-CD
 26943*----------  詳細リターンコードデコードフラグ
 26944         MOVE  CNS-DETAIL-0             TO  WK-DETAIL-RTN-CD-FLG
 26945*---------- フリーメッセージ
 26946         STRING  "ファイル:["
 26947                 WK-PSACT-DAT-FILE-5
 26948                 "]書き込むエラー"
 26949          DELIMITED BY SPACE            INTO  WK-FREE-MSG
 26950         END-STRING
 26951*----------  エラー処理
 26952         PERFORM  ERR-RTN
 26953     END-EVALUATE
 26954*--------------------<DEBUG>--------------------------------------
 26955D    DISPLAY  CNS-PGM-ID":***** データ出力処理H5  END  *****"
 26956*-----------------------------------------------------------------
 26957     CONTINUE.
 26958 DATA-WRITE5-EXT.
 26959     EXIT.
 26960******************************************************************
 26961*    データ出力処理6
 26962******************************************************************
 26963 DATA-WRITE-6-RTN       SECTION.
 26964*--------------------<DEBUG>--------------------------------------
 26965D    DISPLAY  CNS-PGM-ID":***** データ出力処理6 START  *****"
 26966*-----------------------------------------------------------------
 26967     WRITE  DAT-REC6
 26968*-------------------<DEBUG>---------------------------------------
 26969D    DISPLAY  CNS-PGM-ID":DAT-REC6=["DAT-REC6"]"
 26970D    DISPLAY  CNS-PGM-ID":WK-FILE-STATUS-6=[" WK-FILE-STATUS-6 "]"
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 466
* MUSR2651.cob                                                     cpy)cpy)y)y)
 26971*-----------------------------------------------------------------
 26972     EVALUATE  WK-FILE-STATUS-6
 26973       WHEN  CNS-FILE-NORMAL
 26974*--------------------<DEBUG>--------------------------------------
 26975D    DISPLAY  CNS-PGM-ID":WK-WRITE-KENSUU6=["WK-WRITE-KENSUU6"]"
 26976*-----------------------------------------------------------------
 26977         COMPUTE  WK-WRITE-KENSUU6 = WK-WRITE-KENSUU6 + 1
 26978*--------------------<DEBUG>--------------------------------------
 26979D    DISPLAY  CNS-PGM-ID":WK-WRITE-KENSUU6=["WK-WRITE-KENSUU6"]"
 26980D    DISPLAY  CNS-PGM-ID":データ出力処理6正常"
 26981*-----------------------------------------------------------------
 26982         CONTINUE
 26983       WHEN  OTHER
 26984*--------------------<DEBUG>--------------------------------------
 26985D    DISPLAY  CNS-PGM-ID":データ出力処理6エラー"
 26986*-----------------------------------------------------------------
 26987*----------  メッセージ出力用 RTNパッケージの設定
 26988*----------  ワーク実行ステータス
 26989         MOVE  CNS-16                   TO  WK-STATUS
 26990         MOVE  CNS-16                   TO  WK-1190-STATUS
 26991*----------  ワークリターンコード
 26992         MOVE  WK-STATUS                TO  WK-RTN-CODE
 26993*----------  ワークエラーパッケージを編集
 26994         INITIALIZE  WK-SYS-ERR-INFO
 26995*----------  エラー検知プログラムID
 26996         MOVE  CNS-PGM-ID               TO  WK-ERR-PGM-ID
 26997*----------  ポジション
 26998         MOVE  CNS-POS-061              TO  WK-ERR-POS
 26999*----------  リターンコード
 27000         MOVE  CNS-RTN-220              TO  WK-RTN-CD
 27001*----------  詳細リターンコードデコードフラグ
 27002         MOVE  FUNCTION NUMVAL(WK-FILE-STATUS-6)
 27003                                        TO  WK-DETAIL-RTN-CD
 27004*----------  詳細リターンコードデコードフラグ
 27005         MOVE  CNS-DETAIL-0             TO  WK-DETAIL-RTN-CD-FLG
 27006*---------- フリーメッセージ
 27007         STRING  "ファイル:["
 27008                 WK-PSACT-DAT-FILE-6
 27009                 "]書き込むエラー"
 27010          DELIMITED BY SPACE            INTO  WK-FREE-MSG
 27011         END-STRING
 27012*----------  エラー情報追加処理
 27013         PERFORM  ERR-INFO-ADD-RTN
 27014     END-EVALUATE
 27015*--------------------<DEBUG>--------------------------------------
 27016D    DISPLAY  CNS-PGM-ID":***** データ出力処理6  END  *****"
 27017*-----------------------------------------------------------------
 27018     CONTINUE.
 27019 DATA-WRITE-6-EXT.
 27020     EXIT.
 27021******************************************************************
 27022*    データ出力処理6
 27023******************************************************************
 27024 DATA-WRITE6-RTN        SECTION.
 27025*--------------------<DEBUG>--------------------------------------
 27026D    DISPLAY  CNS-PGM-ID":***** データ出力処理H6 START  *****"
 27027*-----------------------------------------------------------------
 27028     WRITE  DAT-REC6
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 467
* MUSR2651.cob                                                     cpy)cpy)y)y)
 27029*-------------------<DEBUG>---------------------------------------
 27030D    DISPLAY  CNS-PGM-ID":DAT-REC6=["DAT-REC6"]"
 27031D    DISPLAY  CNS-PGM-ID":WK-FILE-STATUS-6=[" WK-FILE-STATUS-6 "]"
 27032*-----------------------------------------------------------------
 27033     EVALUATE  WK-FILE-STATUS-6
 27034       WHEN  CNS-FILE-NORMAL
 27035*--------------------<DEBUG>--------------------------------------
 27036D    DISPLAY  CNS-PGM-ID":WK-WRITE-KENSUU6=["WK-WRITE-KENSUU6"]"
 27037*-----------------------------------------------------------------
 27038         COMPUTE  WK-WRITE-KENSUU6 = WK-WRITE-KENSUU6 + 1
 27039*--------------------<DEBUG>--------------------------------------
 27040D    DISPLAY  CNS-PGM-ID":WK-WRITE-KENSUU6=["WK-WRITE-KENSUU6"]"
 27041D    DISPLAY  CNS-PGM-ID":データ出力処理6正常"
 27042*-----------------------------------------------------------------
 27043         CONTINUE
 27044       WHEN  OTHER
 27045*--------------------<DEBUG>--------------------------------------
 27046D    DISPLAY  CNS-PGM-ID":データ出力処理6エラー"
 27047*-----------------------------------------------------------------
 27048*----------  メッセージ出力用 RTNパッケージの設定
 27049*----------  ワーク実行ステータス
 27050         MOVE  CNS-16                   TO  WK-RTN-CODE
 27051*----------  ワークエラーパッケージを編集
 27052         INITIALIZE  WK-SYS-ERR-INFO
 27053*----------  エラー検知プログラムID
 27054         MOVE  CNS-PGM-ID               TO  WK-ERR-PGM-ID
 27055*----------  ポジション
 27056         MOVE  CNS-POS-076              TO  WK-ERR-POS
 27057*----------  リターンコード
 27058         MOVE  CNS-RTN-220              TO  WK-RTN-CD
 27059*----------  詳細リターンコードデコードフラグ
 27060         MOVE  FUNCTION NUMVAL(WK-FILE-STATUS-6)
 27061                                        TO  WK-DETAIL-RTN-CD
 27062*----------  詳細リターンコードデコードフラグ
 27063         MOVE  CNS-DETAIL-0             TO  WK-DETAIL-RTN-CD-FLG
 27064*---------- フリーメッセージ
 27065         STRING  "ファイル:["
 27066                 WK-PSACT-DAT-FILE-6
 27067                 "]書き込むエラー"
 27068          DELIMITED BY SPACE            INTO  WK-FREE-MSG
 27069         END-STRING
 27070*----------  エラー処理
 27071         PERFORM  ERR-RTN
 27072     END-EVALUATE
 27073*--------------------<DEBUG>--------------------------------------
 27074D    DISPLAY  CNS-PGM-ID":***** データ出力処理H6  END  *****"
 27075*-----------------------------------------------------------------
 27076     CONTINUE.
 27077 DATA-WRITE6-EXT.
 27078     EXIT.
 27079******************************************************************
 27080*    データ出力処理7
 27081******************************************************************
 27082 DATA-WRITE-7-RTN       SECTION.
 27083*--------------------<DEBUG>--------------------------------------
 27084D    DISPLAY  CNS-PGM-ID":***** データ出力処理7 START  *****"
 27085*-----------------------------------------------------------------
 27086     WRITE  DAT-REC7
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 468
* MUSR2651.cob                                                     cpy)cpy)y)y)
 27087*-------------------<DEBUG>---------------------------------------
 27088D    DISPLAY  CNS-PGM-ID":DAT-REC7=["DAT-REC7"]"
 27089D    DISPLAY  CNS-PGM-ID":WK-FILE-STATUS-7=[" WK-FILE-STATUS-7 "]"
 27090*-----------------------------------------------------------------
 27091     EVALUATE  WK-FILE-STATUS-7
 27092       WHEN  CNS-FILE-NORMAL
 27093*--------------------<DEBUG>--------------------------------------
 27094D    DISPLAY  CNS-PGM-ID":WK-WRITE-KENSUU7=["WK-WRITE-KENSUU7"]"
 27095*-----------------------------------------------------------------
 27096         COMPUTE  WK-WRITE-KENSUU7 = WK-WRITE-KENSUU7 + 1
 27097*--------------------<DEBUG>--------------------------------------
 27098D    DISPLAY  CNS-PGM-ID":WK-WRITE-KENSUU7=["WK-WRITE-KENSUU7"]"
 27099D    DISPLAY  CNS-PGM-ID":データ出力処理7正常"
 27100*-----------------------------------------------------------------
 27101         CONTINUE
 27102       WHEN  OTHER
 27103*--------------------<DEBUG>--------------------------------------
 27104D    DISPLAY  CNS-PGM-ID":データ出力処理7エラー"
 27105*-----------------------------------------------------------------
 27106*----------  メッセージ出力用 RTNパッケージの設定
 27107*----------  ワーク実行ステータス
 27108         MOVE  CNS-16                   TO  WK-STATUS
 27109         MOVE  CNS-16                   TO  WK-1190-STATUS
 27110*----------  ワークリターンコード
 27111         MOVE  WK-STATUS                TO  WK-RTN-CODE
 27112*----------  ワークエラーパッケージを編集
 27113         INITIALIZE  WK-SYS-ERR-INFO
 27114*----------  エラー検知プログラムID
 27115         MOVE  CNS-PGM-ID               TO  WK-ERR-PGM-ID
 27116*----------  ポジション
 27117         MOVE  CNS-POS-062              TO  WK-ERR-POS
 27118*----------  リターンコード
 27119         MOVE  CNS-RTN-220              TO  WK-RTN-CD
 27120*----------  詳細リターンコードデコードフラグ
 27121         MOVE  FUNCTION NUMVAL(WK-FILE-STATUS-7)
 27122                                        TO  WK-DETAIL-RTN-CD
 27123*----------  詳細リターンコードデコードフラグ
 27124         MOVE  CNS-DETAIL-0             TO  WK-DETAIL-RTN-CD-FLG
 27125*---------- フリーメッセージ
 27126         STRING  "ファイル:["
 27127                 WK-PSACT-DAT-FILE-7
 27128                 "]書き込むエラー"
 27129          DELIMITED BY SPACE            INTO  WK-FREE-MSG
 27130         END-STRING
 27131*----------  エラー情報追加処理
 27132         PERFORM  ERR-INFO-ADD-RTN
 27133     END-EVALUATE
 27134*--------------------<DEBUG>--------------------------------------
 27135D    DISPLAY  CNS-PGM-ID":***** データ出力処理7  END  *****"
 27136*-----------------------------------------------------------------
 27137     CONTINUE.
 27138 DATA-WRITE-7-EXT.
 27139     EXIT.
 27140******************************************************************
 27141*    データ出力処理7
 27142******************************************************************
 27143 DATA-WRITE7-RTN        SECTION.
 27144*--------------------<DEBUG>--------------------------------------
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 469
* MUSR2651.cob                                                     cpy)cpy)y)y)
 27145D    DISPLAY  CNS-PGM-ID":***** データ出力処理H7 START  *****"
 27146*-----------------------------------------------------------------
 27147     WRITE  DAT-REC7
 27148*-------------------<DEBUG>---------------------------------------
 27149D    DISPLAY  CNS-PGM-ID":DAT-REC7=["DAT-REC7"]"
 27150D    DISPLAY  CNS-PGM-ID":WK-FILE-STATUS-7=[" WK-FILE-STATUS-7 "]"
 27151*-----------------------------------------------------------------
 27152     EVALUATE  WK-FILE-STATUS-7
 27153       WHEN  CNS-FILE-NORMAL
 27154*--------------------<DEBUG>--------------------------------------
 27155D    DISPLAY  CNS-PGM-ID":WK-WRITE-KENSUU7=["WK-WRITE-KENSUU7"]"
 27156*-----------------------------------------------------------------
 27157         COMPUTE  WK-WRITE-KENSUU7 = WK-WRITE-KENSUU7 + 1
 27158*--------------------<DEBUG>--------------------------------------
 27159D    DISPLAY  CNS-PGM-ID":WK-WRITE-KENSUU7=["WK-WRITE-KENSUU7"]"
 27160D    DISPLAY  CNS-PGM-ID":データ出力処理7正常"
 27161*-----------------------------------------------------------------
 27162         CONTINUE
 27163       WHEN  OTHER
 27164*--------------------<DEBUG>--------------------------------------
 27165D    DISPLAY  CNS-PGM-ID":データ出力処理7エラー"
 27166*-----------------------------------------------------------------
 27167*----------  メッセージ出力用 RTNパッケージの設定
 27168*----------  ワーク実行ステータス
 27169         MOVE  CNS-16                   TO  WK-RTN-CODE
 27170*----------  ワークエラーパッケージを編集
 27171         INITIALIZE  WK-SYS-ERR-INFO
 27172*----------  エラー検知プログラムID
 27173         MOVE  CNS-PGM-ID               TO  WK-ERR-PGM-ID
 27174*----------  ポジション
 27175         MOVE  CNS-POS-077              TO  WK-ERR-POS
 27176*----------  リターンコード
 27177         MOVE  CNS-RTN-220              TO  WK-RTN-CD
 27178*----------  詳細リターンコードデコードフラグ
 27179         MOVE  FUNCTION NUMVAL(WK-FILE-STATUS-7)
 27180                                        TO  WK-DETAIL-RTN-CD
 27181*----------  詳細リターンコードデコードフラグ
 27182         MOVE  CNS-DETAIL-0             TO  WK-DETAIL-RTN-CD-FLG
 27183*---------- フリーメッセージ
 27184         STRING  "ファイル:["
 27185                 WK-PSACT-DAT-FILE-7
 27186                 "]書き込むエラー"
 27187          DELIMITED BY SPACE            INTO  WK-FREE-MSG
 27188         END-STRING
 27189*----------  エラー処理
 27190         PERFORM  ERR-RTN
 27191     END-EVALUATE
 27192*--------------------<DEBUG>--------------------------------------
 27193D    DISPLAY  CNS-PGM-ID":***** データ出力処理H7  END  *****"
 27194*-----------------------------------------------------------------
 27195     CONTINUE.
 27196 DATA-WRITE7-EXT.
 27197     EXIT.
 27198******************************************************************
 27199*    データ出力処理8
 27200******************************************************************
 27201 DATA-WRITE-8-RTN       SECTION.
 27202*--------------------<DEBUG>--------------------------------------
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 470
* MUSR2651.cob                                                     cpy)cpy)y)y)
 27203D    DISPLAY  CNS-PGM-ID":***** データ出力処理8 START  *****"
 27204*-----------------------------------------------------------------
 27205     WRITE  DAT-REC8
 27206*-------------------<DEBUG>---------------------------------------
 27207D    DISPLAY  CNS-PGM-ID":DAT-REC8=["DAT-REC8"]"
 27208D    DISPLAY  CNS-PGM-ID":WK-FILE-STATUS-8=[" WK-FILE-STATUS-8 "]"
 27209*-----------------------------------------------------------------
 27210     EVALUATE  WK-FILE-STATUS-8
 27211       WHEN  CNS-FILE-NORMAL
 27212*--------------------<DEBUG>--------------------------------------
 27213D    DISPLAY  CNS-PGM-ID":WK-WRITE-KENSUU8=["WK-WRITE-KENSUU8"]"
 27214*-----------------------------------------------------------------
 27215         COMPUTE  WK-WRITE-KENSUU8 = WK-WRITE-KENSUU8 + 1
 27216*--------------------<DEBUG>--------------------------------------
 27217D    DISPLAY  CNS-PGM-ID":WK-WRITE-KENSUU8=["WK-WRITE-KENSUU8"]"
 27218D    DISPLAY  CNS-PGM-ID":データ出力処理8正常"
 27219*-----------------------------------------------------------------
 27220         CONTINUE
 27221       WHEN  OTHER
 27222*--------------------<DEBUG>--------------------------------------
 27223D    DISPLAY  CNS-PGM-ID":データ出力処理8エラー"
 27224*-----------------------------------------------------------------
 27225*----------  メッセージ出力用 RTNパッケージの設定
 27226*----------  ワーク実行ステータス
 27227         MOVE  CNS-16                   TO  WK-STATUS
 27228         MOVE  CNS-16                   TO  WK-1190-STATUS
 27229*----------  ワークリターンコード
 27230         MOVE  WK-STATUS                TO  WK-RTN-CODE
 27231*----------  ワークエラーパッケージを編集
 27232         INITIALIZE  WK-SYS-ERR-INFO
 27233*----------  エラー検知プログラムID
 27234         MOVE  CNS-PGM-ID               TO  WK-ERR-PGM-ID
 27235*----------  ポジション
 27236         MOVE  CNS-POS-063              TO  WK-ERR-POS
 27237*----------  リターンコード
 27238         MOVE  CNS-RTN-220              TO  WK-RTN-CD
 27239*----------  詳細リターンコードデコードフラグ
 27240         MOVE  FUNCTION NUMVAL(WK-FILE-STATUS-8)
 27241                                        TO  WK-DETAIL-RTN-CD
 27242*----------  詳細リターンコードデコードフラグ
 27243         MOVE  CNS-DETAIL-0             TO  WK-DETAIL-RTN-CD-FLG
 27244*---------- フリーメッセージ
 27245         STRING  "ファイル:["
 27246                 WK-PSACT-DAT-FILE-8
 27247                 "]書き込むエラー"
 27248          DELIMITED BY SPACE            INTO  WK-FREE-MSG
 27249         END-STRING
 27250*----------  エラー情報追加処理
 27251         PERFORM  ERR-INFO-ADD-RTN
 27252     END-EVALUATE
 27253*--------------------<DEBUG>--------------------------------------
 27254D    DISPLAY  CNS-PGM-ID":***** データ出力処理8  END  *****"
 27255*-----------------------------------------------------------------
 27256     CONTINUE.
 27257 DATA-WRITE-8-EXT.
 27258     EXIT.
 27259******************************************************************
 27260*    データ出力処理8
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 471
* MUSR2651.cob                                                     cpy)cpy)y)y)
 27261******************************************************************
 27262 DATA-WRITE8-RTN        SECTION.
 27263*--------------------<DEBUG>--------------------------------------
 27264D    DISPLAY  CNS-PGM-ID":***** データ出力処理H8 START  *****"
 27265*-----------------------------------------------------------------
 27266     WRITE  DAT-REC8
 27267*-------------------<DEBUG>---------------------------------------
 27268D    DISPLAY  CNS-PGM-ID":DAT-REC8=["DAT-REC8"]"
 27269D    DISPLAY  CNS-PGM-ID":WK-FILE-STATUS-8=[" WK-FILE-STATUS-8 "]"
 27270*-----------------------------------------------------------------
 27271     EVALUATE  WK-FILE-STATUS-8
 27272       WHEN  CNS-FILE-NORMAL
 27273*--------------------<DEBUG>--------------------------------------
 27274D    DISPLAY  CNS-PGM-ID":WK-WRITE-KENSUU8=["WK-WRITE-KENSUU8"]"
 27275*-----------------------------------------------------------------
 27276         COMPUTE  WK-WRITE-KENSUU8 = WK-WRITE-KENSUU8 + 1
 27277*--------------------<DEBUG>--------------------------------------
 27278D    DISPLAY  CNS-PGM-ID":WK-WRITE-KENSUU8=["WK-WRITE-KENSUU8"]"
 27279D    DISPLAY  CNS-PGM-ID":データ出力処理8正常"
 27280*-----------------------------------------------------------------
 27281         CONTINUE
 27282       WHEN  OTHER
 27283*--------------------<DEBUG>--------------------------------------
 27284D    DISPLAY  CNS-PGM-ID":データ出力処理8エラー"
 27285*-----------------------------------------------------------------
 27286*----------  メッセージ出力用 RTNパッケージの設定
 27287*----------  ワーク実行ステータス
 27288         MOVE  CNS-16                   TO  WK-RTN-CODE
 27289*----------  ワークエラーパッケージを編集
 27290         INITIALIZE  WK-SYS-ERR-INFO
 27291*----------  エラー検知プログラムID
 27292         MOVE  CNS-PGM-ID               TO  WK-ERR-PGM-ID
 27293*----------  ポジション
 27294         MOVE  CNS-POS-078              TO  WK-ERR-POS
 27295*----------  リターンコード
 27296         MOVE  CNS-RTN-220              TO  WK-RTN-CD
 27297*----------  詳細リターンコードデコードフラグ
 27298         MOVE  FUNCTION NUMVAL(WK-FILE-STATUS-8)
 27299                                        TO  WK-DETAIL-RTN-CD
 27300*----------  詳細リターンコードデコードフラグ
 27301         MOVE  CNS-DETAIL-0             TO  WK-DETAIL-RTN-CD-FLG
 27302*---------- フリーメッセージ
 27303         STRING  "ファイル:["
 27304                 WK-PSACT-DAT-FILE-8
 27305                 "]書き込むエラー"
 27306          DELIMITED BY SPACE            INTO  WK-FREE-MSG
 27307         END-STRING
 27308*----------  エラー処理
 27309         PERFORM  ERR-RTN
 27310     END-EVALUATE
 27311*--------------------<DEBUG>--------------------------------------
 27312D    DISPLAY  CNS-PGM-ID":***** データ出力処理H8  END  *****"
 27313*-----------------------------------------------------------------
 27314     CONTINUE.
 27315 DATA-WRITE8-EXT.
 27316     EXIT.
 27317******************************************************************
 27318*    DATファイル5クローズ処理
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 472
* MUSR2651.cob                                                     cpy)cpy)y)y)
 27319******************************************************************
 27320 CLOSE-FILE-5-RTN       SECTION.
 27321*--------------------<DEBUG>--------------------------------------
 27322D    DISPLAY  CNS-PGM-ID":*****DATファイル5クローズ処理  "
 27323D             "START  *****"
 27324*--------------------<DEBUG>--------------------------------------
 27325     MOVE  CNS-OFF                 TO  FLG-FILE-OPEN-5
 27326     CLOSE  OUT-FILE-5
 27327*-------------------<DEBUG>---------------------------------------
 27328D    DISPLAY   CNS-PGM-ID":FILE-STATUS-5=[" WK-FILE-STATUS-5 "]"
 27329*-----------------------------------------------------------------
 27330     EVALUATE  WK-FILE-STATUS-5
 27331       WHEN  CNS-FILE-NORMAL
 27332*--------------------<DEBUG>--------------------------------------
 27333D    DISPLAY  CNS-PGM-ID":DATファイル5クローズ処理正常"
 27334*-----------------------------------------------------------------
 27335         CONTINUE
 27336       WHEN  OTHER
 27337*--------------------<DEBUG>--------------------------------------
 27338D    DISPLAY  CNS-PGM-ID":DATファイル5クローズ処理エラー"
 27339*-----------------------------------------------------------------
 27340*----------  ワークリターンコード
 27341         MOVE  CNS-16                  TO  WK-RTN-CODE
 27342*----------  ワークエラーパッケージを編集
 27343         INITIALIZE  WK-SYS-ERR-INFO
 27344*----------  エラー検知プログラムID
 27345         MOVE  CNS-PGM-ID              TO  WK-ERR-PGM-ID
 27346*----------  ポジション
 27347         MOVE  CNS-POS-064             TO  WK-ERR-POS
 27348*----------  リターンコード
 27349         MOVE  CNS-RTN-230             TO  WK-RTN-CD
 27350*----------  詳細リターンコード
 27351         MOVE  FUNCTION NUMVAL(WK-FILE-STATUS-5)
 27352                                       TO  WK-DETAIL-RTN-CD
 27353*----------  詳細リターンコードデコードフラグ
 27354         MOVE  CNS-DETAIL-0            TO  WK-DETAIL-RTN-CD-FLG
 27355*---------- フリーメッセージ
 27356         STRING  "ファイル:["
 27357                 WK-PSACT-DAT-FILE-5
 27358                 "]クローズエラー"
 27359         DELIMITED BY SPACE           INTO  WK-FREE-MSG
 27360         END-STRING
 27361*----------  エラー処理
 27362       PERFORM  ERR-RTN
 27363     END-EVALUATE
 27364*--------------------<DEBUG>--------------------------------------
 27365D    DISPLAY CNS-PGM-ID":ファイル5オープンフラグ=["
 27366D            FLG-FILE-OPEN-5"]"
 27367D    DISPLAY CNS-PGM-ID":*****DATファイル5クローズ処理 END  *****"
 27368*-----------------------------------------------------------------
 27369     CONTINUE.
 27370 CLOSE-FILE-5-EXT.
 27371     EXIT.
 27372******************************************************************
 27373*    DATファイル6クローズ処理
 27374******************************************************************
 27375 CLOSE-FILE-6-RTN       SECTION.
 27376*--------------------<DEBUG>--------------------------------------
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 473
* MUSR2651.cob                                                     cpy)cpy)y)y)
 27377D    DISPLAY  CNS-PGM-ID":*****DATファイル6クローズ処理  "
 27378D             "START  *****"
 27379*--------------------<DEBUG>--------------------------------------
 27380     MOVE  CNS-OFF                 TO  FLG-FILE-OPEN-6
 27381     CLOSE  OUT-FILE-6
 27382*-------------------<DEBUG>---------------------------------------
 27383D    DISPLAY   CNS-PGM-ID":FILE-STATUS-6=[" WK-FILE-STATUS-6 "]"
 27384*-----------------------------------------------------------------
 27385     EVALUATE  WK-FILE-STATUS-6
 27386       WHEN  CNS-FILE-NORMAL
 27387*--------------------<DEBUG>--------------------------------------
 27388D    DISPLAY  CNS-PGM-ID":DATファイル6クローズ処理正常"
 27389*-----------------------------------------------------------------
 27390         CONTINUE
 27391       WHEN  OTHER
 27392*--------------------<DEBUG>--------------------------------------
 27393D    DISPLAY  CNS-PGM-ID":DATファイル6クローズ処理エラー"
 27394*-----------------------------------------------------------------
 27395*----------  ワークリターンコード
 27396         MOVE  CNS-16                  TO  WK-RTN-CODE
 27397*----------  ワークエラーパッケージを編集
 27398         INITIALIZE  WK-SYS-ERR-INFO
 27399*----------  エラー検知プログラムID
 27400         MOVE  CNS-PGM-ID              TO  WK-ERR-PGM-ID
 27401*----------  ポジション
 27402         MOVE  CNS-POS-065             TO  WK-ERR-POS
 27403*----------  リターンコード
 27404         MOVE  CNS-RTN-230             TO  WK-RTN-CD
 27405*----------  詳細リターンコード
 27406         MOVE  FUNCTION NUMVAL(WK-FILE-STATUS-6)
 27407                                       TO  WK-DETAIL-RTN-CD
 27408*----------  詳細リターンコードデコードフラグ
 27409         MOVE  CNS-DETAIL-0            TO  WK-DETAIL-RTN-CD-FLG
 27410*---------- フリーメッセージ
 27411         STRING  "ファイル:["
 27412                 WK-PSACT-DAT-FILE-6
 27413                 "]クローズエラー"
 27414         DELIMITED BY SPACE           INTO  WK-FREE-MSG
 27415         END-STRING
 27416*----------  エラー処理
 27417       PERFORM  ERR-RTN
 27418     END-EVALUATE
 27419*--------------------<DEBUG>--------------------------------------
 27420D    DISPLAY CNS-PGM-ID":ファイル6オープンフラグ=["
 27421D            FLG-FILE-OPEN-6"]"
 27422D    DISPLAY CNS-PGM-ID":*****DATファイル6クローズ処理 END  *****"
 27423*-----------------------------------------------------------------
 27424     CONTINUE.
 27425 CLOSE-FILE-6-EXT.
 27426     EXIT.
 27427******************************************************************
 27428*    DATファイル7クローズ処理
 27429******************************************************************
 27430 CLOSE-FILE-7-RTN       SECTION.
 27431*--------------------<DEBUG>--------------------------------------
 27432D    DISPLAY  CNS-PGM-ID":*****DATファイル7クローズ処理  "
 27433D             "START  *****"
 27434*--------------------<DEBUG>--------------------------------------
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 474
* MUSR2651.cob                                                     cpy)cpy)y)y)
 27435     MOVE  CNS-OFF                 TO  FLG-FILE-OPEN-7
 27436     CLOSE  OUT-FILE-7
 27437*-------------------<DEBUG>---------------------------------------
 27438D    DISPLAY   CNS-PGM-ID":FILE-STATUS-7=[" WK-FILE-STATUS-7 "]"
 27439*-----------------------------------------------------------------
 27440     EVALUATE  WK-FILE-STATUS-7
 27441       WHEN  CNS-FILE-NORMAL
 27442*--------------------<DEBUG>--------------------------------------
 27443D    DISPLAY  CNS-PGM-ID":DATファイル7クローズ処理正常"
 27444*-----------------------------------------------------------------
 27445         CONTINUE
 27446       WHEN  OTHER
 27447*--------------------<DEBUG>--------------------------------------
 27448D    DISPLAY  CNS-PGM-ID":DATファイル7クローズ処理エラー"
 27449*-----------------------------------------------------------------
 27450*----------  ワークリターンコード
 27451         MOVE  CNS-16                  TO  WK-RTN-CODE
 27452*----------  ワークエラーパッケージを編集
 27453         INITIALIZE  WK-SYS-ERR-INFO
 27454*----------  エラー検知プログラムID
 27455         MOVE  CNS-PGM-ID              TO  WK-ERR-PGM-ID
 27456*----------  ポジション
 27457         MOVE  CNS-POS-066             TO  WK-ERR-POS
 27458*----------  リターンコード
 27459         MOVE  CNS-RTN-230             TO  WK-RTN-CD
 27460*----------  詳細リターンコード
 27461         MOVE  FUNCTION NUMVAL(WK-FILE-STATUS-7)
 27462                                       TO  WK-DETAIL-RTN-CD
 27463*----------  詳細リターンコードデコードフラグ
 27464         MOVE  CNS-DETAIL-0            TO  WK-DETAIL-RTN-CD-FLG
 27465*---------- フリーメッセージ
 27466         STRING  "ファイル:["
 27467                 WK-PSACT-DAT-FILE-7
 27468                 "]クローズエラー"
 27469         DELIMITED BY SPACE           INTO  WK-FREE-MSG
 27470         END-STRING
 27471*----------  エラー処理
 27472       PERFORM  ERR-RTN
 27473     END-EVALUATE
 27474*--------------------<DEBUG>--------------------------------------
 27475D    DISPLAY CNS-PGM-ID":ファイル7オープンフラグ=["
 27476D            FLG-FILE-OPEN-7"]"
 27477D    DISPLAY CNS-PGM-ID":*****DATファイル7クローズ処理 END  *****"
 27478*-----------------------------------------------------------------
 27479     CONTINUE.
 27480 CLOSE-FILE-7-EXT.
 27481     EXIT.
 27482******************************************************************
 27483*    DATファイル8クローズ処理
 27484******************************************************************
 27485 CLOSE-FILE-8-RTN       SECTION.
 27486*--------------------<DEBUG>--------------------------------------
 27487D    DISPLAY  CNS-PGM-ID":*****DATファイル8クローズ処理  "
 27488D             "START  *****"
 27489*--------------------<DEBUG>--------------------------------------
 27490     MOVE  CNS-OFF                 TO  FLG-FILE-OPEN-8
 27491     CLOSE  OUT-FILE-8
 27492*-------------------<DEBUG>---------------------------------------
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 475
* MUSR2651.cob                                                     cpy)cpy)y)y)
 27493D    DISPLAY   CNS-PGM-ID":FILE-STATUS-8=[" WK-FILE-STATUS-8 "]"
 27494*-----------------------------------------------------------------
 27495     EVALUATE  WK-FILE-STATUS-8
 27496       WHEN  CNS-FILE-NORMAL
 27497*--------------------<DEBUG>--------------------------------------
 27498D    DISPLAY  CNS-PGM-ID":DATファイル8クローズ処理正常"
 27499*-----------------------------------------------------------------
 27500         CONTINUE
 27501       WHEN  OTHER
 27502*--------------------<DEBUG>--------------------------------------
 27503D    DISPLAY  CNS-PGM-ID":DATファイル8クローズ処理エラー"
 27504*-----------------------------------------------------------------
 27505*----------  ワークリターンコード
 27506         MOVE  CNS-16                  TO  WK-RTN-CODE
 27507*----------  ワークエラーパッケージを編集
 27508         INITIALIZE  WK-SYS-ERR-INFO
 27509*----------  エラー検知プログラムID
 27510         MOVE  CNS-PGM-ID              TO  WK-ERR-PGM-ID
 27511*----------  ポジション
 27512         MOVE  CNS-POS-067             TO  WK-ERR-POS
 27513*----------  リターンコード
 27514         MOVE  CNS-RTN-230             TO  WK-RTN-CD
 27515*----------  詳細リターンコード
 27516         MOVE  FUNCTION NUMVAL(WK-FILE-STATUS-8)
 27517                                       TO  WK-DETAIL-RTN-CD
 27518*----------  詳細リターンコードデコードフラグ
 27519         MOVE  CNS-DETAIL-0            TO  WK-DETAIL-RTN-CD-FLG
 27520*---------- フリーメッセージ
 27521         STRING  "ファイル:["
 27522                 WK-PSACT-DAT-FILE-8
 27523                 "]クローズエラー"
 27524         DELIMITED BY SPACE           INTO  WK-FREE-MSG
 27525         END-STRING
 27526*----------  エラー処理
 27527       PERFORM  ERR-RTN
 27528     END-EVALUATE
 27529*--------------------<DEBUG>--------------------------------------
 27530D    DISPLAY CNS-PGM-ID":ファイル8オープンフラグ=["
 27531D            FLG-FILE-OPEN-8"]"
 27532D    DISPLAY CNS-PGM-ID":*****DATファイル8クローズ処理 END  *****"
 27533*-----------------------------------------------------------------
 27534     CONTINUE.
 27535 CLOSE-FILE-8-EXT.
 27536     EXIT.
 27537******************************************************************
 27538*    カーソル（FETCH）
 27539******************************************************************
 27540 CR-FETCH-2-RTN         SECTION.
 27541*-------------------<DEBUG>---------------------------------------
 27542D    DISPLAY  CNS-PGM-ID":***  カーソル2(FETCH)  START  ***"
 27543*-----------------------------------------------------------------
 27544     INITIALIZE  HST-TBL-SELECT-2
 27545*----------  CURSOR FETCH
 27546*    EXEC SQL
 27547*      FETCH CR2
 27548*      INTO  :HST-TBL-SELECT-2.H-ZANTK-YMD
 27549*    END-EXEC
 27550     MOVE 1 TO SQL-ITERS
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 476
* MUSR2651.cob                                                     cpy)cpy)y)y)
 27551     MOVE 859 TO SQL-OFFSET
 27552     MOVE 0 TO SQL-OCCURS
 27553     MOVE 1 TO SQL-SELERR
 27554     CALL "SQLADR" USING
 27555         SQLCUD
 27556         SQL-CUD
 27557     CALL "SQLADR" USING
 27558         SQLCA
 27559         SQL-SQLEST
 27560     MOVE 256 TO SQL-SQLETY
 27561     CALL "SQLADR" USING
 27562         H-ZANTK-YMD IN
 27563         HST-TBL-SELECT-2 IN
 27564         HST-AREA
 27565         SQL-SQHSTV(1)
 27566     MOVE 8 TO SQL-SQHSTL(1)
 27567     MOVE 0 TO SQL-SQHSTS(1)
 27568     MOVE 0 TO SQL-SQINDV(1)
 27569     MOVE 0 TO SQL-SQINDS(1)
 27570     MOVE 0 TO SQL-SQHARM(1)
 27571     CALL "SQLADR" USING
 27572         SQL-SQHSTV(1)
 27573         SQL-SQPHSV
 27574     CALL "SQLADR" USING
 27575         SQL-SQHSTL(1)
 27576         SQL-SQPHSL
 27577     CALL "SQLADR" USING
 27578         SQL-SQHSTS(1)
 27579         SQL-SQPHSS
 27580     CALL "SQLADR" USING
 27581         SQL-SQINDV(1)
 27582         SQL-SQPIND
 27583     CALL "SQLADR" USING
 27584         SQL-SQINDS(1)
 27585         SQL-SQPINS
 27586     CALL "SQLADR" USING
 27587         SQL-SQHARM(1)
 27588         SQL-SQPARM
 27589     CALL "SQLADR" USING
 27590         SQL-SQHARC(1)
 27591         SQL-SQPARC
 27592
 27593     CALL "SQLBEX" USING
 27594         SQLCTX
 27595         SQLEXD
 27596         SQLFPN
 27597*-------------------<DEBUG>---------------------------------------
 27598D    DISPLAY  CNS-PGM-ID":SQLCODE(CURSOR2 FETCH)  =["SQLCODE"]"
 27599*-----------------------------------------------------------------
 27600     EVALUATE  SQLCODE
 27601       WHEN  CNS-SQL-NORMAL
 27602*----------  進捗管理ＩＮＳＵＰＤルーチン NEW.基準日
 27603         MOVE  CNS-YKJ
 27604           TO  WK-TEMP-MSG-TEXT
 27605         MOVE  H-ZANTK-YMD              OF  HST-TBL-SELECT-2
 27606           TO  WK-TEMP-MSG-YKJ
 27607*-------------------<DEBUG>---------------------------------------
 27608D    DISPLAY  CNS-PGM-ID":= ["WK-TEMP-MSG"]"
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 477
* MUSR2651.cob                                                     cpy)cpy)y)y)
 27609*-----------------------------------------------------------------
 27610*--------------------<DEBUG>--------------------------------------
 27611D    DISPLAY  CNS-PGM-ID":業務タスクID=["
 27612D             WK-GYOMU-TASK-ID       OF  WK-ARGUMENT"]"
 27613*-----------------------------------------------------------------
 27614         IF  WK-GYOMU-TASK-ID       OF  WK-ARGUMENT
 27615           =  CNS-TASK-T7080US
 27616         THEN
 27617           PERFORM  SUSC0405-NEW-RTN
 27618         ELSE
 27619           CONTINUE
 27620         END-IF
 27621         INITIALIZE  WK-SEC-SBT-4156
 27622                     WK-MEG-CD-3002
 27623                     WK-SEC-SBT-3002
 27624                     WK-MEG-CD-3002-3
 27625                     WK-SEC-SBT-3002-3
 27626                     WK-MEG-CD-3004
 27627                     WK-HAKO-CD-4102
 27628                     WK-SEC-SBT-4182-2
 27629                     WK-TRHK-TUKA-4012
 27630                     WK-PRIO-3017
 27631                     WK-TRHK-TUKA-3017
 27632                     WK-CAPITAL-TUKA-3017
 27633                     WK-BIKOU-4116
 27634                     WK-TRHK-TUKA-0604
 27635                     WK-HYK-EX-FLG
 27636                     WK-PRIO-1-FLG
 27637                     WK-KWS-ZYOUHO-FLG
 27638                     WK-BIKOU-FLG
 27639                     WK-KUNI-FLG
 27640*******         テーマ3422              修正  開始        ********
 27641                     WK-TH-ZYOUHO-FLG
 27642                     WK-PRIO-CP
 27643                     WK-BASE-TUKA-CP
 27644                     WK-MOKU-TUKA-CP
 27645*-------------------<DEBUG>---------------------------------------
 27646D    DISPLAY  CNS-PGM-ID":ワーク取引決済乗除区分フラグ= ["
 27647D             WK-TH-ZYOUHO-FLG"]"
 27648D    DISPLAY  CNS-PGM-ID":ーク約定為替換算時採用系列_時価(取引"
 27649D             "通貨)用= ["WK-PRIO-CP"]"
 27650D    DISPLAY  CNS-PGM-ID":ワークベース通貨コード_時価(取引通貨)用"
 27651D             "= ["WK-BASE-TUKA-CP "]"
 27652D    DISPLAY  CNS-PGM-ID":ワーク目的通貨コード_時価(取引通貨)用"
 27653D             "= ["WK-MOKU-TUKA-CP"]"
 27654*-----------------------------------------------------------------
 27655*******         テーマ3422              修正  終了        ********
 27656*---------- 運用通貨コード,仕訳基準パタンコードを取得
 27657         IF  WK-STATUS < CNS-16
 27658           AND  (FLG-UPD NOT = CNS-OFF
 27659                 OR  WK-GYOMU-TASK-ID       OF  WK-ARGUMENT
 27660                 NOT=  CNS-TASK-T7080US)
 27661         THEN
 27662*-------------------<DEBUG>---------------------------------------
 27663D    DISPLAY  CNS-PGM-ID":H-ZANTK-YMD:= ["
 27664D             H-ZANTK-YMD         OF  HST-TBL-SELECT-2"]"
 27665*-----------------------------------------------------------------
 27666           PERFORM  SCZY4007-RTN
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 478
* MUSR2651.cob                                                     cpy)cpy)y)y)
 27667         ELSE
 27668           CONTINUE
 27669         END-IF
 27670*-------------------<DEBUG>---------------------------------------
 27671D    DISPLAY  CNS-PGM-ID":FLG-FETCH-END2 = [" FLG-FETCH-END2 "]"
 27672D    DISPLAY  CNS-PGM-ID":WK-STATUS = [" WK-STATUS "]"
 27673*-----------------------------------------------------------------
 27674*----------  1)外部コード取得処理
 27675         IF  WK-STATUS < CNS-16  AND  FLG-FETCH-END2 = CNS-OFF
 27676           AND  (FLG-UPD NOT = CNS-OFF
 27677                 OR  WK-GYOMU-TASK-ID       OF  WK-ARGUMENT
 27678                 NOT=  CNS-TASK-T7080US)
 27679         THEN
 27680*------------------ <連結障害841の対応 START>---------------------
 27681*--------------------<DEBUG>--------------------------------------
 27682D    DISPLAY  CNS-PGM-ID":WK-PTF-CD-DETAIL=["
 27683D             WK-PTF-CD-DETAIL    OF  WK-PTF-ATT-DATA(WK-IDX-J)"]"
 27684*-----------------------------------------------------------------
 27685             IF  WK-PTF-CD-DETAIL  OF  WK-PTF-ATT-DATA(WK-IDX-J)
 27686                                   NOT = SPACE
 27687             THEN
 27688*-------------------<DEBUG>---------------------------------------
 27689D    DISPLAY  CNS-PGM-ID":H-ZANTK-YMD:= ["
 27690D             H-ZANTK-YMD         OF  HST-TBL-SELECT-2"]"
 27691*-----------------------------------------------------------------
 27692*******         テーマ3406     20130117 修正  開始        ********
 27693                 IF  WK-GYOMU-TASK-ID
 27694                                OF  WK-ARGUMENT
 27695                                NOT = CNS-SBA-ZANDAKA-SETUZOKU
 27696                 THEN
 27697                     PERFORM  GAIBU-PTF-CD-RTN
 27698                 ELSE
 27699                     CONTINUE
 27700                 END-IF
 27701*******         テーマ3406     20130117 修正  終了        ********
 27702             ELSE
 27703                 MOVE  CNS-ON           TO  FLG-STOP-2
 27704*--------------------<DEBUG>--------------------------------------
 27705D    DISPLAY  CNS-PGM-ID":FLG-STOP-2   =["FLG-STOP-2"]"
 27706*-----------------------------------------------------------------
 27707             END-IF
 27708*------------------ <連結障害841の対応 END>-----------------------
 27709         ELSE
 27710             CONTINUE
 27711         END-IF
 27712*----------  3)GAMMA残高データ出力処理
 27713         IF  WK-STATUS = CNS-0  AND  FLG-FETCH-END2 = CNS-OFF
 27714           AND  (FLG-UPD NOT = CNS-OFF
 27715                 OR  WK-GYOMU-TASK-ID       OF  WK-ARGUMENT
 27716                 NOT=  CNS-TASK-T7080US)
 27717         THEN
 27718           PERFORM  DATA-OUT-2-RTN
 27719         ELSE
 27720           CONTINUE
 27721         END-IF
 27722*----------  初期化
 27723         INITIALIZE  WK-STATUS
 27724                     WK-SELECT-KENSUU
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 479
* MUSR2651.cob                                                     cpy)cpy)y)y)
 27725                     FLG-STOP
 27726         IF  FLG-UPD NOT = CNS-OFF
 27727         THEN
 27728*----------  進捗管理ＩＮＳＵＰＤルーチン OLD.基準日
 27729*--------------------<DEBUG>--------------------------------------
 27730D    DISPLAY  CNS-PGM-ID":業務タスクID=["
 27731D             WK-GYOMU-TASK-ID       OF  WK-ARGUMENT"]"
 27732*-----------------------------------------------------------------
 27733           IF  WK-GYOMU-TASK-ID       OF  WK-ARGUMENT
 27734             =  CNS-TASK-T7080US
 27735           THEN
 27736             PERFORM  SUSC0405-OLD-RTN
 27737*----------  ＤＢ コミット処理
 27738             PERFORM  DB-COMMIT1-RTN
 27739           ELSE
 27740             CONTINUE
 27741           END-IF
 27742         ELSE
 27743*-------------------<DEBUG>---------------------------------------
 27744D    DISPLAY  CNS-PGM-ID":*** 進捗管理ＩＮＳＵＰＤ処理なし  ***"
 27745*-----------------------------------------------------------------
 27746           CONTINUE
 27747         END-IF
 27748*-------------------<DEBUG>---------------------------------------
 27749D    DISPLAY  CNS-PGM-ID":FLG-MEISAI-GYOMU-ERR = ["
 27750D                         FLG-MEISAI-GYOMU-ERR "]"
 27751*-----------------------------------------------------------------
 27752*----------  業務エラー1処理
 27753         IF  FLG-MEISAI-GYOMU-ERR = CNS-ON
 27754         THEN
 27755           PERFORM  GYOMU-ERR-1-RTN
 27756         ELSE
 27757*-------------------<DEBUG>---------------------------------------
 27758D    DISPLAY  CNS-PGM-ID":**** 業務エラー1処理しない ****"
 27759*-----------------------------------------------------------------
 27760           CONTINUE
 27761         END-IF
 27762       WHEN  CNS-SQL-NOTFOUND
 27763         MOVE  CNS-ON                   TO  FLG-STOP-2
 27764       WHEN  OTHER
 27765*----------  ワーク実行ステータス
 27766         MOVE  CNS-16                   TO  WK-STATUS
 27767*----------  ワークリターンコード
 27768         MOVE  WK-STATUS                TO  WK-RTN-CODE
 27769*----------  ワークエラーパッケージを編集
 27770         INITIALIZE  WK-SYS-ERR-INFO
 27771*----------  エラー検知プログラムID
 27772         MOVE  CNS-PGM-ID               TO  WK-ERR-PGM-ID
 27773*----------  ポジション
 27774         MOVE  CNS-POS-070              TO  WK-ERR-POS
 27775*----------  リターンコード
 27776         MOVE  CNS-RTN-900              TO  WK-RTN-CD
 27777*----------  詳細リターンコード
 27778         MOVE  SQLCODE                  TO  WK-DETAIL-RTN-CD
 27779*----------  詳細リターンコードデコードフラグ
 27780         MOVE  CNS-DETAIL-1             TO  WK-DETAIL-RTN-CD-FLG
 27781*---------- フリーメッセージ
 27782         MOVE  WK-SELECT-FREE-MSG2      TO  WK-FREE-MSG
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 480
* MUSR2651.cob                                                     cpy)cpy)y)y)
 27783*----------  エラー情報追加処理
 27784         PERFORM  ERR-INFO-ADD-RTN
 27785     END-EVALUATE
 27786*-------------------<DEBUG>---------------------------------------
 27787D    DISPLAY  CNS-PGM-ID":***  カーソル2(FETCH)  END  ***"
 27788*-----------------------------------------------------------------
 27789     CONTINUE.
 27790 CR-FETCH-2-EXT.
 27791     EXIT.
 27792******************************************************************
 27793*    データ出力処理
 27794******************************************************************
 27795 DATA-OUT-2-RTN         SECTION.
 27796*--------------------<DEBUG>--------------------------------------
 27797D    DISPLAY  CNS-PGM-ID":*** データ出力処理START ***"
 27798D    DISPLAY  CNS-PGM-ID":WK-HIT-KENSU=["WK-HIT-KENSU"]"
 27799*-----------------------------------------------------------------
 27800*----------  SQL作成(PREPARE)
 27801     PERFORM  CR-PREPARE-RTN
 27802*-------------------<DEBUG>---------------------------------------
 27803D    DISPLAY  CNS-PGM-ID":WK-STATUS=["WK-STATUS"]"
 27804*-----------------------------------------------------------------
 27805*----------  カーソル作成(DECLARE，OPEN)
 27806     IF  WK-STATUS < CNS-8
 27807     THEN
 27808       PERFORM  CR-OPEN-RTN
 27809     ELSE
 27810*-------------------<DEBUG>---------------------------------------
 27811D    DISPLAY  CNS-PGM-ID":**** カーソル作成しない ****"
 27812*-----------------------------------------------------------------
 27813       CONTINUE
 27814     END-IF
 27815*-------------------<DEBUG>---------------------------------------
 27816D    DISPLAY  CNS-PGM-ID":WK-STATUS=["WK-STATUS"]"
 27817*-----------------------------------------------------------------
 27818     IF  WK-STATUS < CNS-8
 27819     THEN
 27820     MOVE FUNCTION CURRENT-DATE(1:14) TO WK-RUN-SDATETIME
 27821*-------------------<DEBUG>---------------------------------------
 27822     DISPLAY "プログラムID:        ["CNS-PGM-ID"]"                GUT2013
 27823     DISPLAY "セクション:          [DATA-OUT-2-RTN]"              GUT2013
 27824     DISPLAY "セクションの開始時間:["WK-RUN-SDATETIME"]"          GUT2013
 27825*-----------------------------------------------------------------
 27826       PERFORM  UNTIL
 27827         FLG-STOP = CNS-ON  OR  WK-RTN-CODE = CNS-16
 27828*----------  カーソルFETCH
 27829         PERFORM  CR-FETCH-RTN
 27830*
 27831         INITIALIZE  HST-TBL-SELECT
 27832                     WK-STATUS
 27833                     WK-J
 27834                     FLG-MEISAI-GYOMU-ERR
 27835                     WK-GYOMU-ERR-INFO
 27836       END-PERFORM
 27837     MOVE FUNCTION CURRENT-DATE(1:14) TO WK-RUN-EDATETIME
 27838*--------------------<DEBUG>--------------------------------------
 27839     DISPLAY "プログラムID:        ["CNS-PGM-ID"]"                GUT2013
 27840     DISPLAY "セクション:          [DATA-OUT-2-RTN]"              GUT2013
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 481
* MUSR2651.cob                                                     cpy)cpy)y)y)
 27841     DISPLAY "セクションの終了時間:["WK-RUN-EDATETIME"]"          GUT2013
 27842*-----------------------------------------------------------------
 27843     ELSE
 27844       CONTINUE
 27845     END-IF
 27846*-------------------<DEBUG>---------------------------------------
 27847D    DISPLAY  CNS-PGM-ID":FLG-CR-OPEN=["FLG-CR-OPEN"]"
 27848*-----------------------------------------------------------------
 27849*----------  カーソルクローズ処理
 27850     IF  FLG-CR-OPEN = CNS-ON
 27851     THEN
 27852       PERFORM  CR-CLOSE-RTN
 27853     ELSE
 27854*-------------------<DEBUG>---------------------------------------
 27855D    DISPLAY  CNS-PGM-ID":**** カーソルクローズ処理しない ****"
 27856*-----------------------------------------------------------------
 27857       CONTINUE
 27858     END-IF
 27859*--------------------<DEBUG>--------------------------------------
 27860D    DISPLAY  CNS-PGM-ID":WK-IDX-J=["WK-IDX-J"]"
 27861D    DISPLAY  CNS-PGM-ID":*** データ出力処理END ***"
 27862*-----------------------------------------------------------------
 27863     CONTINUE.
 27864 DATA-OUT-2-EXT.
 27865     EXIT.
 27866******************************************************************
 27867*    カーソル(CLOSE)
 27868******************************************************************
 27869 CR-CLOSE-3-RTN         SECTION.
 27870*-------------------<DEBUG>---------------------------------------
 27871D    DISPLAY  CNS-PGM-ID":***  カーソル2(CLOSE)  START  ***"
 27872*-----------------------------------------------------------------
 27873*    EXEC  SQL
 27874*        CLOSE CR2
 27875*    END-EXEC
 27876     MOVE 1 TO SQL-ITERS
 27877     MOVE 878 TO SQL-OFFSET
 27878     MOVE 0 TO SQL-OCCURS
 27879     CALL "SQLADR" USING
 27880         SQLCUD
 27881         SQL-CUD
 27882     CALL "SQLADR" USING
 27883         SQLCA
 27884         SQL-SQLEST
 27885     MOVE 256 TO SQL-SQLETY
 27886
 27887     CALL "SQLBEX" USING
 27888         SQLCTX
 27889         SQLEXD
 27890         SQLFPN
 27891*-------------------<DEBUG>---------------------------------------
 27892D    DISPLAY  CNS-PGM-ID":SQLCODE(CURSOR2 CLOSE)  =["SQLCODE"]"
 27893*-----------------------------------------------------------------
 27894     IF  SQLCODE = CNS-SQL-NORMAL
 27895     THEN
 27896       MOVE  CNS-OFF              TO  FLG-CR-OPEN2
 27897*-------------------<DEBUG>---------------------------------------
 27898D    DISPLAY  CNS-PGM-ID":FLG-CR-OPEN2          =["FLG-CR-OPEN2"]"
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 482
* MUSR2651.cob                                                     cpy)cpy)y)y)
 27899*-----------------------------------------------------------------
 27900     ELSE
 27901*----------  ワーク実行ステータス
 27902       MOVE  CNS-16               TO  WK-STATUS
 27903*----------  ワークリターンコード
 27904       MOVE  WK-STATUS            TO  WK-RTN-CODE
 27905*----------  ワークエラーパッケージを編集
 27906       INITIALIZE  WK-SYS-ERR-INFO
 27907*----------  エラー検知プログラムID
 27908       MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
 27909*----------  ポジション
 27910       MOVE  CNS-POS-089          TO  WK-ERR-POS
 27911*----------  リターンコード
 27912       MOVE  CNS-RTN-900          TO  WK-RTN-CD
 27913*----------  詳細リターンコード
 27914       MOVE  SQLCODE              TO  WK-DETAIL-RTN-CD
 27915*----------  詳細リターンコードデコードフラグ
 27916       MOVE  CNS-DETAIL-1         TO  WK-DETAIL-RTN-CD-FLG
 27917*---------- フリーメッセージ
 27918       MOVE  WK-SELECT-FREE-MSG2  TO  WK-FREE-MSG
 27919*----------  エラー情報追加処理
 27920       PERFORM  ERR-INFO-ADD-RTN
 27921     END-IF
 27922*-------------------<DEBUG>---------------------------------------
 27923D    DISPLAY  CNS-PGM-ID":***  カーソル2(CLOSE)  END  ***"
 27924*-----------------------------------------------------------------
 27925     CONTINUE.
 27926 CR-CLOSE-3-EXT.
 27927     EXIT.
 27928******************************************************************
 27929*    カーソル(CLOSE)
 27930******************************************************************
 27931 CR-CLOSE-4-RTN         SECTION.
 27932*-------------------<DEBUG>---------------------------------------
 27933D    DISPLAY  CNS-PGM-ID":***  カーソル(CLOSE)2  START  ***"
 27934*-----------------------------------------------------------------
 27935*    EXEC  SQL
 27936*        CLOSE CR2
 27937*    END-EXEC
 27938     MOVE 1 TO SQL-ITERS
 27939     MOVE 893 TO SQL-OFFSET
 27940     MOVE 0 TO SQL-OCCURS
 27941     CALL "SQLADR" USING
 27942         SQLCUD
 27943         SQL-CUD
 27944     CALL "SQLADR" USING
 27945         SQLCA
 27946         SQL-SQLEST
 27947     MOVE 256 TO SQL-SQLETY
 27948
 27949     CALL "SQLBEX" USING
 27950         SQLCTX
 27951         SQLEXD
 27952         SQLFPN
 27953*-------------------<DEBUG>---------------------------------------
 27954D    DISPLAY  CNS-PGM-ID":SQLCODE(CURSOR CLOSE)2  =["SQLCODE"]"
 27955*-----------------------------------------------------------------
 27956     IF  SQLCODE = CNS-SQL-NORMAL
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 483
* MUSR2651.cob                                                     cpy)cpy)y)y)
 27957     THEN
 27958       MOVE  CNS-OFF              TO  FLG-CR-OPEN2
 27959*-------------------<DEBUG>---------------------------------------
 27960D    DISPLAY  CNS-PGM-ID":FLG-CR-OPEN2          =["FLG-CR-OPEN2"]"
 27961*-----------------------------------------------------------------
 27962     ELSE
 27963*----------  ワークリターンコード
 27964       MOVE  CNS-16               TO  WK-RTN-CODE
 27965*----------  ワークエラーパッケージを編集
 27966       INITIALIZE  WK-SYS-ERR-INFO
 27967*----------  エラー検知プログラムID
 27968       MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
 27969*----------  ポジション
 27970       MOVE  CNS-POS-090          TO  WK-ERR-POS
 27971*----------  リターンコード
 27972       MOVE  CNS-RTN-900          TO  WK-RTN-CD
 27973*----------  詳細リターンコード
 27974       MOVE  SQLCODE              TO  WK-DETAIL-RTN-CD
 27975*----------  詳細リターンコードデコードフラグ
 27976       MOVE  CNS-DETAIL-1         TO  WK-DETAIL-RTN-CD-FLG
 27977*---------- フリーメッセージ
 27978       MOVE  WK-SELECT-FREE-MSG2  TO  WK-FREE-MSG
 27979*----------  エラー処理
 27980       PERFORM  ERR-RTN
 27981     END-IF
 27982*-------------------<DEBUG>---------------------------------------
 27983D    DISPLAY  CNS-PGM-ID":***  カーソル(CLOSE)2  END  ***"
 27984*-----------------------------------------------------------------
 27985     CONTINUE.
 27986 CR-CLOSE-4-EXT.
 27987     EXIT.
 27988******************************************************************
 27989*    GX接続用銘柄コード編集ルーチン
 27990******************************************************************
 27991 SCZY3026-RTN           SECTION.
 27992*--------------------<DEBUG>--------------------------------------
 27993D    DISPLAY  CNS-PGM-ID":***  GX接続用銘柄コード編集"
 27994D             " START  ***"
 27995*----------------------------------------------------------------
 27996     INITIALIZE  PARM-SCZY3026-INOUT
 27997                 PARM-RTNPKG
 27998*----------  銘柄コード
 27999     MOVE  WK-GAIBU-MEG-CD
 28000       TO  MEG-CD                 OF  PARM-SCZY3026-ARG1
 28001*----------  銘柄通貨
 28002     MOVE  WK-TRHK-TUKA
 28003       TO  MEG-TUKA-CD            OF  PARM-SCZY3026-ARG1
 28004*---------- 証券種別
 28005     MOVE  WK-SEC-SBT-CD-3
 28006       TO  SEC-SBT-CD             OF  PARM-SCZY3026-ARG1
 28007*---------- 株式種別
 28008     MOVE  WK-RF-KABU-SBT
 28009       TO  KABU-SBT               OF  PARM-SCZY3026-ARG1
 28010*--------------------<DEBUG>--------------------------------------
 28011D    DISPLAY  CNS-PGM-ID":銘柄コ=["
 28012D             MEG-CD                 OF  PARM-SCZY3026-ARG1"]"
 28013D    DISPLAY  CNS-PGM-ID":銘柄通貨=["
 28014D             MEG-TUKA-CD            OF  PARM-SCZY3026-ARG1"]"
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 484
* MUSR2651.cob                                                     cpy)cpy)y)y)
 28015D    DISPLAY  CNS-PGM-ID":証券種別=["
 28016D             SEC-SBT-CD             OF  PARM-SCZY3026-ARG1"]"
 28017D    DISPLAY  CNS-PGM-ID":株式種別=["
 28018D             KABU-SBT               OF  PARM-SCZY3026-ARG1"]"
 28019D    DISPLAY  CNS-PGM-ID":***  CALL SCZY3026 START  ***"
 28020*----------------------------------------------------------------
 28021     CALL  "SCZY3026"             USING  PARM-SCZY3026-INOUT
 28022                                         PARM-RTNPKG
 28023*--------------------<DEBUG>-------------------------------------
 28024D    DISPLAY  CNS-PGM-ID":***  CALL SCZY3026 END  ***"
 28025D    DISPLAY  CNS-PGM-ID":RTN-CD(SCZY3026)       =["
 28026D             RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)"]"
 28027D    DISPLAY  CNS-PGM-ID":COUNTER OF PARM-RTNPKG =["
 28028D             COUNTER             OF PARM-RTNPKG "]"
 28029*----------------------------------------------------------------
 28030     EVALUATE  RTN-CD OF PARM-RTNPKG(COUNTER OF PARM-RTNPKG)
 28031*----------  正常
 28032       WHEN  CNS-RTN-000
 28033*---------- 銘柄コード
 28034         MOVE  MEG-CD        OF  PARM-SCZY3026-ARG2
 28035           TO  WK-GAIBU-MEG-CD1
 28036       WHEN  CNS-RTN-800
 28037*----------  ワーク実行ステータス
 28038         IF  WK-STATUS < CNS-4
 28039         THEN
 28040           MOVE  CNS-4                 TO  WK-STATUS
 28041         ELSE
 28042           CONTINUE
 28043         END-IF
 28044*----------  ワークリターンコード
 28045         IF  WK-STATUS > WK-RTN-CODE
 28046         THEN
 28047           MOVE  WK-STATUS           TO  WK-RTN-CODE
 28048         ELSE
 28049           CONTINUE
 28050         END-IF
 28051*----------  1190実行ステータス
 28052         IF  WK-STATUS > WK-1190-STATUS
 28053         THEN
 28054           MOVE  WK-STATUS      TO  WK-1190-STATUS
 28055         ELSE
 28056           CONTINUE
 28057         END-IF
 28058*-------------------<DEBUG>---------------------------------------
 28059D    DISPLAY  CNS-PGM-ID":WK-J=["WK-J"]"
 28060*-----------------------------------------------------------------
 28061         COMPUTE  WK-J = WK-J + CNS-1
 28062*-------------------<DEBUG>---------------------------------------
 28063D    DISPLAY  CNS-PGM-ID":WK-J=["WK-J"]"
 28064*-----------------------------------------------------------------
 28065*----------  明細業務エラーフラグ
 28066         MOVE  CNS-ON             TO  FLG-MEISAI-GYOMU-ERR
 28067*----------  基準日実行ステータス
 28068*---------- ファンドコード
 28069         MOVE  WK-FUND-CD-DETAIL  OF  WK-FUND-PTF-DETAIL(WK-IDX-J)
 28070           TO  WK-GYOMU-FUND-CD
 28071                   OF  WK-GYOMU-ERR-INFO(WK-J)
 28072*---------- ポートフォリオコード
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 485
* MUSR2651.cob                                                     cpy)cpy)y)y)
 28073         MOVE  WK-PTF-CD-DETAIL   OF  WK-FUND-PTF-DETAIL(WK-IDX-J)
 28074           TO  WK-GYOMU-PTF-CD
 28075                   OF  WK-GYOMU-ERR-INFO(WK-J)
 28076*---------- 評価系列コード
 28077         MOVE  WK-DEFAUL-THYK-CD  OF  WK-FUND-PTF-DETAIL(WK-IDX-J)
 28078            TO  WK-GYOMU-HYK-KRTU-CD
 28079                   OF  WK-GYOMU-ERR-INFO(WK-J)
 28080*---------- 基準日From
 28081         MOVE  WK-KIKAN-FR
 28082           TO  WK-GYOMU-KJN-YMD-FROM
 28083                   OF  WK-GYOMU-ERR-INFO(WK-J)
 28084*---------- 基準日To
 28085         MOVE  WK-KIKAN-TO
 28086           TO  WK-GYOMU-KJN-YMD-TO
 28087                   OF  WK-GYOMU-ERR-INFO(WK-J)
 28088*---------- メッセージID
 28089         MOVE  CNS-MSG-E000189
 28090           TO  WK-GYOMU-MSG-ID
 28091                   OF  WK-GYOMU-ERR-INFO(WK-J)
 28092*---------- 置換文字
 28093         MOVE  SPACE
 28094           TO  WK-GYOMU-TK-MOJI(WK-J,CNS-1)
 28095*---------- フリーメッセージ
 28096         STRING  CNS-MEG-TEXT     DELIMITED BY SPACE
 28097                 WK-GAIBU-MEG-CD  DELIMITED BY SIZE
 28098                 CNS-TUK-TEXT     DELIMITED BY SPACE
 28099                 WK-TRHK-TUKA     DELIMITED BY SPACE
 28100                 CNS-SEC-TEXT     DELIMITED BY SPACE
 28101                 WK-SEC-SBT-CD-3  DELIMITED BY SPACE
 28102                 CNS-SSE-TEXT     DELIMITED BY SPACE
 28103                 WK-RF-KABU-SBT   DELIMITED BY SPACE
 28104            INTO   WK-GYOMU-FREE-MSG  OF  WK-GYOMU-ERR-INFO(WK-J)
 28105         END-STRING
 28106*----------  上記以外
 28107       WHEN  OTHER
 28108         CONTINUE
 28109     END-EVALUATE
 28110*--------------------<DEBUG>--------------------------------------
 28111D    DISPLAY  CNS-PGM-ID":WK-GAIBU-MEG-CD1=["WK-GAIBU-MEG-CD1"]"
 28112D    DISPLAY  CNS-PGM-ID":***  GX接続用銘柄コード編集"
 28113D             " END  ***"
 28114*-----------------------------------------------------------------
 28115     CONTINUE.
 28116 SCZY3026-EXT.
 28117     EXIT.
 28118******************************************************************
 28119*    3) 締めチェック処理
 28120******************************************************************
 28121*******         テーマ2682     20100404 修正  開始        ********
 28122 SINU-CHECK-RTN         SECTION.
 28123*******         テーマ2682     20100404 修正  終了        ********
 28124*--------------------<DEBUG>--------------------------------------
 28125D    DISPLAY  CNS-PGM-ID":***  締めチェック処理 START  ***"
 28126D    DISPLAY  CNS-PGM-ID":I-HYK-KRTU-KBN=[" I-HYK-KRTU-KBN
 28127D                                 OF  WK-DENBUN-INFO"]"
 28128*-----------------------------------------------------------------
 28129*******         テーマ2693     20100404 修正  開始        ********
 28130     IF  I-HYK-KRTU-KBN           OF  WK-DENBUN-INFO = CNS-X-2
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 486
* MUSR2651.cob                                                     cpy)cpy)y)y)
 28131     THEN
 28132       PERFORM  SELECT-KAKUTE-RTN
 28133     ELSE
 28134*******         テーマ2693     20100404 修正  終了        ********
 28135*----------  進捗管理テーブル基準日取得2
 28136       PERFORM  SELECT-KIJUN-2-RTN
 28137*******         テーマ2693     20100404 修正  開始        ********
 28138     END-IF
 28139*******         テーマ2693     20100404 修正  終了        ********
 28140*--------------------<DEBUG>--------------------------------------
 28141D    DISPLAY  CNS-PGM-ID":***  締めチェック処理 END  ***"
 28142*-----------------------------------------------------------------
 28143     CONTINUE.
 28144 SINU-CHECK-EXT.
 28145     EXIT.
 28146*******         テーマ2693     20100404 修正  開始        ********
 28147******************************************************************
 28148*    デフォルト評価系列で締めチェック処理
 28149******************************************************************
 28150 SELECT-KAKUTE-RTN      SECTION.
 28151*--------------------<DEBUG>--------------------------------------
 28152D    DISPLAY  CNS-PGM-ID
 28153D        ":***  締めチェック処理（デフォルト評価系列） START  ***"
 28154*-----------------------------------------------------------------
 28155*----------  デフォルト評価系列で締めチェック処理カーソルPREPARE
 28156     PERFORM  CR-PREPARE-3-RTN
 28157*----------  デフォルト評価系列で締めチェック処理カーソルOPEN
 28158     PERFORM  CR-OPEN-3-RTN
 28159*----------  デフォルト評価系列で締めチェック処理カーソルETCH
 28160     PERFORM  CR-FETCH-3-RTN
 28161*----------  カーソルクローズ処理
 28162     IF  FLG-CR-OPEN3 = CNS-ON
 28163     THEN
 28164       PERFORM  CR-CLOSE-5-RTN
 28165     ELSE
 28166*-------------------<DEBUG>---------------------------------------
 28167D    DISPLAY  CNS-PGM-ID":**** カーソルクローズ処理しない ****"
 28168*-----------------------------------------------------------------
 28169       CONTINUE
 28170     END-IF
 28171*--------------------<DEBUG>--------------------------------------
 28172D    DISPLAY  CNS-PGM-ID
 28173D        ":***  締めチェック処理（デフォルト評価系列） END  ***"
 28174*-----------------------------------------------------------------
 28175     CONTINUE.
 28176 SELECT-KAKUTE-EXT.
 28177     EXIT.
 28178*******         テーマ2693     20100404 修正  終了        ********
 28179******************************************************************
 28180*    進捗管理テーブル基準日取得処理2
 28181******************************************************************
 28182*******         テーマ2682     20100404 修正  開始        ********
 28183 SELECT-KIJUN-2-RTN     SECTION.
 28184*******         テーマ2682     20100404 修正  終了        ********
 28185*--------------------<DEBUG>--------------------------------------
 28186D    DISPLAY  CNS-PGM-ID":***  進捗管理テーブル基準日取得処理2"
 28187D             " START  ***"
 28188*-----------------------------------------------------------------
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 487
* MUSR2651.cob                                                     cpy)cpy)y)y)
 28189*----------  SEL-KJN-2-SQL作成(PREPARE)
 28190     PERFORM  SEL-KJN-2-PRE-RTN
 28191*-------------------<DEBUG>---------------------------------------
 28192D    DISPLAY  CNS-PGM-ID":WK-STATUS=["WK-STATUS"]"
 28193*-----------------------------------------------------------------
 28194*----------  SEL-KJN-2-SQL作成(EXECUTE)
 28195     IF  WK-STATUS < CNS-16
 28196     THEN
 28197       PERFORM  SEL-KJN-2-EXE-RTN
 28198     ELSE
 28199*-------------------<DEBUG>---------------------------------------
 28200D    DISPLAY  CNS-PGM-ID":**** SEL-KJN-2(EXECUTE)処理しない ****"
 28201*-----------------------------------------------------------------
 28202       CONTINUE
 28203     END-IF
 28204*-------------------<DEBUG>---------------------------------------
 28205D    DISPLAY  CNS-PGM-ID":WK-STATUS=["WK-STATUS"]"
 28206*-----------------------------------------------------------------
 28207     IF  WK-STATUS < CNS-16
 28208     THEN
 28209*----------  日付の判断処理
 28210       PERFORM  DATE-CHECK-RTN
 28211     ELSE
 28212       CONTINUE
 28213*-------------------<DEBUG>---------------------------------------
 28214D    DISPLAY  CNS-PGM-ID":日付の判断処理しない"
 28215*-----------------------------------------------------------------
 28216     END-IF
 28217*--------------------<DEBUG>--------------------------------------
 28218D    DISPLAY  CNS-PGM-ID":***  進捗管理テーブル基準日取得処理2"
 28219D             " END  ***"
 28220*-----------------------------------------------------------------
 28221     CONTINUE.
 28222 SELECT-KIJUN-2-EXT.
 28223     EXIT.
 28224******************************************************************
 28225*    SEL-KJN-2-SQL作成(PREPARE)
 28226******************************************************************
 28227*******         テーマ2682     20100404 修正  開始        ********
 28228 SEL-KJN-2-PRE-RTN      SECTION.
 28229*******         テーマ2682     20100404 修正  終了        ********
 28230*-------------------<DEBUG>---------------------------------------
 28231D    DISPLAY  CNS-PGM-ID":*** SEL-KJN-2-SQL作成(PREPARE)START ***"
 28232*-----------------------------------------------------------------
 28233     INITIALIZE  SQLSTMT-S-TKDYAA40
 28234                 HST-TBL-TKDYAA40-SELECT
 28235                 HST-SEL-TKDYAA40-WHERE
 28236                 WK-SEL-TKDYAA40-FREE-MSG
 28237*----------  テーブルTKDYAA40
 28238     MOVE  WK-TBL-TKDYAA40
 28239       TO  SQL-TBL-TKDYAA40       OF  SQL-SELECT-TKDYAA40
 28240*----------  利用会社コード
 28241     MOVE  WK-RIYO-CMP-CD
 28242       TO  H-RIYO-CMP-CD          OF  HST-SEL-TKDYAA40-WHERE
 28243*----------  ファンドコード
 28244     MOVE  WK-FUND-CD-DETAIL      OF  WK-FUND-PTF-DETAIL(WK-IDX-J)
 28245       TO  H-FUND-CD              OF  HST-SEL-TKDYAA40-WHERE
 28246*----------  ポートフォリオコード
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 488
* MUSR2651.cob                                                     cpy)cpy)y)y)
 28247     MOVE  WK-PTF-CD-DETAIL       OF  WK-FUND-PTF-DETAIL(WK-IDX-J)
 28248       TO  H-PTF-CD               OF  HST-SEL-TKDYAA40-WHERE
 28249*----------  評価系列コード
 28250     MOVE  WK-DEFAUL-THYK-CD      OF  WK-FUND-PTF-DETAIL(WK-IDX-J)
 28251       TO  H-HYK-KRTU-CD          OF  HST-SEL-TKDYAA40-WHERE
 28252*----------  進捗タスクID←GX残高データ接続
 28253     MOVE  CNS-ST01100
 28254       TO  H-SHINTK-TASK-ID       OF  HST-SEL-TKDYAA40-WHERE
 28255*----------  進捗ステータス←"確定済"
 28256     MOVE  CNS-SHINTK-STS-000
 28257       TO  H-SHINTK-STS           OF  HST-SEL-TKDYAA40-WHERE
 28258     MOVE  SQL-SELECT-TKDYAA40    TO  SQLSTMT-S-TKDYAA40
 28259     STRING SQLSTMT-S-TKDYAA40(1:FUNCTION
 28260                                  LENGTH(SQL-SELECT-TKDYAA40))
 28261          "[:V1="
 28262           H-KJN-YMD              OF  HST-TBL-TKDYAA40-SELECT
 28263          "][:V2="
 28264           H-RIYO-CMP-CD          OF  HST-SEL-TKDYAA40-WHERE
 28265          "][:V3="
 28266           H-FUND-CD              OF  HST-SEL-TKDYAA40-WHERE
 28267          "][:V4="
 28268           H-PTF-CD               OF  HST-SEL-TKDYAA40-WHERE
 28269          "][:V5="
 28270           H-HYK-KRTU-CD          OF  HST-SEL-TKDYAA40-WHERE
 28271          "][:V6="
 28272           H-SHINTK-TASK-ID       OF  HST-SEL-TKDYAA40-WHERE
 28273          "][:V7="
 28274           H-SHINTK-STS           OF  HST-SEL-TKDYAA40-WHERE
 28275          "]"
 28276          DELIMITED BY SIZE
 28277          INTO  WK-SEL-TKDYAA40-FREE-MSG
 28278     END-STRING
 28279*-------------------<DEBUG>---------------------------------------
 28280D    DISPLAY  CNS-PGM-ID":SQLSTMT-S-TKDYAA40 =["
 28281D             SQLSTMT-S-TKDYAA40"]"
 28282D    DISPLAY  CNS-PGM-ID":WK-SEL-TKDYAA40-FREE-MSG =["
 28283D             WK-SEL-TKDYAA40-FREE-MSG"]"
 28284*-----------------------------------------------------------------
 28285*    EXEC  SQL
 28286*      PREPARE  TKDYAA40  FROM  :SQLSTMT-S-TKDYAA40
 28287*    END-EXEC
 28288     MOVE 1 TO SQL-ITERS
 28289     MOVE 908 TO SQL-OFFSET
 28290     MOVE 0 TO SQL-OCCURS
 28291     CALL "SQLADR" USING
 28292         SQLCUD
 28293         SQL-CUD
 28294     CALL "SQLADR" USING
 28295         SQLCA
 28296         SQL-SQLEST
 28297     MOVE 256 TO SQL-SQLETY
 28298     CALL "SQLADR" USING
 28299         SQLSTMT-S-TKDYAA40 IN
 28300         HST-AREA
 28301         SQL-SQHSTV(1)
 28302     MOVE 3000 TO SQL-SQHSTL(1)
 28303     MOVE 0 TO SQL-SQHSTS(1)
 28304     MOVE 0 TO SQL-SQINDV(1)
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 489
* MUSR2651.cob                                                     cpy)cpy)y)y)
 28305     MOVE 0 TO SQL-SQINDS(1)
 28306     MOVE 0 TO SQL-SQHARM(1)
 28307     CALL "SQLADR" USING
 28308         SQL-SQHSTV(1)
 28309         SQL-SQPHSV
 28310     CALL "SQLADR" USING
 28311         SQL-SQHSTL(1)
 28312         SQL-SQPHSL
 28313     CALL "SQLADR" USING
 28314         SQL-SQHSTS(1)
 28315         SQL-SQPHSS
 28316     CALL "SQLADR" USING
 28317         SQL-SQINDV(1)
 28318         SQL-SQPIND
 28319     CALL "SQLADR" USING
 28320         SQL-SQINDS(1)
 28321         SQL-SQPINS
 28322     CALL "SQLADR" USING
 28323         SQL-SQHARM(1)
 28324         SQL-SQPARM
 28325     CALL "SQLADR" USING
 28326         SQL-SQHARC(1)
 28327         SQL-SQPARC
 28328
 28329     CALL "SQLBEX" USING
 28330         SQLCTX
 28331         SQLEXD
 28332         SQLFPN
 28333*-------------------<DEBUG>---------------------------------------
 28334D    DISPLAY  CNS-PGM-ID":SQLCODE(PREPARE)       =["SQLCODE"]"
 28335*-----------------------------------------------------------------
 28336     EVALUATE  SQLCODE
 28337       WHEN  CNS-SQL-NORMAL
 28338         CONTINUE
 28339       WHEN   OTHER
 28340*----------  ワーク実行ステータス
 28341         MOVE  CNS-16               TO  WK-STATUS
 28342*----------  ワークリターンコード
 28343         MOVE  WK-STATUS            TO  WK-RTN-CODE
 28344*----------  ワークエラーパッケージを編集
 28345         INITIALIZE  WK-SYS-ERR-INFO
 28346*----------  エラー検知プログラムID
 28347         MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
 28348*----------  ポジション
 28349         MOVE  CNS-POS-091          TO  WK-ERR-POS
 28350*----------  リターンコード
 28351         MOVE  CNS-RTN-900          TO  WK-RTN-CD
 28352*----------  詳細リターンコード
 28353         MOVE  SQLCODE              TO  WK-DETAIL-RTN-CD
 28354*----------  詳細リターンコードデコードフラグ
 28355         MOVE  CNS-DETAIL-1         TO  WK-DETAIL-RTN-CD-FLG
 28356*---------- フリーメッセージ
 28357         MOVE  WK-SEL-TKDYAA40-FREE-MSG
 28358                                    TO  WK-FREE-MSG
 28359*----------  エラー情報追加処理
 28360         PERFORM  ERR-INFO-ADD-RTN
 28361     END-EVALUATE
 28362*-------------------<DEBUG>---------------------------------------
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 490
* MUSR2651.cob                                                     cpy)cpy)y)y)
 28363D    DISPLAY  CNS-PGM-ID":*** SEL-KJN-2-SQL作成(PREPARE) END ***"
 28364*-----------------------------------------------------------------
 28365     CONTINUE.
 28366 SEL-KJN-2-PRE-EXT.
 28367     EXIT.
 28368******************************************************************
 28369*    SEL-KJN-2-SQL作成(EXECUTE)
 28370******************************************************************
 28371*******         テーマ2682     20100404 修正  開始        ********
 28372 SEL-KJN-2-EXE-RTN      SECTION.
 28373*******         テーマ2682     20100404 修正  終了        ********
 28374*-------------------<DEBUG>---------------------------------------
 28375D    DISPLAY  CNS-PGM-ID":*** SEL-KJN-2-SQL作成(EXECUTE)START ***"
 28376*-----------------------------------------------------------------
 28377*    EXEC SQL EXECUTE TKDYAA40
 28378*          USING :HST-TBL-TKDYAA40-SELECT.H-KJN-YMD,
 28379*                :HST-SEL-TKDYAA40-WHERE.H-RIYO-CMP-CD,
 28380*                :HST-SEL-TKDYAA40-WHERE.H-FUND-CD,
 28381*                :HST-SEL-TKDYAA40-WHERE.H-PTF-CD,
 28382*                :HST-SEL-TKDYAA40-WHERE.H-HYK-KRTU-CD,
 28383*                :HST-SEL-TKDYAA40-WHERE.H-SHINTK-TASK-ID,
 28384*                :HST-SEL-TKDYAA40-WHERE.H-SHINTK-STS
 28385*    END-EXEC
 28386     MOVE 1 TO SQL-ITERS
 28387     MOVE 927 TO SQL-OFFSET
 28388     MOVE 0 TO SQL-OCCURS
 28389     CALL "SQLADR" USING
 28390         SQLCUD
 28391         SQL-CUD
 28392     CALL "SQLADR" USING
 28393         SQLCA
 28394         SQL-SQLEST
 28395     MOVE 256 TO SQL-SQLETY
 28396     CALL "SQLADR" USING
 28397         H-KJN-YMD IN
 28398         HST-TBL-TKDYAA40-SELECT IN
 28399         HST-AREA
 28400         SQL-SQHSTV(1)
 28401     MOVE 8 TO SQL-SQHSTL(1)
 28402     MOVE 0 TO SQL-SQHSTS(1)
 28403     MOVE 0 TO SQL-SQINDV(1)
 28404     MOVE 0 TO SQL-SQINDS(1)
 28405     MOVE 0 TO SQL-SQHARM(1)
 28406     CALL "SQLADR" USING
 28407         H-RIYO-CMP-CD IN
 28408         HST-SEL-TKDYAA40-WHERE IN
 28409         HST-AREA
 28410         SQL-SQHSTV(2)
 28411     MOVE 4 TO SQL-SQHSTL(2)
 28412     MOVE 0 TO SQL-SQHSTS(2)
 28413     MOVE 0 TO SQL-SQINDV(2)
 28414     MOVE 0 TO SQL-SQINDS(2)
 28415     MOVE 0 TO SQL-SQHARM(2)
 28416     CALL "SQLADR" USING
 28417         H-FUND-CD IN
 28418         HST-SEL-TKDYAA40-WHERE IN
 28419         HST-AREA
 28420         SQL-SQHSTV(3)
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 491
* MUSR2651.cob                                                     cpy)cpy)y)y)
 28421     MOVE 12 TO SQL-SQHSTL(3)
 28422     MOVE 0 TO SQL-SQHSTS(3)
 28423     MOVE 0 TO SQL-SQINDV(3)
 28424     MOVE 0 TO SQL-SQINDS(3)
 28425     MOVE 0 TO SQL-SQHARM(3)
 28426     CALL "SQLADR" USING
 28427         H-PTF-CD IN
 28428         HST-SEL-TKDYAA40-WHERE IN
 28429         HST-AREA
 28430         SQL-SQHSTV(4)
 28431     MOVE 4 TO SQL-SQHSTL(4)
 28432     MOVE 0 TO SQL-SQHSTS(4)
 28433     MOVE 0 TO SQL-SQINDV(4)
 28434     MOVE 0 TO SQL-SQINDS(4)
 28435     MOVE 0 TO SQL-SQHARM(4)
 28436     CALL "SQLADR" USING
 28437         H-HYK-KRTU-CD IN
 28438         HST-SEL-TKDYAA40-WHERE IN
 28439         HST-AREA
 28440         SQL-SQHSTV(5)
 28441     MOVE 4 TO SQL-SQHSTL(5)
 28442     MOVE 0 TO SQL-SQHSTS(5)
 28443     MOVE 0 TO SQL-SQINDV(5)
 28444     MOVE 0 TO SQL-SQINDS(5)
 28445     MOVE 0 TO SQL-SQHARM(5)
 28446     CALL "SQLADR" USING
 28447         H-SHINTK-TASK-ID IN
 28448         HST-SEL-TKDYAA40-WHERE IN
 28449         HST-AREA
 28450         SQL-SQHSTV(6)
 28451     MOVE 7 TO SQL-SQHSTL(6)
 28452     MOVE 0 TO SQL-SQHSTS(6)
 28453     MOVE 0 TO SQL-SQINDV(6)
 28454     MOVE 0 TO SQL-SQINDS(6)
 28455     MOVE 0 TO SQL-SQHARM(6)
 28456     CALL "SQLADR" USING
 28457         H-SHINTK-STS IN
 28458         HST-SEL-TKDYAA40-WHERE IN
 28459         HST-AREA
 28460         SQL-SQHSTV(7)
 28461     MOVE 3 TO SQL-SQHSTL(7)
 28462     MOVE 0 TO SQL-SQHSTS(7)
 28463     MOVE 0 TO SQL-SQINDV(7)
 28464     MOVE 0 TO SQL-SQINDS(7)
 28465     MOVE 0 TO SQL-SQHARM(7)
 28466     CALL "SQLADR" USING
 28467         SQL-SQHSTV(1)
 28468         SQL-SQPHSV
 28469     CALL "SQLADR" USING
 28470         SQL-SQHSTL(1)
 28471         SQL-SQPHSL
 28472     CALL "SQLADR" USING
 28473         SQL-SQHSTS(1)
 28474         SQL-SQPHSS
 28475     CALL "SQLADR" USING
 28476         SQL-SQINDV(1)
 28477         SQL-SQPIND
 28478     CALL "SQLADR" USING
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 492
* MUSR2651.cob                                                     cpy)cpy)y)y)
 28479         SQL-SQINDS(1)
 28480         SQL-SQPINS
 28481     CALL "SQLADR" USING
 28482         SQL-SQHARM(1)
 28483         SQL-SQPARM
 28484     CALL "SQLADR" USING
 28485         SQL-SQHARC(1)
 28486         SQL-SQPARC
 28487
 28488     CALL "SQLBEX" USING
 28489         SQLCTX
 28490         SQLEXD
 28491         SQLFPN
 28492*-------------------<DEBUG>---------------------------------------
 28493D    DISPLAY  CNS-PGM-ID":SQLCODE(EXECUTE)= [" SQLCODE "]"
 28494*-----------------------------------------------------------------
 28495     EVALUATE  SQLCODE
 28496       WHEN  CNS-SQL-NORMAL
 28497*-------------------<DEBUG>---------------------------------------
 28498D    DISPLAY  CNS-PGM-ID":H-KJN-YMD OF  HST-TBL-TKDYAA40-SELECT=["
 28499D             H-KJN-YMD             OF  HST-TBL-TKDYAA40-SELECT"]"
 28500*-----------------------------------------------------------------
 28501         MOVE  H-KJN-YMD OF HST-TBL-TKDYAA40-SELECT
 28502           TO  WK-END-YMD-KJN-9
 28503*-------------------<DEBUG>---------------------------------------
 28504D    DISPLAY  CNS-PGM-ID":WK-END-YMD-KJN-9=["WK-END-YMD-KJN-9"]"
 28505*-----------------------------------------------------------------
 28506       WHEN  OTHER
 28507*----------  ワーク実行ステータス
 28508         MOVE  CNS-16               TO  WK-STATUS
 28509*----------  ワークリターンコード
 28510         MOVE  WK-STATUS            TO  WK-RTN-CODE
 28511*--------  ワークエラーパッケージを編集
 28512         INITIALIZE  WK-SYS-ERR-INFO
 28513*----------  エラー検知プログラムID
 28514         MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
 28515*----------  ポジション
 28516         MOVE  CNS-POS-092          TO  WK-ERR-POS
 28517*----------  リターンコード
 28518         MOVE  CNS-RTN-900          TO  WK-RTN-CD
 28519*----------  詳細リターンコード
 28520         MOVE  SQLCODE              TO  WK-DETAIL-RTN-CD
 28521*----------  詳細リターンコードデコードフラグ
 28522         MOVE  CNS-DETAIL-1         TO  WK-DETAIL-RTN-CD-FLG
 28523*---------- フリーメッセージ
 28524         MOVE  WK-SEL-TKDYAA40-FREE-MSG
 28525                                    TO  WK-FREE-MSG
 28526*----------  エラー情報追加処理
 28527         PERFORM  ERR-INFO-ADD-RTN
 28528     END-EVALUATE
 28529*-------------------<DEBUG>---------------------------------------
 28530D    DISPLAY  CNS-PGM-ID":***  SEL-KJN-2-SQL作成(EXECUTE) END ***"
 28531*-----------------------------------------------------------------
 28532     CONTINUE.
 28533 SEL-KJN-2-EXE-EXT.
 28534     EXIT.
 28535******************************************************************
 28536*    日付の判断処理
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 493
* MUSR2651.cob                                                     cpy)cpy)y)y)
 28537******************************************************************
 28538*******         テーマ2682     20100404 修正  開始        ********
 28539 DATE-CHECK-RTN         SECTION.
 28540*******         テーマ2682     20100404 修正  終了        ********
 28541*--------------------<DEBUG>--------------------------------------
 28542D    DISPLAY  CNS-PGM-ID":***  日付の判断処理  START  ***"
 28543*-----------------------------------------------------------------
 28544*-------------------<DEBUG>---------------------------------------
 28545D    DISPLAY  CNS-PGM-ID":ワークGAMMA残高確定日= ["
 28546D             WK-END-YMD-KJN-9 "]"
 28547D    DISPLAY  CNS-PGM-ID":PTF期間FROM= [" WK-KZYN-YMD-FROM
 28548D                       OF  WK-PTF-ATT-DATA(WK-IDX-J) "]"
 28549D    DISPLAY  CNS-PGM-ID":PTF期間TO  = [" WK-KZYN-YMD-TO
 28550D                       OF  WK-PTF-ATT-DATA(WK-IDX-J) "]"
 28551*-----------------------------------------------------------------
 28552     IF  WK-KIKAN-FR-9 = WK-KIKAN-TO-9 THEN
 28553       IF  WK-KIKAN-FR-9 = WK-END-YMD-KJN-9  THEN
 28554*----------  次のto年月日へ進む
 28555         MOVE  CNS-ON             TO  FLG-NEXT-MEISAI
 28556*----------  ワーク実行ステータス
 28557*------------------ <残タスク157の対応 START>---------------------
 28558         IF  WK-STATUS < CNS-4
 28559         THEN
 28560           MOVE  CNS-4            TO  WK-STATUS
 28561         ELSE
 28562           CONTINUE
 28563         END-IF
 28564*------------------ <残タスク157の対応 END>-----------------------
 28565*----------  ワークリターンコード
 28566         IF  WK-STATUS > WK-RTN-CODE
 28567         THEN
 28568           MOVE  WK-STATUS        TO  WK-RTN-CODE
 28569         ELSE
 28570           CONTINUE
 28571         END-IF
 28572*--------------------<DEBUG>--------------------------------------
 28573D    DISPLAY  CNS-PGM-ID":WK-RTN-CODE=["WK-RTN-CODE"]"
 28574*-----------------------------------------------------------------
 28575*----------  ワーク業務エラーパッケージを編集
 28576         INITIALIZE  WK-GYOMU-ERR-INFO
 28577*----------  基準日実行ステータス
 28578*---------- ファンドコード
 28579         MOVE  WK-FUND-CD-DETAIL    OF  WK-PTF-ATT-DATA(WK-IDX-J)
 28580           TO  WK-GYOMU-FUND-CD     OF  WK-GYOMU-ERR-INFO(CNS-1)
 28581*---------- ポートフォリオコード
 28582         MOVE  WK-PTF-CD-DETAIL     OF  WK-PTF-ATT-DATA(WK-IDX-J)
 28583           TO  WK-GYOMU-PTF-CD      OF  WK-GYOMU-ERR-INFO(CNS-1)
 28584*---------- 評価系列コード
 28585         MOVE  WK-DEFAUL-THYK-CD    OF  WK-PTF-ATT-DATA(WK-IDX-J)
 28586           TO  WK-GYOMU-HYK-KRTU-CD  OF  WK-GYOMU-ERR-INFO(CNS-1)
 28587*---------- 基準日From
 28588         MOVE  WK-KIKAN-FR
 28589           TO  WK-GYOMU-KJN-YMD-FROM  OF  WK-GYOMU-ERR-INFO(CNS-1)
 28590*---------- 基準日To
 28591         MOVE  WK-KIKAN-TO
 28592           TO  WK-GYOMU-KJN-YMD-TO  OF  WK-GYOMU-ERR-INFO(CNS-1)
 28593*---------- メッセージID
 28594         MOVE  CNS-MSG-E000355
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 494
* MUSR2651.cob                                                     cpy)cpy)y)y)
 28595           TO  WK-GYOMU-MSG-ID      OF  WK-GYOMU-ERR-INFO(CNS-1)
 28596*---------- 置換文字
 28597         MOVE  SPACE
 28598           TO  WK-GYOMU-TK-MOJI(CNS-1,CNS-1)
 28599*---------- フリーメッセージ
 28600         MOVE  SPACE
 28601           TO  WK-GYOMU-FREE-MSG    OF  WK-GYOMU-ERR-INFO(CNS-1)
 28602*----------  業務エラー1処理
 28603         PERFORM  GYOMU-ERR-1-RTN
 28604       ELSE
 28605         CONTINUE
 28606       END-IF
 28607     ELSE
 28608*----------  テーマ2693対応START
 28609       IF  WK-KZYN-YMD-FROM         OF  WK-PTF-ATT-DATA(WK-IDX-J)
 28610         <= WK-END-YMD-KJN-9
 28611       AND  WK-END-YMD-KJN-9
 28612         <= WK-KZYN-YMD-TO          OF  WK-PTF-ATT-DATA(WK-IDX-J)
 28613*----------  テーマ2693対応END
 28614       THEN
 28615*----------  次のto年月日へ進む
 28616         MOVE  CNS-ON             TO  FLG-NEXT-MEISAI
 28617*----------  ワーク実行ステータス
 28618*------------------ <残タスク157の対応 START>---------------------
 28619         IF  WK-STATUS < CNS-4
 28620         THEN
 28621           MOVE  CNS-4            TO  WK-STATUS
 28622         ELSE
 28623           CONTINUE
 28624         END-IF
 28625*------------------ <残タスク157の対応 END>-----------------------
 28626*----------  ワークリターンコード
 28627         IF  WK-STATUS > WK-RTN-CODE
 28628         THEN
 28629           MOVE  WK-STATUS        TO  WK-RTN-CODE
 28630         ELSE
 28631           CONTINUE
 28632         END-IF
 28633*--------------------<DEBUG>--------------------------------------
 28634D    DISPLAY  CNS-PGM-ID":WK-RTN-CODE=["WK-RTN-CODE"]"
 28635*-----------------------------------------------------------------
 28636*----------  ワーク業務エラーパッケージを編集
 28637         INITIALIZE  WK-GYOMU-ERR-INFO
 28638*----------  基準日実行ステータス
 28639*---------- ファンドコード
 28640         MOVE  WK-FUND-CD-DETAIL    OF  WK-PTF-ATT-DATA(WK-IDX-J)
 28641           TO  WK-GYOMU-FUND-CD     OF  WK-GYOMU-ERR-INFO(CNS-1)
 28642*---------- ポートフォリオコード
 28643         MOVE  WK-PTF-CD-DETAIL     OF  WK-PTF-ATT-DATA(WK-IDX-J)
 28644           TO  WK-GYOMU-PTF-CD      OF  WK-GYOMU-ERR-INFO(CNS-1)
 28645*---------- 評価系列コード
 28646         MOVE  WK-DEFAUL-THYK-CD    OF  WK-PTF-ATT-DATA(WK-IDX-J)
 28647           TO  WK-GYOMU-HYK-KRTU-CD  OF  WK-GYOMU-ERR-INFO(CNS-1)
 28648*---------- 基準日From
 28649         MOVE  WK-KIKAN-FR
 28650           TO  WK-GYOMU-KJN-YMD-FROM  OF  WK-GYOMU-ERR-INFO(CNS-1)
 28651*---------- 基準日To
 28652         MOVE  WK-KIKAN-TO
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 495
* MUSR2651.cob                                                     cpy)cpy)y)y)
 28653           TO  WK-GYOMU-KJN-YMD-TO  OF  WK-GYOMU-ERR-INFO(CNS-1)
 28654*---------- メッセージID
 28655         MOVE  CNS-MSG-E000355
 28656           TO  WK-GYOMU-MSG-ID      OF  WK-GYOMU-ERR-INFO(CNS-1)
 28657*---------- 置換文字
 28658         MOVE  SPACE
 28659           TO  WK-GYOMU-TK-MOJI(CNS-1,CNS-1)
 28660*---------- フリーメッセージ
 28661         MOVE  SPACE
 28662           TO  WK-GYOMU-FREE-MSG    OF  WK-GYOMU-ERR-INFO(CNS-1)
 28663*----------  業務エラー1処理
 28664         PERFORM  GYOMU-ERR-1-RTN
 28665       ELSE
 28666         CONTINUE
 28667       END-IF
 28668     END-IF
 28669*--------------------<DEBUG>--------------------------------------
 28670D    DISPLAY  CNS-PGM-ID":***  日付の判断処理  END  ***"
 28671*-----------------------------------------------------------------
 28672     CONTINUE.
 28673 DATE-CHECK-EXT.
 28674     EXIT.
 28675*******         テーマ2693     20100404 修正  開始        ********
 28676******************************************************************
 28677*    カーソル(CLOSE)
 28678******************************************************************
 28679 CR-CLOSE-5-RTN         SECTION.
 28680*-------------------<DEBUG>---------------------------------------
 28681D    DISPLAY  CNS-PGM-ID":***  カーソル3(CLOSE)  START  ***"
 28682*-----------------------------------------------------------------
 28683*    EXEC  SQL
 28684*        CLOSE CR3
 28685*    END-EXEC
 28686     MOVE 1 TO SQL-ITERS
 28687     MOVE 970 TO SQL-OFFSET
 28688     MOVE 0 TO SQL-OCCURS
 28689     CALL "SQLADR" USING
 28690         SQLCUD
 28691         SQL-CUD
 28692     CALL "SQLADR" USING
 28693         SQLCA
 28694         SQL-SQLEST
 28695     MOVE 256 TO SQL-SQLETY
 28696
 28697     CALL "SQLBEX" USING
 28698         SQLCTX
 28699         SQLEXD
 28700         SQLFPN
 28701*-------------------<DEBUG>---------------------------------------
 28702D    DISPLAY  CNS-PGM-ID":SQLCODE(CURSOR3 CLOSE)  =["SQLCODE"]"
 28703*-----------------------------------------------------------------
 28704     IF  SQLCODE = CNS-SQL-NORMAL
 28705     THEN
 28706       MOVE  CNS-OFF              TO  FLG-CR-OPEN3
 28707*-------------------<DEBUG>---------------------------------------
 28708D    DISPLAY  CNS-PGM-ID":FLG-CR-OPEN3          =["FLG-CR-OPEN3"]"
 28709*-----------------------------------------------------------------
 28710     ELSE
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 496
* MUSR2651.cob                                                     cpy)cpy)y)y)
 28711*----------  ワーク実行ステータス
 28712       MOVE  CNS-16               TO  WK-STATUS
 28713*----------  ワークリターンコード
 28714       MOVE  WK-STATUS            TO  WK-RTN-CODE
 28715*----------  ワークエラーパッケージを編集
 28716       INITIALIZE  WK-SYS-ERR-INFO
 28717*----------  エラー検知プログラムID
 28718       MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
 28719*----------  ポジション
 28720       MOVE  CNS-POS-082          TO  WK-ERR-POS
 28721*----------  リターンコード
 28722       MOVE  CNS-RTN-900          TO  WK-RTN-CD
 28723*----------  詳細リターンコード
 28724       MOVE  SQLCODE              TO  WK-DETAIL-RTN-CD
 28725*----------  詳細リターンコードデコードフラグ
 28726       MOVE  CNS-DETAIL-1         TO  WK-DETAIL-RTN-CD-FLG
 28727*---------- フリーメッセージ
 28728       MOVE  WK-SELECT-FREE-MSG3  TO  WK-FREE-MSG
 28729*----------  エラー情報追加処理
 28730       PERFORM  ERR-INFO-ADD-RTN
 28731     END-IF
 28732*-------------------<DEBUG>---------------------------------------
 28733D    DISPLAY  CNS-PGM-ID":***  カーソル3(CLOSE)  END  ***"
 28734*-----------------------------------------------------------------
 28735     CONTINUE.
 28736 CR-CLOSE-5-EXT.
 28737     EXIT.
 28738******************************************************************
 28739*    カーソル(CLOSE)
 28740******************************************************************
 28741 CR-CLOSE-6-RTN         SECTION.
 28742*-------------------<DEBUG>---------------------------------------
 28743D    DISPLAY  CNS-PGM-ID":***  カーソル(CLOSE)3  START  ***"
 28744*-----------------------------------------------------------------
 28745*    EXEC  SQL
 28746*        CLOSE CR3
 28747*    END-EXEC
 28748     MOVE 1 TO SQL-ITERS
 28749     MOVE 985 TO SQL-OFFSET
 28750     MOVE 0 TO SQL-OCCURS
 28751     CALL "SQLADR" USING
 28752         SQLCUD
 28753         SQL-CUD
 28754     CALL "SQLADR" USING
 28755         SQLCA
 28756         SQL-SQLEST
 28757     MOVE 256 TO SQL-SQLETY
 28758
 28759     CALL "SQLBEX" USING
 28760         SQLCTX
 28761         SQLEXD
 28762         SQLFPN
 28763*-------------------<DEBUG>---------------------------------------
 28764D    DISPLAY  CNS-PGM-ID":SQLCODE(CURSOR CLOSE)3  =["SQLCODE"]"
 28765*-----------------------------------------------------------------
 28766     IF  SQLCODE = CNS-SQL-NORMAL
 28767     THEN
 28768       MOVE  CNS-OFF              TO  FLG-CR-OPEN3
* Micro Focus Server Express         V4.0 revision 000 04-Dec-13 16:03 Page 497
* MUSR2651.cob                                                     cpy)cpy)y)y)
 28769*-------------------<DEBUG>---------------------------------------
 28770D    DISPLAY  CNS-PGM-ID":FLG-CR-OPEN3         =["FLG-CR-OPEN3"]"
 28771*-----------------------------------------------------------------
 28772     ELSE
 28773*----------  ワークリターンコード
 28774       MOVE  CNS-16               TO  WK-RTN-CODE
 28775*----------  ワークエラーパッケージを編集
 28776       INITIALIZE  WK-SYS-ERR-INFO
 28777*----------  エラー検知プログラムID
 28778       MOVE  CNS-PGM-ID           TO  WK-ERR-PGM-ID
 28779*----------  ポジション
 28780       MOVE  CNS-POS-083          TO  WK-ERR-POS
 28781*----------  リターンコード
 28782       MOVE  CNS-RTN-900          TO  WK-RTN-CD
 28783*----------  詳細リターンコード
 28784       MOVE  SQLCODE              TO  WK-DETAIL-RTN-CD
 28785*----------  詳細リターンコードデコードフラグ
 28786       MOVE  CNS-DETAIL-1         TO  WK-DETAIL-RTN-CD-FLG
 28787*---------- フリーメッセージ
 28788       MOVE  WK-SELECT-FREE-MSG3  TO  WK-FREE-MSG
 28789*----------  エラー処理
 28790       PERFORM  ERR-RTN
 28791     END-IF
 28792*-------------------<DEBUG>---------------------------------------
 28793D    DISPLAY  CNS-PGM-ID":***  カーソル(CLOSE)3  END  ***"
 28794*-----------------------------------------------------------------
 28795     CONTINUE.
 28796 CR-CLOSE-6-EXT.
 28797     EXIT.
 28798*******         テーマ2693     20100404 修正  終了        ********
* Micro Focus Server Express         V4.0 revision 000 Compiler
* Copyright (C) 1984-2005 Micro Focus International Ltd. URN RXCTO/AA0/00000A
*                                                        REF GKR-286062000AC
* 合計メッセージ:     0
* データ:    29381212     コード:      249102
